var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,i=(a,t,r)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,o=(e,a)=>{for(var t in a||(a={}))s.call(a,t)&&i(e,t,a[t]);if(r)for(var t of r(a))n.call(a,t)&&i(e,t,a[t]);return e},l=(e,r)=>a(e,t(r)),c=(e,a)=>{var t={};for(var i in e)s.call(e,i)&&a.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&r)for(var i of r(e))a.indexOf(i)<0&&n.call(e,i)&&(t[i]=e[i]);return t},d=(e,a,t)=>new Promise((r,s)=>{var n=e=>{try{o(t.next(e))}catch(a){s(a)}},i=e=>{try{o(t.throw(e))}catch(a){s(a)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,i);o((t=t.apply(e,a)).next())});import{j as h,c as u,R as m,T as f,P as g,C as p,I as x,S as b,u as v,b as y,O as w,d as N,e as j,f as k,g as E,D as T,h as S,i as C,k as A,l as _,m as R,n as O,V as I,o as M,p as P,q as L,r as D,s as F,v as z,w as B,x as U,y as W,L as V,z as H,A as G}from"./vendor-ui-DNPioSOl.js";import{a as q,r as X,R as Y,b as K,c as J}from"./vendor-react-ClyCi2Io.js";import{c as Z,t as Q}from"./vendor-utils-CyEiEXQb.js";import{R as ee,A as ae,C as te,X as re,Y as se,T as ne,a as ie,P as oe,b as le,c as ce,L as de,B as he,d as ue}from"./vendor-charts-KQ7_iqWV.js";import{c as me}from"./vendor-supabase-J0LBLPYD.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)}).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();var fe={},ge=q;fe.createRoot=ge.createRoot,fe.hydrateRoot=ge.hydrateRoot;
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var pe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=(e,a)=>{const t=X.forwardRef((t,r)=>{var s,n=t,{color:i="currentColor",size:d=24,strokeWidth:h=2,absoluteStrokeWidth:u,className:m="",children:f}=n,g=c(n,["color","size","strokeWidth","absoluteStrokeWidth","className","children"]);return X.createElement("svg",o(l(o({ref:r},pe),{width:d,height:d,stroke:i,strokeWidth:u?24*Number(h)/Number(d):h,className:["lucide",`lucide-${s=e,s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,m].join(" ")}),g),[...a.map(([e,a])=>X.createElement(e,a)),...Array.isArray(f)?f:[f]])});return t.displayName=`${e}`,t},be=xe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ve=xe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ye=xe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),we=xe("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),Ne=xe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),je=xe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),ke=xe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Ee=xe("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Te=xe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Se=xe("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),Ce=xe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Ae=xe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),_e=xe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Re=xe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Oe=xe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Ie=xe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Me=xe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Pe=xe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Le=xe("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),De=xe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Fe=xe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ze=xe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Be=xe("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),Ue=xe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),$e=xe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),We=xe("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),Ve=xe("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),He=xe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Ge=xe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),qe=xe("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),Xe=xe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Ye=xe("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ke=xe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),Je=xe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Ze=xe("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Qe=xe("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),ea=xe("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),aa=xe("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),ta=xe("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),ra=xe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),sa=xe("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),na=xe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ia=xe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),oa=xe("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),la=xe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),ca=xe("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),da=xe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),ha=xe("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),ua=xe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),ma=xe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),fa=xe("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),ga=xe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),pa=xe("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),xa=xe("Quote",[["path",{d:"M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z",key:"4rm80e"}],["path",{d:"M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z",key:"10za9r"}]]),ba=xe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),va=xe("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),ya=xe("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),wa=xe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Na=xe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),ja=xe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ka=xe("Sheet",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"3",x2:"21",y1:"9",y2:"9",key:"1vqk6q"}],["line",{x1:"3",x2:"21",y1:"15",y2:"15",key:"o2sbyz"}],["line",{x1:"9",x2:"9",y1:"9",y2:"21",key:"1ib60c"}],["line",{x1:"15",x2:"15",y1:"9",y2:"21",key:"1n26ft"}]]),Ea=xe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Ta=xe("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),Sa=xe("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Ca=xe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),Aa=xe("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),_a=xe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Ra=xe("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Oa=xe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Ia=xe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Ma=xe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Pa=xe("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),La=xe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Da=xe("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),Fa=xe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),za=xe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ba=xe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ua=xe("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]),$a=xe("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Wa=xe("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),Va=xe("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ha=xe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ga=xe("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),qa=xe("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var Xa=Symbol.for("react.lazy"),Ya=Y[" use ".trim().toString()];function Ka(e){return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===Xa&&"_payload"in e&&("object"==typeof(a=e._payload)&&null!==a&&"then"in a);var a}function Ja(e){const a=Qa(e),t=X.forwardRef((e,t)=>{let r=e,{children:s}=r,n=c(r,["children"]);Ka(s)&&"function"==typeof Ya&&(s=Ya(s._payload));const i=X.Children.toArray(s),d=i.find(at);if(d){const e=d.props.children,r=i.map(a=>a===d?X.Children.count(e)>1?X.Children.only(null):X.isValidElement(e)?e.props.children:null:a);return h.jsx(a,l(o({},n),{ref:t,children:X.isValidElement(e)?X.cloneElement(e,void 0,r):null}))}return h.jsx(a,l(o({},n),{ref:t,children:s}))});return t.displayName=`${e}.Slot`,t}var Za=Ja("Slot");function Qa(e){const a=X.forwardRef((e,a)=>{let t=e,{children:r}=t,s=c(t,["children"]);if(Ka(r)&&"function"==typeof Ya&&(r=Ya(r._payload)),X.isValidElement(r)){const e=function(e){var a,t;let r=null==(a=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:a.get,s=r&&"isReactWarning"in r&&r.isReactWarning;if(s)return e.ref;if(r=null==(t=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:t.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s)return e.props.ref;return e.props.ref||e.ref}(r),t=function(e,a){const t=o({},a);for(const r in a){const s=e[r],n=a[r];/^on[A-Z]/.test(r)?s&&n?t[r]=(...e)=>{const a=n(...e);return s(...e),a}:s&&(t[r]=s):"style"===r?t[r]=o(o({},s),n):"className"===r&&(t[r]=[s,n].filter(Boolean).join(" "))}return o(o({},e),t)}(s,r.props);return r.type!==X.Fragment&&(t.ref=a?u(a,e):e),X.cloneElement(r,t)}return X.Children.count(r)>1?X.Children.only(null):null});return a.displayName=`${e}.SlotClone`,a}var et=Symbol("radix.slottable");function at(e){return X.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===et}const tt=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,rt=Z,st=(e,a)=>t=>{var r;if(null==(null==a?void 0:a.variants))return rt(e,null==t?void 0:t.class,null==t?void 0:t.className);const{variants:s,defaultVariants:n}=a,i=Object.keys(s).map(e=>{const a=null==t?void 0:t[e],r=null==n?void 0:n[e];if(null===a)return null;const i=tt(a)||tt(r);return s[e][i]}),l=t&&Object.entries(t).reduce((e,a)=>{let[t,r]=a;return void 0===r||(e[t]=r),e},{}),d=null==a||null===(r=a.compoundVariants)||void 0===r?void 0:r.reduce((e,a)=>{let t=a,{class:r,className:s}=t,i=c(t,["class","className"]);return Object.entries(i).every(e=>{let[a,t]=e;return Array.isArray(t)?t.includes(o(o({},n),l)[a]):o(o({},n),l)[a]===t})?[...e,r,s]:e},[]);return rt(e,i,d,null==t?void 0:t.class,null==t?void 0:t.className)};function nt(...e){return Q(Z(e))}const it=st("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),ot=X.forwardRef((e,a)=>{var t=e,{className:r,variant:s,size:n,asChild:i=!1}=t,l=c(t,["className","variant","size","asChild"]);const d=i?Za:"button";return h.jsx(d,o({ref:a,"data-slot":"button",className:nt(it({variant:s,size:n,className:r}))},l))});function lt({size:e=40,className:a=""}){return h.jsx("div",{className:`bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg ${a}`,style:{width:e,height:e},children:h.jsx(qa,{className:"text-white",style:{width:.6*e,height:.6*e}})})}function ct({onLogin:e,onSignup:a}){const[t,r]=X.useState(!1),[s,n]=X.useState(!1);X.useEffect(()=>{const e=()=>{r(window.scrollY>20)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);const i=[{label:"In√≠cio",href:"#inicio"},{label:"Recursos",href:"#recursos"},{label:"Planos",href:"#planos"},{label:"Depoimentos",href:"#depoimentos"},{label:"FAQ",href:"#faq"}];return h.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 transition-all duration-300 "+(t?"bg-white/95 backdrop-blur-md shadow-md":"bg-white/80 backdrop-blur-sm border-b border-gray-100"),children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"flex items-center justify-between h-16 lg:h-20",children:[h.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx(lt,{}),h.jsx("span",{className:"text-gray-900",children:"LeadFlow CRM"})]}),h.jsx("nav",{className:"hidden lg:flex items-center gap-8",children:i.map(e=>h.jsx("a",{href:e.href,className:"text-gray-600 hover:text-blue-600 transition-colors",children:e.label},e.label))}),h.jsxs("div",{className:"hidden lg:flex items-center gap-4",children:[h.jsxs(ot,{variant:"ghost",className:"text-gray-600",onClick:e,children:[h.jsx(sa,{className:"w-4 h-4 mr-2"}),"Entrar"]}),h.jsx(ot,{onClick:a,className:"bg-blue-600 hover:bg-blue-700 text-white shadow-lg shadow-blue-500/30",children:"Criar Conta Gr√°tis"})]}),h.jsx("button",{className:"lg:hidden p-2 text-gray-600 hover:text-gray-900",onClick:()=>n(!s),"aria-label":"Toggle menu",children:s?h.jsx(Ha,{className:"w-6 h-6"}):h.jsx(la,{className:"w-6 h-6"})})]}),s&&h.jsx("div",{className:"lg:hidden py-4 border-t border-gray-200 bg-white",children:h.jsxs("nav",{className:"flex flex-col gap-4",children:[i.map(e=>h.jsx("a",{href:e.href,className:"text-gray-600 hover:text-blue-600 transition-colors px-2",onClick:()=>n(!1),children:e.label},e.label)),h.jsxs("div",{className:"flex flex-col gap-2 pt-4 border-t border-gray-200",children:[h.jsxs(ot,{variant:"ghost",className:"text-gray-600 w-full",onClick:e,children:[h.jsx(sa,{className:"w-4 h-4 mr-2"}),"Entrar"]}),h.jsx(ot,{onClick:a,className:"bg-blue-600 hover:bg-blue-700 text-white w-full",children:"Criar Conta Gr√°tis"})]})]})})]})})}function dt({onGetStarted:e}){return h.jsxs("section",{id:"inicio",className:"relative pt-32 pb-20 lg:pt-40 lg:pb-32 overflow-hidden bg-white",children:[h.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAxMCAwIEwgMCAwIDAgMTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuMDMiIHN0cm9rZS13aWR0aD0iMSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNncmlkKSIvPjwvc3ZnPg==')] opacity-100"}),h.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-100 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob"}),h.jsx("div",{className:"absolute top-0 right-1/4 w-96 h-96 bg-purple-100 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000"}),h.jsx("div",{className:"absolute -bottom-32 left-1/2 w-96 h-96 bg-pink-100 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000"}),h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:h.jsxs("div",{className:"max-w-5xl mx-auto text-center",children:[h.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-100 rounded-full px-4 py-2 mb-8 hover:shadow-md transition-shadow",children:[h.jsx(Sa,{className:"w-4 h-4 text-blue-600"}),h.jsx("span",{className:"text-gray-700 font-medium",children:"Confiado por mais de 10.000 empresas"})]}),h.jsxs("h1",{className:"text-gray-900 mb-6 leading-[1.1] font-bold",children:[h.jsx("span",{className:"block text-5xl sm:text-6xl lg:text-7xl xl:text-8xl tracking-tight",children:"Transforme"}),h.jsx("span",{className:"block text-5xl sm:text-6xl lg:text-7xl xl:text-8xl tracking-tight bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent",children:"seus leads"}),h.jsx("span",{className:"block text-5xl sm:text-6xl lg:text-7xl xl:text-8xl tracking-tight",children:"em clientes"})]}),h.jsx("p",{className:"text-gray-600 mb-10 text-xl sm:text-2xl leading-relaxed max-w-3xl mx-auto font-normal",children:"Automatize seu funil de vendas, acompanhe cada intera√ß√£o e converta mais leads com o poder da intelig√™ncia artificial."}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-16 justify-center",children:[h.jsxs(ot,{onClick:e,size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-200 text-lg px-8 py-6 font-semibold",children:["Come√ßar Gratuitamente",h.jsx(ye,{className:"w-5 h-5 ml-2"})]}),h.jsxs(ot,{variant:"outline",size:"lg",className:"border-2 border-gray-300 text-gray-700 hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 text-lg px-8 py-6 font-semibold",children:[h.jsx(fa,{className:"w-5 h-5 mr-2"}),"Assistir Demo"]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-8 pt-8 border-t border-gray-200 max-w-2xl mx-auto",children:[h.jsxs("div",{children:[h.jsx("div",{className:"text-3xl sm:text-4xl text-gray-900 mb-1 font-bold",children:"10k+"}),h.jsx("div",{className:"text-gray-600 font-medium",children:"Clientes"})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-3xl sm:text-4xl text-gray-900 mb-1 font-bold",children:"95%"}),h.jsx("div",{className:"text-gray-600 font-medium",children:"Satisfa√ß√£o"})]}),h.jsxs("div",{children:[h.jsx("div",{className:"text-3xl sm:text-4xl text-gray-900 mb-1 font-bold",children:"24/7"}),h.jsx("div",{className:"text-gray-600 font-medium",children:"Suporte"})]})]})]})}),h.jsx("style",{children:"\n        @keyframes blob {\n          0%, 100% { transform: translate(0, 0) scale(1); }\n          33% { transform: translate(30px, -50px) scale(1.1); }\n          66% { transform: translate(-20px, 20px) scale(0.9); }\n        }\n        .animate-blob {\n          animation: blob 7s infinite;\n        }\n        .animation-delay-2000 {\n          animation-delay: 2s;\n        }\n        .animation-delay-4000 {\n          animation-delay: 4s;\n        }\n      "})]})}ot.displayName="Button";const ht=[{icon:ea,title:"Painel de Controle Inteligente",description:"Visualize todas as suas m√©tricas importantes em um √∫nico lugar. Dashboard personaliz√°vel e intuitivo.",gradient:"from-blue-500 to-blue-600"},{icon:Ge,title:"Filtros e Relat√≥rios em Tempo Real",description:"Filtre leads por origem, status, per√≠odo e mais. Gere relat√≥rios detalhados instantaneamente.",gradient:"from-purple-500 to-purple-600"},{icon:Ne,title:"Gr√°ficos Interativos e Indicadores",description:"Acompanhe tend√™ncias com gr√°ficos din√¢micos. KPIs atualizados automaticamente.",gradient:"from-indigo-500 to-indigo-600"},{icon:Ba,title:"Gest√£o de Leads e Planos Integrados",description:"Gerencie todo o ciclo de vida dos leads. Integra√ß√£o perfeita com seus planos de vendas.",gradient:"from-cyan-500 to-cyan-600"},{icon:qa,title:"Automa√ß√µes Poderosas",description:"Configure fluxos automatizados de follow-up e nutri√ß√£o. Economize tempo e aumente convers√µes.",gradient:"from-yellow-500 to-orange-500"},{icon:Ea,title:"Seguran√ßa e Privacidade",description:"Seus dados protegidos com criptografia de ponta. Conformidade total com LGPD e GDPR.",gradient:"from-green-500 to-green-600"},{icon:Xe,title:"Acesso de Qualquer Lugar",description:"Trabalhe de onde estiver. Sincroniza√ß√£o em tempo real entre todos os dispositivos.",gradient:"from-pink-500 to-pink-600"},{icon:Ta,title:"Mobile First",description:"Interface otimizada para dispositivos m√≥veis. Gerencie seus leads em movimento.",gradient:"from-violet-500 to-violet-600"}];function ut(){return h.jsx("section",{id:"recursos",className:"py-16 lg:py-24 bg-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12 lg:mb-16",children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-full mb-4",children:[h.jsx(qa,{className:"w-4 h-4"}),h.jsx("span",{className:"text-sm",children:"Recursos Poderosos"})]}),h.jsx("h2",{className:"text-gray-900 mb-4",children:"Tudo que voc√™ precisa para vender mais"}),h.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"LeadFlow CRM oferece ferramentas completas para captar, qualificar e converter leads de forma eficiente."})]}),h.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-6 lg:gap-8",children:ht.map((e,a)=>{const t=e.icon;return h.jsxs("div",{className:"group relative bg-gray-50 rounded-2xl p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1 border border-gray-100 hover:border-blue-200",children:[h.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${e.gradient} rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform shadow-lg`,children:h.jsx(t,{className:"w-6 h-6 text-white"})}),h.jsx("h3",{className:"text-gray-900 mb-2",children:e.title}),h.jsx("p",{className:"text-sm text-gray-600",children:e.description}),h.jsx("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-br from-blue-500/5 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"})]},a)})}),h.jsxs("div",{className:"text-center mt-12",children:[h.jsx("p",{className:"text-gray-600 mb-4",children:"Explore todos os recursos gratuitamente por 14 dias"}),h.jsxs("a",{href:"#planos",className:"inline-flex items-center text-blue-600 hover:text-blue-700 transition-colors group",children:["Ver todos os planos",h.jsx("svg",{className:"ml-2 w-4 h-4 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})})}const mt=[{icon:Ma,label:"Taxa de Convers√£o",value:"32.5%",change:"+12.3%",positive:!0},{icon:Ba,label:"Leads Ativos",value:"1,847",change:"+245",positive:!0},{icon:Oa,label:"Meta do M√™s",value:"87%",change:"+5%",positive:!0},{icon:Fe,label:"Receita Prevista",value:"R$ 142K",change:"+18.2%",positive:!0}],ft=[{source:"Website",count:524,percentage:35,color:"bg-blue-500"},{source:"Instagram",count:412,percentage:28,color:"bg-purple-500"},{source:"Facebook",count:338,percentage:22,color:"bg-indigo-500"},{source:"LinkedIn",count:225,percentage:15,color:"bg-cyan-500"}],gt=[{status:"Novos",count:423,color:"bg-yellow-400"},{status:"Qualificados",count:387,color:"bg-blue-500"},{status:"Em Negocia√ß√£o",count:245,color:"bg-purple-500"},{status:"Convertidos",count:156,color:"bg-green-500"},{status:"Perdidos",count:89,color:"bg-gray-400"}];function pt(){return h.jsx("section",{className:"py-16 lg:py-24 bg-gradient-to-br from-gray-50 to-blue-50",children:h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 lg:gap-16 items-center",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-full mb-6",children:[h.jsx(Ma,{className:"w-4 h-4"}),h.jsx("span",{className:"text-sm",children:"Analytics & Insights"})]}),h.jsx("h2",{className:"text-gray-900 mb-4",children:"Decis√µes baseadas em dados reais"}),h.jsx("p",{className:"text-gray-600 mb-8",children:"Acompanhe o desempenho das suas campanhas em tempo real. Identifique oportunidades e otimize sua estrat√©gia com insights acion√°veis."}),h.jsx("div",{className:"grid grid-cols-2 gap-4 mb-8",children:mt.map((e,a)=>{const t=e.icon;return h.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-100 shadow-sm hover:shadow-md transition-shadow",children:[h.jsx("div",{className:"flex items-center gap-2 mb-2",children:h.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:h.jsx(t,{className:"w-4 h-4 text-blue-600"})})}),h.jsx("p",{className:"text-sm text-gray-600 mb-1",children:e.label}),h.jsxs("div",{className:"flex items-end justify-between",children:[h.jsx("p",{className:"text-gray-900",children:e.value}),h.jsx("span",{className:"text-xs "+(e.positive?"text-green-600":"text-red-600"),children:e.change})]})]},a)})}),h.jsxs("div",{className:"flex flex-wrap gap-4",children:[h.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[h.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),h.jsx("span",{children:"Atualiza√ß√£o em tempo real"})]}),h.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[h.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),h.jsx("span",{children:"Exporta√ß√£o de relat√≥rios"})]})]})]}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:[h.jsx("h3",{className:"text-gray-900 mb-6",children:"Leads por Origem"}),h.jsx("div",{className:"space-y-4",children:ft.map((e,a)=>h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("span",{className:"text-sm text-gray-600",children:e.source}),h.jsx("span",{className:"text-sm text-gray-900",children:e.count})]}),h.jsx("div",{className:"relative h-2 bg-gray-100 rounded-full overflow-hidden",children:h.jsx("div",{className:`absolute left-0 top-0 h-full ${e.color} rounded-full transition-all duration-500`,style:{width:`${e.percentage}%`}})})]},a))})]}),h.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-gray-100",children:[h.jsx("h3",{className:"text-gray-900 mb-6",children:"Status dos Leads"}),h.jsx("div",{className:"space-y-3",children:gt.map((e,a)=>h.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:`w-3 h-3 ${e.color} rounded-full`}),h.jsx("span",{className:"text-sm text-gray-700",children:e.status})]}),h.jsx("span",{className:"text-gray-900",children:e.count})]},a))})]})]})]})})})}const xt=[{name:"Gratuito",icon:qa,iconColor:"text-gray-600",price:"$0",period:"/m√™s",description:"Perfeito para come√ßar",features:["At√© 100 leads/m√™s","At√© 50 mensagens WhatsApp/m√™s","At√© 5 envios em massa/m√™s","1 campanha ativa","Painel b√°sico de m√©tricas","Suporte por email (48h)"],cta:"Criar Conta Gr√°tis",highlighted:!1,variant:"outline",trial:!1},{name:"Business",icon:_a,iconColor:"text-blue-600",price:"$20",period:"/m√™s",priceAnnual:"$100",periodAnnual:"/ano",description:"Para equipes em crescimento",features:["At√© 1.000 leads/m√™s","At√© 500 mensagens WhatsApp/m√™s","At√© 50 envios em massa/m√™s","At√© 10 campanhas ativas","Painel completo e personaliz√°vel","Relat√≥rios em tempo real","Todas as integra√ß√µes","API de acesso e HTTP endpoint","Suporte priorit√°rio (4h)"],cta:"Come√ßar Agora",highlighted:!0,popular:!0,variant:"default",trial:!1},{name:"Enterprise",icon:Le,iconColor:"text-purple-600",price:"$59",period:"/m√™s",priceAnnual:"$200",periodAnnual:"/ano",description:"Para grandes opera√ß√µes",features:["Leads ilimitados","Mensagens WhatsApp ilimitadas","Envios em massa ilimitados","Campanhas ilimitadas","Tudo do Business, mais:","Gerente de conta dedicado","SLA garantido 99.9%","Suporte priorit√°rio 24/7","Onboarding personalizado","Customiza√ß√µes sob medida","Seguran√ßa avan√ßada"],cta:"Come√ßar Agora",highlighted:!1,variant:"outline",trial:!1}];function bt({onSelectPlan:e}){return h.jsx("section",{id:"planos",className:"py-16 lg:py-24 bg-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12 lg:mb-16",children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-full mb-4",children:[h.jsx(_a,{className:"w-4 h-4"}),h.jsx("span",{className:"text-sm",children:"Planos e Pre√ßos"})]}),h.jsx("h2",{className:"text-gray-900 mb-4",children:"Escolha o plano ideal para voc√™"}),h.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Comece gr√°tis e fa√ßa upgrade quando precisar. Sem compromissos ou taxas escondidas."})]}),h.jsx("div",{className:"md:hidden overflow-x-auto pb-8 -mx-4 px-4",children:h.jsx("div",{className:"flex gap-6 min-w-max",children:xt.map((a,t)=>{const r=a.icon;return h.jsxs("div",{className:"relative rounded-2xl p-8 transition-all duration-300 w-[320px] flex-shrink-0 "+(a.highlighted?"bg-gradient-to-br from-blue-600 to-purple-600 text-white shadow-2xl scale-105 border-2 border-blue-500":"bg-gray-50 border border-gray-200 hover:shadow-xl hover:border-blue-200"),children:[a.popular&&h.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:h.jsxs("span",{className:"inline-flex items-center gap-1 px-4 py-1 bg-yellow-400 text-gray-900 rounded-full text-sm shadow-lg",children:[h.jsx(_a,{className:"w-4 h-4 fill-current"}),"Mais Popular"]})}),h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:`w-12 h-12 ${a.highlighted?"bg-white/20":"bg-white"} rounded-xl flex items-center justify-center`,children:h.jsx(r,{className:`w-6 h-6 ${a.highlighted?"text-white":a.iconColor}`})}),h.jsx("h3",{className:""+(a.highlighted?"text-white":"text-gray-900"),children:a.name})]}),h.jsxs("div",{className:"mb-2",children:[h.jsx("span",{className:""+(a.highlighted?"text-white":"text-gray-900"),children:a.price}),h.jsx("span",{className:"text-sm "+(a.highlighted?"text-white/80":"text-gray-600"),children:a.period})]}),h.jsx("p",{className:"text-sm mb-4 "+(a.highlighted?"text-white/90":"text-gray-600"),children:a.description}),a.trial&&h.jsxs("div",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs mb-6 "+(a.highlighted?"bg-white/20 text-white":"bg-blue-100 text-blue-700"),children:[h.jsx(qa,{className:"w-3 h-3"}),a.trial]}),h.jsx(ot,{className:"w-full mb-8 "+(a.highlighted?"bg-white text-blue-600 hover:bg-gray-100 shadow-lg":"bg-blue-600 text-white hover:bg-blue-700"),size:"lg",onClick:()=>e&&e(a.name),children:a.cta}),h.jsx("ul",{className:"space-y-3",children:a.features.map((e,t)=>h.jsxs("li",{className:"flex items-start gap-3",children:[h.jsx(Ce,{className:"w-5 h-5 flex-shrink-0 mt-0.5 "+(a.highlighted?"text-white":"text-blue-600")}),h.jsx("span",{className:"text-sm "+(a.highlighted?"text-white/90":"text-gray-700"),children:e})]},t))})]},t)})})}),h.jsx("div",{className:"hidden md:grid md:grid-cols-3 gap-8 max-w-7xl mx-auto",children:xt.map((a,t)=>{const r=a.icon;return h.jsxs("div",{className:"relative rounded-2xl p-8 transition-all duration-300 "+(a.highlighted?"bg-gradient-to-br from-blue-600 to-purple-600 text-white shadow-2xl scale-105 border-2 border-blue-500":"bg-gray-50 border border-gray-200 hover:shadow-xl hover:border-blue-200"),children:[a.popular&&h.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2",children:h.jsxs("span",{className:"inline-flex items-center gap-1 px-4 py-1 bg-yellow-400 text-gray-900 rounded-full text-sm shadow-lg",children:[h.jsx(_a,{className:"w-4 h-4 fill-current"}),"Mais Popular"]})}),h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:`w-12 h-12 ${a.highlighted?"bg-white/20":"bg-white"} rounded-xl flex items-center justify-center`,children:h.jsx(r,{className:`w-6 h-6 ${a.highlighted?"text-white":a.iconColor}`})}),h.jsx("h3",{className:""+(a.highlighted?"text-white":"text-gray-900"),children:a.name})]}),h.jsxs("div",{className:"mb-2",children:[h.jsx("span",{className:""+(a.highlighted?"text-white":"text-gray-900"),children:a.price}),h.jsx("span",{className:"text-sm "+(a.highlighted?"text-white/80":"text-gray-600"),children:a.period})]}),h.jsx("p",{className:"text-sm mb-4 "+(a.highlighted?"text-white/90":"text-gray-600"),children:a.description}),a.trial&&h.jsxs("div",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs mb-6 "+(a.highlighted?"bg-white/20 text-white":"bg-blue-100 text-blue-700"),children:[h.jsx(qa,{className:"w-3 h-3"}),a.trial]}),h.jsx(ot,{className:"w-full mb-8 "+(a.highlighted?"bg-white text-blue-600 hover:bg-gray-100 shadow-lg":"bg-blue-600 text-white hover:bg-blue-700"),size:"lg",onClick:()=>e&&e(a.name),children:a.cta}),h.jsx("ul",{className:"space-y-3",children:a.features.map((e,t)=>h.jsxs("li",{className:"flex items-start gap-3",children:[h.jsx(Ce,{className:"w-5 h-5 flex-shrink-0 mt-0.5 "+(a.highlighted?"text-white":"text-blue-600")}),h.jsx("span",{className:"text-sm "+(a.highlighted?"text-white/90":"text-gray-700"),children:e})]},t))})]},t)})}),h.jsxs("div",{className:"text-center mt-12",children:[h.jsxs("p",{className:"text-gray-600 mb-2",children:["üéâ Comece gr√°tis agora - ",h.jsx("strong",{children:"Sem cart√£o de cr√©dito"})]}),h.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Cancele quando quiser, sem multas ou burocracias"}),h.jsxs("p",{className:"text-sm text-blue-600 flex items-center justify-center gap-2",children:[h.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944.901C5.026.382 5.474 0 5.998 0h7.46c2.57 0 4.578.543 5.69 1.81 1.01 1.15 1.304 2.42 1.012 4.287-.023.143-.047.288-.077.437-.983 5.05-4.349 6.797-8.647 6.797h-2.19c-.524 0-.968.382-1.05.9l-1.12 7.106zm14.146-14.42a3.35 3.35 0 0 0-.607-.541c-.013.076-.026.175-.041.254-.93 4.778-4.005 7.201-9.138 7.201h-2.19a.563.563 0 0 0-.556.479l-1.187 7.527h-.506L9.18 14.311h1.248c4.57 0 7.266-2.292 8.032-6.828.018-.106.053-.31.086-.563.055-.062.116-.12.178-.18.117-.114.26-.217.46-.217z"})}),"Pagamentos processados com seguran√ßa via PayPal"]})]})]})})}const vt=[{name:"Ana Carolina Silva",role:"Diretora de Vendas",company:"TechSolutions",image:"professional woman",rating:5,content:"LeadFlow CRM transformou completamente nossa opera√ß√£o comercial. Aumentamos nossa taxa de convers√£o em 40% nos primeiros 3 meses. A interface √© intuitiva e os relat√≥rios s√£o extremamente √∫teis."},{name:"Ricardo Mendes",role:"CEO",company:"StartHub",image:"business man",rating:5,content:"Testamos diversos CRMs antes de encontrar o LeadFlow. A diferen√ßa est√° na simplicidade e na automa√ß√£o inteligente. Nossa equipe adotou a ferramenta em menos de uma semana."},{name:"Juliana Costa",role:"Gerente de Marketing",company:"Growth Agency",image:"professional woman smiling",rating:5,content:"O que mais me impressiona √© a qualidade do suporte e as atualiza√ß√µes constantes. Cada novo recurso realmente resolve problemas reais que enfrentamos no dia a dia."}];function yt(){return h.jsx("section",{id:"depoimentos",className:"py-16 lg:py-24 bg-gradient-to-br from-blue-50 to-purple-50",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12 lg:mb-16",children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-full mb-4",children:[h.jsx(_a,{className:"w-4 h-4 fill-current"}),h.jsx("span",{className:"text-sm",children:"Depoimentos"})]}),h.jsx("h2",{className:"text-gray-900 mb-4",children:"Mais de 10.000 clientes satisfeitos"}),h.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Veja o que nossos clientes est√£o dizendo sobre o LeadFlow CRM"})]}),h.jsx("div",{className:"grid md:grid-cols-3 gap-8 max-w-7xl mx-auto",children:vt.map((e,a)=>h.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 border border-gray-100 relative",children:[h.jsx("div",{className:"absolute top-6 right-6 opacity-10",children:h.jsx(xa,{className:"w-16 h-16 text-blue-600"})}),h.jsx("div",{className:"flex gap-1 mb-4",children:[...Array(e.rating)].map((e,a)=>h.jsx(_a,{className:"w-5 h-5 text-yellow-400 fill-current"},a))}),h.jsxs("p",{className:"text-gray-700 mb-6 relative z-10",children:['"',e.content,'"']}),h.jsxs("div",{className:"flex items-center gap-4 pt-6 border-t border-gray-100",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full flex items-center justify-center text-white flex-shrink-0",children:h.jsx("span",{className:"text-lg",children:e.name.charAt(0)})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-gray-900",children:e.name}),h.jsxs("p",{className:"text-sm text-gray-600",children:[e.role," ‚Ä¢ ",e.company]})]})]})]},a))}),h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 mt-16 max-w-4xl mx-auto",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-blue-600 mb-2",children:"10.000+"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Clientes Ativos"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-blue-600 mb-2",children:"4.9/5"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Avalia√ß√£o M√©dia"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-blue-600 mb-2",children:"98%"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Satisfa√ß√£o"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("p",{className:"text-blue-600 mb-2",children:"24/7"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Suporte"})]})]})]})})}const wt=[{question:"Como funciona o per√≠odo de teste gratuito?",answer:"Voc√™ tem 7 dias para testar todos os recursos de qualquer plano gratuitamente, sem precisar cadastrar cart√£o de cr√©dito. Ao final do per√≠odo, voc√™ pode escolher assinar um plano pago ou continuar com a vers√£o Gratuita."},{question:"Posso mudar de plano a qualquer momento?",answer:"Sim! Voc√™ pode fazer upgrade ou downgrade do seu plano a qualquer momento. As mudan√ßas s√£o processadas imediatamente e o valor √© ajustado proporcionalmente na sua pr√≥xima cobran√ßa."},{question:"Quais formas de pagamento s√£o aceitas?",answer:"Aceitamos PayPal e todos os principais cart√µes de cr√©dito (Visa, Mastercard, American Express). O PayPal oferece seguran√ßa adicional e facilidade no gerenciamento de suas assinaturas."},{question:"Meus dados est√£o seguros?",answer:"Sim! Utilizamos criptografia de ponta a ponta, servidores em nuvem certificados e seguimos as melhores pr√°ticas de seguran√ßa. Somos totalmente compat√≠veis com LGPD e GDPR."},{question:"Posso integrar o LeadFlow com outras ferramentas?",answer:"Sim! Oferecemos integra√ß√µes nativas com as principais ferramentas do mercado, incluindo WhatsApp, Evolution API, Facebook Ads, Google Ads, N8N e muito mais. Tamb√©m disponibilizamos API REST e HTTP endpoint para integra√ß√µes customizadas."},{question:"Como funciona o suporte ao cliente?",answer:"Oferecemos suporte por email e WhatsApp. O tempo de resposta varia de acordo com o plano: plano Gratuito tem suporte em at√© 48h, Business em at√© 4h, e Enterprise conta com suporte priorit√°rio 24/7."},{question:"Posso cancelar minha assinatura a qualquer momento?",answer:"Sim, voc√™ pode cancelar sua assinatura a qualquer momento, sem multas ou taxas adicionais. Voc√™ continuar√° tendo acesso aos recursos do plano at√© o final do per√≠odo pago."},{question:"Existe limite de leads ou mensagens?",answer:"O plano Gratuito permite at√© 100 leads/m√™s, 10 mensagens WhatsApp e 5 envios em massa. O plano Business oferece at√© 500 leads, 200 mensagens e 50 envios em massa. O plano Enterprise n√£o tem limita√ß√µes."}];function Nt(){const[e,a]=X.useState(0);return h.jsx("section",{id:"faq",className:"py-16 lg:py-24 bg-white",children:h.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"text-center mb-12 lg:mb-16",children:[h.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-700 rounded-full mb-4",children:[h.jsx(Ye,{className:"w-4 h-4"}),h.jsx("span",{className:"text-sm",children:"Perguntas Frequentes"})]}),h.jsx("h2",{className:"text-gray-900 mb-4",children:"Tire suas d√∫vidas"}),h.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"N√£o encontrou a resposta que procura? Entre em contato conosco pelo chat ou email."})]}),h.jsx("div",{className:"max-w-3xl mx-auto",children:wt.map((t,r)=>h.jsxs("div",{className:"mb-4 border border-gray-200 rounded-xl overflow-hidden hover:border-blue-200 transition-colors",children:[h.jsxs("button",{onClick:()=>(t=>{a(e===t?null:t)})(r),className:"w-full flex items-center justify-between p-6 text-left bg-white hover:bg-gray-50 transition-colors",children:[h.jsx("span",{className:"text-gray-900 pr-8",children:t.question}),h.jsx(Ae,{className:"w-5 h-5 text-gray-600 flex-shrink-0 transition-transform duration-300 "+(e===r?"rotate-180":"")})]}),h.jsx("div",{className:"overflow-hidden transition-all duration-300 "+(e===r?"max-h-96":"max-h-0"),children:h.jsx("div",{className:"p-6 pt-0 text-gray-600 bg-gray-50",children:t.answer})})]},r))}),h.jsxs("div",{className:"text-center mt-12 p-8 bg-gradient-to-br from-blue-50 to-purple-50 rounded-2xl max-w-2xl mx-auto",children:[h.jsx("h3",{className:"text-gray-900 mb-2",children:"Ainda tem d√∫vidas?"}),h.jsx("p",{className:"text-gray-600 mb-6",children:"Nossa equipe est√° pronta para ajudar voc√™"}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[h.jsx("a",{href:"#",className:"inline-flex items-center justify-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Falar com Suporte"}),h.jsx("a",{href:"#",className:"inline-flex items-center justify-center px-6 py-3 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:"Ver Central de Ajuda"})]})]})]})})}function jt({onGetStarted:e}){return h.jsxs("section",{className:"py-20 lg:py-32 relative overflow-hidden",children:[h.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600 via-blue-700 to-purple-800"}),h.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAxMCAwIEwgMCAwIDAgMTAiIGZpbGw9Im5vbmUiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS1vcGFjaXR5PSIwLjEiIHN0cm9rZS13aWR0aD0iMSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNncmlkKSIvPjwvc3ZnPg==')] opacity-20"}),h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:h.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-white/10 backdrop-blur-sm rounded-2xl flex items-center justify-center mx-auto mb-6",children:h.jsx(qa,{className:"w-8 h-8 text-white"})}),h.jsx("h2",{className:"text-white mb-6",children:"Pronto para transformar seus leads em clientes?"}),h.jsx("p",{className:"text-blue-100 text-lg mb-8 max-w-2xl mx-auto",children:"Junte-se a milhares de empresas que j√° aumentaram suas vendas com LeadFlow CRM. Comece gratuitamente hoje mesmo, sem cart√£o de cr√©dito necess√°rio."}),h.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-12",children:[h.jsxs(ot,{onClick:e,className:"bg-white text-blue-600 hover:bg-gray-100 shadow-xl",children:["Come√ßar Gratuitamente",h.jsx(ye,{className:"w-4 h-4 ml-2"})]}),h.jsx(ot,{variant:"outline",className:"border-white/20 text-white hover:bg-white/10 backdrop-blur-sm",children:"Falar com Vendas"})]}),h.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-8 text-blue-100",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),h.jsx("span",{children:"Teste gr√°tis de 14 dias"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),h.jsx("span",{children:"Sem cart√£o de cr√©dito"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:h.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),h.jsx("span",{children:"Cancele a qualquer momento"})]})]})]})})]})}const kt={product:[{label:"Recursos",href:"#recursos"},{label:"Planos",href:"#planos"},{label:"Integra√ß√µes",href:"#"},{label:"API",href:"#"},{label:"Atualiza√ß√µes",href:"#"}],company:[{label:"Sobre n√≥s",href:"#"},{label:"Blog",href:"#"},{label:"Carreiras",href:"#"},{label:"Imprensa",href:"#"},{label:"Parceiros",href:"#"}],resources:[{label:"Central de Ajuda",href:"#"},{label:"Tutoriais",href:"#"},{label:"Comunidade",href:"#"},{label:"Webinars",href:"#"},{label:"Status",href:"#"}],legal:[{label:"Privacidade",href:"#"},{label:"Termos de Uso",href:"#"},{label:"Seguran√ßa",href:"#"},{label:"LGPD",href:"#"},{label:"Cookies",href:"#"}]},Et=[{icon:We,href:"#",label:"Facebook"},{icon:Ze,href:"#",label:"Instagram"},{icon:aa,href:"#",label:"LinkedIn"},{icon:Pa,href:"#",label:"Twitter"},{icon:Ga,href:"#",label:"YouTube"}];function Tt(){const e=(new Date).getFullYear();return h.jsxs("footer",{className:"bg-gray-900 text-gray-300",children:[h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12 lg:py-16",children:h.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-8 lg:gap-12",children:[h.jsxs("div",{className:"col-span-2",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:h.jsx(qa,{className:"w-6 h-6 text-white"})}),h.jsx("span",{className:"text-white",children:"LeadFlow CRM"})]}),h.jsx("p",{className:"text-gray-400 mb-6 max-w-sm",children:"A solu√ß√£o completa para gerenciar seus leads, automatizar processos e aumentar suas vendas com intelig√™ncia."}),h.jsxs("div",{className:"mb-6",children:[h.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Receba novidades e dicas"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("div",{className:"flex-1 relative",children:[h.jsx(ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),h.jsx("input",{type:"email",placeholder:"Seu email",className:"w-full pl-10 pr-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),h.jsx("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm",children:"Assinar"})]})]}),h.jsx("div",{className:"flex gap-3",children:Et.map(e=>{const a=e.icon;return h.jsx("a",{href:e.href,"aria-label":e.label,className:"w-9 h-9 bg-gray-800 hover:bg-gray-700 rounded-lg flex items-center justify-center transition-colors group",children:h.jsx(a,{className:"w-4 h-4 text-gray-400 group-hover:text-white transition-colors"})},e.label)})})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-white mb-4",children:"Produto"}),h.jsx("ul",{className:"space-y-3",children:kt.product.map(e=>h.jsx("li",{children:h.jsx("a",{href:e.href,className:"text-sm text-gray-400 hover:text-white transition-colors",children:e.label})},e.label))})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-white mb-4",children:"Empresa"}),h.jsx("ul",{className:"space-y-3",children:kt.company.map(e=>h.jsx("li",{children:h.jsx("a",{href:e.href,className:"text-sm text-gray-400 hover:text-white transition-colors",children:e.label})},e.label))})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-white mb-4",children:"Recursos"}),h.jsx("ul",{className:"space-y-3",children:kt.resources.map(e=>h.jsx("li",{children:h.jsx("a",{href:e.href,className:"text-sm text-gray-400 hover:text-white transition-colors",children:e.label})},e.label))})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"text-white mb-4",children:"Legal"}),h.jsx("ul",{className:"space-y-3",children:kt.legal.map(e=>h.jsx("li",{children:h.jsx("a",{href:e.href,className:"text-sm text-gray-400 hover:text-white transition-colors",children:e.label})},e.label))})]})]})}),h.jsx("div",{className:"border-t border-gray-800",children:h.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6",children:h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[h.jsxs("p",{className:"text-sm text-gray-500 text-center md:text-left",children:["¬© ",e," LeadFlow CRM. Todos os direitos reservados."]}),h.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-3 md:gap-6",children:[h.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[h.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Pol√≠tica de Privacidade"}),h.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Termos de Servi√ßo"}),h.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Cookies"})]}),h.jsxs("p",{className:"text-sm text-gray-500",children:["Desenvolvido por ",h.jsx("span",{className:"text-blue-400 font-medium",children:"PersonalCreativeLda"})]})]})]})})})]})}var St=Array(12).fill(0),Ct=({visible:e,className:a})=>K.createElement("div",{className:["sonner-loading-wrapper",a].filter(Boolean).join(" "),"data-visible":e},K.createElement("div",{className:"sonner-spinner"},St.map((e,a)=>K.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),At=K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},K.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),_t=K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},K.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Rt=K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},K.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ot=K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},K.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),It=K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},K.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),K.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Mt=1,Pt=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let a=this.subscribers.indexOf(e);this.subscribers.splice(a,1)}),this.publish=e=>{this.subscribers.forEach(a=>a(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var a;let t=e,{message:r}=t,s=c(t,["message"]),n="number"==typeof(null==e?void 0:e.id)||(null==(a=e.id)?void 0:a.length)>0?e.id:Mt++,i=this.toasts.find(e=>e.id===n),d=void 0===e.dismissible||e.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),i?this.toasts=this.toasts.map(a=>a.id===n?(this.publish(l(o(o({},a),e),{id:n,title:r})),l(o(o({},a),e),{id:n,dismissible:d,title:r})):a):this.addToast(l(o({title:r},s),{dismissible:d,id:n})),n},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(e=>{this.subscribers.forEach(a=>a({id:e.id,dismiss:!0}))}),this.subscribers.forEach(a=>a({id:e,dismiss:!0})),e),this.message=(e,a)=>this.create(l(o({},a),{message:e})),this.error=(e,a)=>this.create(l(o({},a),{message:e,type:"error"})),this.success=(e,a)=>this.create(l(o({},a),{type:"success",message:e})),this.info=(e,a)=>this.create(l(o({},a),{type:"info",message:e})),this.warning=(e,a)=>this.create(l(o({},a),{type:"warning",message:e})),this.loading=(e,a)=>this.create(l(o({},a),{type:"loading",message:e})),this.promise=(e,a)=>{if(!a)return;let t;void 0!==a.loading&&(t=this.create(l(o({},a),{promise:e,type:"loading",message:a.loading,description:"function"!=typeof a.description?a.description:void 0})));let r,s=e instanceof Promise?e:e(),n=void 0!==t,i=s.then(e=>d(this,null,function*(){if(r=["resolve",e],K.isValidElement(e))n=!1,this.create({id:t,type:"default",message:e});else if(Lt(e)&&!e.ok){n=!1;let r="function"==typeof a.error?yield a.error(`HTTP error! status: ${e.status}`):a.error,s="function"==typeof a.description?yield a.description(`HTTP error! status: ${e.status}`):a.description;this.create({id:t,type:"error",message:r,description:s})}else if(void 0!==a.success){n=!1;let r="function"==typeof a.success?yield a.success(e):a.success,s="function"==typeof a.description?yield a.description(e):a.description;this.create({id:t,type:"success",message:r,description:s})}})).catch(e=>d(this,null,function*(){if(r=["reject",e],void 0!==a.error){n=!1;let r="function"==typeof a.error?yield a.error(e):a.error,s="function"==typeof a.description?yield a.description(e):a.description;this.create({id:t,type:"error",message:r,description:s})}})).finally(()=>{var e;n&&(this.dismiss(t),t=void 0),null==(e=a.finally)||e.call(a)}),c=()=>new Promise((e,a)=>i.then(()=>"reject"===r[0]?a(r[1]):e(r[1])).catch(a));return"string"!=typeof t&&"number"!=typeof t?{unwrap:c}:Object.assign(t,{unwrap:c})},this.custom=(e,a)=>{let t=(null==a?void 0:a.id)||Mt++;return this.create(o({jsx:e(t),id:t},a)),t},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Lt=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status,Dt=(e,a)=>{let t=(null==a?void 0:a.id)||Mt++;return Pt.addToast(l(o({title:e},a),{id:t})),t},Ft=Object.assign(Dt,{success:Pt.success,info:Pt.info,warning:Pt.warning,error:Pt.error,custom:Pt.custom,message:Pt.message,promise:Pt.promise,dismiss:Pt.dismiss,loading:Pt.loading},{getHistory:()=>Pt.toasts,getToasts:()=>Pt.getActiveToasts()});function zt(e){return void 0!==e.label}!function(e,{insertAt:a}={}){if("undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===a&&t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}(':where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}\n');var Bt=3,Ut=14;function $t(...e){return e.filter(Boolean).join(" ")}var Wt=e=>{var a,t,r,s,n,i,c,d,h,u,m;let{invert:f,toast:g,unstyled:p,interacting:x,setHeights:b,visibleToasts:v,heights:y,index:w,toasts:N,expanded:j,removeToast:k,defaultRichColors:E,closeButton:T,style:S,cancelButtonStyle:C,actionButtonStyle:A,className:_="",descriptionClassName:R="",duration:O,position:I,gap:M,loadingIcon:P,expandByDefault:L,classNames:D,icons:F,closeButtonAriaLabel:z="Close toast",pauseWhenPageIsHidden:B}=e,[U,$]=K.useState(null),[W,V]=K.useState(null),[H,G]=K.useState(!1),[q,Y]=K.useState(!1),[J,Z]=K.useState(!1),[Q,ee]=K.useState(!1),[ae,te]=K.useState(!1),[re,se]=K.useState(0),[ne,ie]=K.useState(0),oe=K.useRef(g.duration||O||4e3),le=K.useRef(null),ce=K.useRef(null),de=0===w,he=w+1<=v,ue=g.type,me=!1!==g.dismissible,fe=g.className||"",ge=g.descriptionClassName||"",pe=K.useMemo(()=>y.findIndex(e=>e.toastId===g.id)||0,[y,g.id]),xe=K.useMemo(()=>{var e;return null!=(e=g.closeButton)?e:T},[g.closeButton,T]),be=K.useMemo(()=>g.duration||O||4e3,[g.duration,O]),ve=K.useRef(0),ye=K.useRef(0),we=K.useRef(0),Ne=K.useRef(null),[je,ke]=I.split("-"),Ee=K.useMemo(()=>y.reduce((e,a,t)=>t>=pe?e:e+a.height,0),[y,pe]),Te=(()=>{let[e,a]=K.useState(document.hidden);return K.useEffect(()=>{let e=()=>{a(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),e})(),Se=g.invert||f,Ce="loading"===ue;ye.current=K.useMemo(()=>pe*M+Ee,[pe,Ee]),K.useEffect(()=>{oe.current=be},[be]),K.useEffect(()=>{G(!0)},[]),K.useEffect(()=>{let e=ce.current;if(e){let a=e.getBoundingClientRect().height;return ie(a),b(e=>[{toastId:g.id,height:a,position:g.position},...e]),()=>b(e=>e.filter(e=>e.toastId!==g.id))}},[b,g.id]),K.useLayoutEffect(()=>{if(!H)return;let e=ce.current,a=e.style.height;e.style.height="auto";let t=e.getBoundingClientRect().height;e.style.height=a,ie(t),b(e=>e.find(e=>e.toastId===g.id)?e.map(e=>e.toastId===g.id?l(o({},e),{height:t}):e):[{toastId:g.id,height:t,position:g.position},...e])},[H,g.title,g.description,b,g.id]);let Ae=K.useCallback(()=>{Y(!0),se(ye.current),b(e=>e.filter(e=>e.toastId!==g.id)),setTimeout(()=>{k(g)},200)},[g,k,b,ye]);return K.useEffect(()=>{if(g.promise&&"loading"===ue||g.duration===1/0||"loading"===g.type)return;let e;return j||x||B&&Te?(()=>{if(we.current<ve.current){let e=(new Date).getTime()-ve.current;oe.current=oe.current-e}we.current=(new Date).getTime()})():oe.current!==1/0&&(ve.current=(new Date).getTime(),e=setTimeout(()=>{var e;null==(e=g.onAutoClose)||e.call(g,g),Ae()},oe.current)),()=>clearTimeout(e)},[j,x,g,ue,B,Te,Ae]),K.useEffect(()=>{g.delete&&Ae()},[Ae,g.delete]),K.createElement("li",{tabIndex:0,ref:ce,className:$t(_,fe,null==D?void 0:D.toast,null==(a=null==g?void 0:g.classNames)?void 0:a.toast,null==D?void 0:D.default,null==D?void 0:D[ue],null==(t=null==g?void 0:g.classNames)?void 0:t[ue]),"data-sonner-toast":"","data-rich-colors":null!=(r=g.richColors)?r:E,"data-styled":!(g.jsx||g.unstyled||p),"data-mounted":H,"data-promise":!!g.promise,"data-swiped":ae,"data-removed":q,"data-visible":he,"data-y-position":je,"data-x-position":ke,"data-index":w,"data-front":de,"data-swiping":J,"data-dismissible":me,"data-type":ue,"data-invert":Se,"data-swipe-out":Q,"data-swipe-direction":W,"data-expanded":!!(j||L&&H),style:o(o({"--index":w,"--toasts-before":w,"--z-index":N.length-w,"--offset":`${q?re:ye.current}px`,"--initial-height":L?"auto":`${ne}px`},S),g.style),onDragEnd:()=>{Z(!1),$(null),Ne.current=null},onPointerDown:e=>{Ce||!me||(le.current=new Date,se(ye.current),e.target.setPointerCapture(e.pointerId),"BUTTON"!==e.target.tagName&&(Z(!0),Ne.current={x:e.clientX,y:e.clientY}))},onPointerUp:()=>{var e,a,t,r;if(Q||!me)return;Ne.current=null;let s=Number((null==(e=ce.current)?void 0:e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),n=Number((null==(a=ce.current)?void 0:a.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),i=(new Date).getTime()-(null==(t=le.current)?void 0:t.getTime()),o="x"===U?s:n,l=Math.abs(o)/i;if(Math.abs(o)>=20||l>.11)return se(ye.current),null==(r=g.onDismiss)||r.call(g,g),V("x"===U?s>0?"right":"left":n>0?"down":"up"),Ae(),ee(!0),void te(!1);Z(!1),$(null)},onPointerMove:a=>{var t,r,s,n;if(!Ne.current||!me||(null==(t=window.getSelection())?void 0:t.toString().length)>0)return;let i=a.clientY-Ne.current.y,o=a.clientX-Ne.current.x,l=null!=(r=e.swipeDirections)?r:function(e){let[a,t]=e.split("-"),r=[];return a&&r.push(a),t&&r.push(t),r}(I);!U&&(Math.abs(o)>1||Math.abs(i)>1)&&$(Math.abs(o)>Math.abs(i)?"x":"y");let c={x:0,y:0};"y"===U?(l.includes("top")||l.includes("bottom"))&&(l.includes("top")&&i<0||l.includes("bottom")&&i>0)&&(c.y=i):"x"===U&&(l.includes("left")||l.includes("right"))&&(l.includes("left")&&o<0||l.includes("right")&&o>0)&&(c.x=o),(Math.abs(c.x)>0||Math.abs(c.y)>0)&&te(!0),null==(s=ce.current)||s.style.setProperty("--swipe-amount-x",`${c.x}px`),null==(n=ce.current)||n.style.setProperty("--swipe-amount-y",`${c.y}px`)}},xe&&!g.jsx?K.createElement("button",{"aria-label":z,"data-disabled":Ce,"data-close-button":!0,onClick:Ce||!me?()=>{}:()=>{var e;Ae(),null==(e=g.onDismiss)||e.call(g,g)},className:$t(null==D?void 0:D.closeButton,null==(s=null==g?void 0:g.classNames)?void 0:s.closeButton)},null!=(n=null==F?void 0:F.close)?n:It):null,g.jsx||X.isValidElement(g.title)?g.jsx?g.jsx:"function"==typeof g.title?g.title():g.title:K.createElement(K.Fragment,null,ue||g.icon||g.promise?K.createElement("div",{"data-icon":"",className:$t(null==D?void 0:D.icon,null==(i=null==g?void 0:g.classNames)?void 0:i.icon)},g.promise||"loading"===g.type&&!g.icon?g.icon||(null!=F&&F.loading?K.createElement("div",{className:$t(null==D?void 0:D.loader,null==(_e=null==g?void 0:g.classNames)?void 0:_e.loader,"sonner-loader"),"data-visible":"loading"===ue},F.loading):P?K.createElement("div",{className:$t(null==D?void 0:D.loader,null==(Re=null==g?void 0:g.classNames)?void 0:Re.loader,"sonner-loader"),"data-visible":"loading"===ue},P):K.createElement(Ct,{className:$t(null==D?void 0:D.loader,null==(Oe=null==g?void 0:g.classNames)?void 0:Oe.loader),visible:"loading"===ue})):null,"loading"!==g.type?g.icon||(null==F?void 0:F[ue])||(e=>{switch(e){case"success":return At;case"info":return Rt;case"warning":return _t;case"error":return Ot;default:return null}})(ue):null):null,K.createElement("div",{"data-content":"",className:$t(null==D?void 0:D.content,null==(c=null==g?void 0:g.classNames)?void 0:c.content)},K.createElement("div",{"data-title":"",className:$t(null==D?void 0:D.title,null==(d=null==g?void 0:g.classNames)?void 0:d.title)},"function"==typeof g.title?g.title():g.title),g.description?K.createElement("div",{"data-description":"",className:$t(R,ge,null==D?void 0:D.description,null==(h=null==g?void 0:g.classNames)?void 0:h.description)},"function"==typeof g.description?g.description():g.description):null),X.isValidElement(g.cancel)?g.cancel:g.cancel&&zt(g.cancel)?K.createElement("button",{"data-button":!0,"data-cancel":!0,style:g.cancelButtonStyle||C,onClick:e=>{var a,t;zt(g.cancel)&&me&&(null==(t=(a=g.cancel).onClick)||t.call(a,e),Ae())},className:$t(null==D?void 0:D.cancelButton,null==(u=null==g?void 0:g.classNames)?void 0:u.cancelButton)},g.cancel.label):null,X.isValidElement(g.action)?g.action:g.action&&zt(g.action)?K.createElement("button",{"data-button":!0,"data-action":!0,style:g.actionButtonStyle||A,onClick:e=>{var a,t;zt(g.action)&&(null==(t=(a=g.action).onClick)||t.call(a,e),!e.defaultPrevented&&Ae())},className:$t(null==D?void 0:D.actionButton,null==(m=null==g?void 0:g.classNames)?void 0:m.actionButton)},g.action.label):null));var _e,Re,Oe};function Vt(){if("undefined"==typeof window||"undefined"==typeof document)return"ltr";let e=document.documentElement.getAttribute("dir");return"auto"!==e&&e?e:window.getComputedStyle(document.documentElement).direction}function Ht(e,a){let t={};return[e,a].forEach((e,a)=>{let r=1===a,s=r?"--mobile-offset":"--offset",n=r?"16px":"32px";function i(e){["top","right","bottom","left"].forEach(a=>{t[`${s}-${a}`]="number"==typeof e?`${e}px`:e})}"number"==typeof e||"string"==typeof e?i(e):"object"==typeof e?["top","right","bottom","left"].forEach(a=>{void 0===e[a]?t[`${s}-${a}`]=n:t[`${s}-${a}`]="number"==typeof e[a]?`${e[a]}px`:e[a]}):i(n)}),t}var Gt=X.forwardRef(function(e,a){let{invert:t,position:r="bottom-right",hotkey:s=["altKey","KeyT"],expand:n,closeButton:i,className:c,offset:d,mobileOffset:h,theme:u="light",richColors:m,duration:f,style:g,visibleToasts:p=Bt,toastOptions:x,dir:b=Vt(),gap:v=Ut,loadingIcon:y,icons:w,containerAriaLabel:N="Notifications",pauseWhenPageIsHidden:j}=e,[k,E]=K.useState([]),T=K.useMemo(()=>Array.from(new Set([r].concat(k.filter(e=>e.position).map(e=>e.position)))),[k,r]),[S,C]=K.useState([]),[A,_]=K.useState(!1),[R,O]=K.useState(!1),[I,M]=K.useState("system"!==u?u:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),P=K.useRef(null),L=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),D=K.useRef(null),F=K.useRef(!1),z=K.useCallback(e=>{E(a=>{var t;return null!=(t=a.find(a=>a.id===e.id))&&t.delete||Pt.dismiss(e.id),a.filter(({id:a})=>a!==e.id)})},[]);return K.useEffect(()=>Pt.subscribe(e=>{e.dismiss?E(a=>a.map(a=>a.id===e.id?l(o({},a),{delete:!0}):a)):setTimeout(()=>{J.flushSync(()=>{E(a=>{let t=a.findIndex(a=>a.id===e.id);return-1!==t?[...a.slice(0,t),o(o({},a[t]),e),...a.slice(t+1)]:[e,...a]})})})}),[]),K.useEffect(()=>{if("system"!==u)return void M(u);if("system"===u&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?M("dark"):M("light")),"undefined"==typeof window)return;let e=window.matchMedia("(prefers-color-scheme: dark)");try{e.addEventListener("change",({matches:e})=>{M(e?"dark":"light")})}catch(a){e.addListener(({matches:e})=>{try{M(e?"dark":"light")}catch(a){}})}},[u]),K.useEffect(()=>{k.length<=1&&_(!1)},[k]),K.useEffect(()=>{let e=e=>{var a,t;s.every(a=>e[a]||e.code===a)&&(_(!0),null==(a=P.current)||a.focus()),"Escape"===e.code&&(document.activeElement===P.current||null!=(t=P.current)&&t.contains(document.activeElement))&&_(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[s]),K.useEffect(()=>{if(P.current)return()=>{D.current&&(D.current.focus({preventScroll:!0}),D.current=null,F.current=!1)}},[P.current]),K.createElement("section",{ref:a,"aria-label":`${N} ${L}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},T.map((a,r)=>{var s;let[l,u]=a.split("-");return k.length?K.createElement("ol",{key:a,dir:"auto"===b?Vt():b,tabIndex:-1,ref:P,className:c,"data-sonner-toaster":!0,"data-theme":I,"data-y-position":l,"data-lifted":A&&k.length>1&&!n,"data-x-position":u,style:o(o({"--front-toast-height":`${(null==(s=S[0])?void 0:s.height)||0}px`,"--width":"356px","--gap":`${v}px`},g),Ht(d,h)),onBlur:e=>{F.current&&!e.currentTarget.contains(e.relatedTarget)&&(F.current=!1,D.current&&(D.current.focus({preventScroll:!0}),D.current=null))},onFocus:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||F.current||(F.current=!0,D.current=e.relatedTarget)},onMouseEnter:()=>_(!0),onMouseMove:()=>_(!0),onMouseLeave:()=>{R||_(!1)},onDragEnd:()=>_(!1),onPointerDown:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||O(!0)},onPointerUp:()=>O(!1)},k.filter(e=>!e.position&&0===r||e.position===a).map((r,s)=>{var o,l;return K.createElement(Wt,{key:r.id,icons:w,index:s,toast:r,defaultRichColors:m,duration:null!=(o=null==x?void 0:x.duration)?o:f,className:null==x?void 0:x.className,descriptionClassName:null==x?void 0:x.descriptionClassName,invert:t,visibleToasts:p,closeButton:null!=(l=null==x?void 0:x.closeButton)?l:i,interacting:R,position:a,style:null==x?void 0:x.style,unstyled:null==x?void 0:x.unstyled,classNames:null==x?void 0:x.classNames,cancelButtonStyle:null==x?void 0:x.cancelButtonStyle,actionButtonStyle:null==x?void 0:x.actionButtonStyle,removeToast:z,toasts:k.filter(e=>e.position==r.position),heights:S.filter(e=>e.position==r.position),setHeights:C,expandByDefault:n,gap:v,loadingIcon:y,expanded:A,pauseWhenPageIsHidden:j,swipeDirections:e.swipeDirections})})):null}))});function qt({totalLeads:e,leadsNovosHoje:a,leadsFechados:t,leads:r=[],limites:s}){const n=r.filter(e=>{var a;const t=null==(a=e.status)?void 0:a.toLowerCase().replace(/_/g," ");return"novo"===t||"new"===t}).length,i=r.filter(e=>{var a;const t=null==(a=e.status)?void 0:a.toLowerCase().replace(/_/g," ");return"em negociacao"===t||"negociacao"===t||"in negotiation"===t||"negotiation"===t}).length,o=r.filter(e=>{var a;const t=null==(a=e.status)?void 0:a.toLowerCase().replace(/_/g," ");return"qualificado"===t||"qualified"===t||"aguardando resposta"===t||"waiting"===t}).length,l=r.filter(e=>{var a;const t=null==(a=e.status)?void 0:a.toLowerCase().replace(/_/g," ");return"perdido"===t||"lost"===t||"descartado"===t||"rejeitado"===t||"rejected"===t}).length,c=[{title:"Leads Novos",value:n.toLocaleString(),icon:Ma,iconBg:"bg-blue-100 dark:bg-blue-900/30",iconColor:"text-blue-600 dark:text-blue-400"},{title:"Em Negocia√ß√£o",value:i.toLocaleString(),icon:Oa,iconBg:"bg-orange-100 dark:bg-orange-900/30",iconColor:"text-orange-600 dark:text-orange-400"},{title:"Qualificados",value:o.toLocaleString(),icon:Ee,iconBg:"bg-purple-100 dark:bg-purple-900/30",iconColor:"text-purple-600 dark:text-purple-400"},{title:"Leads Perdidos",value:l.toLocaleString(),icon:Va,iconBg:"bg-red-100 dark:bg-red-900/30",iconColor:"text-red-600 dark:text-red-400"}];return h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:c.map((e,a)=>{const t=e.icon;return h.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-5 border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-300",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`w-12 h-12 rounded-xl ${e.iconBg} flex items-center justify-center flex-shrink-0`,children:h.jsx(t,{className:`w-6 h-6 ${e.iconColor}`})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-0.5",children:e.value}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:e.title})]})]})},a)})})}function Xt({totalLeads:e,leadsNovosHoje:a,leadsFechados:t}){const r=e>0?(t/e*100).toFixed(1):"0",s=e>0?Math.min(e/100*100,100):0,n=a>0?Math.min(a/10*100,100):0,i=e>0?t/e*100:0,o=e>0?"+12%":"0%",l=a>0?"+8%":"0%",c=t>0?"+15%":"0%",d=parseFloat(r)>0?"+3%":"0%",u=[{id:"total-leads-card",value:e.toLocaleString(),label:"Total de Leads",icon:De,gradient:"from-indigo-500 to-purple-600",bgGradient:"from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20",badge:o,progressColor:"from-indigo-500 to-purple-600",progress:s},{id:"leads-today-card",value:a.toLocaleString(),label:"Leads Captados Hoje",icon:Ma,gradient:"from-pink-500 to-rose-500",bgGradient:"from-pink-50 to-rose-50 dark:from-pink-900/20 dark:to-rose-900/20",badge:l,progressColor:"from-pink-500 to-rose-500",progress:n},{id:"leads-converted-card",value:t.toLocaleString(),label:"Leads Convertidos",icon:Ee,gradient:"from-cyan-500 to-blue-500",bgGradient:"from-cyan-50 to-blue-50 dark:from-cyan-900/20 dark:to-blue-900/20",badge:c,progressColor:"from-cyan-500 to-blue-500",progress:i},{id:"conversion-rate-card",value:`${r}%`,label:"Taxa de Convers√£o",icon:Oa,gradient:"from-green-500 to-emerald-500",bgGradient:"from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20",badge:d,progressColor:"from-green-500 to-emerald-500",progress:parseFloat(r)}];return h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map((e,a)=>{const t=e.icon;return h.jsxs("div",{id:e.id,className:"relative bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-300",children:[h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${e.gradient} flex items-center justify-center shadow-md`,children:h.jsx(t,{className:"w-6 h-6 text-white"})}),h.jsx("span",{className:"px-2.5 py-1 bg-green-50 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-full text-xs font-semibold",children:e.badge})]}),h.jsx("div",{className:"mb-1",children:h.jsx("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:e.value})}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:e.label}),h.jsx("div",{className:"w-full bg-gray-100 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:h.jsx("div",{className:`h-full bg-gradient-to-r ${e.progressColor} rounded-full transition-all duration-700`,style:{width:`${Math.min(100,e.progress)}%`}})})]},a)})})}function Yt({origens:e,status:a,onFilterChange:t}){const[r,s]=X.useState(""),[n,i]=X.useState(""),[o,l]=X.useState(""),c=()=>{t({origem:r,status:n,busca:o})};return h.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-4 border border-gray-100 dark:border-gray-700 shadow-sm mb-6",children:h.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[h.jsxs("select",{value:r,onChange:e=>s(e.target.value),className:"hidden md:block border border-gray-200 dark:border-gray-600 rounded-lg px-4 py-2.5 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm min-w-[180px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[h.jsx("option",{value:"",children:"Origem: Todas"}),e.map(e=>h.jsx("option",{value:e,children:e},e))]}),h.jsxs("select",{value:n,onChange:e=>i(e.target.value),className:"hidden md:block border border-gray-200 dark:border-gray-600 rounded-lg px-4 py-2.5 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 text-sm min-w-[180px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[h.jsx("option",{value:"",children:"Status: Todos"}),a.map(e=>h.jsx("option",{value:e,children:e},e))]}),h.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[h.jsx(wa,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 dark:text-gray-500"}),h.jsx("input",{type:"text",value:o,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"===e.key&&c()},placeholder:"üîç Buscar leads...",className:"w-full border border-gray-200 dark:border-gray-600 rounded-lg pl-10 pr-4 py-2.5 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),h.jsx("button",{onClick:c,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg transition-all duration-200 shadow-sm hover:shadow-md whitespace-nowrap",children:"Aplicar Filtros"})]})})}function Kt({leads:e,onEdit:a,onDelete:t,onChat:r,onRefresh:s,onExport:n,onImport:i,onToggleEmailMarketing:o,onSendEmail:l,onNovoLead:c,onCampaigns:d,onDeleteMultiple:u,userPlan:m,planExpired:f,loading:g}){const[p,x]=X.useState(""),[b,v]=X.useState(1),[y,w]=X.useState(null),[N,j]=X.useState(new Set),k=e.filter(e=>{var a,t,r,s,n,i;if(!p)return!0;const o=p.toLowerCase();return(null==(a=e.nome)?void 0:a.toLowerCase().includes(o))||(null==(t=e.telefone)?void 0:t.includes(p))||(null==(r=e.email)?void 0:r.toLowerCase().includes(o))||(null==(s=e.interesse)?void 0:s.toLowerCase().includes(o))||(null==(n=e.origem)?void 0:n.toLowerCase().includes(o))||(null==(i=e.status)?void 0:i.toLowerCase().includes(o))}),E=Math.ceil(k.length/10),T=10*(b-1),S=T+10,C=k.slice(T,S),A=e=>{x(e),v(1)},_=k.length>0&&N.size===k.length,R=e=>{v(Math.max(1,Math.min(e,E)))},O=e=>{if(!e)return"-";try{const a=new Date(e);return isNaN(a.getTime())?e:a.toLocaleDateString("pt-BR")}catch(a){return e}},I=e=>{const a=e.toLowerCase(),t={novo:"bg-blue-100 text-blue-700",qualificado:"bg-blue-100 text-blue-600","em negociacao":"bg-amber-100 text-amber-700",em_negociacao:"bg-amber-100 text-amber-700",aguardando:"bg-amber-100 text-amber-700",aguardando_resposta:"bg-amber-100 text-amber-700",fechado:"bg-green-100 text-green-700",convertido:"bg-green-100 text-green-700",perdido:"bg-red-100 text-red-700"};let r="bg-indigo-100 text-indigo-700";for(const[s,n]of Object.entries(t))if(a.includes(s)){r=n;break}return h.jsx("span",{className:`inline-block px-3 py-1 rounded-md text-xs ${r}`,children:e})};return h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-100 dark:border-gray-700 shadow-sm overflow-hidden",children:[h.jsxs("div",{className:"px-4 md:px-6 py-4 border-b border-gray-100 dark:border-gray-700 bg-white dark:bg-gray-800",children:[h.jsxs("div",{className:"block md:hidden space-y-3",children:[h.jsx("h3",{className:"text-gray-900 dark:text-white",children:"Tabela de Leads"}),h.jsxs("div",{className:"relative",children:[h.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),h.jsx("input",{type:"text",value:p,onChange:e=>A(e.target.value),placeholder:"Buscar leads...",className:"w-full pl-9 pr-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:border-blue-500 dark:focus:border-blue-400 transition-colors"})]}),h.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1",children:[c&&h.jsx("button",{onClick:c,className:"flex items-center justify-center min-w-[40px] h-10 px-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors shadow-sm",title:"Adicionar Leads",children:h.jsx(ga,{className:"w-5 h-5"})}),s&&h.jsx("button",{onClick:s,disabled:g,className:"flex items-center justify-center min-w-[40px] h-10 px-3 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",title:"Atualizar",children:h.jsx(ba,{className:"w-5 h-5 "+(g?"animate-spin":"")})}),n&&h.jsx("button",{onClick:n,className:"flex items-center justify-center min-w-[40px] h-10 px-3 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 hover:border-emerald-500 text-gray-700 dark:text-gray-200 hover:text-emerald-600 dark:hover:text-emerald-400 rounded-lg transition-colors shadow-sm",title:"Exportar",children:h.jsx(ze,{className:"w-5 h-5"})}),i&&h.jsx("button",{onClick:i,className:"flex items-center justify-center min-w-[40px] h-10 px-3 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 hover:border-blue-500 text-gray-700 dark:text-gray-200 hover:text-blue-600 dark:hover:text-blue-400 rounded-lg transition-colors shadow-sm",title:"Importar",children:h.jsx(La,{className:"w-5 h-5"})}),d&&h.jsx("button",{onClick:d,className:"flex items-center justify-center min-w-[40px] h-10 px-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors shadow-sm",title:"Campanhas",children:h.jsx(oa,{className:"w-5 h-5"})})]})]}),h.jsxs("div",{className:"hidden md:block",children:[h.jsxs("div",{className:"flex justify-between items-center gap-4 mb-3",children:[h.jsx("h3",{className:"text-gray-900 dark:text-white",children:"Tabela de Leads"}),h.jsxs("div",{className:"relative",children:[h.jsx(wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),h.jsx("input",{type:"text",value:p,onChange:e=>A(e.target.value),placeholder:"Buscar leads...",className:"pl-9 pr-4 py-2 border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:border-blue-500 dark:focus:border-blue-400 transition-colors"})]})]}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[c&&h.jsxs("button",{onClick:c,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors shadow-sm",children:[h.jsx(ga,{className:"w-4 h-4"}),h.jsx("span",{children:"Adicionar Leads"})]}),N.size>0&&u&&h.jsxs("button",{onClick:()=>{0!==N.size&&confirm(`Tem certeza que deseja deletar ${N.size} lead(s) selecionado(s)?`)&&u&&(u(Array.from(N)),j(new Set))},className:"inline-flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors shadow-sm",children:[h.jsx(Ia,{className:"w-4 h-4"}),h.jsxs("span",{children:["Deletar Selecionados (",N.size,")"]})]}),N.size>0&&h.jsxs("button",{onClick:()=>j(new Set),className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg transition-colors shadow-sm",children:[h.jsx(Aa,{className:"w-4 h-4"}),h.jsx("span",{children:"Limpar Sele√ß√£o"})]}),s&&h.jsxs("button",{onClick:s,disabled:g,className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx(ba,{className:"w-4 h-4 "+(g?"animate-spin":"")}),h.jsx("span",{children:"Atualizar"})]}),n&&h.jsxs("button",{onClick:n,className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-emerald-50 dark:hover:bg-emerald-900/30 hover:border-emerald-500 text-gray-700 dark:text-gray-200 hover:text-emerald-600 dark:hover:text-emerald-400 rounded-lg transition-colors shadow-sm",children:[h.jsx(ze,{className:"w-4 h-4"}),h.jsx("span",{children:"Exportar"})]}),i&&h.jsxs("button",{onClick:i,className:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 hover:border-blue-500 text-gray-700 dark:text-gray-200 hover:text-blue-600 dark:hover:text-blue-400 rounded-lg transition-colors shadow-sm",children:[h.jsx(La,{className:"w-4 h-4"}),h.jsx("span",{children:"Importar"})]}),d&&h.jsxs("button",{onClick:d,className:"inline-flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors shadow-sm",children:[h.jsx(oa,{className:"w-4 h-4"}),h.jsx("span",{children:"Campanhas"})]})]})]})]}),h.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[600px]",children:h.jsxs("table",{className:"w-full min-w-[900px]",children:[h.jsx("thead",{className:"sticky top-0 z-10 bg-white dark:bg-gray-800",children:h.jsxs("tr",{className:"border-b-2 border-gray-200 dark:border-gray-700",children:[h.jsx("th",{className:"px-4 py-4 text-left",style:{width:"50px"},children:h.jsx("button",{onClick:()=>{if(N.size===k.length)j(new Set);else{const a=k.map((a,t)=>e.findIndex(e=>e.id===k[t].id));j(new Set(a))}},className:"p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:_?"Desmarcar todos":"Selecionar todos",children:_?h.jsx(Se,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}):h.jsx(Aa,{className:"w-5 h-5 text-gray-400"})})}),h.jsx("th",{className:"px-6 py-4 text-left text-xs uppercase tracking-wider text-gray-600 dark:text-gray-400",children:"Data"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs uppercase tracking-wider text-gray-600 dark:text-gray-400",children:"Nome"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs uppercase tracking-wider text-gray-600 dark:text-gray-400",children:"Email"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs uppercase tracking-wider text-gray-600 dark:text-gray-400",children:"Telefone"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs uppercase tracking-wider text-gray-600 dark:text-gray-400",children:"Interesse"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs uppercase tracking-wider text-gray-600 dark:text-gray-400",children:"Origem"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs uppercase tracking-wider text-gray-600 dark:text-gray-400",children:"Status"}),h.jsx("th",{className:"px-6 py-4 text-left text-xs uppercase tracking-wider text-gray-600 dark:text-gray-400",style:{width:"140px"},children:"A√ß√µes"})]})}),h.jsx("tbody",{children:0===C.length?h.jsx("tr",{children:h.jsx("td",{colSpan:9,className:"px-6 py-12 text-center text-gray-500 dark:text-gray-400",children:"Nenhum lead encontrado. Adicione seu primeiro lead!"})}):C.map((s,n)=>{const i=e.findIndex(e=>e.id===s.id),c=N.has(i);return h.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700 transition-colors "+(c?"bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30":s.marcado_email?"bg-purple-50 dark:bg-purple-900/10 hover:bg-purple-100 dark:hover:bg-purple-900/20":"hover:bg-gray-50 dark:hover:bg-gray-700/50"),onMouseEnter:()=>w(n),onMouseLeave:()=>w(null),children:[h.jsx("td",{className:"px-4 py-4",children:h.jsx("button",{onClick:()=>(e=>{const a=new Set(N);a.has(e)?a.delete(e):a.add(e),j(a)})(i),className:"p-1 rounded hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:c?"Desmarcar":"Selecionar",children:c?h.jsx(Se,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}):h.jsx(Aa,{className:"w-5 h-5 text-gray-400"})})}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300",children:O(s.data)}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 dark:text-white",children:h.jsxs("div",{className:"flex items-center gap-2",children:[s.nome||"-",s.marcado_email&&h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 rounded text-xs",children:[h.jsx(ia,{className:"w-3 h-3"}),"Email"]})]})}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300",children:s.email?h.jsx("a",{href:`mailto:${s.email}`,className:"text-blue-600 dark:text-blue-400 hover:underline",children:s.email}):h.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"-"})}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300",children:s.telefone||"-"}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300",children:s.interesse||"-"}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 dark:text-gray-300",children:s.origem||"-"}),h.jsx("td",{className:"px-6 py-4 text-sm",children:I(s.status)}),h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{className:"flex gap-2",children:[s.email&&y===n&&l&&h.jsx("button",{onClick:()=>l(i),className:"p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-purple-50 dark:hover:bg-purple-900/30 hover:border-purple-500 hover:text-purple-600 dark:hover:text-purple-400 transition-all",title:"Enviar Email",children:h.jsx(ia,{className:"w-4 h-4"})}),s.email&&y===n&&o&&h.jsx("button",{onClick:()=>o(i),className:"p-2 border rounded-lg transition-all "+(s.marcado_email?"bg-blue-100 dark:bg-blue-900/50 border-blue-500 dark:border-blue-600 text-blue-600 dark:text-blue-400":"border-gray-200 dark:border-gray-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 hover:border-blue-500 hover:text-blue-600 dark:hover:text-blue-400"),title:s.marcado_email?"Remover da lista de envio em massa":"Marcar para envio em massa",children:h.jsx(Se,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>r(i),className:"p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/30 hover:border-green-500 hover:text-green-600 dark:hover:text-green-400 transition-all",title:"WhatsApp",children:h.jsx(ca,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>a(i),className:"p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-amber-50 dark:hover:bg-amber-900/30 hover:border-amber-500 hover:text-amber-600 dark:hover:text-amber-400 transition-all",title:"Editar",children:h.jsx(Ca,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>t(i),className:"p-2 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30 hover:border-red-500 hover:text-red-600 dark:hover:text-red-400 transition-all",title:"Deletar",children:h.jsx(Ia,{className:"w-4 h-4"})})]})})]},n)})})]})}),h.jsxs("div",{className:"px-6 py-4 bg-white dark:bg-gray-800 border-t border-gray-100 dark:border-gray-700 flex justify-between items-center",children:[h.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Mostrando ",k.length>0?T+1:0," a ",Math.min(S,k.length)," de ",k.length," resultados"]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>R(b-1),className:"px-3 py-1.5 text-sm border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-all text-gray-700 dark:text-gray-300 "+(1===b?"opacity-50 cursor-not-allowed":""),disabled:1===b,children:"Anterior"}),h.jsx("div",{className:"flex gap-1",children:(()=>{const e=[];if(E<=5)for(let a=1;a<=E;a++)e.push(a);else b<=3?e.push(1,2,3,4,"...",E):b>=E-2?e.push(1,"...",E-3,E-2,E-1,E):e.push(1,"...",b-1,b,b+1,"...",E);return e})().map((e,a)=>h.jsx("button",{onClick:()=>"number"==typeof e&&R(e),className:"min-w-[36px] px-3 py-1.5 text-sm rounded-lg transition-all "+(e===b?"bg-blue-600 text-white":"number"==typeof e?"border border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700/50 text-gray-700 dark:text-gray-300":"text-gray-400 cursor-default"),disabled:"number"!=typeof e,children:e},`${e}-${a}`))}),h.jsx("button",{onClick:()=>R(b+1),className:"px-3 py-1.5 text-sm border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-all text-gray-700 dark:text-gray-300 "+(b===E||0===E?"opacity-50 cursor-not-allowed":""),disabled:b===E||0===E,children:"Pr√≥ximo"})]})]})]})}function Jt({leads:e,origens:a=[],status:t=[],onFilterChange:r}){const s=X.useMemo(()=>a.length>0?a:Array.from(new Set(e.map(e=>e.origem).filter(Boolean))),[e,a]),n=X.useMemo(()=>t.length>0?t:Array.from(new Set(e.map(e=>e.status).filter(Boolean))),[e,t]),i=e.reduce((e,a)=>(a.origem&&(e[a.origem]=(e[a.origem]||0)+1),e),{}),o={whatsapp:"WhatsApp",facebook:"Facebook",instagram:"Instagram",site:"Site",indicacao:"Indica√ß√£o",google:"Google",linkedin:"LinkedIn",email:"Email",telefone:"Telefone",outros:"Outros"},l=Object.entries(i).map(([e,a])=>({name:o[e.toLowerCase()]||e,value:a,fullName:o[e.toLowerCase()]||e})).sort((e,a)=>a.value-e.value),c=e.reduce((e,a)=>(a.status&&(e[a.status]=(e[a.status]||0)+1),e),{}),d=Object.entries(c).map(([e,a])=>({name:e,value:a})),u=(()=>{const a=["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"],t=new Date,r=[];for(let s=6;s>=0;s--){const n=new Date(t);n.setDate(n.getDate()-s);const i=a[n.getDay()],o=n.toISOString().split("T")[0],l=e.filter(e=>e.data===o).length;r.push({name:i,leads:l,date:o})}return r})(),m=[{name:"Entregues",value:5234,color:"#10b981"},{name:"Abertas",value:4123,color:"#3b82f6"},{name:"Respostas",value:2045,color:"#a855f7"},{name:"Cliques",value:892,color:"#f59e0b"}],f=["#6366f1","#10b981","#f59e0b","#ef4444","#8b5cf6","#14b8a6"],g=({active:a,payload:t})=>{if(a&&t&&t.length){const a=t[0],r=e.length,s=r>0?(a.value/r*100).toFixed(1):"0";return h.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-4 shadow-xl",children:[h.jsx("p",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:a.payload.fullName||a.payload.name}),h.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a.value," lead",1!==a.value?"s":""," (",s,"%)"]})]})}return null},p=({active:e,payload:a})=>e&&a&&a.length?h.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl p-4 shadow-xl",children:[h.jsx("p",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:a[0].payload.name}),h.jsxs("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:[a[0].value," leads"]})]}):null;return h.jsxs("div",{className:"space-y-6",children:[r&&h.jsx(Yt,{origens:s,status:n,onFilterChange:r}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Leads por Origem"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-500"}),h.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Total: ",e.length]})]})]}),l.length>0?h.jsx(ee,{width:"100%",height:350,children:h.jsxs(ae,{data:l,margin:{top:10,right:30,left:0,bottom:60},children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"colorOrigem",x1:"0",y1:"0",x2:"0",y2:"1",children:[h.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),h.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),h.jsx(te,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700",opacity:.3}),h.jsx(re,{dataKey:"name",tick:{fill:"#9ca3af",fontSize:12},stroke:"#e5e7eb",className:"dark:stroke-gray-700",angle:-45,textAnchor:"end",height:80}),h.jsx(se,{tick:{fill:"#9ca3af",fontSize:12},stroke:"#e5e7eb",className:"dark:stroke-gray-700",allowDecimals:!1}),h.jsx(ne,{content:h.jsx(g,{})}),h.jsx(ie,{type:"monotone",dataKey:"value",stroke:"#6366f1",strokeWidth:3,fillOpacity:1,fill:"url(#colorOrigem)"})]})}):h.jsx("div",{className:"flex items-center justify-center h-[350px] text-gray-400 dark:text-gray-500",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-3",children:h.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),h.jsx("p",{className:"font-medium",children:"Nenhum lead cadastrado"})]})})]}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Evolu√ß√£o de Leads"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{className:"px-3 py-1 text-xs font-medium bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400 rounded-lg",children:"7 dias"}),h.jsx("button",{className:"px-3 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:"30 dias"})]})]}),h.jsx(ee,{width:"100%",height:350,children:h.jsxs(ae,{data:u,margin:{top:10,right:30,left:0,bottom:20},children:[h.jsx("defs",{children:h.jsxs("linearGradient",{id:"colorLeads",x1:"0",y1:"0",x2:"0",y2:"1",children:[h.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),h.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),h.jsx(te,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700",opacity:.3}),h.jsx(re,{dataKey:"name",tick:{fill:"#9ca3af",fontSize:12},stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),h.jsx(se,{tick:{fill:"#9ca3af",fontSize:12},stroke:"#e5e7eb",className:"dark:stroke-gray-700",allowDecimals:!1}),h.jsx(ne,{content:h.jsx(p,{})}),h.jsx(ie,{type:"monotone",dataKey:"leads",stroke:"#6366f1",strokeWidth:3,fillOpacity:1,fill:"url(#colorLeads)"})]})})]})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[h.jsx("div",{className:"flex items-center justify-between mb-6",children:h.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Status dos Leads"})}),d.length>0?h.jsx(ee,{width:"100%",height:350,children:h.jsxs(oe,{children:[h.jsx(le,{data:d,cx:"50%",cy:"45%",innerRadius:60,outerRadius:110,paddingAngle:4,dataKey:"value",label:({name:e,percent:a})=>`${(100*a).toFixed(0)}%`,labelLine:!1,children:d.map((e,a)=>h.jsx(ce,{fill:f[a%f.length]},`cell-${a}`))}),h.jsx(ne,{contentStyle:{backgroundColor:"var(--tooltip-bg, white)",border:"1px solid #e5e7eb",borderRadius:"12px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",padding:"12px"}}),h.jsx(de,{verticalAlign:"bottom",align:"center",layout:"horizontal",iconType:"circle",iconSize:10,wrapperStyle:{fontSize:"12px",paddingTop:"20px"}})]})}):h.jsx("div",{className:"flex items-center justify-center h-[350px] text-gray-400 dark:text-gray-500",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-3",children:h.jsxs("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"}),h.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"})]})}),h.jsx("p",{className:"font-medium",children:"Nenhum status definido"})]})})]}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[h.jsx("div",{className:"flex items-center justify-between mb-6",children:h.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Engajamento em Campanhas"})}),h.jsx(ee,{width:"100%",height:350,children:h.jsxs(he,{data:m,layout:"vertical",margin:{top:10,right:30,left:80,bottom:10},children:[h.jsx(te,{strokeDasharray:"3 3",stroke:"#e5e7eb",className:"dark:stroke-gray-700",opacity:.3}),h.jsx(re,{type:"number",tick:{fill:"#9ca3af",fontSize:12},stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),h.jsx(se,{type:"category",dataKey:"name",tick:{fill:"#9ca3af",fontSize:12},stroke:"#e5e7eb",className:"dark:stroke-gray-700"}),h.jsx(ne,{contentStyle:{backgroundColor:"var(--tooltip-bg, white)",border:"1px solid #e5e7eb",borderRadius:"12px",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)",padding:"12px"},cursor:{fill:"rgba(99, 102, 241, 0.1)"}}),h.jsx(ue,{dataKey:"value",radius:[0,8,8,0],children:m.map((e,a)=>h.jsx(ce,{fill:e.color},`cell-${a}`))})]})})]})]})]})}function Zt({limites:e,diasRestantes:a,onUpgrade:t,userPlan:r="free",isTrial:s=!1}){const n=e.leads>0?e.usados.leads/e.leads*100:0,i=e.mensagens>0?e.usados.mensagens/e.mensagens*100:0,o=e.envios>0?e.usados.envios/e.envios*100:0,l=e=>e>=90?"bg-red-500":e>=75?"bg-amber-500":"bg-blue-500",c=[{title:"Limite de Leads",usado:e.usados.leads,total:e.leads,percentual:n,icon:Ba,iconBg:"bg-blue-100 dark:bg-blue-900/30",iconColor:"text-blue-600 dark:text-blue-400",barColor:l(n)},{title:"Limite de Mensagens",usado:e.usados.mensagens,total:e.mensagens,percentual:i,icon:da,iconBg:"bg-green-100 dark:bg-green-900/30",iconColor:"text-green-600 dark:text-green-400",barColor:l(i)},{title:"Limite de Emails",usado:e.usados.envios,total:e.envios,percentual:o,icon:ia,iconBg:"bg-purple-100 dark:bg-purple-900/30",iconColor:"text-purple-600 dark:text-purple-400",barColor:l(o)}];return h.jsxs("div",{id:"plan-limits-card",className:"space-y-6",children:[h.jsxs("div",{id:"dashboard-welcome",className:"flex items-center justify-between",children:[h.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Limites do Plano"}),h.jsxs("button",{onClick:t,"data-upgrade-btn":!0,className:"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-6 py-2.5 rounded-xl transition-all duration-300 flex items-center gap-2 shadow-md hover:shadow-lg font-semibold text-sm",children:[h.jsx(Le,{className:"w-4 h-4"}),h.jsx("span",{children:"Upgrade de Plano"})]})]}),h.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:c.map((e,a)=>{const t=e.icon;return h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all duration-300",children:[h.jsx("div",{className:"flex justify-center mb-6",children:h.jsx("div",{className:`w-16 h-16 rounded-full ${e.iconBg} flex items-center justify-center`,children:h.jsx(t,{className:`w-8 h-8 ${e.iconColor}`})})}),h.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 text-center mb-4",children:e.title}),h.jsx("div",{className:"text-center mb-4",children:h.jsxs("div",{className:"flex items-center justify-center gap-2",children:[h.jsx("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:e.usado.toLocaleString()}),h.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"/"}),h.jsx("span",{className:"text-xl text-gray-600 dark:text-gray-400",children:-1===e.total?"‚àû":e.total.toLocaleString()})]})}),h.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden",children:h.jsx("div",{className:`h-full ${e.barColor} rounded-full transition-all duration-700`,style:{width:`${Math.min(e.percentual,100)}%`}})})]},a)})})]})}function Qt({leads:e,onEdit:a,onDelete:t,onChat:r,onSendEmail:s}){const n=[...e].sort((e,a)=>{const t=new Date(e.data||"").getTime();return new Date(a.data||"").getTime()-t}).slice(0,5),i=["bg-blue-100 text-blue-600","bg-purple-100 text-purple-600","bg-orange-100 text-orange-600","bg-green-100 text-green-600","bg-pink-100 text-pink-600"],o=e=>{if(!e)return"Sem data";const a=new Date(e),t=(new Date).getTime()-a.getTime(),r=Math.floor(t/36e5),s=Math.floor(t/864e5);return r<1?"Agora":r<24?`${r}h atr√°s`:1===s?"Ontem":s<7?`${s}d atr√°s`:a.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})};return 0===n.length?h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[h.jsx("h3",{className:"text-gray-900 dark:text-white mb-6",children:"Leads Recentes"}),h.jsx("div",{className:"text-center py-8",children:h.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhum lead cadastrado ainda"})})]}):h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700 shadow-sm",children:[h.jsx("h3",{className:"text-gray-900 dark:text-white mb-6",children:"Leads Recentes"}),h.jsx("div",{className:"space-y-3",children:n.map(n=>{const l=(e=>{if(!e)return{bg:"bg-gray-100",text:"text-gray-700",label:"Sem status"};const a=e.toLowerCase().replace(/_/g," ");return"novo"===a||"new"===a?{bg:"bg-emerald-100",text:"text-emerald-700",label:"Novo"}:"convertido"===a||"converted"===a||"fechado"===a?{bg:"bg-emerald-100",text:"text-emerald-700",label:"Fechado"}:a.includes("negociacao")||a.includes("negotiation")?{bg:"bg-yellow-100",text:"text-yellow-700",label:"Negocia√ß√£o"}:a.includes("qualificado")||a.includes("qualified")||a.includes("aguardando")||a.includes("contato")?{bg:"bg-blue-100",text:"text-blue-700",label:"Contato"}:"perdido"===a||"lost"===a?{bg:"bg-red-100",text:"text-red-700",label:"Perdido"}:{bg:"bg-gray-100",text:"text-gray-700",label:e}})(n.status),c=e.findIndex(e=>e.id===n.id),d=i[c%i.length];return h.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[h.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[h.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 ${d}`,children:h.jsx(za,{className:"w-5 h-5"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-gray-900 dark:text-white font-medium truncate",children:n.nome}),h.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:[n.origem||"Sem origem"," ‚Ä¢ ",o(n.data)]})]})]}),h.jsx("span",{className:`px-3 py-1 rounded-lg text-sm font-medium flex-shrink-0 ${l.bg} ${l.text}`,children:l.label}),h.jsxs("div",{className:"flex gap-1 ml-2",children:[a&&h.jsx("button",{className:"p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 text-blue-600 dark:text-blue-400 transition-colors flex-shrink-0",onClick:()=>a(c),title:"Editar lead",children:h.jsx(Ca,{className:"w-4 h-4"})}),r&&h.jsx("button",{className:"p-2 rounded-lg hover:bg-green-50 dark:hover:bg-green-900/30 text-green-600 dark:text-green-400 transition-colors flex-shrink-0",onClick:()=>r(c),title:"Chat WhatsApp",children:h.jsx(ca,{className:"w-4 h-4"})}),s&&n.email&&h.jsx("button",{className:"p-2 rounded-lg hover:bg-purple-50 dark:hover:bg-purple-900/30 text-purple-600 dark:text-purple-400 transition-colors flex-shrink-0",onClick:()=>s(c),title:"Enviar e-mail",children:h.jsx(ia,{className:"w-4 h-4"})}),t&&h.jsx("button",{className:"p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30 text-red-600 dark:text-red-400 transition-colors flex-shrink-0",onClick:()=>t(c),title:"Excluir lead",children:h.jsx(Ia,{className:"w-4 h-4"})})]})]},n.id)})})]})}function er(e){var a=c(e,[]);return h.jsx(m,o({"data-slot":"dropdown-menu"},a))}function ar(e){var a=c(e,[]);return h.jsx(f,o({"data-slot":"dropdown-menu-trigger"},a))}function tr(e){var a=e,{className:t,sideOffset:r=4}=a,s=c(a,["className","sideOffset"]);return h.jsx(g,{children:h.jsx(p,o({"data-slot":"dropdown-menu-content",sideOffset:r,className:nt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t)},s))})}function rr(e){var a=e,{className:t,inset:r,variant:s="default"}=a,n=c(a,["className","inset","variant"]);return h.jsx(x,o({"data-slot":"dropdown-menu-item","data-inset":r,"data-variant":s,className:nt("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t)},n))}function sr(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(b,o({"data-slot":"dropdown-menu-separator",className:nt("bg-border -mx-1 my-1 h-px",t)},r))}function nr(...e){const a=e[0];if(1===e.length)return a;const t=()=>{const t=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){const r=t.reduce((a,{useScope:t,scopeName:r})=>{const s=t(e)[`__scope${r}`];return o(o({},a),s)},{});return X.useMemo(()=>({[`__scope${a.scopeName}`]:r}),[r])}};return t.scopeName=a.scopeName,t}var ir=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{const t=Ja(`Primitive.${a}`),r=X.forwardRef((e,r)=>{const s=e,{asChild:n}=s,i=c(s,["asChild"]),d=n?t:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),h.jsx(d,l(o({},i),{ref:r}))});return r.displayName=`Primitive.${a}`,l(o({},e),{[a]:r})},{}),or={exports:{}},lr={},cr=X;var dr="function"==typeof Object.is?Object.is:function(e,a){return e===a&&(0!==e||1/e==1/a)||e!=e&&a!=a},hr=cr.useState,ur=cr.useEffect,mr=cr.useLayoutEffect,fr=cr.useDebugValue;function gr(e){var a=e.getSnapshot;e=e.value;try{var t=a();return!dr(e,t)}catch(r){return!0}}var pr="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,a){return a()}:function(e,a){var t=a(),r=hr({inst:{value:t,getSnapshot:a}}),s=r[0].inst,n=r[1];return mr(function(){s.value=t,s.getSnapshot=a,gr(s)&&n({inst:s})},[e,t,a]),ur(function(){return gr(s)&&n({inst:s}),e(function(){gr(s)&&n({inst:s})})},[e]),fr(t),t};lr.useSyncExternalStore=void 0!==cr.useSyncExternalStore?cr.useSyncExternalStore:pr,or.exports=lr;var xr=or.exports;function br(){return()=>{}}var vr="Avatar",[yr]=function(e,a=[]){let t=[];const r=()=>{const a=t.map(e=>X.createContext(e));return function(t){const r=(null==t?void 0:t[e])||a;return X.useMemo(()=>({[`__scope${e}`]:l(o({},t),{[e]:r})}),[t,r])}};return r.scopeName=e,[function(a,r){const s=X.createContext(r);s.displayName=a+"Context";const n=t.length;t=[...t,r];const i=a=>{var t;const r=a,{scope:i,children:o}=r,l=c(r,["scope","children"]),d=(null==(t=null==i?void 0:i[e])?void 0:t[n])||s,u=X.useMemo(()=>l,Object.values(l));return h.jsx(d.Provider,{value:u,children:o})};return i.displayName=a+"Provider",[i,function(t,i){var o;const l=(null==(o=null==i?void 0:i[e])?void 0:o[n])||s,c=X.useContext(l);if(c)return c;if(void 0!==r)return r;throw new Error(`\`${t}\` must be used within \`${a}\``)}]},nr(r,...a)]}(vr),[wr,Nr]=yr(vr),jr=X.forwardRef((e,a)=>{const t=e,{__scopeAvatar:r}=t,s=c(t,["__scopeAvatar"]),[n,i]=X.useState("idle");return h.jsx(wr,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:i,children:h.jsx(ir.span,l(o({},s),{ref:a}))})});jr.displayName=vr;var kr="AvatarImage",Er=X.forwardRef((e,a)=>{const t=e,{__scopeAvatar:r,src:s,onLoadingStatusChange:n=()=>{}}=t,i=c(t,["__scopeAvatar","src","onLoadingStatusChange"]),d=Nr(kr,r),u=function(e,{referrerPolicy:a,crossOrigin:t}){const r=xr.useSyncExternalStore(br,()=>!0,()=>!1),s=X.useRef(null),n=r?(s.current||(s.current=new window.Image),s.current):null,[i,o]=X.useState(()=>Cr(n,e));return y(()=>{o(Cr(n,e))},[n,e]),y(()=>{const e=e=>()=>{o(e)};if(!n)return;const r=e("loaded"),s=e("error");return n.addEventListener("load",r),n.addEventListener("error",s),a&&(n.referrerPolicy=a),"string"==typeof t&&(n.crossOrigin=t),()=>{n.removeEventListener("load",r),n.removeEventListener("error",s)}},[n,t,a]),i}(s,i),m=v(e=>{n(e),d.onImageLoadingStatusChange(e)});return y(()=>{"idle"!==u&&m(u)},[u,m]),"loaded"===u?h.jsx(ir.img,l(o({},i),{ref:a,src:s})):null});Er.displayName=kr;var Tr="AvatarFallback",Sr=X.forwardRef((e,a)=>{const t=e,{__scopeAvatar:r,delayMs:s}=t,n=c(t,["__scopeAvatar","delayMs"]),i=Nr(Tr,r),[d,u]=X.useState(void 0===s);return X.useEffect(()=>{if(void 0!==s){const e=window.setTimeout(()=>u(!0),s);return()=>window.clearTimeout(e)}},[s]),d&&"loaded"!==i.imageLoadingStatus?h.jsx(ir.span,l(o({},n),{ref:a})):null});function Cr(e,a){return e?a?(e.src!==a&&(e.src=a),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}Sr.displayName=Tr;var Ar=jr,_r=Er,Rr=Sr;function Or(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(Ar,o({"data-slot":"avatar",className:nt("relative flex size-10 shrink-0 overflow-hidden rounded-full",t)},r))}function Ir(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(_r,o({"data-slot":"avatar-image",className:nt("aspect-square size-full",t)},r))}function Mr(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(Rr,o({"data-slot":"avatar-fallback",className:nt("bg-muted flex size-full items-center justify-center rounded-full",t)},r))}function Pr({user:e,onProfile:a,onSettings:t,onChangePassword:r,onLogout:s}){var n;return h.jsxs(er,{children:[h.jsx(ar,{asChild:!0,children:h.jsx("button",{className:"relative rounded-full ring-2 ring-gray-200 dark:ring-gray-700 hover:ring-blue-500 dark:hover:ring-blue-400 transition-all focus:outline-none",children:h.jsxs(Or,{className:"h-9 w-9",children:[h.jsx(Ir,{src:null==e?void 0:e.avatar,alt:(null==e?void 0:e.name)||"User"}),h.jsx(Mr,{className:"text-sm bg-blue-600 text-white",children:(null==(n=null==e?void 0:e.name)?void 0:n.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2))||"U"})]})})}),h.jsxs(tr,{align:"end",className:"w-52 p-2",children:[h.jsxs(rr,{onClick:a,className:"px-3 py-2.5 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",children:[h.jsx(za,{className:"w-4 h-4 mr-3"}),h.jsx("span",{className:"text-sm",children:"Ver Perfil"})]}),h.jsxs(rr,{onClick:t,className:"px-3 py-2.5 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",children:[h.jsx(ja,{className:"w-4 h-4 mr-3"}),h.jsx("span",{className:"text-sm",children:"Configura√ß√µes da Conta"})]}),h.jsxs(rr,{onClick:r,className:"px-3 py-2.5 rounded-lg cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800",children:[h.jsx(ra,{className:"w-4 h-4 mr-3"}),h.jsx("span",{className:"text-sm",children:"Alterar Senha"})]}),h.jsx(sr,{className:"my-1"}),h.jsxs(rr,{onClick:s,className:"px-3 py-2.5 rounded-lg cursor-pointer hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400",children:[h.jsx(na,{className:"w-4 h-4 mr-3"}),h.jsx("span",{className:"text-sm",children:"Sair"})]})]})]})}function Lr({onStartTour:e}){const[a,t]=X.useState(!1),[r,s]=X.useState([]);X.useEffect(()=>{n()},[]);const n=()=>{const e=localStorage.getItem("leadsflow_notifications");if(e){const a=JSON.parse(e);s(a.map(e=>l(o({},e),{timestamp:new Date(e.timestamp)})))}else{const e=[{id:"1",type:"welcome",title:"üëã Bem-vindo ao LeadsFlow!",message:"Estamos felizes em t√™-lo conosco. Explore todas as funcionalidades e comece a gerenciar seus leads de forma eficiente.",timestamp:new Date,read:!1},{id:"2",type:"tour",title:"üéØ Tour Guiado Dispon√≠vel",message:"Novo por aqui? Clique para fazer um tour guiado e conhecer todas as funcionalidades da plataforma.",timestamp:new Date,read:!1},{id:"3",type:"update",title:"‚ú® Nova Vers√£o v31",message:"Sistema de importa√ß√£o de leads aprimorado com suporte total para Excel (.xlsx/.xls) e normaliza√ß√£o autom√°tica de colunas.",timestamp:new Date(Date.now()-36e5),read:!1}];s(e),i(e)}},i=e=>{localStorage.setItem("leadsflow_notifications",JSON.stringify(e))},c=e=>{const a=r.map(a=>a.id===e?l(o({},a),{read:!0}):a);s(a),i(a)},d=r.filter(e=>!e.read).length,u=e=>{switch(e){case"welcome":return h.jsx(qe,{className:"w-5 h-5 text-purple-600"});case"tour":return h.jsx(Sa,{className:"w-5 h-5 text-blue-600"});case"update":return h.jsx(Je,{className:"w-5 h-5 text-green-600"});case"success":return h.jsx(Te,{className:"w-5 h-5 text-green-600"});default:return h.jsx(je,{className:"w-5 h-5 text-gray-600"})}},m=e=>{const a=(new Date).getTime()-e.getTime(),t=Math.floor(a/6e4),r=Math.floor(a/36e5),s=Math.floor(a/864e5);return t<1?"Agora":t<60?`${t}m atr√°s`:r<24?`${r}h atr√°s`:s<7?`${s}d atr√°s`:e.toLocaleDateString("pt-BR")};return h.jsxs("div",{className:"relative",children:[h.jsxs("button",{id:"notification-button",onClick:()=>t(!a),className:"relative p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[h.jsx(je,{className:"w-5 h-5 text-gray-700 dark:text-gray-300"}),d>0&&h.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center animate-pulse",children:d>9?"9+":d})]}),a&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>t(!1)}),h.jsxs("div",{className:"absolute right-0 top-12 w-96 max-h-[600px] bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 z-50 overflow-hidden flex flex-col",children:[h.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-800",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Notifica√ß√µes"}),h.jsx("button",{onClick:()=>t(!1),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-lg transition-colors",children:h.jsx(Ha,{className:"w-4 h-4"})})]}),r.length>0&&h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>{const e=r.map(e=>l(o({},e),{read:!0}));s(e),i(e)},className:"text-xs h-7",children:"Marcar todas como lidas"}),h.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>{s([]),localStorage.removeItem("leadsflow_notifications")},className:"text-xs h-7 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:"Limpar tudo"})]})]}),h.jsx("div",{className:"flex-1 overflow-y-auto",children:0===r.length?h.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mb-3",children:h.jsx(je,{className:"w-8 h-8 text-gray-400"})}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm text-center",children:"Nenhuma notifica√ß√£o no momento"}),h.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-xs text-center mt-1",children:"Voc√™ receber√° atualiza√ß√µes aqui"})]}):h.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:r.map(a=>h.jsx("div",{className:`p-4 transition-colors ${a.read?"bg-white dark:bg-gray-800":"bg-blue-50 dark:bg-blue-900/10"} hover:bg-gray-50 dark:hover:bg-gray-700/50`,children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"flex-shrink-0 mt-0.5",children:u(a.type)}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[h.jsx("h4",{className:"font-medium text-sm text-gray-900 dark:text-white",children:a.title}),!a.read&&h.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0 mt-1"})]}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 leading-relaxed mb-2",children:a.message}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:m(a.timestamp)}),h.jsxs("div",{className:"flex items-center gap-1",children:["tour"===a.type&&h.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>{return r=a.id,c(r),t(!1),void(e&&e());var r},className:"text-xs h-6 text-blue-600 hover:text-blue-700",children:"Iniciar Tour"}),!a.read&&h.jsx(ot,{variant:"ghost",size:"sm",onClick:()=>c(a.id),className:"text-xs h-6",children:"Marcar como lida"}),h.jsx("button",{onClick:()=>(e=>{const a=r.filter(a=>a.id!==e);s(a),i(a)})(a.id),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",children:h.jsx(Ha,{className:"w-3 h-3 text-gray-400"})})]})]})]})]})},a.id))})})]})]})]})}function Dr({user:e,isDark:a,currentPage:t,onNavigate:r,onToggleTheme:s,onNovoLead:n,onEmailMarketing:i,onMassMessage:o,onSettings:l,onLogout:c,isSidebarOpen:d,onToggleSidebar:u,onStartTour:m}){const[f,g]=X.useState(!1);X.useEffect(()=>{const e=()=>{g(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);return h.jsx("header",{className:"sticky top-0 z-30 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:h.jsxs("div",{className:"px-4 lg:px-6 h-16 flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("button",{onClick:u,className:"md:hidden p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Toggle menu",children:h.jsx(la,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:h.jsx(qa,{className:"w-5 h-5 text-white"})}),h.jsx("div",{className:"hidden sm:block",children:h.jsx("h1",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"LeadsFlow API"})})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Lr,{onStartTour:m}),h.jsx("button",{id:"theme-toggle",onClick:s,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Toggle theme",children:a?h.jsx(Ra,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}):h.jsx(ua,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),h.jsx("div",{id:"user-avatar",children:h.jsx(Pr,{user:e,onProfile:()=>{r("account")},onSettings:l,onChangePassword:()=>{r("account")},onLogout:c})})]})]})})}const Fr=[{id:"dashboard",label:"Dashboard",icon:Ke},{id:"leads",label:"Leads",icon:Ba},{id:"campaigns",label:"Campanhas",icon:Na},{id:"plan",label:"Plano",icon:Le},{id:"integrations",label:"Integra√ß√µes",icon:ja},{id:"security",label:"Seguran√ßa",icon:Ea},{id:"account",label:"Configura√ß√µes da Conta",icon:za}];function zr({isOpen:e,onClose:a,currentPage:t,onNavigate:r,isDark:s,onToggleTheme:n,isMobile:i=!1,user:o}){var l,c;const d=!0===(null==o?void 0:o.isAdmin)||"admin@leadflow.com"===(null==o?void 0:o.email),u=e=>{r(e),i&&a()};return h.jsxs(h.Fragment,{children:[e&&i&&h.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-40 transition-opacity",onClick:a}),h.jsx("aside",{className:`\n          h-screen bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 \n          transition-all duration-300 ease-in-out flex-shrink-0\n          ${i?"fixed top-0 left-0 z-50 w-[70%] max-w-xs overflow-y-auto":"md:fixed md:top-0 md:left-0 w-[260px] overflow-y-auto"}\n          ${e?"translate-x-0":i?"-translate-x-full":""}\n          ${e||i?"":"hidden md:block"}\n        `,children:h.jsxs("div",{className:"flex flex-col h-full",children:[h.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-800",children:h.jsxs("div",{className:"flex items-start justify-between mb-4",children:[h.jsxs("div",{className:"flex-1 flex flex-col items-center text-center",children:[h.jsxs(Or,{className:"h-16 w-16 mb-3",children:[h.jsx(Ir,{src:null==o?void 0:o.avatar,alt:(null==o?void 0:o.name)||"User"}),h.jsx(Mr,{className:"text-xl bg-blue-600 text-white",children:(null==(l=null==o?void 0:o.name)?void 0:l.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2))||"U"})]}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Ol√°,"}),h.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:(null==o?void 0:o.name)||(null==(c=null==o?void 0:o.email)?void 0:c.split("@")[0])||"Usu√°rio"})]}),i&&h.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:h.jsx(Ha,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]})}),h.jsx("nav",{id:"sidebar-navigation",className:"flex-1 p-4 overflow-y-auto",children:h.jsxs("ul",{className:"space-y-1",children:[Fr.map(e=>{const a=e.icon,r=t===e.id;return h.jsx("li",{children:h.jsxs("button",{onClick:()=>u(e.id),className:"w-full flex items-center justify-between px-4 py-3 rounded-lg transition-colors "+(r?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"),children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(a,{className:"w-5 h-5"}),h.jsx("span",{className:"text-sm font-medium",children:e.label})]}),r&&h.jsx(Re,{className:"w-4 h-4"})]})},e.id)}),d&&h.jsx(h.Fragment,{children:h.jsx("li",{className:"pt-2 mt-2 border-t border-gray-200 dark:border-gray-800",children:h.jsxs("button",{onClick:()=>u("admin"),className:"w-full flex items-center justify-between px-4 py-3 rounded-lg transition-colors "+("admin"===t?"bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400":"text-gray-700 dark:text-gray-300 hover:bg-purple-50 dark:hover:bg-purple-900/10"),children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(Da,{className:"w-5 h-5"}),h.jsx("span",{className:"text-sm font-medium",children:"Admin"})]}),"admin"===t&&h.jsx(Re,{className:"w-4 h-4"})]})})})]})}),h.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-800",children:h.jsx("button",{onClick:n,className:"w-full flex items-center justify-between px-4 py-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-700 dark:text-gray-300",children:h.jsxs("div",{className:"flex items-center gap-3",children:[s?h.jsx(Ra,{className:"w-5 h-5"}):h.jsx(ua,{className:"w-5 h-5"}),h.jsxs("span",{className:"text-sm font-medium",children:["Tema ",s?"Claro":"Escuro"]})]})})})]})})]})}function Br({user:e,onUpgrade:a}){var t;const[r,s]=X.useState("monthly"),n=(null==e?void 0:e.plan)||"free",i=[{id:"free",name:"Free",icon:qa,color:"from-gray-500 to-gray-600",price:{monthly:0,annual:0},features:["100 leads","50 mensagens WhatsApp/m√™s","5 envios em massa/m√™s","Suporte b√°sico"]},{id:"business",name:"Business",icon:va,color:"from-blue-500 to-blue-600",price:{monthly:20,annual:100},features:["1.000 leads","500 mensagens WhatsApp/m√™s","50 envios em massa/m√™s","Suporte priorit√°rio","Integra√ß√µes avan√ßadas"]},{id:"enterprise",name:"Enterprise",icon:Le,color:"from-purple-500 to-purple-600",price:{monthly:59,annual:200},features:["Leads ilimitados","Mensagens WhatsApp ilimitadas","Envios em massa ilimitados","Suporte VIP 24/7","API dedicada","Gestor de conta"]}];return h.jsxs("div",{className:"max-w-6xl mx-auto px-4 md:px-0",children:[h.jsxs("div",{className:"mb-8 text-center",children:[h.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"Planos e Pre√ßos"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Escolha o plano ideal para o seu neg√≥cio"})]}),h.jsx("div",{className:"flex justify-center mb-8",children:h.jsxs("div",{className:"inline-flex items-center bg-gray-100 dark:bg-gray-800 rounded-lg p-1",children:[h.jsx("button",{onClick:()=>s("monthly"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("monthly"===r?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"),children:"Mensal"}),h.jsxs("button",{onClick:()=>s("annual"),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors "+("annual"===r?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"),children:["Anual",h.jsx("span",{className:"ml-2 text-xs bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-2 py-0.5 rounded-full",children:"Economize"})]})]})}),h.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:i.map(e=>{const t=e.icon,s=n===e.id,i=e.price[r];return h.jsxs("div",{className:"relative bg-white dark:bg-gray-900 rounded-xl border-2 transition-all "+(s?"border-blue-500 shadow-lg":"border-gray-200 dark:border-gray-800 hover:border-gray-300 dark:hover:border-gray-700"),children:[s&&h.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2",children:h.jsx("span",{className:"bg-blue-600 text-white text-xs font-medium px-3 py-1 rounded-full",children:"Plano Atual"})}),h.jsxs("div",{className:"p-6",children:[h.jsx("div",{className:`w-12 h-12 bg-gradient-to-br ${e.color} rounded-lg flex items-center justify-center mb-4`,children:h.jsx(t,{className:"w-6 h-6 text-white"})}),h.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:e.name}),h.jsxs("div",{className:"mb-6",children:[h.jsxs("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:["$",i]}),h.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["/","monthly"===r?"m√™s":"ano"]})]}),h.jsx("ul",{className:"space-y-3 mb-6",children:e.features.map((e,a)=>h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(Ce,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),h.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:e})]},a))}),h.jsx(ot,{onClick:a,disabled:s,className:"w-full "+(s?"bg-gray-100 dark:bg-gray-800 text-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:s?"Plano Atual":"Fazer Upgrade"})]})]},e.id)})}),h.jsx("div",{className:"mt-8 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:h.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[h.jsx("strong",{children:"Plano Atual:"})," ",(null==(t=i.find(e=>e.id===n))?void 0:t.name)||"Free"]})})]})}function Ur(e){var a=e,{className:t,type:r}=a,s=c(a,["className","type"]);return h.jsx("input",o({type:r,"data-slot":"input",className:nt("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground bg-input-background dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t)},s))}var $r=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{const t=Ja(`Primitive.${a}`),r=X.forwardRef((e,r)=>{const s=e,{asChild:n}=s,i=c(s,["asChild"]),d=n?t:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),h.jsx(d,l(o({},i),{ref:r}))});return r.displayName=`Primitive.${a}`,l(o({},e),{[a]:r})},{}),Wr=X.forwardRef((e,a)=>h.jsx($r.label,l(o({},e),{ref:a,onMouseDown:a=>{var t;a.target.closest("button, input, select, textarea")||(null==(t=e.onMouseDown)||t.call(e,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}})));Wr.displayName="Label";var Vr=Wr;function Hr(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(Vr,o({"data-slot":"label",className:nt("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t)},r))}const Gr="rfzmpkdtasgwkopiboya",qr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJmem1wa2R0YXNnd2tvcGlib3lhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMwMTE0NjYsImV4cCI6MjA3ODU4NzQ2Nn0.4rJFIB19QRESkIdZGDIotsjGxidQ93PpV89CexlANE4",Xr=Object.freeze(Object.defineProperty({__proto__:null,projectId:Gr,publicAnonKey:qr},Symbol.toStringTag,{value:"Module"}));function Yr(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx("div",o({"data-slot":"card",className:nt("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",t)},r))}function Kr(e){var a=c(e,[]);return h.jsx(N,o({"data-slot":"dialog"},a))}function Jr(e){var a=c(e,[]);return h.jsx(S,o({"data-slot":"dialog-portal"},a))}const Zr=X.forwardRef((e,a)=>{var t=e,{className:r}=t,s=c(t,["className"]);return h.jsx(w,o({ref:a,"data-slot":"dialog-overlay",className:nt("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",r)},s))});function Qr(e){var a=e,{className:t,children:r}=a,s=c(a,["className","children"]);return h.jsxs(Jr,{"data-slot":"dialog-portal",children:[h.jsx(Zr,{}),h.jsxs(j,l(o({"data-slot":"dialog-content",className:nt("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t)},s),{children:[r,h.jsxs(k,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[h.jsx(Ha,{}),h.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})}function es(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx("div",o({"data-slot":"dialog-header",className:nt("flex flex-col gap-2 text-center sm:text-left",t)},r))}function as(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx("div",o({"data-slot":"dialog-footer",className:nt("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t)},r))}function ts(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(E,o({"data-slot":"dialog-title",className:nt("text-lg leading-none font-semibold",t)},r))}function rs(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(T,o({"data-slot":"dialog-description",className:nt("text-muted-foreground text-sm",t)},r))}Zr.displayName=w.displayName;const ss=st("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function ns(e){var a=e,{className:t,variant:r}=a,s=c(a,["className","variant"]);return h.jsx("div",o({"data-slot":"alert",role:"alert",className:nt(ss({variant:r}),t)},s))}function is(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx("div",o({"data-slot":"alert-description",className:nt("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t)},r))}function os(){const[e,a]=X.useState({status:"disconnected",connected:!1}),[t,r]=X.useState(!1),[s,n]=X.useState(null),[i,o]=X.useState(!1),[l,c]=X.useState(null),[u,m]=X.useState(!1);X.useEffect(()=>{g()},[]),X.useEffect(()=>{let a=null;return(i||"pending"===e.status||"connecting"===e.status)&&(a=setInterval(()=>{g()},2e3)),()=>{a&&clearInterval(a)}},[i,e.status]);const f=()=>({"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("leadflow_access_token")}`}),g=()=>d(this,null,function*(){try{if(!localStorage.getItem("leadflow_access_token"))return;const t=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/whatsapp/status`,{method:"GET",headers:f()});if(!t.ok)return;const r=yield t.json(),s=!e.connected,l=r.connected,d="connecting"===r.status||"connecting"===r.instanceState;a({status:r.status||(r.connected?"connected":"disconnected"),connected:r.connected||!1,instanceName:r.instanceName,profileName:r.profileName,profilePictureUrl:r.profilePictureUrl,apikey:r.apikey}),r.apikey&&localStorage.setItem("evolution_api_key",r.apikey),d&&!l&&i&&Ft.info("Conectando WhatsApp...",{description:"QR Code escaneado! Aguarde a confirma√ß√£o.",duration:2e3}),l&&s&&(i&&o(!1),n(null),c(null),Ft.success("WhatsApp conectado com sucesso! üéâ",{description:"Agora voc√™ pode enviar mensagens para seus leads.",duration:5e3}))}catch(t){}}),p=()=>d(this,null,function*(){m(!0);try{const e=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/whatsapp/qrcode`,{method:"GET",headers:f()}),a=yield e.json();if(!e.ok)throw new Error(a.error||"Failed to get QR code");a.base64?n(a.base64):a.qrcode&&n(a.qrcode)}catch(e){c(e.message||"Erro ao obter QR code")}finally{m(!1)}});return h.jsxs("div",{className:"space-y-4",children:[h.jsxs(Yr,{className:"p-6",children:[h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex items-start space-x-4",children:[h.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-lg",children:h.jsx(Ta,{className:"w-6 h-6 text-green-600 dark:text-green-500"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"font-semibold mb-1",children:"WhatsApp"}),h.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.connected?h.jsxs(h.Fragment,{children:[h.jsx(Te,{className:"w-4 h-4 text-green-600"}),h.jsx("span",{className:"text-green-600",children:"Conectado"})]}):"connecting"===e.status?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 text-blue-600 animate-spin"}),h.jsx("span",{className:"text-blue-600",children:"Conectando..."})]}):"pending"===e.status?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 text-yellow-600 animate-spin"}),h.jsx("span",{className:"text-yellow-600",children:"Aguardando QR Code..."})]}):h.jsxs(h.Fragment,{children:[h.jsx(Va,{className:"w-4 h-4 text-gray-400"}),h.jsx("span",{className:"text-gray-500",children:"Desconectado"})]})}),e.profileName&&h.jsxs("p",{className:"text-sm text-muted-foreground",children:["Conta: ",e.profileName]}),h.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.connected?"Seu WhatsApp est√° conectado e pronto para enviar mensagens.":"connecting"===e.status?"QR Code escaneado! Finalizando conex√£o...":"pending"===e.status?"Escaneie o QR Code para conectar.":"Conecte seu WhatsApp para enviar mensagens aos seus leads."})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[e.connected?h.jsx(ot,{variant:"destructive",size:"sm",onClick:()=>d(this,null,function*(){if(confirm("Tem certeza que deseja desconectar o WhatsApp?")){r(!0),c(null);try{const e=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/whatsapp/disconnect`,{method:"POST",headers:f()}),t=yield e.json();if(!e.ok)throw new Error(t.error||"Failed to disconnect WhatsApp");a({status:"disconnected",connected:!1}),Ft.success("WhatsApp desconectado com sucesso")}catch(e){c(e.message||"Erro ao desconectar WhatsApp"),Ft.error("Erro ao desconectar WhatsApp")}finally{r(!1)}}}),disabled:t,children:t?h.jsx(ta,{className:"w-4 h-4 animate-spin"}):"Desconectar"}):h.jsx(ot,{size:"sm",onClick:()=>d(this,null,function*(){r(!0),c(null);try{const e=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/whatsapp/connect`,{method:"POST",headers:f()}),t=yield e.json();if(!e.ok){const e=t.details?`${t.error}: ${t.details}`:t.error;throw new Error(e||"Failed to connect WhatsApp")}t.qrCode?(n(t.qrCode),o(!0),a({status:"pending",connected:!1}),setTimeout(()=>{g()},1e3)):"connected"===t.status||t.connected?(a({status:"connected",connected:!0}),c(null),Ft.success("WhatsApp j√° est√° conectado!")):(yield p(),o(!0),a({status:"pending",connected:!1}))}catch(e){c(e.message||"Erro ao conectar WhatsApp"),Ft.error("Erro ao conectar WhatsApp",{description:e.message||"Tente novamente em alguns instantes."})}finally{r(!1)}}),disabled:t||"connecting"===e.status,children:t?h.jsx(ta,{className:"w-4 h-4 animate-spin"}):h.jsxs(h.Fragment,{children:[h.jsx(pa,{className:"w-4 h-4 mr-2"}),"Conectar WhatsApp"]})}),h.jsx(ot,{variant:"ghost",size:"sm",onClick:g,disabled:u,children:h.jsx(ba,{className:"w-4 h-4 "+(u?"animate-spin":"")})})]})]}),l&&h.jsx(ns,{variant:"destructive",className:"mt-4",children:h.jsx(is,{children:l})})]}),h.jsx(Kr,{open:i,onOpenChange:o,children:h.jsxs(Qr,{className:"sm:max-w-md",children:[h.jsxs(es,{children:[h.jsxs(ts,{className:"flex items-center gap-2",children:[h.jsx(pa,{className:"w-5 h-5"}),"Conectar WhatsApp"]}),h.jsx(rs,{children:"Escaneie o QR Code abaixo com seu WhatsApp para conectar sua conta"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("ol",{className:"text-sm text-muted-foreground space-y-1 ml-4 list-decimal",children:[h.jsx("li",{children:"Abra o WhatsApp no seu celular"}),h.jsx("li",{children:"Toque em Mais op√ß√µes (‚ãÆ) > Aparelhos conectados"}),h.jsx("li",{children:'Toque em "Conectar um aparelho"'}),h.jsx("li",{children:"Aponte seu celular para esta tela para escanear o c√≥digo"})]}),s?h.jsxs("div",{className:"flex flex-col items-center justify-center p-4 bg-white rounded-lg",children:[h.jsx("img",{src:s,alt:"QR Code",className:"w-64 h-64"}),"connecting"===e.status?h.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 mt-4",children:[h.jsx(ta,{className:"w-4 h-4 animate-spin"}),h.jsx("span",{children:"Conectando... Aguarde!"})]}):h.jsx("p",{className:"text-sm text-gray-600 mt-4",children:"Aguardando escaneamento..."})]}):h.jsxs("div",{className:"flex flex-col items-center justify-center p-16 bg-gray-50 rounded-lg",children:[h.jsx(ta,{className:"w-8 h-8 animate-spin text-gray-400 mb-2"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Gerando QR Code..."})]}),h.jsx(ns,{children:h.jsx(is,{className:"text-xs",children:"O QR Code expira ap√≥s alguns minutos. Se n√£o conseguir conectar, feche esta janela e tente novamente."})})]})]})})]})}function ls({user:e}){const[a,t]=X.useState(null),[r,s]=X.useState(""),[n,i]=X.useState(""),[o,l]=X.useState(""),[c,d]=X.useState(""),[u,m]=X.useState(""),[f,g]=X.useState(""),[p,x]=X.useState(!1),[b,v]=X.useState(""),[y,w]=X.useState(""),[N,j]=X.useState(!1),[k,E]=X.useState(""),[T,S]=X.useState(!1),[C,A]=X.useState(""),[_,R]=X.useState(!1),[O,I]=X.useState(""),[M,P]=X.useState(!1),[L,D]=X.useState("n8n");X.useEffect(()=>{const e=localStorage.getItem("evolution_api_key");e&&v(e);const a=localStorage.getItem("n8n_webhook_url");a&&(w(a),j(!0));const t=localStorage.getItem("meta_pixel_id");t&&(E(t),S(!0));const r=localStorage.getItem("google_analytics_id");r&&(A(r),R(!0));const s=localStorage.getItem("chat_webhook_url");s&&(I(s),P(!0))},[]);const F=(null==e?void 0:e.plan)||(null==e?void 0:e.subscription_plan)||"free",z="business"===F||"enterprise"===F;(null==e?void 0:e.id)&&(window.location.origin,e.id);const B=()=>{Ft.success("Webhook configurado com sucesso!")},U=()=>{Ft.success("SMTP configurado com sucesso!")},$=()=>{if(y){try{new URL(y)}catch(e){return void Ft.error("URL inv√°lida. Certifique-se de incluir http:// ou https://")}localStorage.setItem("n8n_webhook_url",y),j(!0),Ft.success("‚úÖ Webhook N8N configurado com sucesso!")}else Ft.error("Por favor, insira a URL do webhook N8N")},W=()=>{localStorage.removeItem("n8n_webhook_url"),w(""),j(!1),Ft.success("üóëÔ∏è Configura√ß√£o do webhook N8N removida")},V=()=>{k?(localStorage.setItem("meta_pixel_id",k),S(!0),Ft.success("Meta Pixel configurado com sucesso!")):Ft.error("Por favor, insira o ID do Meta Pixel")},H=()=>{C?(localStorage.setItem("google_analytics_id",C),R(!0),Ft.success("Google Analytics configurado com sucesso!")):Ft.error("Por favor, insira o ID do Google Analytics")},G=[{id:"n8n",name:"Webhooks N8N",description:"Integra√ß√£o com planilha Google Sheets em tempo real",icon:ka,color:"text-cyan-600 dark:text-cyan-400",bgColor:"bg-cyan-50 dark:bg-cyan-900/20",borderColor:"border-cyan-200 dark:border-cyan-800",badge:N?"‚úì Configurado":null},{id:"webhook",name:"Webhooks",description:"Receba notifica√ß√µes em tempo real",icon:Ua,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-800"},{id:"smtp",name:"SMTP",description:"Configure seu servidor de email",icon:ia,color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-900/20",borderColor:"border-purple-200 dark:border-purple-800"},{id:"whatsapp",name:"WhatsApp API",description:"Integra√ß√£o com Evolution API",icon:da,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-200 dark:border-green-800"},{id:"meta-pixel",name:"Meta Pixel (Facebook)",description:"Rastreie eventos de convers√£o de leads no Meta Ads",icon:Ne,color:"text-indigo-600 dark:text-indigo-400",bgColor:"bg-indigo-50 dark:bg-indigo-900/20",borderColor:"border-indigo-200 dark:border-indigo-800",badge:T?"‚úì Configurado":null},{id:"google-analytics",name:"Google Analytics",description:"Envie eventos de convers√£o para o Google Analytics",icon:$e,color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-50 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800",badge:_?"‚úì Configurado":null}];return h.jsxs("div",{className:"max-w-4xl mx-auto px-4 md:px-0",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"Integra√ß√µes"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configure suas integra√ß√µes e servi√ßos externos"})]}),h.jsx("div",{className:"space-y-4",children:G.map(e=>{const f=e.icon,g=a===e.id;return h.jsxs("div",{className:`bg-white dark:bg-gray-900 rounded-xl border-2 transition-all ${g?e.borderColor:"border-gray-200 dark:border-gray-800 hover:border-gray-300 dark:hover:border-gray-700"}`,children:[h.jsxs("button",{onClick:()=>{return r=e.id,void t(a===r?null:r);var r},className:"w-full p-6 flex items-center justify-between text-left hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors rounded-t-xl",children:[h.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[h.jsx("div",{className:`w-12 h-12 ${e.bgColor} rounded-lg flex items-center justify-center flex-shrink-0`,children:h.jsx(f,{className:`w-6 h-6 ${e.color}`})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:e.name}),"badge"in e&&e.badge&&h.jsx("span",{className:"px-2 py-0.5 rounded-md text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:e.badge})]}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.description})]})]}),g?h.jsx(Oe,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}):h.jsx(Ae,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]}),g&&h.jsxs("div",{className:"px-6 pb-6 border-t border-gray-200 dark:border-gray-800 pt-6 relative",children:[!z&&("meta-pixel"===e.id||"google-analytics"===e.id)&&h.jsx("div",{className:"absolute inset-0 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm z-50 flex items-center justify-center rounded-b-xl",children:h.jsxs("div",{className:"max-w-md mx-auto p-8 text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:h.jsx(Le,{className:"w-8 h-8 text-white"})}),h.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Recurso Premium"}),h.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[e.name," est√° dispon√≠vel apenas nos planos ",h.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:"Business"})," e ",h.jsx("span",{className:"font-semibold text-purple-600 dark:text-purple-400",children:"Enterprise"}),"."]}),h.jsxs(ot,{onClick:()=>{const e=new CustomEvent("open-upgrade-modal");window.dispatchEvent(e)},className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold shadow-lg",children:[h.jsx(Le,{className:"w-4 h-4 mr-2"}),"Fazer Upgrade"]}),h.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mt-4",children:[h.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded p-2",children:[h.jsx("p",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Business"}),h.jsx("p",{className:"text-blue-600 dark:text-blue-400 font-bold",children:"$20/m√™s"})]}),h.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/30 border border-purple-200 dark:border-purple-800 rounded p-2",children:[h.jsx("p",{className:"font-semibold text-purple-900 dark:text-purple-100",children:"Enterprise"}),h.jsx("p",{className:"text-purple-600 dark:text-purple-400 font-bold",children:"$59/m√™s"})]})]})]})}),"webhook"===e.id&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"webhook-url",className:"text-sm",children:"URL do Webhook"}),h.jsx(Ur,{id:"webhook-url",type:"url",value:r,onChange:e=>s(e.target.value),placeholder:"https://seu-dominio.com/webhook",className:"mt-1.5"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Cole a URL onde deseja receber as notifica√ß√µes via webhook"})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx(ot,{onClick:B,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Salvar Webhook"})})]}),"smtp"===e.id&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"smtp-host",className:"text-sm",children:"Host SMTP"}),h.jsx(Ur,{id:"smtp-host",type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"smtp.gmail.com",className:"mt-1.5"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"smtp-port",className:"text-sm",children:"Porta"}),h.jsx(Ur,{id:"smtp-port",type:"text",value:o,onChange:e=>l(e.target.value),placeholder:"587",className:"mt-1.5"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"smtp-user",className:"text-sm",children:"Usu√°rio"}),h.jsx(Ur,{id:"smtp-user",type:"email",value:c,onChange:e=>d(e.target.value),placeholder:"seu@email.com",className:"mt-1.5"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"smtp-password",className:"text-sm",children:"Senha"}),h.jsx(Ur,{id:"smtp-password",type:"password",value:u,onChange:e=>m(e.target.value),placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",className:"mt-1.5"})]})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx(ot,{onClick:U,className:"bg-purple-600 hover:bg-purple-700 text-white",children:"Salvar SMTP"})})]}),"whatsapp"===e.id&&h.jsx(os,{}),"meta-pixel"===e.id&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200 dark:border-indigo-800 rounded-lg p-4",children:[h.jsx("h4",{className:"text-sm font-semibold text-indigo-900 dark:text-indigo-100 mb-2",children:"üìä Rastreie Convers√µes no Meta Ads"}),h.jsx("p",{className:"text-xs text-indigo-800 dark:text-indigo-200 mb-2",children:'Configure o Meta Pixel (Facebook Pixel) para rastrear eventos de convers√£o quando um lead for marcado como "Convertido" na sua CRM.'}),h.jsxs("p",{className:"text-xs text-indigo-800 dark:text-indigo-200",children:["Evento disparado automaticamente: ",h.jsx("code",{className:"bg-white dark:bg-gray-950 px-1.5 py-0.5 rounded text-indigo-900 dark:text-indigo-100 font-semibold",children:"Lead"})]})]}),h.jsxs("div",{children:[h.jsxs(Hr,{htmlFor:"meta-pixel-id",className:"text-sm flex items-center gap-2",children:[h.jsx(Ne,{className:"w-4 h-4 text-indigo-600 dark:text-indigo-400"}),"Meta Pixel ID"]}),h.jsx(Ur,{id:"meta-pixel-id",type:"text",value:k,onChange:e=>E(e.target.value),placeholder:"123456789012345",className:"mt-1.5 font-mono"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Encontre seu Pixel ID no Gerenciador de Eventos do Meta Business Suite"})]}),h.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[h.jsx("h4",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"‚ÑπÔ∏è Como funciona"}),h.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1.5",children:[h.jsx("li",{children:'‚Ä¢ Quando voc√™ marcar um lead como "Convertido", o pixel dispara automaticamente'}),h.jsx("li",{children:'‚Ä¢ O evento "Lead" √© enviado para o Meta com os dados do lead'}),h.jsx("li",{children:"‚Ä¢ Voc√™ pode ver as convers√µes no Gerenciador de An√∫ncios"}),h.jsx("li",{children:"‚Ä¢ Otimize suas campanhas com base em convers√µes reais"})]})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx(ot,{onClick:V,className:"bg-indigo-600 hover:bg-indigo-700 text-white",children:"Salvar Meta Pixel"})})]}),"google-analytics"===e.id&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4",children:[h.jsx("h4",{className:"text-sm font-semibold text-orange-900 dark:text-orange-100 mb-2",children:"üìà Rastreie Convers√µes no Google Analytics"}),h.jsx("p",{className:"text-xs text-orange-800 dark:text-orange-200 mb-2",children:'Configure o Google Analytics 4 (GA4) para rastrear eventos de convers√£o quando um lead for marcado como "Convertido" na sua CRM.'}),h.jsxs("p",{className:"text-xs text-orange-800 dark:text-orange-200",children:["Evento disparado automaticamente: ",h.jsx("code",{className:"bg-white dark:bg-gray-950 px-1.5 py-0.5 rounded text-orange-900 dark:text-orange-100 font-semibold",children:"generate_lead"})]})]}),h.jsxs("div",{children:[h.jsxs(Hr,{htmlFor:"google-analytics-id",className:"text-sm flex items-center gap-2",children:[h.jsx($e,{className:"w-4 h-4 text-orange-600 dark:text-orange-400"}),"Google Analytics Measurement ID"]}),h.jsx(Ur,{id:"google-analytics-id",type:"text",value:C,onChange:e=>A(e.target.value),placeholder:"G-XXXXXXXXXX",className:"mt-1.5 font-mono"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Encontre seu Measurement ID no Google Analytics (Admin ‚Üí Data Streams)"})]}),h.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[h.jsx("h4",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"‚ÑπÔ∏è Como funciona"}),h.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-1.5",children:[h.jsx("li",{children:'‚Ä¢ Quando voc√™ marcar um lead como "Convertido", o evento √© disparado automaticamente'}),h.jsx("li",{children:'‚Ä¢ O evento "generate_lead" √© enviado para o GA4 com os dados do lead'}),h.jsx("li",{children:"‚Ä¢ Voc√™ pode ver as convers√µes em Relat√≥rios ‚Üí Eventos no GA4"}),h.jsx("li",{children:"‚Ä¢ Configure o evento como convers√£o no GA4 para otimizar suas campanhas"})]})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx(ot,{onClick:H,className:"bg-orange-600 hover:bg-orange-700 text-white",children:"Salvar Google Analytics"})})]}),"n8n"===e.id&&h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"bg-cyan-50 dark:bg-cyan-900/20 border border-cyan-200 dark:border-cyan-800 rounded-lg p-4",children:[h.jsxs("h4",{className:"text-sm font-semibold text-cyan-900 dark:text-cyan-100 mb-2 flex items-center gap-2",children:[h.jsx(ka,{className:"w-4 h-4"}),"Configure as URLs dos webhooks do N8N para integra√ß√£o com sua planilha Google Sheets."]}),h.jsxs("p",{className:"text-xs text-cyan-800 dark:text-cyan-200",children:["As URLs devem ter o formato: ",h.jsx("code",{className:"bg-white dark:bg-gray-950 px-1.5 py-0.5 rounded text-cyan-900 dark:text-cyan-100",children:"https://seu-n8n.com/webhook/nome"})]})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[h.jsxs(Hr,{htmlFor:"n8n-webhook-url",className:"text-sm flex items-center gap-2",children:[h.jsx(Ua,{className:"w-4 h-4 text-cyan-600 dark:text-cyan-400"}),"Webhook - Cadastrar Novo Lead"]}),N&&h.jsx("span",{className:"px-2 py-0.5 rounded-md text-xs font-medium bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",children:"‚úì Configurado"})]}),N&&y&&h.jsx("div",{className:"mb-2 p-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md",children:h.jsxs("p",{className:"text-xs text-green-800 dark:text-green-200 break-all",children:[h.jsx("strong",{children:"URL atual:"})," ",y]})}),h.jsx(Ur,{id:"n8n-webhook-url",type:"url",value:y,onChange:e=>w(e.target.value),placeholder:"https://seu-n8n.com/webhook/listar-leads",className:"mt-1.5 font-mono text-xs"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"Endpoint GET/POST para listar ou criar leads na planilha"})]}),h.jsxs("div",{className:"flex gap-2 justify-end",children:[h.jsx(ot,{onClick:$,className:"bg-cyan-600 hover:bg-cyan-700 text-white",children:"üíæ Salvar"}),N&&h.jsx(ot,{onClick:W,variant:"outline",className:"border-red-600 text-red-600 hover:bg-red-50 dark:border-red-500 dark:text-red-400 dark:hover:bg-red-900/20",children:"üóëÔ∏è Limpar"})]})]})]})]},e.id)})})]})}function cs({user:e}){const[a,t]=X.useState(!1);return h.jsxs("div",{className:"max-w-4xl mx-auto px-4 md:px-0",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"Seguran√ßa"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Gerencie a seguran√ßa da sua conta"})]}),h.jsx("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-800 p-6 mb-6",children:h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-green-50 dark:bg-green-900/20 rounded-lg flex items-center justify-center flex-shrink-0",children:h.jsx(Ta,{className:"w-5 h-5 text-green-600"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"Autentica√ß√£o de Dois Fatores"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Adicione uma camada extra de seguran√ßa √† sua conta"}),h.jsx("div",{className:"flex items-center gap-2",children:a?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),h.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"Ativado"})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),h.jsx("span",{className:"text-sm text-gray-500",children:"Desativado"})]})})]})]}),h.jsx(ot,{onClick:a?()=>{t(!1),Ft.success("Autentica√ß√£o de dois fatores desativada!")}:()=>{t(!0),Ft.success("Autentica√ß√£o de dois fatores ativada!")},variant:a?"outline":"default",className:a?"":"bg-green-600 hover:bg-green-700 text-white",children:a?"Desativar":"Ativar"})]})}),h.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-800 p-6 mb-6",children:[h.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[h.jsx("div",{className:"w-10 h-10 bg-blue-50 dark:bg-blue-900/20 rounded-lg flex items-center justify-center",children:h.jsx(Qe,{className:"w-5 h-5 text-blue-600"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"Chaves de API"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Gerencie suas chaves de acesso √† API"})]})]}),h.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4 mb-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Chave Principal"}),h.jsx("span",{className:"text-xs text-gray-500",children:"Criada em 15 nov 2024"})]}),h.jsx("code",{className:"text-sm text-gray-600 dark:text-gray-400 font-mono",children:"lf_sk_xxxxxxxxxxxxxxxxxxxxxxxx"})]}),h.jsx(ot,{variant:"outline",className:"w-full",children:"Gerar Nova Chave"})]}),h.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-800 p-6",children:[h.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[h.jsx("div",{className:"w-10 h-10 bg-purple-50 dark:bg-purple-900/20 rounded-lg flex items-center justify-center",children:h.jsx(Ie,{className:"w-5 h-5 text-purple-600"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-1",children:"Sess√µes Ativas"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Dispositivos conectados √† sua conta"})]})]}),h.jsx("div",{className:"space-y-3",children:[{id:"1",device:"Chrome on Windows",location:"S√£o Paulo, Brasil",lastActive:"2 minutos atr√°s",current:!0},{id:"2",device:"Safari on iPhone",location:"S√£o Paulo, Brasil",lastActive:"2 horas atr√°s",current:!1}].map(e=>h.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.device}),e.current&&h.jsx("span",{className:"text-xs bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-2 py-0.5 rounded-full",children:"Atual"})]}),h.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.location," ‚Ä¢ ",e.lastActive]})]}),!e.current&&h.jsx(ot,{onClick:()=>(e.id,void Ft.success("Sess√£o encerrada com sucesso!")),variant:"outline",size:"sm",className:"text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",children:"Encerrar"})]},e.id))})]})]})}function ds({user:e,onUpdateUser:a}){var t;const[r,s]=X.useState("avatar"),[n,i]=X.useState(!1),[c,u]=X.useState(null),[m,f]=X.useState(null),[g,p]=X.useState((null==e?void 0:e.name)||""),[x,b]=X.useState(""),[v,y]=X.useState(""),[w,N]=X.useState(""),j=[{id:"avatar",label:"Avatar",icon:La},{id:"name",label:"Nome",icon:za},{id:"password",label:"Senha",icon:ra}];return h.jsxs("div",{className:"max-w-4xl mx-auto px-4 md:px-0",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"Configura√ß√µes da Conta"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Gerencie suas informa√ß√µes pessoais e seguran√ßa"})]}),h.jsx("div",{className:"border-b border-gray-200 dark:border-gray-800 mb-6",children:h.jsx("div",{className:"flex gap-6 overflow-x-auto",children:j.map(e=>{const a=e.icon;return h.jsxs("button",{onClick:()=>s(e.id),className:"flex items-center gap-2 px-1 py-3 border-b-2 transition-colors whitespace-nowrap text-sm "+(r===e.id?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"),children:[h.jsx(a,{className:"w-4 h-4"}),e.label]},e.id)})})}),h.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 p-6",children:["avatar"===r&&h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Alterar Avatar"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Atualize sua foto de perfil"})]}),h.jsxs("div",{className:"flex items-start gap-6",children:[h.jsxs(Or,{className:"h-24 w-24",children:[h.jsx(Ir,{src:m||(null==e?void 0:e.avatar),alt:(null==e?void 0:e.name)||"User"}),h.jsx(Mr,{className:"text-2xl bg-blue-600 text-white",children:(null==(t=null==e?void 0:e.name)?void 0:t.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2))||"U"})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("input",{type:"file",id:"avatar-upload",accept:"image/*",onChange:e=>{var a;const t=null==(a=e.target.files)?void 0:a[0];if(t){u(t);const e=new FileReader;e.onloadend=()=>{f(e.result)},e.readAsDataURL(t)}},className:"hidden"}),h.jsxs("label",{htmlFor:"avatar-upload",className:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-lg text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-colors",children:[h.jsx(La,{className:"w-4 h-4 mr-2"}),"Escolher Arquivo"]}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:"JPG, PNG ou GIF. M√°ximo 2MB."})]})]}),c&&h.jsx("div",{className:"flex justify-end",children:h.jsx(ot,{onClick:()=>d(this,null,function*(){if(c){i(!0);try{yield new Promise(e=>setTimeout(e,1500)),a(l(o({},e),{avatar:m})),Ft.success("Avatar atualizado com sucesso!"),u(null),f(null)}catch(t){Ft.error("Erro ao atualizar avatar")}finally{i(!1)}}else Ft.error("Selecione uma imagem")}),disabled:n,className:"bg-blue-600 hover:bg-blue-700 text-white",children:n?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar Avatar"})})]}),"name"===r&&h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Alterar Nome"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Atualize seu nome de exibi√ß√£o"})]}),h.jsxs("div",{className:"max-w-md space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"name",className:"text-sm",children:"Nome Completo"}),h.jsx(Ur,{id:"name",type:"text",value:g,onChange:e=>p(e.target.value),placeholder:"Seu nome completo",className:"mt-1.5"})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx(ot,{onClick:()=>d(this,null,function*(){if(g.trim()){i(!0);try{yield new Promise(e=>setTimeout(e,1e3)),a(l(o({},e),{name:g})),Ft.success("Nome atualizado com sucesso!")}catch(t){Ft.error("Erro ao atualizar nome")}finally{i(!1)}}else Ft.error("Nome n√£o pode estar vazio")}),disabled:n||g===(null==e?void 0:e.name),className:"bg-blue-600 hover:bg-blue-700 text-white",children:n?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar Nome"})})]})]}),"password"===r&&h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Alterar Senha"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-6",children:"Atualize sua senha de acesso"})]}),h.jsxs("div",{className:"max-w-md space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"current-password",className:"text-sm",children:"Senha Atual"}),h.jsx(Ur,{id:"current-password",type:"password",value:x,onChange:e=>b(e.target.value),placeholder:"Digite sua senha atual",className:"mt-1.5"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"new-password",className:"text-sm",children:"Nova Senha"}),h.jsx(Ur,{id:"new-password",type:"password",value:v,onChange:e=>y(e.target.value),placeholder:"Digite sua nova senha",className:"mt-1.5"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"confirm-password",className:"text-sm",children:"Confirmar Nova Senha"}),h.jsx(Ur,{id:"confirm-password",type:"password",value:w,onChange:e=>N(e.target.value),placeholder:"Confirme sua nova senha",className:"mt-1.5"})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx(ot,{onClick:()=>d(this,null,function*(){if(x&&v&&w)if(v.length<6)Ft.error("A nova senha deve ter pelo menos 6 caracteres");else if(v===w){i(!0);try{yield new Promise(e=>setTimeout(e,1e3)),Ft.success("Senha atualizada com sucesso!"),b(""),y(""),N("")}catch(e){Ft.error("Erro ao atualizar senha")}finally{i(!1)}}else Ft.error("As senhas n√£o coincidem");else Ft.error("Preencha todos os campos")}),disabled:n,className:"bg-blue-600 hover:bg-blue-700 text-white",children:n?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Alterar Senha"})})]})]})]})]})}let hs=null;const us=()=>(hs||(hs=me(`https://${Gr}.supabase.co`,qr,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"}})),hs),ms=`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab`,fs=void 0===import.meta;function gs(e){return d(this,arguments,function*(e,a={},t=!1){var r;const s=o({"Content-Type":"application/json"},a.headers||{});if(t){let e=localStorage.getItem("leadflow_access_token");if(!e)try{const{data:a}=yield us().auth.getSession();(null==(r=a.session)?void 0:r.access_token)&&(e=a.session.access_token,localStorage.setItem("leadflow_access_token",e))}catch(n){}if(e)s.Authorization=`Bearer ${e}`;else if(!fs)throw new Error("Voc√™ precisa estar logado para realizar esta a√ß√£o. Por favor, fa√ßa login novamente.")}else s.Authorization=`Bearer ${qr}`;try{const r=yield fetch(`${ms}${e}`,l(o({},a),{headers:s}));if(404===r.status&&"/admin/notification-settings"===e)return ps(e);let n;try{n=yield r.json()}catch(i){throw new Error(`Invalid JSON response from server (${r.status})`)}if(!r.ok)throw 401===r.status&&t&&(localStorage.removeItem("leadflow_access_token"),localStorage.removeItem("leadflow_refresh_token"),setTimeout(()=>window.location.reload(),1e3)),new Error(n.error||n.details||`API error: ${r.status}`);return n}catch(n){if(n instanceof TypeError&&"Failed to fetch"===n.message){if(fs&&("GET"===a.method||!a.method))return ps(e);if("/admin/notification-settings"===e&&"POST"===a.method)return{success:!0,settings:JSON.parse(a.body)};if(a.method&&"GET"!==a.method)throw new Error(`Backend indispon√≠vel. N√£o foi poss√≠vel realizar opera√ß√£o ${a.method} em ${e}`)}if(n instanceof Error&&n.message.includes("Invalid JSON response from server (404)")&&"/admin/notification-settings"===e)return"POST"===a.method?{success:!0,settings:JSON.parse(a.body)}:ps(e);throw n}})}function ps(e){return"/user/profile"===e||"/users/profile"===e?{id:"mock-user-id",email:"demo@leadsflow.com",name:"Demo User",plan:"free",subscription_plan:"free",isTrial:!1,limits:{leads:100,messages:50,massMessages:5},usage:{leads:0,messages:0,massMessages:0}}:"/leads"===e?[]:e.startsWith("/webhooks/settings")?{success:!0,webhookSettings:{metaPixelId:""}}:"/admin/notification-settings"===e?{success:!0,settings:{upgradeNotifications:!0,newUserNotifications:!1,paymentNotifications:!0}}:{success:!0,data:null}}const xs=(e,a="GET",t)=>d(void 0,null,function*(){const r={method:a};t&&(r.body=JSON.stringify(t));const s=!["/plans","/auth/signup","/auth/signin"].some(a=>e.startsWith(a));return gs(e,r,s)}),bs={setupDemo:()=>d(void 0,null,function*(){return yield gs("/auth/setup-demo",{method:"POST"})}),setupAdmin:()=>d(void 0,null,function*(){return yield gs("/auth/setup-admin",{method:"POST"})}),signup:(e,a,t,r="starter")=>d(void 0,null,function*(){var s,n;try{const s=yield gs("/auth/signup",{method:"POST",body:JSON.stringify({email:e,password:a,name:t,selectedPlan:r})});return s.success?(yield new Promise(e=>setTimeout(e,2e3)),yield bs.signin(e,a)):s}catch(i){if((null==(s=i.message)?void 0:s.includes("already been registered"))||(null==(n=i.message)?void 0:n.includes("User already registered")))throw new Error('Este email j√° est√° cadastrado. Se voc√™ esqueceu sua senha, use a op√ß√£o "Esqueceu a senha?" na tela de login.');throw i}}),signin:(e,a)=>d(void 0,null,function*(){try{const{data:t,error:r}=yield us().auth.signInWithPassword({email:e,password:a});if(r){if(r.message.includes("Invalid login credentials"))throw new Error('Email ou senha incorretos. Verifique suas credenciais.\n\nüí° Dica: Se voc√™ ainda n√£o tem conta, clique em "Criar conta gr√°tis".');if(r.message.includes("Email not confirmed"))throw new Error("Email n√£o confirmado. Por favor, verifique seu email e confirme sua conta antes de fazer login.");throw new Error(r.message)}if(!t.session||!t.user)throw new Error("Falha no login. Nenhuma sess√£o foi criada.");return localStorage.setItem("leadflow_access_token",t.session.access_token),localStorage.setItem("leadflow_refresh_token",t.session.refresh_token),{success:!0,user:{id:t.user.id,email:t.user.email}}}catch(t){throw t}}),signout:()=>d(void 0,null,function*(){try{return yield us().auth.signOut(),localStorage.removeItem("leadflow_access_token"),localStorage.removeItem("leadflow_refresh_token"),{success:!0}}catch(e){throw e}})},vs=e=>d(void 0,null,function*(){return{success:!0,user:yield gs("/users/profile",{method:"PUT",body:JSON.stringify({name:e})},!0)}}),ys=(e,a)=>d(void 0,null,function*(){return gs("/user/change-password",{method:"POST",body:JSON.stringify({currentPassword:e,newPassword:a})},!0)}),ws=()=>d(void 0,null,function*(){return gs("/plans",{})}),Ns=e=>d(void 0,null,function*(){return gs("/plans/upgrade",{method:"POST",body:JSON.stringify({planId:e})},!0)}),js=()=>d(void 0,null,function*(){const e=yield gs("/leads",{},!0);return{success:!0,leads:Array.isArray(e)?e:[]}}),ks=e=>d(void 0,null,function*(){return{success:!0,lead:yield gs("/leads",{method:"POST",body:JSON.stringify(e)},!0)}}),Es=(e,a)=>d(void 0,null,function*(){return{success:!0,lead:yield gs(`/leads/${e}`,{method:"PUT",body:JSON.stringify(a)},!0)}}),Ts=e=>d(void 0,null,function*(){return yield gs(`/leads/${e}`,{method:"DELETE"},!0),{success:!0}});function Ss(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(C,l(o({"data-slot":"switch",className:nt("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-switch-background focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t)},r),{children:h.jsx(A,{"data-slot":"switch-thumb",className:nt("bg-card dark:data-[state=unchecked]:bg-card-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})}))}function Cs(){const[e,a]=X.useState([]),[t,r]=X.useState([]),[s,n]=X.useState(!1),[i,c]=X.useState(""),[u,m]=X.useState(null),[f,g]=X.useState(!1),[p,x]=X.useState("business"),[b,v]=X.useState(30),[y,w]=X.useState({upgradeNotifications:!0,newUserNotifications:!1,paymentNotifications:!0}),[N,j]=X.useState(!1);X.useEffect(()=>{k(),C()},[]),X.useEffect(()=>{if(i){const a=e.filter(e=>{var a;return e.email.toLowerCase().includes(i.toLowerCase())||(null==(a=e.name)?void 0:a.toLowerCase().includes(i.toLowerCase()))});r(a)}else r(e)},[i,e]);const k=()=>d(this,null,function*(){n(!0);try{const e=yield xs("/admin/users","GET");e.success?(a(e.users||[]),r(e.users||[])):Ft.error(e.message||"Erro ao carregar usu√°rios")}catch(e){Ft.error("Erro ao carregar usu√°rios: "+e.message)}finally{n(!1)}}),E=e=>{switch(e){case"free":return h.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 text-gray-700 rounded-md text-xs",children:"Free"});case"business":return h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 text-blue-700 rounded-md text-xs",children:[h.jsx(va,{className:"w-3 h-3"}),"Business"]});case"enterprise":return h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-700 rounded-md text-xs",children:[h.jsx(Le,{className:"w-3 h-3"}),"Enterprise"]});default:return h.jsx("span",{className:"text-xs text-gray-500",children:e})}},T=e=>{if(!e)return null;const a=new Date,t=new Date(e),r=Math.ceil((t.getTime()-a.getTime())/864e5);return r<0?h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 rounded-md text-xs",children:[h.jsx(Ha,{className:"w-3 h-3"}),"Expirado"]}):r<=7?h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-700 rounded-md text-xs",children:[h.jsx(ke,{className:"w-3 h-3"}),r," dias restantes"]}):h.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-md text-xs",children:[h.jsx(Ce,{className:"w-3 h-3"}),r," dias restantes"]})},S=(()=>{let a=0,t=0,r=0,s=0;e.forEach(e=>{var n,i,o,l;if(e.planExpiresAt){const a=new Date;if(new Date(e.planExpiresAt)<a)return}"business"===e.plan?(null==(n=e.subscription_plan)?void 0:n.includes("annual"))||(null==(i=e.subscription_plan)?void 0:i.includes("yearly"))?t+=100:a+=20:"enterprise"===e.plan&&((null==(o=e.subscription_plan)?void 0:o.includes("annual"))||(null==(l=e.subscription_plan)?void 0:l.includes("yearly"))?s+=200:r+=59)});const n=a+t/12,i=r+s/12,o=12*a+t,l=12*r+s;return{totalMRR:n+i,totalARR:o+l,businessMRR:n,enterpriseMRR:i,businessARR:o,enterpriseARR:l,businessMonthlyCount:e.filter(e=>{var a;return"business"===e.plan&&!(null==(a=e.subscription_plan)?void 0:a.includes("annual"))}).length,businessAnnualCount:e.filter(e=>{var a;return"business"===e.plan&&(null==(a=e.subscription_plan)?void 0:a.includes("annual"))}).length,enterpriseMonthlyCount:e.filter(e=>{var a;return"enterprise"===e.plan&&!(null==(a=e.subscription_plan)?void 0:a.includes("annual"))}).length,enterpriseAnnualCount:e.filter(e=>{var a;return"enterprise"===e.plan&&(null==(a=e.subscription_plan)?void 0:a.includes("annual"))}).length}})(),C=()=>d(this,null,function*(){try{const e=yield xs("/admin/notification-settings","GET");e.success&&w(e.settings)}catch(e){}});return h.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[h.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin - Gest√£o de Usu√°rios"}),h.jsx("p",{className:"text-gray-600",children:"Gerencie planos e configura√ß√µes de usu√°rios"})]}),h.jsxs(ot,{onClick:()=>j(!0),variant:"outline",className:"flex items-center gap-2",children:[h.jsx(je,{className:"w-4 h-4"}),"Configurar Notifica√ß√µes"]})]}),h.jsx("div",{className:"mb-6",children:h.jsxs("div",{className:"relative",children:[h.jsx(wa,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{type:"text",placeholder:"Buscar por email ou nome...",value:i,onChange:e=>c(e.target.value),className:"pl-10"})]})}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8",children:[h.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:h.jsx(Ba,{className:"w-5 h-5 text-blue-600"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Total Usu√°rios"}),h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]})]})}),h.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:h.jsx(Ba,{className:"w-5 h-5 text-gray-600"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Free"}),h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(e=>"free"===e.plan).length})]})]})}),h.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:h.jsx(va,{className:"w-5 h-5 text-blue-600"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Business"}),h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(e=>"business"===e.plan).length})]})]})}),h.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:h.jsx(Le,{className:"w-5 h-5 text-purple-600"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Enterprise"}),h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.filter(e=>"enterprise"===e.plan).length})]})]})}),h.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border-2 border-green-200 p-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center",children:h.jsx(Fe,{className:"w-5 h-5 text-white"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-green-700 font-medium",children:"MRR Total"}),h.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["$",S.totalMRR.toFixed(2)]})]})]})}),h.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg border-2 border-green-200 p-4",children:h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center",children:h.jsx(Ma,{className:"w-5 h-5 text-white"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-green-700 font-medium",children:"ARR Total"}),h.jsxs("p",{className:"text-2xl font-bold text-green-700",children:["$",S.totalARR.toFixed(2)]})]})]})})]}),h.jsxs("div",{className:"mb-8",children:[h.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Detalhamento de Faturamento"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:h.jsx(va,{className:"w-6 h-6 text-blue-600"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-900",children:"Plano Business"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Receita mensal e anual"})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between pb-3 border-b border-gray-100",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Assinantes Mensais"}),h.jsx("p",{className:"text-xs text-gray-500",children:"$20/m√™s cada"})]}),h.jsxs("div",{className:"text-right",children:[h.jsxs("p",{className:"font-bold text-gray-900",children:[S.businessMonthlyCount," usu√°rios"]}),h.jsxs("p",{className:"text-sm text-blue-600",children:["$",20*S.businessMonthlyCount,"/m√™s"]})]})]}),h.jsxs("div",{className:"flex items-center justify-between pb-3 border-b border-gray-100",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Assinantes Anuais"}),h.jsx("p",{className:"text-xs text-gray-500",children:"$100/ano cada"})]}),h.jsxs("div",{className:"text-right",children:[h.jsxs("p",{className:"font-bold text-gray-900",children:[S.businessAnnualCount," usu√°rios"]}),h.jsxs("p",{className:"text-sm text-blue-600",children:["$",100*S.businessAnnualCount,"/ano"]})]})]}),h.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("p",{className:"font-medium text-gray-900",children:"MRR Business"}),h.jsxs("p",{className:"text-xl font-bold text-blue-600",children:["$",S.businessMRR.toFixed(2)]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("p",{className:"font-medium text-gray-900",children:"ARR Business"}),h.jsxs("p",{className:"text-xl font-bold text-blue-600",children:["$",S.businessARR.toFixed(2)]})]})]})]})]}),h.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:h.jsx(Le,{className:"w-6 h-6 text-purple-600"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-bold text-gray-900",children:"Plano Enterprise"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Receita mensal e anual"})]})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between pb-3 border-b border-gray-100",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Assinantes Mensais"}),h.jsx("p",{className:"text-xs text-gray-500",children:"$59/m√™s cada"})]}),h.jsxs("div",{className:"text-right",children:[h.jsxs("p",{className:"font-bold text-gray-900",children:[S.enterpriseMonthlyCount," usu√°rios"]}),h.jsxs("p",{className:"text-sm text-purple-600",children:["$",59*S.enterpriseMonthlyCount,"/m√™s"]})]})]}),h.jsxs("div",{className:"flex items-center justify-between pb-3 border-b border-gray-100",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-600",children:"Assinantes Anuais"}),h.jsx("p",{className:"text-xs text-gray-500",children:"$200/ano cada"})]}),h.jsxs("div",{className:"text-right",children:[h.jsxs("p",{className:"font-bold text-gray-900",children:[S.enterpriseAnnualCount," usu√°rios"]}),h.jsxs("p",{className:"text-sm text-purple-600",children:["$",200*S.enterpriseAnnualCount,"/ano"]})]})]}),h.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("p",{className:"font-medium text-gray-900",children:"MRR Enterprise"}),h.jsxs("p",{className:"text-xl font-bold text-purple-600",children:["$",S.enterpriseMRR.toFixed(2)]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("p",{className:"font-medium text-gray-900",children:"ARR Enterprise"}),h.jsxs("p",{className:"text-xl font-bold text-purple-600",children:["$",S.enterpriseARR.toFixed(2)]})]})]})]})]})]}),h.jsxs("div",{className:"mt-6 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border-2 border-green-200 p-6",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center",children:h.jsx(Fe,{className:"w-7 h-7 text-white"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Faturamento Total"}),h.jsx("p",{className:"text-sm text-gray-600",children:"Receita recorrente de todos os planos pagos ativos"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[h.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[h.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Receita Mensal Recorrente (MRR)"}),h.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["$",S.totalMRR.toFixed(2)]}),h.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[S.businessMonthlyCount+S.enterpriseMonthlyCount," assinantes mensais +"," ",S.businessAnnualCount+S.enterpriseAnnualCount," anuais (convertido)"]})]}),h.jsxs("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:[h.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Receita Anual Recorrente (ARR)"}),h.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["$",S.totalARR.toFixed(2)]}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Proje√ß√£o anual baseada em todos os assinantes ativos"})]})]})]})]}),h.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:h.jsx("div",{className:"overflow-x-auto",children:h.jsxs("table",{className:"w-full",children:[h.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:h.jsxs("tr",{children:[h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usu√°rio"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Plano"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cadastro"}),h.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A√ß√µes"})]})}),h.jsx("tbody",{className:"divide-y divide-gray-200",children:s?h.jsx("tr",{children:h.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"Carregando usu√°rios..."})}):0===t.length?h.jsx("tr",{children:h.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"Nenhum usu√°rio encontrado"})}):t.map(e=>h.jsxs("tr",{className:"hover:bg-gray-50",children:[h.jsx("td",{className:"px-6 py-4",children:h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900",children:e.name||"Sem nome"}),h.jsx("p",{className:"text-sm text-gray-500",children:e.email})]})}),h.jsx("td",{className:"px-6 py-4",children:E(e.plan)}),h.jsx("td",{className:"px-6 py-4",children:T(e.planExpiresAt)}),h.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("pt-BR")}),h.jsx("td",{className:"px-6 py-4",children:h.jsx(ot,{onClick:()=>{m(e),g(!0)},size:"sm",variant:"outline",children:"Ativar Plano"})})]},e.id))})]})})}),f&&u&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[h.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:["Ativar Plano - ",u.email]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecionar Plano"}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("button",{onClick:()=>x("business"),className:"p-3 rounded-lg border-2 transition "+("business"===p?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(va,{className:"w-4 h-4 text-blue-600"}),h.jsx("span",{className:"font-medium text-gray-900",children:"Business"})]}),h.jsx("p",{className:"text-xs text-gray-500",children:"$20/m√™s ou $100/ano"})]}),h.jsxs("button",{onClick:()=>x("enterprise"),className:"p-3 rounded-lg border-2 transition "+("enterprise"===p?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"),children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx(Le,{className:"w-4 h-4 text-purple-600"}),h.jsx("span",{className:"font-medium text-gray-900",children:"Enterprise"})]}),h.jsx("p",{className:"text-xs text-gray-500",children:"$59/m√™s ou $200/ano"})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dura√ß√£o (dias)"}),h.jsx("div",{className:"grid grid-cols-4 gap-2",children:[30,90,180,365].map(e=>h.jsxs("button",{onClick:()=>v(e),className:"p-2 rounded-lg border-2 text-sm font-medium transition "+(b===e?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"),children:[e,"d"]},e))}),h.jsx(Ur,{type:"number",value:b,onChange:e=>v(parseInt(e.target.value)||30),className:"mt-2",placeholder:"Dias personalizados"})]}),h.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[h.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Resumo:"}),h.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Plano: ",h.jsx("span",{className:"text-blue-600",children:p})]}),h.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Expira em:"," ",h.jsx("span",{className:"text-blue-600",children:new Date(Date.now()+24*b*60*60*1e3).toLocaleDateString("pt-BR")})]})]})]}),h.jsxs("div",{className:"flex gap-3 mt-6",children:[h.jsx(ot,{onClick:()=>{g(!1),m(null)},variant:"outline",className:"flex-1",children:"Cancelar"}),h.jsx(ot,{onClick:()=>d(this,null,function*(){if(u){n(!0);try{const e=new Date;e.setDate(e.getDate()+b);(yield xs("/admin/activate-plan","POST",{userId:u.id,planId:p,expiresAt:e.toISOString()})).success&&(Ft.success(`Plano ${p} ativado com sucesso!`),g(!1),m(null),k())}catch(e){Ft.error(e.message||"Erro ao ativar plano")}finally{n(!1)}}}),disabled:s,className:"flex-1",children:s?"Ativando...":"Ativar Plano"})]})]})}),N&&h.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:h.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[h.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Configura√ß√µes de Notifica√ß√£o"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notifica√ß√µes de Upgrade"}),h.jsx(Ss,{checked:y.upgradeNotifications,onCheckedChange:e=>w(l(o({},y),{upgradeNotifications:e}))})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notifica√ß√µes de Novo Usu√°rio"}),h.jsx(Ss,{checked:y.newUserNotifications,onCheckedChange:e=>w(l(o({},y),{newUserNotifications:e}))})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notifica√ß√µes de Pagamento"}),h.jsx(Ss,{checked:y.paymentNotifications,onCheckedChange:e=>w(l(o({},y),{paymentNotifications:e}))})]})]}),h.jsxs("div",{className:"flex gap-3 mt-6",children:[h.jsx(ot,{onClick:()=>{j(!1)},variant:"outline",className:"flex-1",children:"Cancelar"}),h.jsx(ot,{onClick:()=>d(this,null,function*(){var e;n(!0);try{const e=yield xs("/admin/notification-settings","POST",y);e.success?(Ft.success("Configura√ß√µes de notifica√ß√£o salvas com sucesso!"),j(!1)):Ft.error(e.message||"Erro ao salvar configura√ß√µes de notifica√ß√£o")}catch(a){(null==(e=a.message)?void 0:e.includes("Backend indispon√≠vel"))?(Ft.success("Configura√ß√µes salvas (modo demo)"),j(!1)):Ft.error("Erro ao salvar configura√ß√µes de notifica√ß√£o: "+a.message)}finally{n(!1)}}),disabled:s,className:"flex-1",children:s?"Salvando...":"Salvar Configura√ß√µes"})]})]})})]})}function As(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx("textarea",o({"data-slot":"textarea",className:nt("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive bg-input-background dark:bg-gray-700 text-gray-900 dark:text-gray-100 flex field-sizing-content min-h-16 w-full rounded-md border px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t)},r))}function _s(e){var a=c(e,[]);return h.jsx(_,o({"data-slot":"select"},a))}function Rs(e){var a=c(e,[]);return h.jsx(I,o({"data-slot":"select-value"},a))}function Os(e){var a=e,{className:t,size:r="default",children:s}=a,n=c(a,["className","size","children"]);return h.jsxs(R,l(o({"data-slot":"select-trigger","data-size":r,className:nt("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t)},n),{children:[s,h.jsx(O,{asChild:!0,children:h.jsx(Ae,{className:"size-4 opacity-50"})})]}))}function Is(e){var a=e,{className:t,children:r,position:s="popper"}=a,n=c(a,["className","children","position"]);return h.jsx(M,{children:h.jsxs(P,l(o({"data-slot":"select-content",className:nt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:s},n),{children:[h.jsx(Ps,{}),h.jsx(L,{className:nt("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:r}),h.jsx(Ls,{})]}))})}function Ms(e){var a=e,{className:t,children:r}=a,s=c(a,["className","children"]);return h.jsxs(D,l(o({"data-slot":"select-item",className:nt("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t)},s),{children:[h.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:h.jsx(F,{children:h.jsx(Ce,{className:"size-4"})})}),h.jsx(z,{children:r})]}))}function Ps(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(B,l(o({"data-slot":"select-scroll-up-button",className:nt("flex cursor-default items-center justify-center py-1",t)},r),{children:h.jsx(Oe,{className:"size-4"})}))}function Ls(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(U,l(o({"data-slot":"select-scroll-down-button",className:nt("flex cursor-default items-center justify-center py-1",t)},r),{children:h.jsx(Ae,{className:"size-4"})}))}const Ds={saudacao:"Ol√° {nome}! üëã\n\nEspero que esteja bem! Somos da LeadsFlow e gostar√≠amos de conversar com voc√™.",promocao:"Ol√° {nome}! üéÅ\n\nTemos uma oferta especial esta semana!\n\nGostaria de conhecer os detalhes?",agradecimento:"Ol√° {nome}! üôè\n\nMuito obrigado pelo seu interesse! Estamos √† disposi√ß√£o para qualquer d√∫vida.",followup:"Ol√° {nome}! üìû\n\nEstou entrando em contato novamente para saber se teve a oportunidade de analisar nossa proposta.\n\nFico no aguardo!"};function Fs({onNovoLead:e,onEmailMarketing:a,onMassMessage:t,leads:r=[],userPlan:s="free",user:n,onUserUpdate:i}){const[c,u]=X.useState("whatsapp"),[m,f]=X.useState(""),[g,p]=X.useState(""),[x,b]=X.useState("3000"),[v,y]=X.useState([]),[w,N]=X.useState({sent:0,failed:0,remaining:0}),[j,k]=X.useState(""),[E,T]=X.useState(""),[S,C]=X.useState(!1),[A,_]=X.useState(0),[R,O]=X.useState(!1),[I,M]=X.useState(""),[P,L]=X.useState(""),[D,F]=X.useState(""),[z,B]=X.useState("");X.useEffect(()=>{const e=localStorage.getItem("n8n_webhook_url"),a=localStorage.getItem("evolution_api_key");e&&f(e),a&&k(a),U()},[]);const U=()=>d(this,null,function*(){try{const e=localStorage.getItem("leadflow_access_token");if(!e)return;const a=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/whatsapp/status`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});if(a.ok){const e=yield a.json();O(e.connected||!1),M(e.instanceName||""),e.instanceName&&localStorage.setItem("whatsapp_instance_name",e.instanceName)}}catch(e){}}),$=[{id:"whatsapp",name:"Campanhas WhatsApp",icon:da,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-50 dark:bg-green-900/20",borderColor:"border-green-200 dark:border-green-800",hoverBg:"hover:bg-green-50 dark:hover:bg-green-900/20"},{id:"email",name:"Campanhas Email",icon:ia,color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-900/20",borderColor:"border-purple-200 dark:border-purple-800",hoverBg:"hover:bg-purple-50 dark:hover:bg-purple-900/20"},{id:"automation",name:"Automa√ß√£o",icon:qa,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-900/20",borderColor:"border-blue-200 dark:border-blue-800",hoverBg:"hover:bg-blue-50 dark:hover:bg-blue-900/20"}];$.find(e=>e.id===c),"free"===s||null==n||n.subscription_plan;const W="business"===s||"business"===(null==n?void 0:n.subscription_plan),V="enterprise"===s||"enterprise"===(null==n?void 0:n.subscription_plan),H=W||V,[G,q]=X.useState(!1);X.useEffect(()=>{H||"whatsapp"!==c||q(!0)},[c,H]);const Y={free:{messages:50,massMessages:5},business:{messages:1e3,massMessages:1e3},enterprise:{messages:1/0,massMessages:1/0}},K=(null==n?void 0:n.subscription_plan)||s||"free",J=Y[K],Z=(null==n?void 0:n.usage)||{messages:0,massMessages:0},Q=e=>"enterprise"===K||Z.messages+e<=J.messages,ee=()=>"enterprise"===K||Z.massMessages+1<=J.massMessages,ae=(e,a=1)=>d(this,null,function*(){try{const t=localStorage.getItem("leadflow_access_token");if(!t)return!1;const r=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/usage/increment`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({type:e,quantity:a})});if(r.ok){const e=yield r.json();if(n&&e.usage){const a=l(o({},n),{usage:e.usage});i&&i(a),_(e=>e+1)}return!0}return!1}catch(t){return!1}});return h.jsxs("div",{className:"w-full max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h1",{className:"text-3xl font-semibold text-gray-900 dark:text-white mb-2",children:"Campanhas"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gerencie suas campanhas de marketing e automa√ß√µes"})]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8",children:$.map(e=>{const a=e.icon,t=c===e.id;return h.jsxs("button",{onClick:()=>u(e.id),className:"relative p-6 rounded-xl border-2 transition-all text-left group "+(t?`${e.borderColor} ${e.bgColor} shadow-md`:"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 hover:border-gray-300 dark:hover:border-gray-600 hover:shadow-sm"),children:[h.jsx("div",{className:"flex items-center gap-3 mb-3",children:h.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center transition-all ${t?e.bgColor:"bg-gray-100 dark:bg-gray-700 group-hover:bg-gray-200 dark:group-hover:bg-gray-600"}`,children:h.jsx(a,{className:`w-6 h-6 transition-colors ${t?e.color:"text-gray-500 dark:text-gray-400 group-hover:text-gray-700 dark:group-hover:text-gray-300"}`})})}),h.jsx("h3",{className:`font-semibold mb-1 transition-colors ${t?e.color:"text-gray-900 dark:text-white group-hover:text-gray-700 dark:group-hover:text-gray-200"}`,children:e.name}),h.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["whatsapp"===e.id&&"Envie mensagens via WhatsApp","email"===e.id&&"Campanhas de email marketing","automation"===e.id&&"Configure automa√ß√µes"]}),t&&h.jsx("div",{className:`absolute inset-0 rounded-xl ${e.bgColor} opacity-20 pointer-events-none`})]},e.id)})}),"whatsapp"===c&&h.jsxs(h.Fragment,{children:[!R&&h.jsx("div",{className:"mb-6 bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-300 dark:border-orange-700 rounded-xl p-6",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-orange-100 dark:bg-orange-900/40 rounded-full flex items-center justify-center flex-shrink-0",children:h.jsx(da,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-lg font-semibold text-orange-900 dark:text-orange-100 mb-2",children:"üì± Conecte seu WhatsApp primeiro"}),h.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-200 mb-3",children:"Para usar o envio em massa via N8N, voc√™ precisa conectar sua conta WhatsApp criando uma inst√¢ncia via QR Code."}),h.jsx("p",{className:"text-xs text-orange-700 dark:text-orange-300 mb-4",children:"A inst√¢ncia criada ser√° usada automaticamente para enviar as mensagens atrav√©s do N8N."}),h.jsxs(ot,{onClick:()=>{const e=new CustomEvent("navigate-to-integrations");window.dispatchEvent(e),Ft.info("V√° para Integra√ß√µes ‚Üí WhatsApp API e escaneie o QR Code")},className:"bg-orange-600 hover:bg-orange-700 text-white",children:[h.jsx(da,{className:"w-4 h-4 mr-2"}),"Ir para Integra√ß√µes"]})]})]})}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden relative",children:[h.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-b border-green-100 dark:border-green-800/50 px-6 py-5",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-14 h-14 bg-white dark:bg-gray-800 rounded-xl shadow-sm flex items-center justify-center border border-green-200 dark:border-green-700",children:h.jsx(da,{className:"w-7 h-7 text-green-600 dark:text-green-400"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Envio em Massa via N8N"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-0.5",children:"Conecte com seu workflow N8N para envio automatizado"})]})]})}),h.jsxs("div",{className:"p-6 space-y-8",children:[h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100/50 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-5 border border-blue-200 dark:border-blue-800",children:[h.jsx("div",{className:"flex items-center justify-between mb-3",children:h.jsx("div",{className:"w-10 h-10 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center shadow-sm",children:h.jsx(Ba,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})})}),h.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-100 font-medium mb-1",children:"Leads Selecionados"}),h.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:v.length})]}),h.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-100/50 dark:from-green-900/20 dark:to-emerald-800/20 rounded-xl p-5 border border-green-200 dark:border-green-800",children:[h.jsx("div",{className:"flex items-center justify-between mb-3",children:h.jsx("div",{className:"w-10 h-10 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center shadow-sm",children:h.jsx(Te,{className:"w-5 h-5 text-green-600 dark:text-green-400"})})}),h.jsx("p",{className:"text-sm text-green-900 dark:text-green-100 font-medium mb-1",children:"Enviadas"}),h.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:w.sent})]}),h.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-orange-100/50 dark:from-amber-900/20 dark:to-orange-800/20 rounded-xl p-5 border border-amber-200 dark:border-amber-800",children:[h.jsx("div",{className:"flex items-center justify-between mb-3",children:h.jsx("div",{className:"w-10 h-10 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center shadow-sm",children:h.jsx(qa,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})})}),h.jsx("p",{className:"text-sm text-amber-900 dark:text-amber-100 font-medium mb-1",children:"Envios em Massa"}),h.jsx("p",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400",children:"enterprise"===K?"‚àû":`${Z.massMessages}/${J.massMessages}`}),h.jsxs("p",{className:"text-xs text-amber-700 dark:text-amber-300 mt-1",children:["free"===K&&"Plano FREE","business"===K&&"Plano Business","enterprise"===K&&"Ilimitado"]})]},`mass-messages-${A}`)]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Ua,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),h.jsx(Hr,{htmlFor:"n8n-webhook-url",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"URL do Webhook N8N"})]}),h.jsx(Ur,{id:"n8n-webhook-url",value:m,onChange:e=>{f(e.target.value),localStorage.setItem("n8n_webhook_url",e.target.value)},placeholder:"https://seu-n8n.com/webhook/...",className:"h-11"}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-start gap-1.5",children:[h.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"‚ÑπÔ∏è"}),h.jsx("span",{children:"Cole a URL do webhook do seu workflow N8N para integra√ß√£o autom√°tica"})]})]}),h.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Ba,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),h.jsx(Hr,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Selecionar Leads"})]}),h.jsxs("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/30 px-3 py-1 rounded-full",children:[v.length," selecionados"]})]}),0===r.length?h.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-xl p-12 text-center",children:[h.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(Ba,{className:"w-8 h-8 text-gray-400"})}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 font-medium mb-1",children:"Nenhum lead cadastrado"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500",children:"Adicione leads ao CRM para enviar campanhas"})]}):h.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden",children:[h.jsx("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4",children:h.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[h.jsx("input",{type:"checkbox",id:"select-all",checked:v.length===r.length&&r.length>0,onChange:e=>{e.target.checked?(y([...r]),Ft.success(`${r.length} leads selecionados`)):(y([]),Ft.info("Sele√ß√£o limpa"))},className:"w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-2 focus:ring-green-500 focus:ring-offset-0 transition-all"}),h.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors",children:["Selecionar Todos (",r.length,")"]})]})}),h.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:h.jsx("div",{className:"p-3 space-y-2",children:r.map((e,a)=>{const t=v.some(a=>a.id===e.id||(a.telefone||a.phone)===(e.telefone||e.phone)),r=e.telefone||e.phone||"Sem telefone",s=e.nome||e.name||"Sem nome",n=e.email||"";return h.jsxs("div",{onClick:()=>{y(t?v.filter(a=>a.id!==e.id&&(a.telefone||a.phone)!==(e.telefone||e.phone)):[...v,e])},className:"flex items-center gap-3 p-4 rounded-lg border-2 transition-all cursor-pointer group "+(t?"bg-green-50 dark:bg-green-900/30 border-green-400 dark:border-green-600 shadow-sm":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:border-green-300 dark:hover:border-green-700 hover:shadow-sm"),children:[h.jsx("input",{type:"checkbox",checked:t,onChange:()=>{},className:"w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-2 focus:ring-green-500 focus:ring-offset-0"}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"font-semibold text-gray-900 dark:text-white truncate mb-1",children:s}),h.jsxs("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs",children:[h.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600 dark:text-gray-400",children:[h.jsx(ma,{className:"w-3.5 h-3.5"}),h.jsx("span",{children:r})]}),n&&h.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600 dark:text-gray-400",children:[h.jsx(we,{className:"w-3.5 h-3.5"}),h.jsx("span",{className:"truncate max-w-[200px]",children:n})]})]})]}),t&&h.jsx(Te,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0"})]},e.id||a)})})})]}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-start gap-1.5",children:[h.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"üí°"}),h.jsx("span",{children:'Clique nos leads para selecion√°-los individualmente ou use "Selecionar Todos"'})]})]}),h.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Sa,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),h.jsx(Hr,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Mensagem da Campanha"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"message-template",className:"text-sm text-gray-600 dark:text-gray-400 mb-2 block",children:"Templates Prontos"}),h.jsxs(_s,{onValueChange:e=>{p(Ds[e]||""),T(e)},value:E,children:[h.jsx(Os,{className:"h-11 bg-white dark:bg-gray-800",children:h.jsx(Rs,{placeholder:"üéØ Escolha um template ou crie sua mensagem"})}),h.jsxs(Is,{children:[h.jsx(Ms,{value:"saudacao",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{children:"üëã"}),h.jsx("span",{children:"Sauda√ß√£o"})]})}),h.jsx(Ms,{value:"promocao",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{children:"üéÅ"}),h.jsx("span",{children:"Promo√ß√£o"})]})}),h.jsx(Ms,{value:"agradecimento",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{children:"üôè"}),h.jsx("span",{children:"Agradecimento"})]})}),h.jsx(Ms,{value:"followup",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{children:"üìû"}),h.jsx("span",{children:"Follow-up"})]})})]})]})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"n8n-message",className:"text-sm text-gray-600 dark:text-gray-400 mb-2 block",children:"Texto da Mensagem"}),h.jsx(As,{id:"n8n-message",value:g,onChange:e=>p(e.target.value),placeholder:"Digite sua mensagem personalizada aqui...",className:"min-h-[180px] resize-none bg-white dark:bg-gray-800"}),h.jsxs("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[h.jsx("p",{className:"text-xs text-blue-900 dark:text-blue-100 font-medium mb-1.5",children:"üî§ Vari√°veis dispon√≠veis:"}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsx("code",{className:"px-2 py-1 bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 rounded text-xs font-mono border border-blue-200 dark:border-blue-700",children:"{nome}"}),h.jsx("code",{className:"px-2 py-1 bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 rounded text-xs font-mono border border-blue-200 dark:border-blue-700",children:"{email}"}),h.jsx("code",{className:"px-2 py-1 bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 rounded text-xs font-mono border border-blue-200 dark:border-blue-700",children:"{telefone}"})]})]})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"delay",className:"text-sm text-gray-600 dark:text-gray-400 mb-2 block",children:"Delay entre Mensagens (ms)"}),h.jsxs("div",{className:"relative",children:[h.jsx(Ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),h.jsx(Ur,{id:"delay",type:"number",value:x,onChange:e=>b(e.target.value),placeholder:"3000",className:"h-11 pl-10 bg-white dark:bg-gray-800"})]}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 flex items-start gap-1.5",children:[h.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"‚è±Ô∏è"}),h.jsx("span",{children:"Intervalo recomendado: 3000ms (3 segundos) para evitar bloqueios"})]})]})]}),h.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),"enterprise"!==K&&Z.massMessages>=.8*J.massMessages&&h.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-300 dark:border-orange-700 rounded-xl p-4",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900/40 rounded-full flex items-center justify-center flex-shrink-0",children:h.jsx(qa,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"font-semibold text-orange-900 dark:text-orange-100 mb-1",children:Z.massMessages>=J.massMessages?"‚ö†Ô∏è Limite Atingido!":"‚ö†Ô∏è Limite Pr√≥ximo!"}),h.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:[Z.massMessages>=J.massMessages?"Voc√™ atingiu o limite de envios em massa do seu plano.":`Voc√™ j√° usou ${Z.massMessages} de ${J.massMessages} envios em massa dispon√≠veis.`," ","Fa√ßa upgrade para continuar enviando campanhas."]}),h.jsxs(ot,{onClick:()=>{const e=new CustomEvent("open-upgrade-modal");window.dispatchEvent(e)},size:"sm",className:"mt-3 bg-orange-600 hover:bg-orange-700 text-white",children:[h.jsx(Le,{className:"w-4 h-4 mr-2"}),"Fazer Upgrade"]})]})]})}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs(ot,{onClick:()=>d(this,null,function*(){if(!R||!I)return void Ft.error("‚ùå Conecte seu WhatsApp primeiro!",{description:"V√° para Integra√ß√µes ‚Üí WhatsApp API e conecte sua conta via QR Code antes de enviar mensagens em massa.",duration:6e3});if(!m.trim())return void Ft.error("Digite a URL do webhook N8N");if(!g.trim())return void Ft.error("Digite ou selecione uma mensagem");if(0===v.length)return void Ft.error("Selecione pelo menos um lead");if(!ee()){Ft.error("Limite de mensagens em massa atingido para seu plano atual.",{description:`Voc√™ j√° usou ${Z.massMessages}/${J.massMessages} envios. Fa√ßa upgrade para continuar.`,duration:6e3});const e=new CustomEvent("open-upgrade-modal");return void window.dispatchEvent(e)}const e=Ft.loading(`Enviando para ${v.length} contatos...`);try{const a={instanceName:I,contatos:v.map(e=>({nome:e.nome||e.name,telefone:e.telefone||e.phone,mensagem:g.replace("{nome}",e.nome||e.name||"").replace("{email}",e.email||"").replace("{telefone}",e.telefone||e.phone||"")})),delay:parseInt(x)||3e3};j&&(a.apikey=j);const t=yield fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),mode:"cors"});if(Ft.dismiss(e),t.ok){yield t.json().catch(()=>({}));yield ae("massMessages"),Ft.success(`‚úÖ Mensagens enviadas para ${v.length} contatos via N8N!`),N({sent:w.sent+v.length,failed:0,remaining:0}),y([])}else{yield t.text().catch(()=>"Erro desconhecido");Ft.error(`Erro ${t.status}: Verifique seu webhook N8N`)}}catch(a){if(Ft.dismiss(e),"TypeError"===a.name&&a.message.includes("Failed to fetch")){Ft.error("üö´ Erro de CORS: O webhook N8N bloqueou a requisi√ß√£o. Copie o JSON abaixo e envie manualmente.",{duration:8e3});const e={instanceName:I,contatos:v.map(e=>({nome:e.nome||e.name,telefone:e.telefone||e.phone,mensagem:g.replace("{nome}",e.nome||e.name||"").replace("{email}",e.email||"").replace("{telefone}",e.telefone||e.phone||"")})),delay:parseInt(x)||3e3};j&&(e.apikey=j),navigator.clipboard.writeText(JSON.stringify(e,null,2)).then(()=>Ft.success("üìã JSON copiado! Cole no seu N8N.")).catch(()=>Ft.info("Veja o JSON no console do navegador (F12)"))}else Ft.error("Erro ao conectar com N8N. Verifique a URL e conex√£o.")}}),disabled:!m||!g||0===v.length,className:"w-full h-14 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-semibold text-base shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-lg",children:[h.jsx(Na,{className:"w-5 h-5 mr-2"}),v.length>0?`Enviar para ${v.length} ${1===v.length?"lead":"leads"} via N8N`:"Enviar via N8N"]}),!m&&h.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400",children:"‚ö†Ô∏è Configure a URL do webhook"}),m&&(!g||0===v.length)&&h.jsxs("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400",children:[!g&&"‚ö†Ô∏è Digite ou selecione uma mensagem",g&&0===v.length&&"‚ö†Ô∏è Selecione pelo menos um lead"]})]})]})]})]}),"email"===c&&h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[h.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border-b border-purple-100 dark:border-purple-800/50 px-6 py-5",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-14 h-14 bg-white dark:bg-gray-800 rounded-xl shadow-sm flex items-center justify-center border border-purple-200 dark:border-purple-700",children:h.jsx(ia,{className:"w-7 h-7 text-purple-600 dark:text-purple-400"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Nova Campanha de Email"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-0.5",children:"Crie e envie campanhas de email marketing"})]})]})}),h.jsxs("div",{className:"p-6 space-y-8",children:[h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100/50 dark:from-purple-900/20 dark:to-purple-800/20 rounded-xl p-5 border border-purple-200 dark:border-purple-800",children:[h.jsx("div",{className:"flex items-center justify-between mb-3",children:h.jsx("div",{className:"w-10 h-10 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center shadow-sm",children:h.jsx(Ba,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})})}),h.jsx("p",{className:"text-sm text-purple-900 dark:text-purple-100 font-medium mb-1",children:"Destinat√°rios"}),h.jsx("p",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:r.filter(e=>e.email).length}),h.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-300 mt-1",children:"Com email v√°lido"})]}),h.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-orange-100/50 dark:from-amber-900/20 dark:to-orange-800/20 rounded-xl p-5 border border-amber-200 dark:border-amber-800",children:[h.jsx("div",{className:"flex items-center justify-between mb-3",children:h.jsx("div",{className:"w-10 h-10 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center shadow-sm",children:h.jsx(ia,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})})}),h.jsx("p",{className:"text-sm text-amber-900 dark:text-amber-100 font-medium mb-1",children:"Mensagens Restantes"}),h.jsx("p",{className:"text-3xl font-bold text-amber-600 dark:text-amber-400",children:"enterprise"===K?"‚àû":""+(J.messages-Z.messages)}),h.jsxs("p",{className:"text-xs text-amber-700 dark:text-amber-300 mt-1",children:["free"===K&&`${Z.messages}/${J.messages} usadas`,"business"===K&&`${Z.messages}/${J.messages} usadas`,"enterprise"===K&&"Ilimitadas"]})]},`messages-${A}`),h.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100/50 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-5 border border-blue-200 dark:border-blue-800",children:[h.jsx("div",{className:"flex items-center justify-between mb-3",children:h.jsx("div",{className:"w-10 h-10 bg-white dark:bg-gray-800 rounded-lg flex items-center justify-center shadow-sm",children:h.jsx(Ua,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})})}),h.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-100 font-medium mb-1",children:"SMTP"}),h.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-2",children:"Configure nas Integra√ß√µes"})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Sa,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),h.jsx(Hr,{htmlFor:"email-campaign-name",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nome da Campanha"})]}),h.jsx(Ur,{id:"email-campaign-name",value:P,onChange:e=>L(e.target.value),placeholder:"Ex: Promo√ß√£o Black Friday 2024",className:"h-11 bg-white dark:bg-gray-800"}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-start gap-1.5",children:[h.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"‚ÑπÔ∏è"}),h.jsx("span",{children:"Nome interno para identificar sua campanha"})]})]}),h.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ia,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),h.jsx(Hr,{htmlFor:"email-subject",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Assunto do Email"})]}),h.jsx(Ur,{id:"email-subject",value:D,onChange:e=>F(e.target.value),placeholder:"Digite o assunto do email...",className:"h-11 bg-white dark:bg-gray-800"}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-start gap-1.5",children:[h.jsx("span",{className:"text-blue-600 dark:text-blue-400 mt-0.5",children:"üí°"}),h.jsx("span",{children:"Use assuntos claros e atrativos para aumentar a taxa de abertura"})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Sa,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),h.jsx(Hr,{htmlFor:"email-body",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Corpo do Email"})]}),h.jsx(As,{id:"email-body",value:z,onChange:e=>B(e.target.value),placeholder:"Digite o conte√∫do do email...",className:"min-h-[250px] resize-none bg-white dark:bg-gray-800"}),h.jsxs("div",{className:"mt-3 p-3 bg-purple-50 dark:bg-purple-900/20 border border-purple-200 dark:border-purple-800 rounded-lg",children:[h.jsx("p",{className:"text-xs text-purple-900 dark:text-purple-100 font-medium mb-1.5",children:"üî§ Vari√°veis dispon√≠veis:"}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsx("code",{className:"px-2 py-1 bg-white dark:bg-gray-800 text-purple-600 dark:text-purple-400 rounded text-xs font-mono border border-purple-200 dark:border-purple-700",children:"{nome}"}),h.jsx("code",{className:"px-2 py-1 bg-white dark:bg-gray-800 text-purple-600 dark:text-purple-400 rounded text-xs font-mono border border-purple-200 dark:border-purple-700",children:"{email}"})]}),h.jsx("p",{className:"text-xs text-purple-800 dark:text-purple-200 mt-2",children:"‚ú® Suporte a HTML para formata√ß√£o avan√ßada"})]})]}),h.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),"enterprise"!==K&&Z.messages>=.8*J.messages&&h.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-300 dark:border-orange-700 rounded-xl p-4",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-orange-100 dark:bg-orange-900/40 rounded-full flex items-center justify-center flex-shrink-0",children:h.jsx(ia,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"font-semibold text-orange-900 dark:text-orange-100 mb-1",children:Z.messages>=J.messages?"‚ö†Ô∏è Limite Atingido!":"‚ö†Ô∏è Limite Pr√≥ximo!"}),h.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200",children:[Z.messages>=J.messages?"Voc√™ atingiu o limite de mensagens do seu plano.":`Voc√™ j√° usou ${Z.messages} de ${J.messages} mensagens dispon√≠veis.`," ","Fa√ßa upgrade para continuar enviando emails."]}),h.jsxs(ot,{onClick:()=>{const e=new CustomEvent("open-upgrade-modal");window.dispatchEvent(e)},size:"sm",className:"mt-3 bg-orange-600 hover:bg-orange-700 text-white",children:[h.jsx(Le,{className:"w-4 h-4 mr-2"}),"Fazer Upgrade"]})]})]})}),h.jsxs("div",{children:[h.jsxs(ot,{onClick:()=>{if(!P.trim())return void Ft.error("Digite um nome para a campanha");if(!D.trim())return void Ft.error("Digite o assunto do email");if(!z.trim())return void Ft.error("Digite o conte√∫do do email");const e=r.filter(e=>e.email).length;if(!Q(e)){Ft.error("Limite de mensagens atingido para seu plano atual.",{description:`Voc√™ tentou enviar ${e} emails, mas s√≥ tem ${J.messages-Z.messages} mensagens dispon√≠veis. Fa√ßa upgrade para continuar.`,duration:6e3});const a=new CustomEvent("open-upgrade-modal");return void window.dispatchEvent(a)}a?(a(),ae("messages",e)):(Ft.success("Campanha de Email criada com sucesso!"),ae("messages",e))},disabled:!P||!D||!z,className:"w-full h-14 bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white font-semibold text-base shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-lg",children:[h.jsx(Na,{className:"w-5 h-5 mr-2"}),"Enviar Campanha de Email"]}),(!P||!D||!z)&&h.jsxs("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mt-3",children:[!P&&"‚ö†Ô∏è Digite o nome da campanha",P&&!D&&"‚ö†Ô∏è Digite o assunto do email",P&&D&&!z&&"‚ö†Ô∏è Digite o conte√∫do do email"]})]})]})]}),"automation"===c&&h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[h.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 border-b border-blue-100 dark:border-blue-800/50 px-6 py-5",children:h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:"w-14 h-14 bg-white dark:bg-gray-800 rounded-xl shadow-sm flex items-center justify-center border border-blue-200 dark:border-blue-700",children:h.jsx(qa,{className:"w-7 h-7 text-blue-600 dark:text-blue-400"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Automa√ß√µes"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-0.5",children:"Configure fluxos automatizados de comunica√ß√£o"})]})]})}),h.jsx("div",{className:"p-6",children:h.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 border-2 border-dashed border-blue-300 dark:border-blue-700 rounded-xl p-12 text-center",children:[h.jsx("div",{className:"w-20 h-20 bg-white dark:bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-6 shadow-sm",children:h.jsx(qa,{className:"w-10 h-10 text-blue-600 dark:text-blue-400"})}),h.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3",children:"Em Breve"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400 max-w-md mx-auto mb-6",children:"Estamos desenvolvendo recursos de automa√ß√£o avan√ßados para voc√™ criar fluxos inteligentes de nutri√ß√£o de leads."}),h.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-100 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 rounded-lg text-sm font-medium",children:[h.jsx(Ie,{className:"w-4 h-4"}),h.jsx("span",{children:"Funcionalidade em desenvolvimento"})]})]})})]}),"whatsapp"===c&&h.jsx("div",{className:"mt-6 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"w-8 h-8 bg-amber-100 dark:bg-amber-900/40 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5",children:h.jsx("span",{className:"text-lg",children:"üí°"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-amber-900 dark:text-amber-100 mb-1",children:"Como funciona?"}),h.jsxs("p",{className:"text-xs text-amber-800 dark:text-amber-200 leading-relaxed",children:["O sistema envia os dados dos leads selecionados para seu workflow N8N, incluindo automaticamente o",h.jsx("code",{className:"px-1.5 py-0.5 bg-amber-100 dark:bg-amber-900/40 rounded mx-1 font-mono",children:"instanceName"}),"e",h.jsx("code",{className:"px-1.5 py-0.5 bg-amber-100 dark:bg-amber-900/40 rounded mx-1 font-mono",children:"apikey"}),"da Evolution API. Configure seu workflow N8N para processar esses dados e enviar as mensagens via WhatsApp."]})]})]})}),h.jsx(Kr,{open:G,onOpenChange:q,children:h.jsxs(Qr,{className:"sm:max-w-md",children:[h.jsxs(es,{children:[h.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:h.jsx(Le,{className:"w-8 h-8 text-white"})}),h.jsx(ts,{className:"text-center text-2xl",children:"Recurso Premium"}),h.jsxs(rs,{className:"text-center pt-2",children:["O envio em massa via N8N est√° dispon√≠vel apenas nos planos ",h.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:"Business"})," e ",h.jsx("span",{className:"font-semibold text-purple-600 dark:text-purple-400",children:"Enterprise"}),"."]})]}),h.jsxs("div",{className:"space-y-4 py-4",children:[h.jsx("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400",children:"Fa√ßa upgrade para desbloquear automa√ß√µes avan√ßadas e envios em massa ilimitados."}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 border-2 border-blue-200 dark:border-blue-800 rounded-lg p-4 text-center",children:[h.jsx("p",{className:"font-bold text-blue-900 dark:text-blue-100 mb-1",children:"Business"}),h.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300 mb-2",children:"5 envios/m√™s"}),h.jsxs("p",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:["$20",h.jsx("span",{className:"text-sm",children:"/m√™s"})]})]}),h.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/30 border-2 border-purple-200 dark:border-purple-800 rounded-lg p-4 text-center",children:[h.jsx("p",{className:"font-bold text-purple-900 dark:text-purple-100 mb-1",children:"Enterprise"}),h.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-300 mb-2",children:"Ilimitado"}),h.jsxs("p",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:["$59",h.jsx("span",{className:"text-sm",children:"/m√™s"})]})]})]}),h.jsxs(ot,{onClick:()=>{q(!1);const e=new CustomEvent("open-upgrade-modal");window.dispatchEvent(e)},className:"w-full h-12 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold shadow-lg",children:[h.jsx(Le,{className:"w-5 h-5 mr-2"}),"Fazer Upgrade Agora"]})]})]})})]})}function zs({isOpen:e,onClose:a,onSave:t}){const[r,s]=X.useState({nome:"",email:"",telefone:"",interesse:"",origem:"",status:"novo",agente_atual:"",observacoes:""}),[n,i]=X.useState(!1),[c,u]=X.useState(!1),[m,f]=X.useState("");if(!e)return null;const g=e=>{const{name:a,value:t}=e.target;s(e=>l(o({},e),{[a]:t})),"telefone"===a&&p(t)},p=e=>{const a=e.replace(/[\s\-\(\)]/g,"");return a?a.length<10?(f("Telefone muito curto. Inclua o c√≥digo do pa√≠s."),!1):a.match(/^[+]?\d+$/)?a.startsWith("0")||a.length<11&&!a.startsWith("+")?(f("‚ö†Ô∏è Adicione o c√≥digo do pa√≠s (ex: 258 para Mo√ßambique)"),!1):(f(""),!0):(f("Use apenas n√∫meros e opcionalmente + no in√≠cio"),!1):(f(""),!1)},x=e=>d(this,null,function*(){if(e.preventDefault(),p(r.telefone)){i(!0),u(!1);try{const e=l(o({},r),{data:(new Date).toISOString().split("T")[0]});(yield t(e))&&(u(!0),setTimeout(()=>{b()},1500))}catch(a){}finally{i(!1)}}else f("‚ö†Ô∏è Telefone deve incluir c√≥digo do pa√≠s (ex: 258840000000 ou +258840000000)")}),b=()=>{s({nome:"",email:"",telefone:"",interesse:"",origem:"",status:"novo",agente_atual:"",observacoes:""}),u(!1),f(""),a()};return h.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-in zoom-in-95 duration-200",children:[h.jsxs("div",{className:"px-6 py-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800 z-10",children:[h.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"‚ûï Adicionar Novo Lead"}),h.jsx("button",{onClick:b,className:"w-9 h-9 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center justify-center transition-colors",children:h.jsx(Ha,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),h.jsxs("div",{className:"px-6 py-6",children:[c&&h.jsxs("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-lg text-green-700 dark:text-green-300 flex items-center gap-2",children:[h.jsx(Ce,{className:"w-5 h-5"}),h.jsx("span",{children:"Lead adicionado com sucesso! ‚úì"})]}),h.jsxs("form",{onSubmit:x,className:"space-y-5",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Nome Completo ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx("input",{type:"text",name:"nome",value:r.nome,onChange:g,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ex: Jo√£o Silva"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),h.jsx("input",{type:"email",name:"email",value:r.email,onChange:g,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"joao@email.com"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Telefone ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx("input",{type:"tel",name:"telefone",value:r.telefone,onChange:g,required:!0,className:"w-full px-4 py-2.5 border rounded-lg focus:outline-none focus:ring-2 transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white "+(m?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-transparent"),placeholder:"258840000000 ou +258840000000"}),m?h.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center gap-1",children:[h.jsx("span",{children:"‚ö†Ô∏è"}),h.jsx("span",{children:m})]}):h.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs mt-1",children:"üì± Obrigat√≥rio incluir c√≥digo do pa√≠s (ex: 258 para Mo√ßambique)"})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Interesse ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx("input",{type:"text",name:"interesse",value:r.interesse,onChange:g,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ex: M√°quina de corte a laser"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Origem ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsxs("select",{name:"origem",value:r.origem,onChange:g,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[h.jsx("option",{value:"",children:"Selecione..."}),h.jsx("option",{value:"whatsapp",children:"WhatsApp"}),h.jsx("option",{value:"facebook",children:"Facebook"}),h.jsx("option",{value:"instagram",children:"Instagram"}),h.jsx("option",{value:"site",children:"Site"}),h.jsx("option",{value:"indicacao",children:"Indica√ß√£o"}),h.jsx("option",{value:"outros",children:"Outros"})]})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Status ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsxs("select",{name:"status",value:r.status,onChange:g,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[h.jsx("option",{value:"novo",children:"Novo"}),h.jsx("option",{value:"qualificado",children:"Qualificado"}),h.jsx("option",{value:"em_negociacao",children:"Em Negocia√ß√£o"}),h.jsx("option",{value:"aguardando_resposta",children:"Aguardando Resposta"}),h.jsx("option",{value:"convertido",children:"Convertido"}),h.jsx("option",{value:"perdido",children:"Perdido"})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Agente Respons√°vel"}),h.jsx("input",{type:"text",name:"agente_atual",value:r.agente_atual,onChange:g,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ex: Maria Silva"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Observa√ß√µes"}),h.jsx("textarea",{name:"observacoes",value:r.observacoes,onChange:g,rows:4,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Adicione notas sobre este lead..."})]})]})]}),h.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end sticky bottom-0 bg-white dark:bg-gray-800",children:[h.jsx(ot,{type:"button",variant:"outline",onClick:b,disabled:n,children:"Cancelar"}),h.jsx(ot,{type:"submit",onClick:x,disabled:n,className:"bg-blue-600 hover:bg-blue-700 text-white",children:n?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Salvando..."]}):h.jsx(h.Fragment,{children:"üíæ Salvar Lead"})})]})]})})}function Bs({isOpen:e,lead:a,onClose:t,onSave:r}){const[s,n]=X.useState({id:"",nome:"",telefone:"",interesse:"",origem:"",status:"novo",agente_atual:"",observacoes:""}),[i,c]=X.useState(!1),[u,m]=X.useState(!1);if(X.useEffect(()=>{e&&a&&n(o({},a))},[e,a]),!e||!a)return null;const f=e=>{const{name:a,value:t}=e.target;n(e=>l(o({},e),{[a]:t}))},g=e=>d(this,null,function*(){e.preventDefault(),c(!0),m(!1);try{yield r(s),m(!0),setTimeout(()=>{p()},1500)}catch(a){}finally{c(!1)}}),p=()=>{n({id:"",nome:"",telefone:"",interesse:"",origem:"",status:"novo",agente_atual:"",observacoes:""}),m(!1),t()};return h.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-in zoom-in-95 duration-200",children:[h.jsxs("div",{className:"px-6 py-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800 z-10",children:[h.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"‚úèÔ∏è Editar Lead"}),h.jsx("button",{onClick:p,className:"w-9 h-9 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center justify-center transition-colors",children:h.jsx(Ha,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),h.jsxs("div",{className:"px-6 py-6",children:[u&&h.jsxs("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-lg text-green-700 dark:text-green-300 flex items-center gap-2",children:[h.jsx(Ce,{className:"w-5 h-5"}),h.jsx("span",{children:"Lead atualizado com sucesso! ‚úì"})]}),h.jsxs("form",{onSubmit:g,className:"space-y-5",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Nome Completo ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx("input",{type:"text",name:"nome",value:s.nome,onChange:f,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ex: Jo√£o Silva"})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Telefone ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx("input",{type:"tel",name:"telefone",value:s.telefone,onChange:f,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"258840000000"})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Interesse ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx("input",{type:"text",name:"interesse",value:s.interesse,onChange:f,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ex: M√°quina de corte a laser"})]}),h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Origem ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsxs("select",{name:"origem",value:s.origem,onChange:f,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[h.jsx("option",{value:"",children:"Selecione..."}),h.jsx("option",{value:"whatsapp",children:"WhatsApp"}),h.jsx("option",{value:"facebook",children:"Facebook"}),h.jsx("option",{value:"instagram",children:"Instagram"}),h.jsx("option",{value:"site",children:"Site"}),h.jsx("option",{value:"indicacao",children:"Indica√ß√£o"}),h.jsx("option",{value:"outros",children:"Outros"})]})]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsxs("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:["Status ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsxs("select",{name:"status",value:s.status,onChange:f,required:!0,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[h.jsx("option",{value:"novo",children:"Novo"}),h.jsx("option",{value:"qualificado",children:"Qualificado"}),h.jsx("option",{value:"em_negociacao",children:"Em Negocia√ß√£o"}),h.jsx("option",{value:"aguardando_resposta",children:"Aguardando Resposta"}),h.jsx("option",{value:"convertido",children:"Convertido"}),h.jsx("option",{value:"perdido",children:"Perdido"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Agente Respons√°vel"}),h.jsx("input",{type:"text",name:"agente_atual",value:s.agente_atual||"",onChange:f,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Ex: Maria Silva"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Observa√ß√µes"}),h.jsx("textarea",{name:"observacoes",value:s.observacoes||"",onChange:f,rows:4,className:"w-full px-4 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Adicione notas sobre este lead..."})]})]})]}),h.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end sticky bottom-0 bg-white dark:bg-gray-800",children:[h.jsx(ot,{type:"button",variant:"outline",onClick:p,disabled:i,children:"Cancelar"}),h.jsx(ot,{type:"submit",onClick:g,disabled:i,className:"bg-blue-600 hover:bg-blue-700 text-white",children:i?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Salvando..."]}):h.jsx(h.Fragment,{children:"üíæ Salvar Altera√ß√µes"})})]})]})})}function Us({isOpen:e,lead:a,onClose:t,webhookUrl:r}){const[s,n]=X.useState(""),[i,o]=X.useState([]),[l,c]=X.useState(!1),u=X.useRef(null);if(X.useEffect(()=>{e&&a&&o([])},[e,a]),X.useEffect(()=>{var e;null==(e=u.current)||e.scrollIntoView({behavior:"smooth"})},[i]),!e||!a)return null;const m=()=>d(this,null,function*(){if(!s.trim())return;if(!r||""===r.trim())return void alert("‚ö†Ô∏è Configure o webhook de envio de mensagens nas configura√ß√µes!");c(!0);const e={texto:s,tipo:"sent",hora:(new Date).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})};o(a=>[...a,e]),n("");try{const e=yield fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telefone:a.telefone,nome:a.nome,mensagem:s})});if(!e.ok)throw new Error("Erro ao enviar mensagem");{const a=yield e.json();a.resposta&&setTimeout(()=>{const e={texto:a.resposta,tipo:"received",hora:(new Date).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})};o(a=>[...a,e])},1e3)}}catch(t){alert("Erro ao enviar mensagem. Verifique se o webhook est√° configurado corretamente.")}finally{c(!1)}}),f=(a.nome||"?").charAt(0).toUpperCase();return h.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:h.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden shadow-2xl animate-in zoom-in-95 duration-200 flex flex-col",children:[h.jsxs("div",{className:"px-6 py-5 border-b border-gray-200 flex justify-between items-center bg-white",children:[h.jsx("h2",{className:"text-xl text-gray-900",children:"üí¨ Conversa WhatsApp"}),h.jsx("button",{onClick:t,className:"w-9 h-9 rounded-lg hover:bg-gray-100 flex items-center justify-center transition-colors",children:h.jsx(Ha,{className:"w-5 h-5 text-gray-500"})})]}),h.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[h.jsxs("div",{className:"bg-green-600 text-white px-4 py-3 flex items-center gap-3",children:[h.jsx("div",{className:"w-9 h-9 bg-white/20 rounded-full flex items-center justify-center",children:h.jsx("span",{className:"text-sm",children:f})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm truncate",children:a.nome||"Lead"}),h.jsxs("div",{className:"text-xs opacity-90",children:["+",a.telefone]})]})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto bg-[#e5ddd5] p-4 space-y-3",children:[0===i.length?h.jsx("div",{className:"text-center text-gray-600 py-8",children:h.jsx("p",{className:"text-sm",children:"Conversa iniciada"})}):i.map((e,a)=>h.jsx("div",{className:"flex "+("sent"===e.tipo?"justify-end":"justify-start"),children:h.jsxs("div",{className:"max-w-[70%] rounded-lg px-4 py-2 "+("sent"===e.tipo?"bg-[#dcf8c6] text-gray-900":"bg-white text-gray-900"),children:[h.jsx("div",{className:"text-sm whitespace-pre-wrap break-words",children:e.texto}),h.jsx("div",{className:"text-[11px] text-gray-600 mt-1 text-right",children:e.hora})]})},a)),h.jsx("div",{ref:u})]}),h.jsxs("div",{className:"bg-white border-t border-gray-200 p-3 flex gap-2",children:[h.jsx("input",{type:"text",value:s,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),m())},placeholder:"Digite uma mensagem...",disabled:l,className:"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent text-sm"}),h.jsx("button",{onClick:m,disabled:l||!s.trim(),className:"w-10 h-10 bg-green-600 hover:bg-green-700 text-white rounded-full flex items-center justify-center transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?h.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):h.jsx(Na,{className:"w-4 h-4"})})]})]})]})})}const $s={saudacao:"Ol√° {nome}! üëã\n\nEspero que esteja tudo bem! Sou da PersonalCreativeMZ e vi que voc√™ tem interesse em {interesse}.\n\nGostaria de saber mais sobre suas necessidades?",followup:"Oi {nome}! üòä\n\nEstou entrando em contato para dar continuidade ao seu interesse em {interesse}.\n\nPodemos conversar sobre como podemos ajudar?",promocao:"Ol√° {nome}! üéÅ\n\nTemos uma oferta especial para {interesse} esta semana!\n\nGostaria de conhecer os detalhes?",agradecimento:"Ol√° {nome}! üôè\n\nMuito obrigado pelo seu interesse em nossos servi√ßos!\n\nFico √† disposi√ß√£o para qualquer d√∫vida sobre {interesse}."};function Ws({isOpen:e,leads:a,onClose:t,webhookUrl:r,userPlan:s,onUpgrade:n}){const[i,o]=X.useState([]),[l,c]=X.useState(""),[u,m]=X.useState(""),[f,g]=X.useState(!1),[p,x]=X.useState(!1),[b,v]=X.useState(""),[y,w]=X.useState({enviados:0,falhas:0}),[N,j]=X.useState(!1),k=!s||"free"===s;if(X.useEffect(()=>{e&&(o([]),c(""),m(""),x(!1),v(""),w({enviados:0,falhas:0}))},[e]),X.useEffect(()=>{if(l&&i.length>0){const e=i[0],t=a[e],r=l.replace(/{nome}/g,(null==t?void 0:t.nome)||"[Nome do Lead]").replace(/{interesse}/g,(null==t?void 0:t.interesse)||"[Interesse do Lead]");m(r)}else if(l){const e=l.replace(/{nome}/g,"[Nome do Lead]").replace(/{interesse}/g,"[Interesse do Lead]");m(e)}else m("Digite uma mensagem para ver o preview...")},[l,i,a]),!e)return null;const E=e=>{c($s[e])};return h.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-in zoom-in-95 duration-200",children:[h.jsxs("div",{className:"px-6 py-5 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800 z-10",children:[h.jsx("h2",{className:"text-xl text-gray-900 dark:text-white",children:"üì§ Envio de Mensagens em Massa"}),h.jsx("button",{onClick:t,className:"w-9 h-9 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center justify-center transition-colors",children:h.jsx(Ha,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),k&&h.jsx("div",{className:"mx-6 mt-6 mb-0",children:h.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 border-2 border-amber-300 dark:border-amber-700 rounded-xl p-6 shadow-lg",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center flex-shrink-0 shadow-md",children:h.jsx(Le,{className:"w-7 h-7 text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:"üöÄ Recurso Premium - Envio em Massa"}),h.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-4",children:["O ",h.jsx("strong",{children:"Envio em Massa de Mensagens WhatsApp"})," est√° dispon√≠vel apenas nos planos ",h.jsx("strong",{children:"Business"})," e ",h.jsx("strong",{children:"Enterprise"}),"."]}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 mb-4 border border-amber-200 dark:border-amber-800",children:[h.jsx("p",{className:"text-sm text-gray-800 dark:text-gray-200 mb-2",children:h.jsx("strong",{children:"‚ú® Recursos inclusos:"})}),h.jsxs("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-1.5 ml-4",children:[h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(qa,{className:"w-4 h-4 text-amber-600 mt-0.5 flex-shrink-0"}),h.jsxs("span",{children:[h.jsx("strong",{children:"Business:"})," Envio em massa ilimitado + Webhook N8N"]})]}),h.jsxs("li",{className:"flex items-start gap-2",children:[h.jsx(va,{className:"w-4 h-4 text-purple-600 mt-0.5 flex-shrink-0"}),h.jsxs("span",{children:[h.jsx("strong",{children:"Enterprise:"})," Tudo do Business + Webhook N8N dedicado"]})]})]})]}),h.jsxs(ot,{onClick:()=>{n&&(t(),n())},className:"bg-gradient-to-r from-amber-500 to-orange-600 hover:from-amber-600 hover:to-orange-700 text-white shadow-md",children:[h.jsx(Le,{className:"w-4 h-4 mr-2"}),"Fazer Upgrade Agora"]})]})]})})}),h.jsxs("div",{className:"px-6 "+(k?"py-4 opacity-50 pointer-events-none":"py-6"),children:[p&&h.jsxs("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-lg text-green-700 dark:text-green-300 flex items-center gap-2",children:[h.jsx(Ce,{className:"w-5 h-5"}),h.jsxs("span",{children:["Processo conclu√≠do! ",y.enviados," mensagens processadas. ‚úì"]})]}),b&&h.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-lg text-red-700 dark:text-red-300",children:b}),h.jsxs("div",{className:"mb-6",children:[h.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-3",children:"üìã Selecione os Leads"}),h.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg mb-3",children:h.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[h.jsx("input",{type:"checkbox",checked:i.length===a.length,onChange:()=>{i.length===a.length?o([]):o(a.map((e,a)=>a))},className:"w-4 h-4 text-blue-600 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"}),h.jsx("strong",{className:"text-sm text-gray-900 dark:text-white",children:"Selecionar Todos"})]})}),h.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg max-h-48 overflow-y-auto p-2 bg-white dark:bg-gray-800",children:a.map((e,a)=>h.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg cursor-pointer transition-colors",children:[h.jsx("input",{type:"checkbox",checked:i.includes(a),onChange:()=>(e=>{o(a=>a.includes(e)?a.filter(a=>a!==e):[...a,e])})(a),className:"w-4 h-4 text-blue-600 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500"}),h.jsxs("div",{className:"flex-1 text-sm text-gray-900 dark:text-gray-200",children:[h.jsx("strong",{children:e.nome||"Sem nome"})," - ",e.telefone||"Sem telefone"," (",e.status||"Sem status",")"]})]},a))})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-3",children:"üìù Templates R√°pidos"}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsx("button",{onClick:()=>E("saudacao"),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-blue-600 hover:text-white hover:border-blue-600 transition-colors text-sm text-gray-700 dark:text-gray-300",children:"üëã Sauda√ß√£o"}),h.jsx("button",{onClick:()=>E("followup"),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-blue-600 hover:text-white hover:border-blue-600 transition-colors text-sm text-gray-700 dark:text-gray-300",children:"üìû Follow-up"}),h.jsx("button",{onClick:()=>E("promocao"),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-blue-600 hover:text-white hover:border-blue-600 transition-colors text-sm text-gray-700 dark:text-gray-300",children:"üéÅ Promo√ß√£o"}),h.jsx("button",{onClick:()=>E("agradecimento"),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-blue-600 hover:text-white hover:border-blue-600 transition-colors text-sm text-gray-700 dark:text-gray-300",children:"üôè Agradecimento"})]})]}),h.jsxs("div",{className:"mb-6",children:[h.jsx("label",{className:"block text-sm text-gray-700 dark:text-gray-300 mb-2",children:"üí¨ Mensagem"}),h.jsx("textarea",{value:l,onChange:e=>c(e.target.value),rows:6,className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Digite a mensagem que ser√° enviada para os leads selecionados...\n\nUse {nome} para personalizar com o nome do lead\nUse {interesse} para incluir o interesse do lead"}),h.jsxs("div",{className:"mt-3 bg-[#e5ddd5] dark:bg-gray-700 p-4 rounded-lg",children:[h.jsx("strong",{className:"text-sm text-gray-700 dark:text-gray-300 block mb-2",children:"Preview:"}),h.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 whitespace-pre-wrap",children:u})]})]}),h.jsxs("div",{className:"grid grid-cols-3 gap-4 bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg",children:[h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl text-blue-600 dark:text-blue-400",children:i.length}),h.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Leads Selecionados"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl text-green-600 dark:text-green-400",children:y.enviados}),h.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Enviados"})]}),h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"text-2xl text-red-600 dark:text-red-400",children:y.falhas}),h.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Falhas"})]})]})]}),h.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 justify-end sticky bottom-0 bg-white dark:bg-gray-800",children:[h.jsx(ot,{type:"button",variant:"outline",onClick:t,disabled:f,children:"Cancelar"}),h.jsx(ot,{onClick:k?void 0:()=>d(this,null,function*(){if(0===i.length)return void alert("‚ö†Ô∏è Selecione pelo menos um lead!");if(!l.trim())return void alert("‚ö†Ô∏è Digite uma mensagem!");if(!r||""===r.trim())return void alert("‚ö†Ô∏è Configure o webhook de envio em massa nas configura√ß√µes!");if(!confirm(`Confirma o envio de ${i.length} mensagens?`))return;g(!0),x(!1),v("");const e=i.map(e=>{const t=a[e],r=l.replace(/{nome}/g,t.nome||"Cliente").replace(/{interesse}/g,t.interesse||"nossos produtos");return{nome:t.nome,telefone:t.telefone,mensagem:r}});try{const a=yield fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leads:e,delay:3e3})});if(!a.ok)throw new Error("Erro no webhook");const n=yield a.json();w({enviados:void 0!==n.enviados?n.enviados:i.length,falhas:n.falhas||0});const o=void 0!==n.enviados?n.enviados:i.length;if(o>0)try{const e=localStorage.getItem("leadflow_access_token");yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/increment-whatsapp-mass-usage`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({messageCount:o})})}catch(s){}x(!0),setTimeout(()=>{t()},3e3)}catch(n){v("Erro ao processar envio em massa. Verifique se o webhook est√° configurado.")}finally{g(!1)}}),disabled:f||k,className:"bg-green-600 hover:bg-green-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:k?h.jsxs(h.Fragment,{children:[h.jsx(Le,{className:"w-4 h-4 mr-2"}),"Recurso Premium"]}):f?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Enviando..."]}):h.jsx(h.Fragment,{children:"üì§ Enviar Mensagens"})})]})]})})}const Vs={"business-monthly":"https://www.paypal.com/ncp/payment/MJFXSMAZY9VPS","business-annual":"https://www.paypal.com/ncp/payment/ADJF2GY82HDCW","enterprise-monthly":"https://www.paypal.com/ncp/payment/6XX4G2TKPCA6Y","enterprise-annual":"https://www.paypal.com/ncp/payment/ESX4B2DFC6AZL"};function Hs({planId:e}){const a=Vs[e];if(!a)return h.jsx("div",{className:"text-center text-red-500 text-sm p-4",children:"Link de pagamento n√£o configurado. Entre em contato com o suporte."});return h.jsxs(ot,{onClick:()=>{window.open(a,"_blank","noopener,noreferrer")},className:"w-full bg-[#0070ba] hover:bg-[#005a9c] text-white font-medium py-6 rounded-lg flex items-center justify-center gap-2 transition-all",children:[h.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:h.jsx("path",{d:"M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944.901C5.026.382 5.474 0 5.998 0h7.46c2.57 0 4.578.543 5.69 1.81 1.01 1.15 1.304 2.42 1.012 4.287-.023.143-.047.288-.077.437-.983 5.05-4.349 6.797-8.647 6.797h-2.19c-.524 0-.968.382-1.05.9l-1.12 7.106zm14.146-14.42a3.35 3.35 0 0 0-.607-.541c-.013.076-.026.175-.041.254-.93 4.778-4.005 7.201-9.138 7.201h-2.19a.563.563 0 0 0-.556.479l-1.187 7.527h-.506L9.18 14.311h1.248c4.57 0 7.266-2.292 8.032-6.828.018-.106.053-.31.086-.563.055-.062.116-.12.178-.18.117-.114.26-.217.46-.217z"})}),"Pagar com PayPal",h.jsx(Be,{className:"w-4 h-4"})]})}const Gs={business:{monthly:20,annual:100},enterprise:{monthly:59,annual:200}};function qs({isOpen:e,onClose:a,currentPlan:t,onUpgradeSuccess:r}){const[s,n]=X.useState([]),[i,o]=X.useState(!1),[l,c]=X.useState(null),[u,m]=X.useState("monthly"),[f,g]=X.useState(null);X.useEffect(()=>{e&&p()},[e]);const p=()=>d(this,null,function*(){try{const e=yield ws();e.success&&n(e.plans)}catch(e){}}),x=e=>d(this,null,function*(){if(e!==t)if("free"===e){o(!0),c(e);try{const t=yield Ns(e);t.success&&(Ft.success("Plano atualizado para Free!"),r(t.user),a())}catch(s){const e=s.message||"Erro ao atualizar plano. Tente novamente.";Ft.error(e)}finally{o(!1),c(null)}}else g(e)}),b=e=>d(this,null,function*(){o(!0);try{const t=yield xs("/paypal/activate-subscription","POST",{subscriptionId:e,planId:f,billingPeriod:u});t.success&&(Ft.success("Plano ativado com sucesso!"),r(t.user),a())}catch(t){Ft.error("Erro ao ativar assinatura. Entre em contato com o suporte.")}finally{o(!1)}}),v={free:{icon:qa,color:"text-gray-400",bg:"bg-gray-500/10"},business:{icon:va,color:"text-blue-400",bg:"bg-blue-500/10"},enterprise:{icon:Le,color:"text-purple-400",bg:"bg-purple-500/10"}};return e?h.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-y-auto p-4",children:[h.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm",onClick:a}),h.jsxs("div",{className:"w-full max-w-4xl mx-auto rounded-2xl bg-neutral-950 border border-neutral-800 relative z-10",children:[h.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-50 w-10 h-10 flex items-center justify-center rounded-full bg-neutral-900 hover:bg-neutral-800 border border-neutral-800 hover:border-neutral-700 transition-colors","aria-label":"Fechar modal",children:h.jsx(Ha,{className:"w-5 h-5 text-neutral-400"})}),h.jsxs("div",{className:"overflow-y-auto max-h-[90vh] pb-6",children:[h.jsxs("div",{className:"p-6 sm:p-8 pb-4",children:[h.jsx("h2",{className:"text-2xl font-semibold text-white text-center",children:"Choose Your Plan"}),h.jsx("p",{className:"text-neutral-400 text-center text-sm mt-2",children:"Select the plan that works for you"})]}),h.jsx("div",{className:"flex justify-center pb-6 px-4",children:h.jsxs("div",{className:"inline-flex gap-2 bg-neutral-900 p-1 rounded-lg border border-neutral-800",children:[h.jsx("button",{onClick:()=>m("monthly"),className:"px-6 py-2 text-sm font-medium rounded-md transition "+("monthly"===u?"bg-white text-black":"text-neutral-400 hover:text-white"),children:"Monthly"}),h.jsxs("button",{onClick:()=>m("annual"),className:"px-6 py-2 text-sm font-medium rounded-md transition relative "+("annual"===u?"bg-white text-black":"text-neutral-400 hover:text-white"),children:["Annual",h.jsx("span",{className:"absolute -top-1.5 -right-1.5 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-full",children:"-20%"})]})]})}),h.jsx("div",{className:"hidden sm:grid sm:grid-cols-3 gap-6 px-6 sm:px-8",children:s.map(e=>{var a;const r=e.id===t,s="business"===e.id,n=v[e.id],o=n.icon;return h.jsxs("div",{className:"relative bg-neutral-900 rounded-xl p-6 border border-neutral-800 hover:border-neutral-700 transition",children:[s&&h.jsx("div",{className:"absolute -top-2.5 left-1/2 -translate-x-1/2 bg-white text-black text-xs px-3 py-1 rounded-full font-medium",children:"Popular"}),r&&h.jsx("div",{className:"absolute top-3 right-3",children:h.jsx("span",{className:"bg-green-500/10 text-green-400 px-2 py-1 rounded-md text-xs border border-green-500/20",children:"Current"})}),h.jsx("div",{className:"flex justify-center mb-4",children:h.jsx("div",{className:`${n.bg} p-3 rounded-lg`,children:h.jsx(o,{className:`w-8 h-8 ${n.color}`})})}),h.jsx("h3",{className:"text-xl font-bold text-white text-center mb-1",children:e.name}),h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("div",{className:"text-3xl font-bold text-white",children:"free"===e.id?"$0":"annual"===u?`$${(null==(a=Gs[e.id])?void 0:a.annual)||0}`:`$${e.price}`}),h.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"annual"===u?"/year":"/month"})]}),f===e.id?h.jsxs("div",{className:"mb-6",children:[h.jsx(Hs,{planId:`${e.id}-${u}`,onSuccess:b,onError:()=>g(null)}),h.jsx("button",{onClick:()=>g(null),className:"w-full mt-2 text-xs text-neutral-500 hover:text-neutral-300 transition",children:"Voltar"})]}):h.jsx(ot,{onClick:()=>x(e.id),disabled:r||i,className:"w-full font-medium py-5 rounded-lg mb-6 transition "+(r?"bg-neutral-800 text-neutral-500 cursor-not-allowed":"bg-white text-black hover:bg-neutral-200"),children:i&&l===e.id?h.jsxs("span",{className:"flex items-center justify-center gap-2",children:[h.jsx(ta,{className:"w-4 h-4 animate-spin"}),"Loading..."]}):r?"Current Plan":"Select Plan"}),h.jsx("div",{className:"space-y-2 border-t border-neutral-800 pt-4",children:e.features.slice(0,5).map((e,a)=>h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(Ce,{className:"w-4 h-4 text-neutral-500 flex-shrink-0 mt-0.5"}),h.jsx("span",{className:"text-xs text-neutral-400 leading-relaxed",children:e})]},a))})]},e.id)})}),h.jsx("div",{className:"sm:hidden flex gap-4 overflow-x-auto snap-x snap-mandatory px-4 pb-4",children:s.map(e=>{var a;const r=e.id===t,s="business"===e.id,n=v[e.id],o=n.icon;return h.jsxs("div",{className:"snap-center min-w-[85%] relative bg-neutral-900 rounded-xl p-6 border border-neutral-800 flex-shrink-0",children:[s&&h.jsx("div",{className:"absolute -top-2.5 left-1/2 -translate-x-1/2 bg-white text-black text-xs px-3 py-1 rounded-full font-medium",children:"Popular"}),r&&h.jsx("div",{className:"absolute top-3 right-3",children:h.jsx("span",{className:"bg-green-500/10 text-green-400 px-2 py-1 rounded-md text-xs border border-green-500/20",children:"Current"})}),h.jsx("div",{className:"flex justify-center mb-4",children:h.jsx("div",{className:`${n.bg} p-3 rounded-lg`,children:h.jsx(o,{className:`w-8 h-8 ${n.color}`})})}),h.jsx("h3",{className:"text-xl font-bold text-white text-center mb-1",children:e.name}),h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("div",{className:"text-3xl font-bold text-white",children:"free"===e.id?"$0":"annual"===u?`$${(null==(a=Gs[e.id])?void 0:a.annual)||0}`:`$${e.price}`}),h.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"annual"===u?"/year":"/month"})]}),f===e.id?h.jsxs("div",{className:"mb-6",children:[h.jsx(Hs,{planId:`${e.id}-${u}`,onSuccess:b,onError:()=>g(null)}),h.jsx("button",{onClick:()=>g(null),className:"w-full mt-2 text-xs text-neutral-500 hover:text-neutral-300 transition",children:"Voltar"})]}):h.jsx(ot,{onClick:()=>x(e.id),disabled:r||i,className:"w-full font-medium py-5 rounded-lg mb-6 transition "+(r?"bg-neutral-800 text-neutral-500 cursor-not-allowed":"bg-white text-black hover:bg-neutral-200"),children:i&&l===e.id?h.jsxs("span",{className:"flex items-center justify-center gap-2",children:[h.jsx(ta,{className:"w-4 h-4 animate-spin"}),"Loading..."]}):r?"Current Plan":"Select Plan"}),h.jsx("div",{className:"space-y-2 border-t border-neutral-800 pt-4",children:e.features.slice(0,5).map((e,a)=>h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(Ce,{className:"w-4 h-4 text-neutral-500 flex-shrink-0 mt-0.5"}),h.jsx("span",{className:"text-xs text-neutral-400 leading-relaxed",children:e})]},a))})]},e.id)})}),h.jsx("div",{className:"mt-6 text-center border-t border-neutral-800 pt-6 px-4",children:h.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4 text-neutral-500 text-xs",children:[h.jsx("span",{children:"‚úì No hidden fees"}),h.jsx("span",{children:"‚úì Cancel anytime"}),h.jsx("span",{children:"‚úì Secure payments"})]})})]})]})]}):null}function Xs({isOpen:e,onClose:a,leadIds:t,leadNames:r,isMassMessage:s,onSuccess:n,userPlan:i}){const[o,l]=X.useState(""),[c,u]=X.useState(!1),[m,f]=X.useState(null),[g,p]=X.useState(!1),[x,b]=X.useState(null),[v,y]=X.useState(!1),[w,N]=X.useState("unknown"),[j,k]=X.useState(!1),E="enterprise"===i;X.useEffect(()=>{e&&T()},[e]);const T=()=>d(this,null,function*(){y(!0);try{const e=localStorage.getItem("leadflow_access_token"),a=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/whatsapp/status`,{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}),t=yield a.json();t.success&&!0===t.connected?(N("connected"),f(null)):(N("disconnected"),"disconnected"===t.status||"no connection"===t.status?f("WhatsApp n√£o conectado. V√° em Configura√ß√µes > Integra√ß√µes para escanear o QR Code e conectar sua conta WhatsApp."):"pending"===t.status?f("WhatsApp em processo de conex√£o. Aguarde alguns segundos e tente novamente."):f("WhatsApp n√£o est√° conectado. V√° em Configura√ß√µes > Integra√ß√µes para conectar."))}catch(e){N("disconnected"),f("Erro ao verificar conex√£o do WhatsApp. Verifique se voc√™ j√° conectou sua conta WhatsApp nas Configura√ß√µes.")}finally{y(!1)}}),S=()=>d(this,null,function*(){const e=localStorage.getItem("n8n_mass_webhook_url");if(!e)throw new Error("Configure o webhook N8N nas Configura√ß√µes > Integra√ß√µes primeiro!");const a=localStorage.getItem("leadflow_access_token"),r=[];for(const n of t)try{const e=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/leads/${n}`,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(e.ok){const a=yield e.json();(a.telefone||a.phone)&&r.push({id:a.id,name:a.nome||a.name,phone:a.telefone||a.phone,email:a.email})}}catch(l){}if(0===r.length)throw new Error("Nenhum lead com telefone v√°lido encontrado");const s=yield fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leads:r,message:o.trim(),timestamp:(new Date).toISOString(),source:"LeadsFlow CRM"})});if(!s.ok)throw new Error(`Erro ao enviar para N8N: ${s.statusText}`);const i=yield s.json();p(!0),b({total:r.length,successful:i.sent||r.length,failed:i.failed||0}),Ft.success(`Envio em massa via N8N iniciado! ${r.length} mensagens ser√£o processadas.`),setTimeout(()=>{C(),n&&n()},2e3)}),C=()=>{l(""),f(null),p(!1),b(null),a()};return h.jsx(Kr,{open:e,onOpenChange:C,children:h.jsxs(Qr,{className:"sm:max-w-lg",children:[h.jsxs(es,{children:[h.jsxs(ts,{className:"flex items-center gap-2",children:[h.jsx(da,{className:"w-5 h-5"}),s?"Enviar Mensagem em Massa":"Enviar Mensagem"]}),h.jsx(rs,{children:s?`Enviar mensagem para ${t.length} lead${t.length>1?"s":""}`:`Enviar mensagem para ${r[0]}`})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"rounded-lg border bg-gray-50 dark:bg-gray-800 p-3",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("div",{className:"flex items-center gap-2",children:"connected"===w?h.jsxs(h.Fragment,{children:[h.jsx(Wa,{className:"w-4 h-4 text-green-600"}),h.jsx("span",{className:"text-sm text-green-600 dark:text-green-400",children:"‚úÖ WhatsApp Conectado"})]}):"disconnected"===w?h.jsxs(h.Fragment,{children:[h.jsx($a,{className:"w-4 h-4 text-red-600"}),h.jsx("span",{className:"text-sm text-red-600 dark:text-red-400",children:"‚ùå WhatsApp Desconectado"})]}):h.jsxs(h.Fragment,{children:[h.jsx(be,{className:"w-4 h-4 text-gray-600"}),h.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"‚è≥ Verificando..."})]})}),h.jsx(ot,{variant:"outline",size:"sm",onClick:T,disabled:v,children:v?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-3 h-3 mr-1 animate-spin"}),"Verificando..."]}):"Verificar Conex√£o"})]}),"disconnected"===w&&h.jsxs("div",{className:"mt-3 p-3 bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-800 rounded-md",children:[h.jsxs("p",{className:"text-xs text-amber-800 dark:text-amber-200 mb-2",children:[h.jsx("strong",{children:"‚ö†Ô∏è Aten√ß√£o:"})," Seu WhatsApp n√£o est√° conectado!"]}),h.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:h.jsx("strong",{children:"Como conectar:"})}),h.jsxs("ol",{className:"text-xs text-amber-700 dark:text-amber-300 ml-4 mt-1 space-y-1",children:[h.jsxs("li",{children:["1. Clique no √≠cone de ",h.jsx("strong",{children:"Configura√ß√µes"})," (‚öôÔ∏è) no topo do Dashboard"]}),h.jsxs("li",{children:["2. V√° at√© a aba ",h.jsx("strong",{children:"Integra√ß√µes"})]}),h.jsxs("li",{children:["3. Clique em ",h.jsx("strong",{children:'"Conectar WhatsApp"'})]}),h.jsxs("li",{children:["4. Escaneie o ",h.jsx("strong",{children:"QR Code"})," com seu WhatsApp"]})]})]})]}),s&&E&&h.jsxs(ns,{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-950/20 dark:to-blue-950/20 border-purple-200 dark:border-purple-800",children:[h.jsx(va,{className:"h-4 w-4 text-purple-600"}),h.jsxs(is,{children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1",children:[h.jsxs("p",{className:"text-sm text-purple-900 dark:text-purple-100 mb-1 flex items-center gap-2",children:[h.jsx("strong",{children:"üöÄ Envio via Webhook N8N"}),h.jsx(Le,{className:"w-4 h-4 text-amber-500"})]}),h.jsx("p",{className:"text-xs text-purple-800 dark:text-purple-200",children:"Ative para enviar dados para seu workflow N8N automatizar o envio via Evolution API"})]}),h.jsx(Ss,{checked:j,onCheckedChange:k,disabled:c||g})]}),j&&h.jsxs("div",{className:"mt-3 p-3 bg-blue-100 dark:bg-blue-900/20 rounded-md",children:[h.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100 flex items-center gap-1",children:[h.jsx(Je,{className:"w-3 h-3"}),h.jsx("strong",{children:"Como funciona:"})]}),h.jsxs("ul",{className:"text-xs text-blue-800 dark:text-blue-200 ml-4 mt-1 space-y-1",children:[h.jsx("li",{children:"‚Ä¢ Dados dos leads ser√£o enviados para seu webhook N8N"}),h.jsx("li",{children:"‚Ä¢ Seu workflow N8N processa e envia via Evolution API"}),h.jsx("li",{children:"‚Ä¢ Usa a inst√¢ncia WhatsApp conectada via QR Code"}),h.jsx("li",{children:"‚Ä¢ Configure o webhook em Configura√ß√µes ‚Üí Integra√ß√µes"})]})]})]})]}),s&&r.length>0&&h.jsxs("div",{className:"rounded-lg border bg-muted/50 p-3",children:[h.jsx("p",{className:"text-sm mb-2",children:"Destinat√°rios:"}),h.jsxs("div",{className:"text-sm text-muted-foreground max-h-24 overflow-y-auto",children:[r.slice(0,5).map((e,a)=>h.jsxs("div",{children:["‚Ä¢ ",e]},a)),r.length>5&&h.jsxs("div",{className:"text-xs mt-1",children:["+ ",r.length-5," mais..."]})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Hr,{htmlFor:"message",children:"Mensagem"}),h.jsx(As,{id:"message",placeholder:"Digite sua mensagem aqui...",value:o,onChange:e=>l(e.target.value),rows:6,disabled:c||g}),h.jsxs("p",{className:"text-xs text-muted-foreground",children:[o.length," caracteres"]})]}),m&&h.jsxs(ns,{variant:"destructive",children:[h.jsx(be,{className:"h-4 w-4"}),h.jsx(is,{children:h.jsxs("div",{className:"space-y-1",children:[h.jsx("p",{children:m}),m.includes("n√£o est√° registrado no WhatsApp")&&h.jsx("p",{className:"text-xs mt-2",children:'üí° Dica: Verifique se o n√∫mero do lead est√° correto e possui WhatsApp ativo. V√° em "Editar Lead" para corrigir o telefone.'})]})})]}),g&&h.jsxs(ns,{className:"border-green-200 bg-green-50 dark:bg-green-950/20 dark:border-green-900",children:[h.jsx(Ee,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),h.jsx(is,{className:"text-green-900 dark:text-green-100",children:s&&x?h.jsxs("div",{children:[h.jsx("p",{className:"font-medium mb-1",children:"Mensagens enviadas!"}),h.jsxs("p",{className:"text-sm",children:["‚úì ",x.successful||x.sent||0," enviadas com sucesso",x.failed>0&&h.jsxs(h.Fragment,{children:[" ‚Ä¢ ‚úó ",x.failed," falharam"]})]})]}):"Mensagem enviada com sucesso!"})]}),s&&t.length>10&&!c&&!g&&h.jsxs(ns,{children:[h.jsx(be,{className:"h-4 w-4"}),h.jsx(is,{className:"text-xs",children:"O envio em massa pode demorar alguns minutos. As mensagens s√£o enviadas com intervalo de 1-2 segundos entre cada uma para evitar bloqueio."})]}),h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx(ot,{variant:"outline",onClick:C,disabled:c,children:"Cancelar"}),h.jsx(ot,{onClick:()=>d(this,null,function*(){if(o.trim()){u(!0),f(null),p(!1);try{if(s&&j)yield S();else if(s){const e=yield xs("/whatsapp/send-mass","POST",{leadIds:t,message:o.trim()});if(!e.success)throw new Error(e.error||"Erro ao enviar mensagens");p(!0),b(e.summary),Ft.success(`Mensagem enviada para ${e.summary.successful} de ${e.summary.total} leads!`),setTimeout(()=>{C(),n&&n()},2e3)}else{const e=yield xs(`/leads/${t[0]}`,"GET"),a=e.telefone||e.phone;if(!e||!a)throw new Error("Lead n√£o encontrado ou sem telefone cadastrado");const r=yield xs("/whatsapp/send","POST",{phone:a,message:o.trim(),leadId:t[0]});if(!r.success)throw new Error(r.error||"Erro ao enviar mensagem");p(!0),Ft.success("Mensagem enviada com sucesso!"),setTimeout(()=>{C(),n&&n()},1e3)}}catch(e){const a=e.message||e.error||"Erro ao enviar mensagem";f(a),a.includes("WhatsApp not connected")||a.includes("WhatsApp n√£o conectado")?(f("WhatsApp n√£o conectado! V√° em Configura√ß√µes > Integra√ß√µes para conectar seu WhatsApp escaneando o QR Code."),Ft.error("WhatsApp n√£o conectado! Configure nas Integra√ß√µes.")):a.includes("limit reached")||a.includes("limit")?(f("Limite de mensagens atingido! Fa√ßa upgrade do seu plano."),Ft.error("Limite de mensagens atingido! Fa√ßa upgrade do seu plano.")):a.includes("n√£o est√° registrado no WhatsApp")||a.includes("not registered")?Ft.error("Este n√∫mero n√£o est√° registrado no WhatsApp. Verifique o telefone do lead."):Ft.error(a)}finally{u(!1)}}else f("Por favor, digite uma mensagem")}),disabled:c||g||!o.trim()||"connected"!==w,className:"bg-green-600 hover:bg-green-700 text-white",children:c?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 mr-2 animate-spin"}),"Enviando..."]}):g?h.jsxs(h.Fragment,{children:[h.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Enviado!"]}):h.jsxs(h.Fragment,{children:[h.jsx(Na,{className:"w-4 h-4 mr-2"}),"Enviar ",s&&`(${t.length})`]})})]}),"disconnected"===w&&h.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"üí° O bot√£o de envio ser√° habilitado ap√≥s conectar o WhatsApp"})]})]})})}
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ys=1252,Ks=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Js={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Zs=function(e){-1!=Ks.indexOf(e)&&(Ys=Js[0]=e)};var Qs=function(e){Zs(e)};function en(){Qs(1200),Zs(1252)}function an(e){for(var a=[],t=0,r=e.length;t<r;++t)a[t]=e.charCodeAt(t);return a}function tn(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return a.join("")}var rn,sn=function(e){var a=e.charCodeAt(0),t=e.charCodeAt(1);return 255==a&&254==t?function(e){for(var a=[],t=0;t<e.length>>1;++t)a[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return a.join("")}(e.slice(2)):254==a&&255==t?tn(e.slice(2)):65279==a?e.slice(1):e},nn=function(e){return String.fromCharCode(e)},on=function(e){return String.fromCharCode(e)},ln="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cn(e){for(var a="",t=0,r=0,s=0,n=0,i=0,o=0,l=0,c=0;c<e.length;)n=(t=e.charCodeAt(c++))>>2,i=(3&t)<<4|(r=e.charCodeAt(c++))>>4,o=(15&r)<<2|(s=e.charCodeAt(c++))>>6,l=63&s,isNaN(r)?o=l=64:isNaN(s)&&(l=64),a+=ln.charAt(n)+ln.charAt(i)+ln.charAt(o)+ln.charAt(l);return a}function dn(e){var a="",t=0,r=0,s=0,n=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)t=ln.indexOf(e.charAt(l++))<<2|(n=ln.indexOf(e.charAt(l++)))>>4,a+=String.fromCharCode(t),r=(15&n)<<4|(i=ln.indexOf(e.charAt(l++)))>>2,64!==i&&(a+=String.fromCharCode(r)),s=(3&i)<<6|(o=ln.indexOf(e.charAt(l++))),64!==o&&(a+=String.fromCharCode(s));return a}var hn=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),un=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(a){e=!0}return e?function(e,a){return a?new Buffer(e,a):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function mn(e){return hn?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function fn(e){return hn?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var gn=function(e){return hn?un(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function pn(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var a=[],t=0;t<e.length;++t)a[t]=String.fromCharCode(e[t]);return a.join("")}function xn(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return xn(new Uint8Array(e));for(var a=new Array(e.length),t=0;t<e.length;++t)a[t]=e[t];return a}var bn=hn?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:un(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var a=0,t=0;for(a=0;a<e.length;++a)t+=e[a].length;var r=new Uint8Array(t),s=0;for(a=0,t=0;a<e.length;t+=s,++a)if(s=e[a].length,e[a]instanceof Uint8Array)r.set(e[a],t);else{if("string"==typeof e[a])throw"wtf";r.set(new Uint8Array(e[a]),t)}return r}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var vn=/\u0000/g,yn=/[\u0001-\u0006]/g;function wn(e){for(var a="",t=e.length-1;t>=0;)a+=e.charAt(t--);return a}function Nn(e,a){var t=""+e;return t.length>=a?t:_i("0",a-t.length)+t}function jn(e,a){var t=""+e;return t.length>=a?t:_i(" ",a-t.length)+t}function kn(e,a){var t=""+e;return t.length>=a?t:t+_i(" ",a-t.length)}var En=Math.pow(2,32);function Tn(e,a){return e>En||e<-En?function(e,a){var t=""+Math.round(e);return t.length>=a?t:_i("0",a-t.length)+t}(e,a):function(e,a){var t=""+e;return t.length>=a?t:_i("0",a-t.length)+t}(Math.round(e),a)}function Sn(e,a){return a=a||0,e.length>=7+a&&103==(32|e.charCodeAt(a))&&101==(32|e.charCodeAt(a+1))&&110==(32|e.charCodeAt(a+2))&&101==(32|e.charCodeAt(a+3))&&114==(32|e.charCodeAt(a+4))&&97==(32|e.charCodeAt(a+5))&&108==(32|e.charCodeAt(a+6))}var Cn=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],An=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var _n={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "'},Rn={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},On={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function In(e,a,t){for(var r=e<0?-1:1,s=e*r,n=0,i=1,o=0,l=1,c=0,d=0,h=Math.floor(s);c<a&&(o=(h=Math.floor(s))*i+n,d=h*c+l,!(s-h<5e-8));)s=1/(s-h),n=i,i=o,l=c,c=d;if(d>a&&(c>a?(d=l,o=n):(d=c,o=i)),!t)return[0,r*o,d];var u=Math.floor(r*o/d);return[u,r*o-u*d,d]}function Mn(e,a,t){if(e>2958465||e<0)return null;var r=0|e,s=Math.floor(86400*(e-r)),n=0,i=[],o={D:r,T:s,u:86400*(e-r)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),a&&a.date1904&&(r+=1462),o.u>.9999&&(o.u=0,86400==++s&&(o.T=s=0,++r,++o.D)),60===r)i=t?[1317,10,29]:[1900,2,29],n=3;else if(0===r)i=t?[1317,8,29]:[1900,1,0],n=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),r<60&&(n=(n+6)%7),t&&(n=function(e,a){a[0]-=581;var t=e.getDay();e<60&&(t=(t+6)%7);return t}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=n,o}var Pn=new Date(1899,11,31,0,0,0),Ln=Pn.getTime(),Dn=new Date(1900,2,1,0,0,0);function Fn(e,a){var t=e.getTime();return a?t-=1262304e5:e>=Dn&&(t+=864e5),(t-(Ln+6e4*(e.getTimezoneOffset()-Pn.getTimezoneOffset())))/864e5}function zn(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Bn(e){var a,t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return a=t>=-4&&t<=-1?e.toPrecision(10+t):Math.abs(t)<=9?function(e){var a=e<0?12:11,t=zn(e.toFixed(12));return t.length<=a||(t=e.toPrecision(10)).length<=a?t:e.toExponential(5)}(e):10===t?e.toFixed(10).substr(0,12):function(e){var a=zn(e.toFixed(11));return a.length>(e<0?12:11)||"0"===a||"-0"===a?e.toPrecision(6):a}(e),zn(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(a.toUpperCase()))}function Un(e,a){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Bn(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return li(14,Fn(e,a&&a.date1904),a)}throw new Error("unsupported value in General format: "+e)}function $n(e,a,t,r){var s,n="",i=0,o=0,l=t.y,c=0;switch(e){case 98:l=t.y+543;case 121:switch(a.length){case 1:case 2:s=l%100,c=2;break;default:s=l%1e4,c=4}break;case 109:switch(a.length){case 1:case 2:s=t.m,c=a.length;break;case 3:return An[t.m-1][1];case 5:return An[t.m-1][0];default:return An[t.m-1][2]}break;case 100:switch(a.length){case 1:case 2:s=t.d,c=a.length;break;case 3:return Cn[t.q][0];default:return Cn[t.q][1]}break;case 104:switch(a.length){case 1:case 2:s=1+(t.H+11)%12,c=a.length;break;default:throw"bad hour format: "+a}break;case 72:switch(a.length){case 1:case 2:s=t.H,c=a.length;break;default:throw"bad hour format: "+a}break;case 77:switch(a.length){case 1:case 2:s=t.M,c=a.length;break;default:throw"bad minute format: "+a}break;case 115:if("s"!=a&&"ss"!=a&&".0"!=a&&".00"!=a&&".000"!=a)throw"bad second format: "+a;return 0!==t.u||"s"!=a&&"ss"!=a?(o=r>=2?3===r?1e3:100:1===r?10:1,(i=Math.round(o*(t.S+t.u)))>=60*o&&(i=0),"s"===a?0===i?"0":""+i/o:(n=Nn(i,2+r),"ss"===a?n.substr(0,2):"."+n.substr(2,a.length-1))):Nn(t.S,a.length);case 90:switch(a){case"[h]":case"[hh]":s=24*t.D+t.H;break;case"[m]":case"[mm]":s=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":s=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+a}c=3===a.length?1:2;break;case 101:s=l,c=1}return c>0?Nn(s,c):""}function Wn(e){if(e.length<=3)return e;for(var a=e.length%3,t=e.substr(0,a);a!=e.length;a+=3)t+=(t.length>0?",":"")+e.substr(a,3);return t}var Vn=/%/g;function Hn(e,a){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==a)return"0.0E+0";if(a<0)return"-"+Hn(e,-a);var s=e.indexOf(".");-1===s&&(s=e.indexOf("E"));var n=Math.floor(Math.log(a)*Math.LOG10E)%s;if(n<0&&(n+=s),-1===(t=(a/Math.pow(10,n)).toPrecision(r+1+(s+n)%s)).indexOf("e")){var i=Math.floor(Math.log(a)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+n):t+="E+"+(i-n);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,a,t,r){return a+t+r.substr(0,(s+n)%s)+"."+r.substr(n)+"E"})}else t=a.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Gn=/# (\?+)( ?)\/( ?)(\d+)/;var qn=/^#*0*\.([0#]+)/,Xn=/\).*[0#]/,Yn=/\(###\) ###\\?-####/;function Kn(e){for(var a,t="",r=0;r!=e.length;++r)switch(a=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(a)}return t}function Jn(e,a){var t=Math.pow(10,a);return""+Math.round(e*t)/t}function Zn(e,a){var t=e-Math.floor(e),r=Math.pow(10,a);return a<(""+Math.round(t*r)).length?0:Math.round(t*r)}function Qn(e,a,t){if(40===e.charCodeAt(0)&&!a.match(Xn)){var r=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Qn("n",r,t):"("+Qn("n",r,-t)+")"}if(44===a.charCodeAt(a.length-1))return function(e,a,t){for(var r=a.length-1;44===a.charCodeAt(r-1);)--r;return ti(e,a.substr(0,r),t/Math.pow(10,3*(a.length-r)))}(e,a,t);if(-1!==a.indexOf("%"))return function(e,a,t){var r=a.replace(Vn,""),s=a.length-r.length;return ti(e,r,t*Math.pow(10,2*s))+_i("%",s)}(e,a,t);if(-1!==a.indexOf("E"))return Hn(a,t);if(36===a.charCodeAt(0))return"$"+Qn(e,a.substr(" "==a.charAt(1)?2:1),t);var s,n,i,o,l=Math.abs(t),c=t<0?"-":"";if(a.match(/^00+$/))return c+Tn(l,a.length);if(a.match(/^[#?]+$/))return"0"===(s=Tn(t,0))&&(s=""),s.length>a.length?s:Kn(a.substr(0,a.length-s.length))+s;if(n=a.match(Gn))return function(e,a,t){var r=parseInt(e[4],10),s=Math.round(a*r),n=Math.floor(s/r),i=s-n*r,o=r;return t+(0===n?"":""+n)+" "+(0===i?_i(" ",e[1].length+1+e[4].length):jn(i,e[1].length)+e[2]+"/"+e[3]+Nn(o,e[4].length))}(n,l,c);if(a.match(/^#+0+$/))return c+Tn(l,a.length-a.indexOf("0"));if(n=a.match(qn))return s=Jn(t,n[1].length).replace(/^([^\.]+)$/,"$1."+Kn(n[1])).replace(/\.$/,"."+Kn(n[1])).replace(/\.(\d*)$/,function(e,a){return"."+a+_i("0",Kn(n[1]).length-a.length)}),-1!==a.indexOf("0.")?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),n=a.match(/^(0*)\.(#*)$/))return c+Jn(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=a.match(/^#{1,3},##0(\.?)$/))return c+Wn(Tn(l,0));if(n=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Qn(e,a,-t):Wn(""+(Math.floor(t)+function(e,a){return a<(""+Math.round((e-Math.floor(e))*Math.pow(10,a))).length?1:0}(t,n[1].length)))+"."+Nn(Zn(t,n[1].length),n[1].length);if(n=a.match(/^#,#*,#0/))return Qn(e,a.replace(/^#,#*,/,""),t);if(n=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=wn(Qn(e,a.replace(/[\\-]/g,""),t)),i=0,wn(wn(a.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<s.length?s.charAt(i++):"0"===e?"0":""}));if(a.match(Yn))return"("+(s=Qn(e,"##########",t)).substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),o=In(l,Math.pow(10,i)-1,!1),s=""+c," "==(d=ti("n",n[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],(d=kn(o[2],i)).length<n[4].length&&(d=Kn(n[4].substr(n[4].length-d.length))+d),s+=d;if(n=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c+((o=In(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?jn(o[1],i)+n[2]+"/"+n[3]+kn(o[2],i):_i(" ",2*i+1+n[2].length+n[3].length));if(n=a.match(/^[#0?]+$/))return s=Tn(t,0),a.length<=s.length?s:Kn(a.substr(0,a.length-s.length))+s;if(n=a.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=a.indexOf(".")-i,u=a.length-s.length-h;return Kn(a.substr(0,h)+s+a.substr(a.length-u))}if(n=a.match(/^00,000\.([#0]*0)$/))return i=Zn(t,n[1].length),t<0?"-"+Qn(e,a,-t):Wn(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Nn(0,3-e.length):"")+e})+"."+Nn(i,n[1].length);switch(a){case"###,##0.00":return Qn(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var m=Wn(Tn(l,0));return"0"!==m?c+m:"";case"###,###.00":return Qn(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Qn(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+a+"|")}function ei(e,a){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==a)return"0.0E+0";if(a<0)return"-"+ei(e,-a);var s=e.indexOf(".");-1===s&&(s=e.indexOf("E"));var n=Math.floor(Math.log(a)*Math.LOG10E)%s;if(n<0&&(n+=s),!(t=(a/Math.pow(10,n)).toPrecision(r+1+(s+n)%s)).match(/[Ee]/)){var i=Math.floor(Math.log(a)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+n):t+="E+"+(i-n),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,a,t,r){return a+t+r.substr(0,(s+n)%s)+"."+r.substr(n)+"E"})}else t=a.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ai(e,a,t){if(40===e.charCodeAt(0)&&!a.match(Xn)){var r=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ai("n",r,t):"("+ai("n",r,-t)+")"}if(44===a.charCodeAt(a.length-1))return function(e,a,t){for(var r=a.length-1;44===a.charCodeAt(r-1);)--r;return ti(e,a.substr(0,r),t/Math.pow(10,3*(a.length-r)))}(e,a,t);if(-1!==a.indexOf("%"))return function(e,a,t){var r=a.replace(Vn,""),s=a.length-r.length;return ti(e,r,t*Math.pow(10,2*s))+_i("%",s)}(e,a,t);if(-1!==a.indexOf("E"))return ei(a,t);if(36===a.charCodeAt(0))return"$"+ai(e,a.substr(" "==a.charAt(1)?2:1),t);var s,n,i,o,l=Math.abs(t),c=t<0?"-":"";if(a.match(/^00+$/))return c+Nn(l,a.length);if(a.match(/^[#?]+$/))return s=""+t,0===t&&(s=""),s.length>a.length?s:Kn(a.substr(0,a.length-s.length))+s;if(n=a.match(Gn))return function(e,a,t){return t+(0===a?"":""+a)+_i(" ",e[1].length+2+e[4].length)}(n,l,c);if(a.match(/^#+0+$/))return c+Nn(l,a.length-a.indexOf("0"));if(n=a.match(qn))return s=(s=(""+t).replace(/^([^\.]+)$/,"$1."+Kn(n[1])).replace(/\.$/,"."+Kn(n[1]))).replace(/\.(\d*)$/,function(e,a){return"."+a+_i("0",Kn(n[1]).length-a.length)}),-1!==a.indexOf("0.")?s:s.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),n=a.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=a.match(/^#{1,3},##0(\.?)$/))return c+Wn(""+l);if(n=a.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ai(e,a,-t):Wn(""+t)+"."+_i("0",n[1].length);if(n=a.match(/^#,#*,#0/))return ai(e,a.replace(/^#,#*,/,""),t);if(n=a.match(/^([0#]+)(\\?-([0#]+))+$/))return s=wn(ai(e,a.replace(/[\\-]/g,""),t)),i=0,wn(wn(a.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<s.length?s.charAt(i++):"0"===e?"0":""}));if(a.match(Yn))return"("+(s=ai(e,"##########",t)).substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(n=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),o=In(l,Math.pow(10,i)-1,!1),s=""+c," "==(d=ti("n",n[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),s+=d+n[2]+"/"+n[3],(d=kn(o[2],i)).length<n[4].length&&(d=Kn(n[4].substr(n[4].length-d.length))+d),s+=d;if(n=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),c+((o=In(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?jn(o[1],i)+n[2]+"/"+n[3]+kn(o[2],i):_i(" ",2*i+1+n[2].length+n[3].length));if(n=a.match(/^[#0?]+$/))return s=""+t,a.length<=s.length?s:Kn(a.substr(0,a.length-s.length))+s;if(n=a.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=a.indexOf(".")-i,u=a.length-s.length-h;return Kn(a.substr(0,h)+s+a.substr(a.length-u))}if(n=a.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ai(e,a,-t):Wn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Nn(0,3-e.length):"")+e})+"."+Nn(0,n[1].length);switch(a){case"###,###":case"##,###":case"#,###":var m=Wn(""+l);return"0"!==m?c+m:"";default:if(a.match(/\.[0#?]*$/))return ai(e,a.slice(0,a.lastIndexOf(".")),t)+Kn(a.slice(a.lastIndexOf(".")))}throw new Error("unsupported format |"+a+"|")}function ti(e,a,t){return(0|t)===t?ai(e,a,t):Qn(e,a,t)}var ri=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function si(e){for(var a=0,t="",r="";a<e.length;)switch(t=e.charAt(a)){case"G":Sn(e,a)&&(a+=6),a++;break;case'"':for(;34!==e.charCodeAt(++a)&&a<e.length;);++a;break;case"\\":case"_":a+=2;break;case"@":++a;break;case"B":case"b":if("1"===e.charAt(a+1)||"2"===e.charAt(a+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"‰∏ä":if("A/P"===e.substr(a,3).toUpperCase())return!0;if("AM/PM"===e.substr(a,5).toUpperCase())return!0;if("‰∏äÂçà/‰∏ãÂçà"===e.substr(a,5).toUpperCase())return!0;++a;break;case"[":for(r=t;"]"!==e.charAt(a++)&&a<e.length;)r+=e.charAt(a);if(r.match(ri))return!0;break;case".":case"0":case"#":for(;a<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++a))>-1||"\\"==t&&"-"==e.charAt(a+1)&&"0#".indexOf(e.charAt(a+2))>-1););break;case"?":for(;e.charAt(++a)===t;);break;case"*":++a," "!=e.charAt(a)&&"*"!=e.charAt(a)||++a;break;case"(":case")":++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;);break;default:++a}return!1}var ni=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ii(e,a){if(null==a)return!1;var t=parseFloat(a[2]);switch(a[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0}return!1}function oi(e,a){var t=function(e){for(var a=[],t=!1,r=0,s=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:a[a.length]=e.substr(s,r-s),s=r+1}if(a[a.length]=e.substr(s),!0===t)throw new Error("Format |"+e+"| unterminated string ");return a}(e),r=t.length,s=t[r-1].indexOf("@");if(r<4&&s>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof a)return[4,4===t.length||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var n=a>0?t[0]:a<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[r,n];if(null!=t[0].match(/\[[=<>]/)||null!=t[1].match(/\[[=<>]/)){var i=t[0].match(ni),o=t[1].match(ni);return ii(a,i)?[r,t[0]]:ii(a,o)?[r,t[1]]:[r,t[null!=i&&null!=o?2:1]]}return[r,n]}function li(e,a,t){null==t&&(t={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&t.dateNF?t.dateNF:e;break;case"number":null==(r=14==e&&t.dateNF?t.dateNF:(null!=t.table?t.table:_n)[e])&&(r=t.table&&t.table[Rn[e]]||_n[Rn[e]]),null==r&&(r=On[e]||"General")}if(Sn(r,0))return Un(a,t);a instanceof Date&&(a=Fn(a,t.date1904));var s=oi(r,a);if(Sn(s[1]))return Un(a,t);if(!0===a)a="TRUE";else if(!1===a)a="FALSE";else if(""===a||null==a)return"";return function(e,a,t,r){for(var s,n,i,o=[],l="",c=0,d="",h="t",u="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Sn(e,c))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var m=e.charAt(++c),f="("===m||")"===m?m:"t";o[o.length]={t:f,v:m},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:a},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==s&&null==(s=Mn(a,t,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},h=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(a<0)return"";if(null==s&&null==(s=Mn(a,t)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===h.toLowerCase()&&(d="M"),"h"===d&&(d=u),o[o.length]={t:d,v:l},h=d;break;case"A":case"a":case"‰∏ä":var g={t:d,v:d};if(null==s&&(s=Mn(a,t)),"A/P"===e.substr(c,3).toUpperCase()?(null!=s&&(g.v=s.H>=12?"P":"A"),g.t="T",u="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=s&&(g.v=s.H>=12?"PM":"AM"),g.t="T",c+=5,u="h"):"‰∏äÂçà/‰∏ãÂçà"===e.substr(c,5).toUpperCase()?(null!=s&&(g.v=s.H>=12?"‰∏ãÂçà":"‰∏äÂçà"),g.t="T",c+=5,u="h"):(g.t="t",++c),null==s&&"T"===g.t)return"";o[o.length]=g,h=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(ri)){if(null==s&&null==(s=Mn(a,t)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",si(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=s){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},h=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===r?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=‚Ç¨acfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var p,x=0,b=0;for(c=o.length-1,h="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=u,h="h",x<1&&(x=1);break;case"s":(p=o[c].v.match(/\.0+$/))&&(b=Math.max(b,p[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":h=o[c].t;break;case"m":"s"===h&&(o[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&o[c].v.match(/[Hh]/)&&(x=1),x<2&&o[c].v.match(/[Mm]/)&&(x=2),x<3&&o[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:s.u>=.5&&(s.u=0,++s.S),s.S>=60&&(s.S=0,++s.M),s.M>=60&&(s.M=0,++s.H);break;case 2:s.u>=.5&&(s.u=0,++s.S),s.S>=60&&(s.S=0,++s.M)}var v,y="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=$n(o[c].t.charCodeAt(0),o[c].v,s,b),o[c].t="t";break;case"n":case"?":for(v=c+1;null!=o[v]&&("?"===(d=o[v].t)||"D"===d||(" "===d||"t"===d)&&null!=o[v+1]&&("?"===o[v+1].t||"t"===o[v+1].t&&"/"===o[v+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[v].v||" "===o[v].v&&null!=o[v+1]&&"?"==o[v+1].t));)o[c].v+=o[v].v,o[v]={v:"",t:";"},++v;y+=o[c].v,c=v-1;break;case"G":o[c].t="t",o[c].v=Un(a,t)}var w,N,j="";if(y.length>0){40==y.charCodeAt(0)?(w=a<0&&45===y.charCodeAt(0)?-a:a,N=ti("n",y,w)):(N=ti("n",y,w=a<0&&r>1?-a:a),w<0&&o[0]&&"t"==o[0].t&&(N=N.substr(1),o[0].v="-"+o[0].v)),v=N.length-1;var k=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){k=c;break}var E=o.length;if(k===o.length&&-1===N.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(v>=o[c].v.length-1?(v-=o[c].v.length,o[c].v=N.substr(v+1,o[c].v.length)):v<0?o[c].v="":(o[c].v=N.substr(0,v+1),v=-1),o[c].t="t",E=c);v>=0&&E<o.length&&(o[E].v=N.substr(0,v+1)+o[E].v)}else if(k!==o.length&&-1===N.indexOf("E")){for(v=N.indexOf(".")-1,c=k;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(n=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")-1:o[c].v.length-1,j=o[c].v.substr(n+1);n>=0;--n)v>=0&&("0"===o[c].v.charAt(n)||"#"===o[c].v.charAt(n))&&(j=N.charAt(v--)+j);o[c].v=j,o[c].t="t",E=c}for(v>=0&&E<o.length&&(o[E].v=N.substr(0,v+1)+o[E].v),v=N.indexOf(".")+1,c=k;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===k)){for(n=o[c].v.indexOf(".")>-1&&c===k?o[c].v.indexOf(".")+1:0,j=o[c].v.substr(0,n);n<o[c].v.length;++n)v<N.length&&(j+=N.charAt(v++));o[c].v=j,o[c].t="t",E=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=r>1&&a<0&&c>0&&"-"===o[c-1].v?-a:a,o[c].v=ti(o[c].t,o[c].v,w),o[c].t="t");var T="";for(c=0;c!==o.length;++c)null!=o[c]&&(T+=o[c].v);return T}(s[1],a,t,s[0])}function ci(e,a){if("number"!=typeof a){a=+a||-1;for(var t=0;t<392;++t)if(null!=_n[t]){if(_n[t]==e){a=t;break}}else a<0&&(a=t);a<0&&(a=391)}return _n[a]=e,a}function di(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "',_n=e}var hi={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ui=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var mi=function(){var e={};e.version="1.2.0";var a=function(){for(var e=0,a=new Array(256),t=0;256!=t;++t)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=t)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,a[t]=e;return"undefined"!=typeof Int32Array?new Int32Array(a):a}();var t=function(e){var a=0,t=0,r=0,s="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)s[r]=e[r];for(r=0;256!=r;++r)for(t=e[r],a=256+r;a<4096;a+=256)t=s[a]=t>>>8^e[255&t];var n=[];for(r=1;16!=r;++r)n[r-1]="undefined"!=typeof Int32Array?s.subarray(256*r,256*r+256):s.slice(256*r,256*r+256);return n}(a),r=t[0],s=t[1],n=t[2],i=t[3],o=t[4],l=t[5],c=t[6],d=t[7],h=t[8],u=t[9],m=t[10],f=t[11],g=t[12],p=t[13],x=t[14];return e.table=a,e.bstr=function(e,t){for(var r=-1^t,s=0,n=e.length;s<n;)r=r>>>8^a[255&(r^e.charCodeAt(s++))];return~r},e.buf=function(e,t){for(var b=-1^t,v=e.length-15,y=0;y<v;)b=x[e[y++]^255&b]^p[e[y++]^b>>8&255]^g[e[y++]^b>>16&255]^f[e[y++]^b>>>24]^m[e[y++]]^u[e[y++]]^h[e[y++]]^d[e[y++]]^c[e[y++]]^l[e[y++]]^o[e[y++]]^i[e[y++]]^n[e[y++]]^s[e[y++]]^r[e[y++]]^a[e[y++]];for(v+=15;y<v;)b=b>>>8^a[255&(b^e[y++])];return~b},e.str=function(e,t){for(var r=-1^t,s=0,n=e.length,i=0,o=0;s<n;)(i=e.charCodeAt(s++))<128?r=r>>>8^a[255&(r^i)]:i<2048?r=(r=r>>>8^a[255&(r^(192|i>>6&31))])>>>8^a[255&(r^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(s++),r=(r=(r=(r=r>>>8^a[255&(r^(240|i>>8&7))])>>>8^a[255&(r^(128|i>>2&63))])>>>8^a[255&(r^(128|o>>6&15|(3&i)<<4))])>>>8^a[255&(r^(128|63&o))]):r=(r=(r=r>>>8^a[255&(r^(224|i>>12&15))])>>>8^a[255&(r^(128|i>>6&63))])>>>8^a[255&(r^(128|63&i))];return~r},e}(),fi=function(){var e,a={};function t(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:t(e.slice(0,-1));var a=e.lastIndexOf("/");return-1===a?e:e.slice(0,a+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var a=e.lastIndexOf("/");return-1===a?e:e.slice(a+1)}function s(e,a){"string"==typeof a&&(a=new Date(a));var t=a.getHours();t=(t=t<<6|a.getMinutes())<<5|a.getSeconds()>>>1,e.write_shift(2,t);var r=a.getFullYear()-1980;r=(r=r<<4|a.getMonth()+1)<<5|a.getDate(),e.write_shift(2,r)}function n(e){nl(e,0);for(var a={},t=0;e.l<=e.length-4;){var r=e.read_shift(2),s=e.read_shift(2),n=e.l+s,i={};if(21589===r)1&(t=e.read_shift(1))&&(i.mtime=e.read_shift(4)),s>5&&(2&t&&(i.atime=e.read_shift(4)),4&t&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=n,a[r]=i}return a}function i(){return e||(e={})}function o(e,a){if(80==e[0]&&75==e[1])return re(e,a);if(109==(32|e[0])&&105==(32|e[1]))return function(e,a){if("mime-version:"!=N(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var t=a&&a.root||"",r=(hn&&Buffer.isBuffer(e)?e.toString("binary"):N(e)).split("\r\n"),s=0,n="";for(s=0;s<r.length;++s)if(n=r[s],/^Content-Location:/i.test(n)&&(n=n.slice(n.indexOf("file")),t||(t=n.slice(0,n.lastIndexOf("/")+1)),n.slice(0,t.length)!=t))for(;t.length>0&&(t=(t=t.slice(0,t.length-1)).slice(0,t.lastIndexOf("/")+1),n.slice(0,t.length)!=t););var i=(r[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],d={FileIndex:l,FullPaths:c};u(d);var h,m=0;for(s=0;s<r.length;++s){var f=r[s];f!==o&&f!==o+"--"||(m++&&ce(d,r.slice(h,s),t),h=s)}return d}(e,a);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var t,r,s,n,i,o,m=512,f=[],g=e.slice(0,512);nl(g,0);var p=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var a=e.read_shift(2,"u");return[e.read_shift(2,"u"),a]}(g);switch(t=p[0]){case 3:m=512;break;case 4:m=4096;break;case 0:if(0==p[1])return re(e,a);default:throw new Error("Major Version: Expected 3 or 4 saw "+t)}512!==m&&nl(g=e.slice(0,m),28);var v=e.slice(0,m);!function(e,a){var t=9;switch(e.l+=2,t=e.read_shift(2)){case 9:if(3!=a)throw new Error("Sector Shift: Expected 9 saw "+t);break;case 12:if(4!=a)throw new Error("Sector Shift: Expected 12 saw "+t);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+t)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,t);var y=g.read_shift(4,"i");if(3===t&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);g.l+=4,n=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),i=g.read_shift(4,"i"),r=g.read_shift(4,"i"),o=g.read_shift(4,"i"),s=g.read_shift(4,"i");for(var w=-1,j=0;j<109&&!((w=g.read_shift(4,"i"))<0);++j)f[j]=w;var k=function(e,a){for(var t=Math.ceil(e.length/a)-1,r=[],s=1;s<t;++s)r[s-1]=e.slice(s*a,(s+1)*a);return r[t-1]=e.slice(t*a),r}(e,m);c(o,s,k,m,f);var E=function(e,a,t,r){var s=e.length,n=[],i=[],o=[],l=[],c=r-1,d=0,h=0,u=0,m=0;for(d=0;d<s;++d)if(o=[],(u=d+a)>=s&&(u-=s),!i[u]){l=[];var f=[];for(h=u;h>=0;){f[h]=!0,i[h]=!0,o[o.length]=h,l.push(e[h]);var g=t[Math.floor(4*h/r)];if(r<4+(m=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+r);if(!e[g])break;if(f[h=Jo(e[g],m)])break}n[u]={nodes:o,data:So([l])}}return n}(k,n,f,m);E[n].name="!Directory",r>0&&i!==x&&(E[i].name="!MiniFAT"),E[f[0]].name="!FAT",E.fat_addrs=f,E.ssz=m;var T=[],S=[],C=[];!function(e,a,t,r,s,n,i,o){for(var c,u=0,m=r.length?2:0,f=a[e].data,g=0,p=0;g<f.length;g+=128){var b=f.slice(g,g+128);nl(b,64),p=b.read_shift(2),c=Ao(b,0,p-m),r.push(c);var v={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.ct=h(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(v.mt=h(b,b.l-8)),v.start=b.read_shift(4,"i"),v.size=b.read_shift(4,"i"),v.size<0&&v.start<0&&(v.size=v.type=0,v.start=x,v.name=""),5===v.type?(u=v.start,s>0&&u!==x&&(a[u].name="!StreamData")):v.size>=4096?(v.storage="fat",void 0===a[v.start]&&(a[v.start]=d(t,v.start,a.fat_addrs,a.ssz)),a[v.start].name=v.name,v.content=a[v.start].data.slice(0,v.size)):(v.storage="minifat",v.size<0?v.size=0:u!==x&&v.start!==x&&a[u]&&(v.content=l(v,a[u].data,(a[o]||{}).data))),v.content&&nl(v.content,0),n[c]=v,i.push(v)}}(n,E,k,T,r,{},S,i),function(e,a,t){for(var r=0,s=0,n=0,i=0,o=0,l=t.length,c=[],d=[];r<l;++r)c[r]=d[r]=r,a[r]=t[r];for(;o<d.length;++o)s=e[r=d[o]].L,n=e[r].R,i=e[r].C,c[r]===r&&(-1!==s&&c[s]!==s&&(c[r]=c[s]),-1!==n&&c[n]!==n&&(c[r]=c[n])),-1!==i&&(c[i]=r),-1!==s&&r!=c[r]&&(c[s]=c[r],d.lastIndexOf(s)<o&&d.push(s)),-1!==n&&r!=c[r]&&(c[n]=c[r],d.lastIndexOf(n)<o&&d.push(n));for(r=1;r<l;++r)c[r]===r&&(-1!==n&&c[n]!==n?c[r]=c[n]:-1!==s&&c[s]!==s&&(c[r]=c[s]));for(r=1;r<l;++r)if(0!==e[r].type){if((o=r)!=c[o])do{o=c[o],a[r]=a[o]+"/"+a[r]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[r]=-1}for(a[0]+="/",r=1;r<l;++r)2!==e[r].type&&(a[r]+="/")}(S,C,T),T.shift();var A={FileIndex:S,FullPaths:C};return a&&a.raw&&(A.raw={header:v,sectors:k}),A}function l(e,a,t){for(var r=e.start,s=e.size,n=[],i=r;t&&s>0&&i>=0;)n.push(a.slice(i*p,i*p+p)),s-=p,i=Jo(t,4*i);return 0===n.length?ol(0):bn(n).slice(0,e.size)}function c(e,a,t,r,s){var n=x;if(e===x){if(0!==a)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=t[e],o=(r>>>2)-1;if(!i)return;for(var l=0;l<o&&(n=Jo(i,4*l))!==x;++l)s.push(n);c(Jo(i,r-4),a-1,t,r,s)}}function d(e,a,t,r,s){var n=[],i=[];s||(s=[]);var o=r-1,l=0,c=0;for(l=a;l>=0;){s[l]=!0,n[n.length]=l,i.push(e[l]);var d=t[Math.floor(4*l/r)];if(r<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[d])break;l=Jo(e[d],c)}return{nodes:n,data:So([i])}}function h(e,a){return new Date(1e3*(Ko(e,a+4)/1e7*Math.pow(2,32)+Ko(e,a)/1e7-11644473600))}function u(e,a){var t=a||{},r=t.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),t.CLSID&&(e.FileIndex[0].clsid=t.CLSID),function(e){var a="Sh33tJ5";if(fi.find(e,"/"+a))return;var t=ol(4);t[0]=55,t[1]=t[3]=50,t[2]=54,e.FileIndex.push({name:a,type:2,content:t,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+a),m(e)}(e)}function m(e,a){u(e);for(var s=!1,n=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:n?s=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:n=!0,isNaN(o.R*o.L*o.C)&&(s=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(s=!0);break;default:s=!0}}if(s||a){var l=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},h=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&h.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<h.length;++i){var m=t(h[i][0]);(n=d[m])||(h.push([m,{name:r(m).replace("/",""),type:1,clsid:y,ct:l,mt:l,content:null}]),d[m]=!0)}for(h.sort(function(e,a){return function(e,a){for(var t=e.split("/"),r=a.split("/"),s=0,n=0,i=Math.min(t.length,r.length);s<i;++s){if(n=t[s].length-r[s].length)return n;if(t[s]!=r[s])return t[s]<r[s]?-1:1}return t.length-r.length}(e[0],a[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<h.length;++i)e.FullPaths[i]=h[i][0],e.FileIndex[i]=h[i][1];for(i=0;i<h.length;++i){var f=e.FileIndex[i],g=e.FullPaths[i];if(f.name=r(g).replace("/",""),f.L=f.R=f.C=-(f.color=1),f.size=f.content?f.content.length:0,f.start=0,f.clsid=f.clsid||y,0===i)f.C=h.length>1?1:-1,f.size=0,f.type=5;else if("/"==g.slice(-1)){for(c=i+1;c<h.length&&t(e.FullPaths[c])!=g;++c);for(f.C=c>=h.length?-1:c,c=i+1;c<h.length&&t(e.FullPaths[c])!=t(g);++c);f.R=c>=h.length?-1:c,f.type=1}else t(e.FullPaths[i+1]||"")==t(g)&&(f.R=i+1),f.type=2}}}function f(e,a){var t=a||{};if("mad"==t.fileType)return function(e,a){for(var t=a||{},r=t.boundary||"SheetJS",s=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],n=e.FullPaths[0],i=n,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(n.length),(o=e.FileIndex[l]).size&&o.content&&"Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,d=hn&&Buffer.isBuffer(c)?c.toString("binary"):N(c),h=0,u=Math.min(1024,d.length),m=0,f=0;f<=u;++f)(m=d.charCodeAt(f))>=32&&m<128&&++h;var g=h>=4*u/5;s.push(r),s.push("Content-Location: "+(t.root||"file:///C:/SheetJS/")+i),s.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),s.push("Content-Type: "+ie(o,i)),s.push(""),s.push(g?le(d):oe(d))}return s.push(r+"--\r\n"),s.join("\r\n")}(e,t);if(m(e),"zip"===t.fileType)return function(e,a){var t=a||{},r=[],n=[],i=ol(1),o=t.compression?8:0,l=0,c=0,d=0,h=0,u=0,m=e.FullPaths[0],f=m,g=e.FileIndex[0],p=[],x=0;for(c=1;c<e.FullPaths.length;++c)if(f=e.FullPaths[c].slice(m.length),(g=e.FileIndex[c]).size&&g.content&&"Sh33tJ5"!=f){var b=h,v=ol(f.length);for(d=0;d<f.length;++d)v.write_shift(1,127&f.charCodeAt(d));v=v.slice(0,v.l),p[u]=mi.buf(g.content,0);var y=g.content;8==o&&(y=j(y)),(i=ol(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),g.mt?s(i,g.mt):i.write_shift(4,0),i.write_shift(-4,p[u]),i.write_shift(4,y.length),i.write_shift(4,g.content.length),i.write_shift(2,v.length),i.write_shift(2,0),h+=i.length,r.push(i),h+=v.length,r.push(v),h+=y.length,r.push(y),(i=ol(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,p[u]),i.write_shift(4,y.length),i.write_shift(4,g.content.length),i.write_shift(2,v.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,b),x+=i.l,n.push(i),x+=v.length,n.push(v),++u}return i=ol(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,u),i.write_shift(2,u),i.write_shift(4,x),i.write_shift(4,h),i.write_shift(2,0),bn([bn(r),bn(n),i])}(e,t);var r=function(e){for(var a=0,t=0,r=0;r<e.FileIndex.length;++r){var s=e.FileIndex[r];if(s.content){var n=s.content.length;n>0&&(n<4096?a+=n+63>>6:t+=n+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=a+127>>7,l=(a+7>>3)+t+i+o,c=l+127>>7,d=c<=109?0:Math.ceil((c-109)/127);l+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var h=[1,d,c,o,i,t,a,0];return e.FileIndex[0].size=a<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),n=ol(r[7]<<9),i=0,o=0;for(i=0;i<8;++i)n.write_shift(1,v[i]);for(i=0;i<8;++i)n.write_shift(2,0);for(n.write_shift(2,62),n.write_shift(2,3),n.write_shift(2,65534),n.write_shift(2,9),n.write_shift(2,6),i=0;i<3;++i)n.write_shift(2,0);for(n.write_shift(4,0),n.write_shift(4,r[2]),n.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),n.write_shift(4,0),n.write_shift(4,4096),n.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:x),n.write_shift(4,r[3]),n.write_shift(-4,r[1]?r[0]-1:x),n.write_shift(4,r[1]),i=0;i<109;++i)n.write_shift(-4,i<r[2]?r[1]+i:-1);if(r[1])for(o=0;o<r[1];++o){for(;i<236+127*o;++i)n.write_shift(-4,i<r[2]?r[1]+i:-1);n.write_shift(-4,o===r[1]-1?x:o+1)}var l=function(e){for(o+=e;i<o-1;++i)n.write_shift(-4,i+1);e&&(++i,n.write_shift(-4,x))};for(o=i=0,o+=r[1];i<o;++i)n.write_shift(-4,w.DIFSECT);for(o+=r[2];i<o;++i)n.write_shift(-4,w.FATSECT);l(r[3]),l(r[4]);for(var c=0,d=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((d=h.content.length)<4096||(h.start=o,l(d+511>>9)));for(l(r[6]+7>>3);511&n.l;)n.write_shift(-4,w.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(d=h.content.length)||d>=4096||(h.start=o,l(d+63>>6)));for(;511&n.l;)n.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<r[4]<<2;++i){var u=e.FullPaths[i];if(u&&0!==u.length){h=e.FileIndex[i],0===i&&(h.start=h.size?h.start-1:x);var f=0===i&&t.root||h.name;if(d=2*(f.length+1),n.write_shift(64,f,"utf16le"),n.write_shift(2,d),n.write_shift(1,h.type),n.write_shift(1,h.color),n.write_shift(-4,h.L),n.write_shift(-4,h.R),n.write_shift(-4,h.C),h.clsid)n.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)n.write_shift(4,0);n.write_shift(4,h.state||0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,h.start),n.write_shift(4,h.size),n.write_shift(4,0)}else{for(c=0;c<17;++c)n.write_shift(4,0);for(c=0;c<3;++c)n.write_shift(4,-1);for(c=0;c<12;++c)n.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((h=e.FileIndex[i]).size>=4096)if(n.l=h.start+1<<9,hn&&Buffer.isBuffer(h.content))h.content.copy(n,n.l,0,h.size),n.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)n.write_shift(1,h.content[c]);for(;511&c;++c)n.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((h=e.FileIndex[i]).size>0&&h.size<4096)if(hn&&Buffer.isBuffer(h.content))h.content.copy(n,n.l,0,h.size),n.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)n.write_shift(1,h.content[c]);for(;63&c;++c)n.write_shift(1,0)}if(hn)n.l=n.length;else for(;n.l<n.length;)n.write_shift(1,0);return n}a.version="1.2.1";var g,p=64,x=-2,b="d0cf11e0a1b11ae1",v=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:x,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function N(e){for(var a=new Array(e.length),t=0;t<e.length;++t)a[t]=String.fromCharCode(e[t]);return a.join("")}function j(e){return g?g.deflateRawSync(e):X(e)}var k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function S(e){var a=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(a>>16|a>>8|a)}for(var C="undefined"!=typeof Uint8Array,A=C?new Uint8Array(256):[],_=0;_<256;++_)A[_]=S(_);function R(e,a){var t=A[255&e];return a<=8?t>>>8-a:(t=t<<8|A[e>>8&255],a<=16?t>>>16-a:(t=t<<8|A[e>>16&255])>>>24-a)}function O(e,a){var t=7&a,r=a>>>3;return(e[r]|(t<=6?0:e[r+1]<<8))>>>t&3}function I(e,a){var t=7&a,r=a>>>3;return(e[r]|(t<=5?0:e[r+1]<<8))>>>t&7}function M(e,a){var t=7&a,r=a>>>3;return(e[r]|(t<=3?0:e[r+1]<<8))>>>t&31}function P(e,a){var t=7&a,r=a>>>3;return(e[r]|(t<=1?0:e[r+1]<<8))>>>t&127}function L(e,a,t){var r=7&a,s=a>>>3,n=(1<<t)-1,i=e[s]>>>r;return t<8-r?i&n:(i|=e[s+1]<<8-r,t<16-r?i&n:(i|=e[s+2]<<16-r,t<24-r?i&n:(i|=e[s+3]<<24-r)&n))}function D(e,a,t){var r=7&a,s=a>>>3;return r<=5?e[s]|=(7&t)<<r:(e[s]|=t<<r&255,e[s+1]=(7&t)>>8-r),a+3}function F(e,a,t){return t=(1&t)<<(7&a),e[a>>>3]|=t,a+1}function z(e,a,t){var r=a>>>3;return t<<=7&a,e[r]|=255&t,t>>>=8,e[r+1]=t,a+8}function B(e,a,t){var r=a>>>3;return t<<=7&a,e[r]|=255&t,t>>>=8,e[r+1]=255&t,e[r+2]=t>>>8,a+16}function U(e,a){var t=e.length,r=2*t>a?2*t:a+5,s=0;if(t>=a)return e;if(hn){var n=fn(r);if(e.copy)e.copy(n);else for(;s<e.length;++s)n[s]=e[s];return n}if(C){var i=new Uint8Array(r);if(i.set)i.set(e);else for(;s<t;++s)i[s]=e[s];return i}return e.length=r,e}function $(e){for(var a=new Array(e),t=0;t<e;++t)a[t]=0;return a}function W(e,a,t){var r=1,s=0,n=0,i=0,o=0,l=e.length,c=C?new Uint16Array(32):$(32);for(n=0;n<32;++n)c[n]=0;for(n=l;n<t;++n)e[n]=0;l=e.length;var d=C?new Uint16Array(l):$(l);for(n=0;n<l;++n)c[s=e[n]]++,r<s&&(r=s),d[n]=0;for(c[0]=0,n=1;n<=r;++n)c[n+16]=o=o+c[n-1]<<1;for(n=0;n<l;++n)0!=(o=e[n])&&(d[n]=c[o+16]++);var h=0;for(n=0;n<l;++n)if(0!=(h=e[n]))for(o=R(d[n],r)>>r-h,i=(1<<r+4-h)-1;i>=0;--i)a[o|i<<h]=15&h|n<<4;return r}var V=C?new Uint16Array(512):$(512),H=C?new Uint16Array(32):$(32);if(!C){for(var G=0;G<512;++G)V[G]=0;for(G=0;G<32;++G)H[G]=0}!function(){for(var e=[],a=0;a<32;a++)e.push(5);W(e,H,32);var t=[];for(a=0;a<=143;a++)t.push(8);for(;a<=255;a++)t.push(9);for(;a<=279;a++)t.push(7);for(;a<=287;a++)t.push(8);W(t,V,288)}();var q=function(){for(var e=C?new Uint8Array(32768):[],a=0,t=0;a<T.length-1;++a)for(;t<T[a+1];++t)e[t]=a;for(;t<32768;++t)e[t]=29;var r=C?new Uint8Array(259):[];for(a=0,t=0;a<E.length-1;++a)for(;t<E[a+1];++t)r[t]=a;return function(a,t){return a.length<8?function(e,a){for(var t=0;t<e.length;){var r=Math.min(65535,e.length-t),s=t+r==e.length;for(a.write_shift(1,+s),a.write_shift(2,r),a.write_shift(2,65535&~r);r-- >0;)a[a.l++]=e[t++]}return a.l}(a,t):function(a,t){for(var s=0,n=0,i=C?new Uint16Array(32768):[];n<a.length;){var o=Math.min(65535,a.length-n);if(o<10){for(7&(s=D(t,s,+!(n+o!=a.length)))&&(s+=8-(7&s)),t.l=s/8|0,t.write_shift(2,o),t.write_shift(2,65535&~o);o-- >0;)t[t.l++]=a[n++];s=8*t.l}else{s=D(t,s,+!(n+o!=a.length)+2);for(var l=0;o-- >0;){var c=a[n],d=-1,h=0;if((d=i[l=32767&(l<<5^c)])&&((d|=-32768&n)>n&&(d-=32768),d<n))for(;a[d+h]==a[n+h]&&h<250;)++h;if(h>2){(c=r[h])<=22?s=z(t,s,A[c+1]>>1)-1:(z(t,s,3),z(t,s+=5,A[c-23]>>5),s+=3);var u=c<8?0:c-4>>2;u>0&&(B(t,s,h-E[c]),s+=u),c=e[n-d],s=z(t,s,A[c]>>3),s-=3;var m=c<4?0:c-2>>1;m>0&&(B(t,s,n-d-T[c]),s+=m);for(var f=0;f<h;++f)i[l]=32767&n,l=32767&(l<<5^a[n]),++n;o-=h-1}else c<=143?c+=48:s=F(t,s,1),s=z(t,s,A[c]),i[l]=32767&n,++n}s=z(t,s,0)-1}}return t.l=(s+7)/8|0,t.l}(a,t)}}();function X(e){var a=ol(50+Math.floor(1.1*e.length)),t=q(e,a);return a.slice(0,t)}var Y=C?new Uint16Array(32768):$(32768),K=C?new Uint16Array(32768):$(32768),J=C?new Uint16Array(128):$(128),Z=1,Q=1;function ee(e,a){var t=M(e,a)+257,r=M(e,a+=5)+1,s=function(e,a){var t=7&a,r=a>>>3;return(e[r]|(t<=4?0:e[r+1]<<8))>>>t&15}(e,a+=5)+4;a+=4;for(var n=0,i=C?new Uint8Array(19):$(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=C?new Uint8Array(8):$(8),d=C?new Uint8Array(8):$(8),h=i.length,u=0;u<s;++u)i[k[u]]=n=I(e,a),l<n&&(l=n),c[n]++,a+=3;var m=0;for(c[0]=0,u=1;u<=l;++u)d[u]=m=m+c[u-1]<<1;for(u=0;u<h;++u)0!=(m=i[u])&&(o[u]=d[m]++);var f=0;for(u=0;u<h;++u)if(0!=(f=i[u])){m=A[o[u]]>>8-f;for(var g=(1<<7-f)-1;g>=0;--g)J[m|g<<f]=7&f|u<<3}var p=[];for(l=1;p.length<t+r;)switch(a+=7&(m=J[P(e,a)]),m>>>=3){case 16:for(n=3+O(e,a),a+=2,m=p[p.length-1];n-- >0;)p.push(m);break;case 17:for(n=3+I(e,a),a+=3;n-- >0;)p.push(0);break;case 18:for(n=11+P(e,a),a+=7;n-- >0;)p.push(0);break;default:p.push(m),l<m&&(l=m)}var x=p.slice(0,t),b=p.slice(t);for(u=t;u<286;++u)x[u]=0;for(u=r;u<30;++u)b[u]=0;return Z=W(x,Y,286),Q=W(b,K,30),a}function ae(e,a){var t=function(e,a){if(3==e[0]&&!(3&e[1]))return[mn(a),2];for(var t=0,r=0,s=fn(a||1<<18),n=0,i=s.length>>>0,o=0,l=0;!(1&r);)if(r=I(e,t),t+=3,r>>>1!=0)for(r>>1==1?(o=9,l=5):(t=ee(e,t),o=Z,l=Q);;){!a&&i<n+32767&&(i=(s=U(s,n+32767)).length);var c=L(e,t,o),d=r>>>1==1?V[c]:Y[c];if(t+=15&d,(d>>>=4)>>>8&255){if(256==d)break;var h=(d-=257)<8?0:d-4>>2;h>5&&(h=0);var u=n+E[d];h>0&&(u+=L(e,t,h),t+=h),c=L(e,t,l),t+=15&(d=r>>>1==1?H[c]:K[c]);var m=(d>>>=4)<4?0:d-2>>1,f=T[d];for(m>0&&(f+=L(e,t,m),t+=m),!a&&i<u&&(i=(s=U(s,u+100)).length);n<u;)s[n]=s[n-f],++n}else s[n++]=d}else{7&t&&(t+=8-(7&t));var g=e[t>>>3]|e[(t>>>3)+1]<<8;if(t+=32,g>0)for(!a&&i<n+g&&(i=(s=U(s,n+g)).length);g-- >0;)s[n++]=e[t>>>3],t+=8}return a?[s,t+7>>>3]:[s.slice(0,n),t+7>>>3]}(e.slice(e.l||0),a);return e.l+=t[1],t[0]}function te(e,a){if(!e)throw new Error(a)}function re(e,a){var t=e;nl(t,0);var r={FileIndex:[],FullPaths:[]};u(r,{root:a.root});for(var s=t.length-4;(80!=t[s]||75!=t[s+1]||5!=t[s+2]||6!=t[s+3])&&s>=0;)--s;t.l=s+4,t.l+=4;var i=t.read_shift(2);t.l+=6;var o=t.read_shift(4);for(t.l=o,s=0;s<i;++s){t.l+=20;var l=t.read_shift(4),c=t.read_shift(4),d=t.read_shift(2),h=t.read_shift(2),m=t.read_shift(2);t.l+=8;var f=t.read_shift(4),g=n(t.slice(t.l+d,t.l+d+h));t.l+=d+h+m;var p=t.l;t.l=f+4,se(t,l,c,r,g),t.l=p}return r}function se(e,a,t,r,s){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var a=65535&e.read_shift(2),t=65535&e.read_shift(2),r=new Date,s=31&t,n=15&(t>>>=5);t>>>=4,r.setMilliseconds(0),r.setFullYear(t+1980),r.setMonth(n-1),r.setDate(s);var i=31&a,o=63&(a>>>=5);return a>>>=6,r.setHours(a),r.setMinutes(o),r.setSeconds(i<<1),r}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),h=e.read_shift(2),u=e.read_shift(2),m="",f=0;f<h;++f)m+=String.fromCharCode(e[e.l++]);if(u){var p=n(e.slice(e.l,e.l+u));(p[21589]||{}).mt&&(l=p[21589].mt),((s||{})[21589]||{}).mt&&(l=s[21589].mt)}e.l+=u;var x=e.slice(e.l,e.l+c);switch(o){case 8:x=function(e,a){if(!g)return ae(e,a);var t=new(0,g.InflateRaw),r=t._processChunk(e.slice(e.l),t._finishFlushFlag);return e.l+=t.bytesRead,r}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var b=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=a&&te(b,"Bad compressed size: "+a+" != "+c),d!=t&&te(b,"Bad uncompressed size: "+t+" != "+d),de(r,m,x,{unsafe:!0,mt:l})}var ne={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,a){if(e.ctype)return e.ctype;var t=e.name||"",r=t.match(/\.([^\.]+)$/);return r&&ne[r[1]]||a&&(r=(t=a).match(/[\.\\]([^\.\\])+$/))&&ne[r[1]]?ne[r[1]]:"application/octet-stream"}function oe(e){for(var a=cn(e),t=[],r=0;r<a.length;r+=76)t.push(a.slice(r,r+76));return t.join("\r\n")+"\r\n"}function le(e){var a=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var a=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==a.length?"0"+a:a)});"\n"==(a=a.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(a="=0D"+a.slice(1));for(var t=[],r=(a=a.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),s=0;s<r.length;++s){var n=r[s];if(0!=n.length)for(var i=0;i<n.length;){var o=76,l=n.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=n.slice(i,i+o),(i+=o)<n.length&&(l+="="),t.push(l)}else t.push("")}return t.join("\r\n")}function ce(e,a,t){for(var r,s="",n="",i="",o=0;o<10;++o){var l=a[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":s=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":n=c[2].trim()}}switch(++o,n.toLowerCase()){case"base64":r=gn(dn(a.slice(o).join("")));break;case"quoted-printable":r=function(e){for(var a=[],t=0;t<e.length;++t){for(var r=e[t];t<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++t];a.push(r)}for(var s=0;s<a.length;++s)a[s]=a[s].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return gn(a.join("\r\n"))}(a.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+n)}var d=de(e,s.slice(t.length),r,{unsafe:!0});i&&(d.ctype=i)}function de(e,a,t,s){var n=s&&s.unsafe;n||u(e);var i=!n&&fi.find(e,a);if(!i){var o=e.FullPaths[0];a.slice(0,o.length)==o?o=a:("/"!=o.slice(-1)&&(o+="/"),o=(o+a).replace("//","/")),i={name:r(a),type:2},e.FileIndex.push(i),e.FullPaths.push(o),n||fi.utils.cfb_gc(e)}return i.content=t,i.size=t?t.length:0,s&&(s.CLSID&&(i.clsid=s.CLSID),s.mt&&(i.mt=s.mt),s.ct&&(i.ct=s.ct)),i}return a.find=function(e,a){var t=e.FullPaths.map(function(e){return e.toUpperCase()}),r=t.map(function(e){var a=e.split("/");return a[a.length-("/"==e.slice(-1)?2:1)]}),s=!1;47===a.charCodeAt(0)?(s=!0,a=t[0].slice(0,-1)+a):s=-1!==a.indexOf("/");var n=a.toUpperCase(),i=!0===s?t.indexOf(n):r.indexOf(n);if(-1!==i)return e.FileIndex[i];var o=!n.match(yn);for(n=n.replace(vn,""),o&&(n=n.replace(yn,"!")),i=0;i<t.length;++i){if((o?t[i].replace(yn,"!"):t[i]).replace(vn,"")==n)return e.FileIndex[i];if((o?r[i].replace(yn,"!"):r[i]).replace(vn,"")==n)return e.FileIndex[i]}return null},a.read=function(a,t){var r=t&&t.type;switch(r||hn&&Buffer.isBuffer(a)&&(r="buffer"),r||"base64"){case"file":return function(a,t){return i(),o(e.readFileSync(a),t)}(a,t);case"base64":return o(gn(dn(a)),t);case"binary":return o(gn(a),t)}return o(a,t)},a.parse=o,a.write=function(a,t){var r=f(a,t);switch(t&&t.type||"buffer"){case"file":return i(),e.writeFileSync(t.filename,r),r;case"binary":return"string"==typeof r?r:N(r);case"base64":return cn("string"==typeof r?r:N(r));case"buffer":if(hn)return Buffer.isBuffer(r)?r:un(r);case"array":return"string"==typeof r?gn(r):r}return r},a.writeFile=function(a,t,r){i();var s=f(a,r);e.writeFileSync(t,s)},a.utils={cfb_new:function(e){var a={};return u(a,e),a},cfb_add:de,cfb_del:function(e,a){u(e);var t=fi.find(e,a);if(t)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==t)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,a,t){u(e);var s=fi.find(e,a);if(s)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==s)return e.FileIndex[n].name=r(t),e.FullPaths[n]=t,!0;return!1},cfb_gc:function(e){m(e,!0)},ReadShift:Qo,CheckField:sl,prep_blob:nl,bconcat:bn,use_zlib:function(e){try{var a=new(0,e.InflateRaw);if(a._processChunk(new Uint8Array([3,0]),a._finishFlushFlag),!a.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(t){}},_deflateRaw:X,_inflateRaw:ae,consts:w},a}();function gi(e){for(var a=Object.keys(e),t=[],r=0;r<a.length;++r)Object.prototype.hasOwnProperty.call(e,a[r])&&t.push(a[r]);return t}function pi(e){for(var a=[],t=gi(e),r=0;r!==t.length;++r)a[e[t[r]]]=t[r];return a}var xi=new Date(1899,11,30,0,0,0);function bi(e,a){return(e.getTime()-(xi.getTime()+6e4*(e.getTimezoneOffset()-xi.getTimezoneOffset())))/864e5}var vi=new Date,yi=xi.getTime()+6e4*(vi.getTimezoneOffset()-xi.getTimezoneOffset()),wi=vi.getTimezoneOffset();function Ni(e){var a=new Date;return a.setTime(24*e*60*60*1e3+yi),a.getTimezoneOffset()!==wi&&a.setTime(a.getTime()+6e4*(a.getTimezoneOffset()-wi)),a}function ji(e){var a=0,t=0,r=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=s.length;++n)if(s[n]){switch(t=1,n>3&&(r=!0),s[n].slice(s[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[n].slice(s[n].length-1));case"D":t*=24;case"H":t*=60;case"M":if(!r)throw new Error("Unsupported ISO Duration Field: M");t*=60}a+=t*parseInt(s[n],10)}return a}var ki=new Date("2017-02-19T19:06:09.000Z"),Ei=isNaN(ki.getFullYear())?new Date("2/19/17"):ki,Ti=2017==Ei.getFullYear();function Si(e,a){var t=new Date(e);if(Ti)return a>0?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):a<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(e instanceof Date)return e;if(1917==Ei.getFullYear()&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3)),n}function Ci(e,a){if(hn&&Buffer.isBuffer(e)){if(a){if(255==e[0]&&254==e[1])return mo(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return mo(tn(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(a){if(255==e[0]&&254==e[1])return mo(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return mo(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"‚Ç¨":"¬Ä","‚Äö":"¬Ç","∆í":"¬É","‚Äû":"¬Ñ","‚Ä¶":"¬Ö","‚Ä†":"¬Ü","‚Ä°":"¬á","ÀÜ":"¬à","‚Ä∞":"¬â","≈†":"¬ä","‚Äπ":"¬ã","≈í":"¬å","≈Ω":"¬é","‚Äò":"¬ë","‚Äô":"¬í","‚Äú":"¬ì","‚Äù":"¬î","‚Ä¢":"¬ï","‚Äì":"¬ñ","‚Äî":"¬ó","Àú":"¬ò","‚Ñ¢":"¬ô","≈°":"¬ö","‚Ä∫":"¬õ","≈ì":"¬ú","≈æ":"¬û","≈∏":"¬ü"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[‚Ç¨‚Äö∆í‚Äû‚Ä¶‚Ä†‚Ä°ÀÜ‚Ä∞≈†‚Äπ≈í≈Ω‚Äò‚Äô‚Äú‚Äù‚Ä¢‚Äì‚ÄîÀú‚Ñ¢≈°‚Ä∫≈ì≈æ≈∏]/g,function(e){return t[e]||e})}catch(n){}for(var r=[],s=0;s!=e.length;++s)r.push(String.fromCharCode(e[s]));return r.join("")}function Ai(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var a={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=Ai(e[t]));return a}function _i(e,a){for(var t="";t.length<a;)t+=e;return t}function Ri(e){var a=Number(e);if(!isNaN(a))return isFinite(a)?a:NaN;if(!/\d/.test(e))return a;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(a=Number(r))?(r=r.replace(/[(](.*)[)]/,function(e,a){return t=-t,a}),isNaN(a=Number(r))?a:a/t):a/t}var Oi=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ii(e){var a=new Date(e),t=new Date(NaN),r=a.getYear(),s=a.getMonth(),n=a.getDate();if(isNaN(n))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Oi.indexOf(i))return t}else if(i.match(/[a-z]/))return t;return r<0||r>8099?t:(s>0||n>1)&&101!=r?a:e.match(/[^-0-9:,\/\\]/)?t:a}var Mi=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(a,t,r){if(e||"string"==typeof t)return a.split(t);for(var s=a.split(t),n=[s[0]],i=1;i<s.length;++i)n.push(r),n.push(s[i]);return n}}();function Pi(e){return e?e.content&&e.type?Ci(e.content,!0):e.data?sn(e.data):e.asNodeBuffer&&hn?sn(e.asNodeBuffer().toString("binary")):e.asBinary?sn(e.asBinary()):e._data&&e._data.getContent?sn(Ci(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Li(e){if(!e)return null;if(e.data)return an(e.data);if(e.asNodeBuffer&&hn)return e.asNodeBuffer();if(e._data&&e._data.getContent){var a=e._data.getContent();return"string"==typeof a?an(a):Array.prototype.slice.call(a)}return e.content&&e.type?e.content:null}function Di(e,a){for(var t=e.FullPaths||gi(e.files),r=a.toLowerCase().replace(/[\/]/g,"\\"),s=r.replace(/\\/g,"/"),n=0;n<t.length;++n){var i=t[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==i||s==i)return e.files?e.files[t[n]]:e.FileIndex[n]}return null}function Fi(e,a){var t=Di(e,a);if(null==t)throw new Error("Cannot find file "+a+" in zip");return t}function zi(e,a,t){if(!t)return(r=Fi(e,a))&&".bin"===r.name.slice(-4)?Li(r):Pi(r);var r;if(!a)return null;try{return zi(e,a)}catch(s){return null}}function Bi(e,a,t){if(!t)return Pi(Fi(e,a));if(!a)return null;try{return Bi(e,a)}catch(r){return null}}function Ui(e){for(var a=e.FullPaths||gi(e.files),t=[],r=0;r<a.length;++r)"/"!=a[r].slice(-1)&&t.push(a[r].replace(/^Root Entry[\/]/,""));return t.sort()}function $i(e,a,t){if(e.FullPaths){var r;if("string"==typeof t)return r=hn?un(t):function(e){for(var a=[],t=0,r=e.length+250,s=mn(e.length+255),n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i<128)s[t++]=i;else if(i<2048)s[t++]=192|i>>6&31,s[t++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++n);s[t++]=240|i>>8&7,s[t++]=128|i>>2&63,s[t++]=128|o>>6&15|(3&i)<<4,s[t++]=128|63&o}else s[t++]=224|i>>12&15,s[t++]=128|i>>6&63,s[t++]=128|63&i;t>r&&(a.push(s.slice(0,t)),t=0,s=mn(65535),r=65530)}return a.push(s.slice(0,t)),bn(a)}(t),fi.utils.cfb_add(e,a,r);fi.utils.cfb_add(e,a,t)}else e.file(a,t)}function Wi(e,a){switch(a.type){case"base64":return fi.read(e,{type:"base64"});case"binary":return fi.read(e,{type:"binary"});case"buffer":case"array":return fi.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+a.type)}function Vi(e,a){if("/"==e.charAt(0))return e.slice(1);var t=a.split("/");"/"!=a.slice(-1)&&t.pop();for(var r=e.split("/");0!==r.length;){var s=r.shift();".."===s?t.pop():"."!==s&&t.push(s)}return t.join("/")}var Hi='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Gi=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qi=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Xi=Hi.match(qi)?qi:/<[^>]*>/g,Yi=/<\w*:/,Ki=/<(\/?)\w+:/;function Ji(e,a,t){for(var r={},s=0,n=0;s!==e.length&&(32!==(n=e.charCodeAt(s))&&10!==n&&13!==n);++s);if(a||(r[0]=e.slice(0,s)),s===e.length)return r;var i=e.match(Gi),o=0,l="",c=0,d="",h="",u=1;if(i)for(c=0;c!=i.length;++c){for(h=i[c],n=0;n!=h.length&&61!==h.charCodeAt(n);++n);for(d=h.slice(0,n).trim();32==h.charCodeAt(n+1);)++n;for(u=34==(s=h.charCodeAt(n+1))||39==s?1:0,l=h.slice(n+1+u,h.length-u),o=0;o!=d.length&&58!==d.charCodeAt(o);++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),r[d]=l,r[d.toLowerCase()]=l;else{var m=(5===o&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(o+1);if(r[m]&&"ext"==d.slice(o-3,o))continue;r[m]=l,r[m.toLowerCase()]=l}}return r}function Zi(e){return e.replace(Ki,"<$1")}var Qi={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},eo=pi(Qi),ao=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,a=/_x([\da-fA-F]{4})_/gi;return function t(r){var s=r+"",n=s.indexOf("<![CDATA[");if(-1==n)return s.replace(e,function(e,a){return Qi[e]||String.fromCharCode(parseInt(a,e.indexOf("x")>-1?16:10))||e}).replace(a,function(e,a){return String.fromCharCode(parseInt(a,16))});var i=s.indexOf("]]>");return t(s.slice(0,n))+s.slice(n+9,i)+t(s.slice(i+3))}}(),to=/[&<>'"]/g,ro=/[\u0000-\u001f]/g;function so(e){return(e+"").replace(to,function(e){return eo[e]}).replace(/\n/g,"<br/>").replace(ro,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var no=function(){var e=/&#(\d+);/g;function a(e,a){return String.fromCharCode(parseInt(a,10))}return function(t){return t.replace(e,a)}}();function io(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function oo(e){for(var a="",t=0,r=0,s=0,n=0,i=0,o=0;t<e.length;)(r=e.charCodeAt(t++))<128?a+=String.fromCharCode(r):(s=e.charCodeAt(t++),r>191&&r<224?(i=(31&r)<<6,i|=63&s,a+=String.fromCharCode(i)):(n=e.charCodeAt(t++),r<240?a+=String.fromCharCode((15&r)<<12|(63&s)<<6|63&n):(o=((7&r)<<18|(63&s)<<12|(63&n)<<6|63&(i=e.charCodeAt(t++)))-65536,a+=String.fromCharCode(55296+(o>>>10&1023)),a+=String.fromCharCode(56320+(1023&o)))));return a}function lo(e){var a,t,r,s=mn(2*e.length),n=1,i=0,o=0;for(t=0;t<e.length;t+=n)n=1,(r=e.charCodeAt(t))<128?a=r:r<224?(a=64*(31&r)+(63&e.charCodeAt(t+1)),n=2):r<240?(a=4096*(15&r)+64*(63&e.charCodeAt(t+1))+(63&e.charCodeAt(t+2)),n=3):(n=4,a=262144*(7&r)+4096*(63&e.charCodeAt(t+1))+64*(63&e.charCodeAt(t+2))+(63&e.charCodeAt(t+3)),o=55296+((a-=65536)>>>10&1023),a=56320+(1023&a)),0!==o&&(s[i++]=255&o,s[i++]=o>>>8,o=0),s[i++]=a%256,s[i++]=a>>>8;return s.slice(0,i).toString("ucs2")}function co(e){return un(e,"binary").toString("utf8")}var ho="foo bar baz√¢¬ò¬É√∞¬ü¬ç¬£",uo=hn&&(co(ho)==oo(ho)&&co||lo(ho)==oo(ho)&&lo)||oo,mo=hn?function(e){return un(e,"utf8").toString("binary")}:function(e){for(var a=[],t=0,r=0,s=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:a.push(String.fromCharCode(r));break;case r<2048:a.push(String.fromCharCode(192+(r>>6))),a.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,s=e.charCodeAt(t++)-56320+(r<<10),a.push(String.fromCharCode(240+(s>>18&7))),a.push(String.fromCharCode(144+(s>>12&63))),a.push(String.fromCharCode(128+(s>>6&63))),a.push(String.fromCharCode(128+(63&s)));break;default:a.push(String.fromCharCode(224+(r>>12))),a.push(String.fromCharCode(128+(r>>6&63))),a.push(String.fromCharCode(128+(63&r)))}return a.join("")},fo=function(){var e={};return function(a,t){var r=a+"|"+(t||"");return e[r]?e[r]:e[r]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",t||"")}}(),go=function(){var e=[["nbsp"," "],["middot","¬∑"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(a){for(var t=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)t=t.replace(e[r][0],e[r][1]);return t}}(),po=function(){var e={};return function(a){return void 0!==e[a]?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}}(),xo=/<\/?(?:vt:)?variant>/g,bo=/<(?:vt:)([^>]*)>([\s\S]*)</;function vo(e,a){var t=Ji(e),r=e.match(po(t.baseType))||[],s=[];if(r.length!=t.size){if(a.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return s}return r.forEach(function(e){var a=e.replace(xo,"").match(bo);a&&s.push({v:uo(a[2]),t:a[1]})}),s}var yo=/(^\s|\s$|\n)/;function wo(e,a,t){return"<"+e+(null!=t?function(e){return gi(e).map(function(a){return" "+a+'="'+e[a]+'"'}).join("")}(t):"")+(null!=a?(a.match(yo)?' xml:space="preserve"':"")+">"+a+"</"+e:"/")+">"}function No(e){if(hn&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return uo(pn(xn(e)));throw new Error("Bad input format: expected Buffer or string")}var jo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,ko="http://schemas.openxmlformats.org/package/2006/content-types",Eo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var To=function(e){for(var a=[],t=0;t<e[0].length;++t)if(e[0][t])for(var r=0,s=e[0][t].length;r<s;r+=10240)a.push.apply(a,e[0][t].slice(r,r+10240));return a},So=hn?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:un(e)})):To(e)}:To,Co=function(e,a,t){for(var r=[],s=a;s<t;s+=2)r.push(String.fromCharCode(Xo(e,s)));return r.join("").replace(vn,"")},Ao=hn?function(e,a,t){return Buffer.isBuffer(e)?e.toString("utf16le",a,t).replace(vn,""):Co(e,a,t)}:Co,_o=function(e,a,t){for(var r=[],s=a;s<a+t;++s)r.push(("0"+e[s].toString(16)).slice(-2));return r.join("")},Ro=hn?function(e,a,t){return Buffer.isBuffer(e)?e.toString("hex",a,a+t):_o(e,a,t)}:_o,Oo=function(e,a,t){for(var r=[],s=a;s<t;s++)r.push(String.fromCharCode(qo(e,s)));return r.join("")},Io=hn?function(e,a,t){return Buffer.isBuffer(e)?e.toString("utf8",a,t):Oo(e,a,t)}:Oo,Mo=function(e,a){var t=Ko(e,a);return t>0?Io(e,a+4,a+4+t-1):""},Po=Mo,Lo=function(e,a){var t=Ko(e,a);return t>0?Io(e,a+4,a+4+t-1):""},Do=Lo,Fo=function(e,a){var t=2*Ko(e,a);return t>0?Io(e,a+4,a+4+t-1):""},zo=Fo,Bo=function(e,a){var t=Ko(e,a);return t>0?Ao(e,a+4,a+4+t):""},Uo=Bo,$o=function(e,a){var t=Ko(e,a);return t>0?Io(e,a+4,a+4+t):""},Wo=$o,Vo=function(e,a){return function(e,a){for(var t=1-2*(e[a+7]>>>7),r=((127&e[a+7])<<4)+(e[a+6]>>>4&15),s=15&e[a+6],n=5;n>=0;--n)s=256*s+e[a+n];return 2047==r?0==s?t*(1/0):NaN:(0==r?r=-1022:(r-=1023,s+=Math.pow(2,52)),t*Math.pow(2,r-52)*s)}(e,a)},Ho=Vo,Go=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};hn&&(Po=function(e,a){if(!Buffer.isBuffer(e))return Mo(e,a);var t=e.readUInt32LE(a);return t>0?e.toString("utf8",a+4,a+4+t-1):""},Do=function(e,a){if(!Buffer.isBuffer(e))return Lo(e,a);var t=e.readUInt32LE(a);return t>0?e.toString("utf8",a+4,a+4+t-1):""},zo=function(e,a){if(!Buffer.isBuffer(e))return Fo(e,a);var t=2*e.readUInt32LE(a);return e.toString("utf16le",a+4,a+4+t-1)},Uo=function(e,a){if(!Buffer.isBuffer(e))return Bo(e,a);var t=e.readUInt32LE(a);return e.toString("utf16le",a+4,a+4+t)},Wo=function(e,a){if(!Buffer.isBuffer(e))return $o(e,a);var t=e.readUInt32LE(a);return e.toString("utf8",a+4,a+4+t)},Ho=function(e,a){return Buffer.isBuffer(e)?e.readDoubleLE(a):Vo(e,a)},Go=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array});var qo=function(e,a){return e[a]},Xo=function(e,a){return 256*e[a+1]+e[a]},Yo=function(e,a){var t=256*e[a+1]+e[a];return t<32768?t:-1*(65535-t+1)},Ko=function(e,a){return e[a+3]*(1<<24)+(e[a+2]<<16)+(e[a+1]<<8)+e[a]},Jo=function(e,a){return e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a]},Zo=function(e,a){return e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]};function Qo(e,a){var t,r,s,n,i,o,l="",c=[];switch(a){case"dbcs":if(o=this.l,hn&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(Xo(this,o)),o+=2;e*=2;break;case"utf8":l=Io(this,this.l,this.l+e);break;case"utf16le":e*=2,l=Ao(this,this.l,this.l+e);break;case"wstr":return Qo.call(this,e,"dbcs");case"lpstr-ansi":l=Po(this,this.l),e=4+Ko(this,this.l);break;case"lpstr-cp":l=Do(this,this.l),e=4+Ko(this,this.l);break;case"lpwstr":l=zo(this,this.l),e=4+2*Ko(this,this.l);break;case"lpp4":e=4+Ko(this,this.l),l=Uo(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Ko(this,this.l),l=Wo(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(s=qo(this,this.l+e++));)c.push(nn(s));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(s=Xo(this,this.l+e));)c.push(nn(s)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return s=qo(this,o),this.l=o+1,n=Qo.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),c.join("")+n;c.push(nn(Xo(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return s=qo(this,o),this.l=o+1,n=Qo.call(this,e-i,s?"dbcs-cont":"sbcs-cont"),c.join("")+n;c.push(nn(qo(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return t=qo(this,this.l),this.l++,t;case 2:return t=("i"===a?Yo:Xo)(this,this.l),this.l+=2,t;case 4:case-4:return"i"!==a&&128&this[this.l+3]?(r=Ko(this,this.l),this.l+=4,r):(t=(e>0?Jo:Zo)(this,this.l),this.l+=4,t);case 8:case-8:if("f"===a)return r=8==e?Ho(this,this.l):Ho([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=Ro(this,this.l,e)}}return this.l+=e,l}var el=function(e,a,t){e[t]=255&a,e[t+1]=a>>>8&255,e[t+2]=a>>>16&255,e[t+3]=a>>>24&255},al=function(e,a,t){e[t]=255&a,e[t+1]=a>>8&255,e[t+2]=a>>16&255,e[t+3]=a>>24&255},tl=function(e,a,t){e[t]=255&a,e[t+1]=a>>>8&255};function rl(e,a,t){var r=0,s=0;if("dbcs"===t){for(s=0;s!=a.length;++s)tl(this,a.charCodeAt(s),this.l+2*s);r=2*a.length}else if("sbcs"===t){for(a=a.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=a.length;++s)this[this.l+s]=255&a.charCodeAt(s);r=a.length}else{if("hex"===t){for(;s<e;++s)this[this.l++]=parseInt(a.slice(2*s,2*s+2),16)||0;return this}if("utf16le"===t){var n=Math.min(this.l+e,this.length);for(s=0;s<Math.min(a.length,e);++s){var i=a.charCodeAt(s);this[this.l++]=255&i,this[this.l++]=i>>8}for(;this.l<n;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&a;break;case 2:r=2,this[this.l]=255&a,a>>>=8,this[this.l+1]=255&a;break;case 3:r=3,this[this.l]=255&a,a>>>=8,this[this.l+1]=255&a,a>>>=8,this[this.l+2]=255&a;break;case 4:r=4,el(this,a,this.l);break;case 8:if(r=8,"f"===t){!function(e,a,t){var r=(a<0||1/a==-1/0?1:0)<<7,s=0,n=0,i=r?-a:a;isFinite(i)?0==i?s=n=0:(s=Math.floor(Math.log(i)/Math.LN2),n=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(a)?26985:0);for(var o=0;o<=5;++o,n/=256)e[t+o]=255&n;e[t+6]=(15&s)<<4|15&n,e[t+7]=s>>4|r}(this,a,this.l);break}case 16:break;case-4:r=4,al(this,a,this.l)}}return this.l+=r,this}function sl(e,a){var t=Ro(this,this.l,e.length>>1);if(t!==e)throw new Error(a+"Expected "+e+" saw "+t);this.l+=e.length>>1}function nl(e,a){e.l=a,e.read_shift=Qo,e.chk=sl,e.write_shift=rl}function il(e,a){e.l+=a}function ol(e){var a=mn(e);return nl(a,0),a}function ll(e,a,t){if(e){var r,s,n;nl(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=gm[o]||gm[65535];for(n=127&(r=e.read_shift(1)),s=1;s<4&&128&r;++s)n+=(127&(r=e.read_shift(1)))<<7*s;l=e.l+n;var d=c.f&&c.f(e,n,t);if(e.l=l,a(d,c,o))return}}}function cl(){var e=[],a=hn?256:2048,t=function(e){var a=ol(e);return nl(a,0),a},r=t(a),s=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},n=function(e){return r&&e<r.length-r.l?r:(s(),r=t(Math.max(e+1,a)))};return{next:n,push:function(e){s(),null==(r=e).l&&(r.l=r.length),n(a)},end:function(){return s(),bn(e)},_bufs:e}}function dl(e,a,t){var r=Ai(e);if(a.s?(r.cRel&&(r.c+=a.s.c),r.rRel&&(r.r+=a.s.r)):(r.cRel&&(r.c+=a.c),r.rRel&&(r.r+=a.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function hl(e,a,t){var r=Ai(e);return r.s=dl(r.s,a.s,t),r.e=dl(r.e,a.s,t),r}function ul(e,a){if(e.cRel&&e.c<0)for(e=Ai(e);e.c<0;)e.c+=a>8?16384:256;if(e.rRel&&e.r<0)for(e=Ai(e);e.r<0;)e.r+=a>8?1048576:a>5?65536:16384;var t=vl(e);return e.cRel||null==e.cRel||(t=t.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(t=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(t)),t}function ml(e,a){return 0!=e.s.r||e.s.rRel||e.e.r!=(a.biff>=12?1048575:a.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(a.biff>=12?16383:255)||e.e.cRel?ul(e.s,a.biff)+":"+ul(e.e,a.biff):(e.s.rRel?"":"$")+gl(e.s.r)+":"+(e.e.rRel?"":"$")+gl(e.e.r):(e.s.cRel?"":"$")+xl(e.s.c)+":"+(e.e.cRel?"":"$")+xl(e.e.c)}function fl(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function gl(e){return""+(e+1)}function pl(e){for(var a=e.replace(/^\$([A-Z])/,"$1"),t=0,r=0;r!==a.length;++r)t=26*t+a.charCodeAt(r)-64;return t-1}function xl(e){if(e<0)throw new Error("invalid column "+e);var a="";for(++e;e;e=Math.floor((e-1)/26))a=String.fromCharCode((e-1)%26+65)+a;return a}function bl(e){for(var a=0,t=0,r=0;r<e.length;++r){var s=e.charCodeAt(r);s>=48&&s<=57?a=10*a+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:a-1}}function vl(e){for(var a=e.c+1,t="";a;a=(a-1)/26|0)t=String.fromCharCode((a-1)%26+65)+t;return t+(e.r+1)}function yl(e){var a=e.indexOf(":");return-1==a?{s:bl(e),e:bl(e)}:{s:bl(e.slice(0,a)),e:bl(e.slice(a+1))}}function wl(e,a){return void 0===a||"number"==typeof a?wl(e.s,e.e):("string"!=typeof e&&(e=vl(e)),"string"!=typeof a&&(a=vl(a)),e==a?e:e+":"+a)}function Nl(e){var a={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,s=0,n=e.length;for(t=0;r<n&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)t=26*t+s;for(a.s.c=--t,t=0;r<n&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)t=10*t+s;if(a.s.r=--t,r===n||10!=s)return a.e.c=a.s.c,a.e.r=a.s.r,a;for(++r,t=0;r!=n&&!((s=e.charCodeAt(r)-64)<1||s>26);++r)t=26*t+s;for(a.e.c=--t,t=0;r!=n&&!((s=e.charCodeAt(r)-48)<0||s>9);++r)t=10*t+s;return a.e.r=--t,a}function jl(e,a){var t="d"==e.t&&a instanceof Date;if(null!=e.z)try{return e.w=li(e.z,t?bi(a):a)}catch(r){}try{return e.w=li((e.XF||{}).numFmtId||(t?14:0),t?bi(a):a)}catch(r){return""+a}}function kl(e,a,t){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),"e"==e.t?Jl[e.v]||e.v:jl(e,null==a?e.v:a))}function El(e,a){var t=a&&a.sheet?a.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function Tl(e,a,t){var r=t||{},s=e?Array.isArray(e):r.dense,n=e||(s?[]:{}),i=0,o=0;if(n&&null!=r.origin){if("number"==typeof r.origin)i=r.origin;else{var l="string"==typeof r.origin?bl(r.origin):r.origin;i=l.r,o=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=Nl(n["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var h=0;h!=a.length;++h)if(a[h]){if(!Array.isArray(a[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=a[h].length;++u)if(void 0!==a[h][u]){var m={v:a[h][u]},f=i+h,g=o+u;if(c.s.r>f&&(c.s.r=f),c.s.c>g&&(c.s.c=g),c.e.r<f&&(c.e.r=f),c.e.c<g&&(c.e.c=g),!a[h][u]||"object"!=typeof a[h][u]||Array.isArray(a[h][u])||a[h][u]instanceof Date)if(Array.isArray(m.v)&&(m.f=a[h][u][1],m.v=m.v[0]),null===m.v)if(m.f)m.t="n";else if(r.nullError)m.t="e",m.v=0;else{if(!r.sheetStubs)continue;m.t="z"}else"number"==typeof m.v?m.t="n":"boolean"==typeof m.v?m.t="b":m.v instanceof Date?(m.z=r.dateNF||_n[14],r.cellDates?(m.t="d",m.w=li(m.z,bi(m.v))):(m.t="n",m.v=bi(m.v),m.w=li(m.z,m.v))):m.t="s";else m=a[h][u];if(s)n[f]||(n[f]=[]),n[f][g]&&n[f][g].z&&(m.z=n[f][g].z),n[f][g]=m;else{var p=vl({c:g,r:f});n[p]&&n[p].z&&(m.z=n[p].z),n[p]=m}}}return c.s.c<1e7&&(n["!ref"]=wl(c)),n}function Sl(e,a){return Tl(null,e,a)}function Cl(e){var a=e.read_shift(4);return 0===a?"":e.read_shift(a,"dbcs")}function Al(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function _l(e,a){var t=e.l,r=e.read_shift(1),s=Cl(e),n=[],i={t:s,h:s};if(1&r){for(var o=e.read_shift(4),l=0;l!=o;++l)n.push(Al(e));i.r=n}else i.r=[{ich:0,ifnt:0}];return e.l=t+a,i}var Rl=_l;function Ol(e){var a=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:a,iStyleRef:t}}function Il(e){var a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:a}}var Ml=Cl;function Pl(e){var a=e.read_shift(4);return 0===a||4294967295===a?"":e.read_shift(a,"dbcs")}var Ll=Cl,Dl=Pl;function Fl(e){var a=e.slice(e.l,e.l+4),t=1&a[0],r=2&a[0];e.l+=4;var s=0===r?Ho([0,0,0,0,252&a[0],a[1],a[2],a[3]],0):Jo(a,0)>>2;return t?s/100:s}function zl(e){var a={s:{},e:{}};return a.s.r=e.read_shift(4),a.e.r=e.read_shift(4),a.s.c=e.read_shift(4),a.e.c=e.read_shift(4),a}var Bl=zl;function Ul(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function $l(e,a){var t=e.read_shift(4);switch(t){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(t>400)throw new Error("Unsupported Clipboard: "+t.toString(16));return e.l-=4,e.read_shift(0,1==a?"lpstr":"lpwstr")}var Wl=80,Vl=[Wl,81],Hl={1:{n:"CodePage",t:2},2:{n:"Category",t:Wl},3:{n:"PresentationFormat",t:Wl},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Wl},15:{n:"Company",t:Wl},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Wl},27:{n:"ContentStatus",t:Wl},28:{n:"Language",t:Wl},29:{n:"Version",t:Wl},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Gl={1:{n:"CodePage",t:2},2:{n:"Title",t:Wl},3:{n:"Subject",t:Wl},4:{n:"Author",t:Wl},5:{n:"Keywords",t:Wl},6:{n:"Comments",t:Wl},7:{n:"Template",t:Wl},8:{n:"LastAuthor",t:Wl},9:{n:"RevNumber",t:Wl},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Wl},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},ql={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Xl=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Yl(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var Kl=Ai(Yl([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Jl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Zl={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ql={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var ec={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ac(e){var a=e.lastIndexOf("/");return e.slice(0,a+1)+"_rels/"+e.slice(a+1)+".rels"}function tc(e,a){var t={"!id":{}};if(!e)return t;"/"!==a.charAt(0)&&(a="/"+a);var r={};return(e.match(Xi)||[]).forEach(function(e){var s=Ji(e);if("<Relationship"===s[0]){var n={};n.Type=s.Type,n.Target=s.Target,n.Id=s.Id,s.TargetMode&&(n.TargetMode=s.TargetMode);var i="External"===s.TargetMode?s.Target:Vi(s.Target,a);t[i]=n,r[s.Id]=n}}),t["!id"]=r,t}var rc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],sc=function(){for(var e=new Array(rc.length),a=0;a<rc.length;++a){var t=rc[a],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[a]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function nc(e){var a={};e=uo(e);for(var t=0;t<rc.length;++t){var r=rc[t],s=e.match(sc[t]);null!=s&&s.length>0&&(a[r[1]]=ao(s[1])),"date"===r[2]&&a[r[1]]&&(a[r[1]]=Si(a[r[1]]))}return a}var ic=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function oc(e,a,t,r){var s=[];if("string"==typeof e)s=vo(e,r);else for(var n=0;n<e.length;++n)s=s.concat(e[n].map(function(e){return{v:e}}));var i="string"==typeof a?vo(a,r).map(function(e){return e.v}):a,o=0,l=0;if(i.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"Â∑•‰ΩúË°®":case"–õ–∏—Å—Ç—ã":case"ÿ£Ÿàÿ±ÿßŸÇ ÿßŸÑÿπŸÖŸÑ":case"„ÉØ„Éº„ÇØ„Ç∑„Éº„Éà":case"◊í◊ú◊ô◊ï◊†◊ï◊™ ◊¢◊ë◊ï◊ì◊î":case"Arbeitsbl√§tter":case"√áalƒ±≈üma Sayfalarƒ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c√°lculo":case"Planilhas":case"Regneark":case"Hojas de c√°lculo":case"Werkbladen":t.Worksheets=l,t.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"ÂêçÂâç‰ªò„Åç‰∏ÄË¶ß":case"Benannte Bereiche":case"Navngivne omr√•der":t.NamedRanges=l,t.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":t.Chartsheets=l,t.ChartNames=i.slice(o,o+l)}o+=l}}var lc=/<[^>]+>[^<]*/g;var cc,dc={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function hc(e,a,t){cc||(cc=pi(dc)),e[a=cc[a]||a]=t}function uc(e){var a=e.read_shift(4),t=e.read_shift(4);return new Date(1e3*(t/1e7*Math.pow(2,32)+a/1e7-11644473600)).toISOString().replace(/\.000/,"")}function mc(e,a,t){var r=e.l,s=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return s}function fc(e,a,t){return e.read_shift(0,"lpwstr")}function gc(e,a,t){return 31===a?fc(e):mc(e,0,t)}function pc(e,a,t){return gc(e,a,!1===t?0:4)}function xc(e){var a=e.l,t=yc(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-a&2&&(e.l+=2),[t,yc(e,3)]}function bc(e,a){for(var t=e.read_shift(4),r={},s=0;s!=t;++s){var n=e.read_shift(4),i=e.read_shift(4);r[n]=e.read_shift(i,1200===a?"utf16le":"utf8").replace(vn,"").replace(yn,"!"),1200===a&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),r}function vc(e){var a=e.read_shift(4),t=e.slice(e.l,e.l+a);return e.l+=a,(3&a)>0&&(e.l+=4-(3&a)&3),t}function yc(e,a,t){var r,s=e.read_shift(2),n=t||{};if(e.l+=2,12!==a&&s!==a&&-1===Vl.indexOf(a)&&(4126!=(65534&a)||4126!=(65534&s)))throw new Error("Expected type "+a+" saw "+s);switch(12===a?s:a){case 2:return r=e.read_shift(2,"i"),n.raw||(e.l+=2),r;case 3:return r=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return r=e.read_shift(4);case 30:return mc(e,0,4).replace(vn,"");case 31:return fc(e);case 64:return uc(e);case 65:return vc(e);case 71:return function(e){var a={};return a.Size=e.read_shift(4),e.l+=a.Size+3-(a.Size-1)%4,a}(e);case 80:return pc(e,s,!n.raw).replace(vn,"");case 81:return function(e,a){if(!a)throw new Error("VtUnalignedString must have positive length");return gc(e,a,0)}(e,s).replace(vn,"");case 4108:return function(e){for(var a=e.read_shift(4),t=[],r=0;r<a/2;++r)t.push(xc(e));return t}(e);case 4126:case 4127:return 4127==s?function(e){for(var a=e.read_shift(4),t=[],r=0;r!=a;++r){var s=e.l;t[r]=e.read_shift(0,"lpwstr").replace(vn,""),e.l-s&2&&(e.l+=2)}return t}(e):function(e){for(var a=e.read_shift(4),t=[],r=0;r!=a;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(vn,"");return t}(e);default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+s)}}function wc(e,a){var t=e.l,r=e.read_shift(4),s=e.read_shift(4),n=[],i=0,o=0,l=-1,c={};for(i=0;i!=s;++i){var d=e.read_shift(4),h=e.read_shift(4);n[i]=[d,h+t]}n.sort(function(e,a){return e[1]-a[1]});var u={};for(i=0;i!=s;++i){if(e.l!==n[i][1]){var m=!0;if(i>0&&a)switch(a[n[i-1][0]].t){case 2:e.l+2===n[i][1]&&(e.l+=2,m=!1);break;case 80:case 4108:e.l<=n[i][1]&&(e.l=n[i][1],m=!1)}if((!a||0==i)&&e.l<=n[i][1]&&(m=!1,e.l=n[i][1]),m)throw new Error("Read Error: Expected address "+n[i][1]+" at "+e.l+" :"+i)}if(a){var f=a[n[i][0]];if(u[f.n]=yc(e,f.t,{raw:!0}),"version"===f.p&&(u[f.n]=String(u[f.n]>>16)+"."+("0000"+String(65535&u[f.n])).slice(-4)),"CodePage"==f.n)switch(u[f.n]){case 0:u[f.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Qs(o=u[f.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+u[f.n])}}else if(1===n[i][0]){if(o=u.CodePage=yc(e,2),Qs(o),-1!==l){var g=e.l;e.l=n[l][1],c=bc(e,o),e.l=g}}else if(0===n[i][0]){if(0===o){l=i,e.l=n[i+1][1];continue}c=bc(e,o)}else{var p,x=c[n[i][0]];switch(e[e.l]){case 65:e.l+=4,p=vc(e);break;case 30:case 31:e.l+=4,p=pc(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,p=e.read_shift(4,"i");break;case 19:e.l+=4,p=e.read_shift(4);break;case 5:e.l+=4,p=e.read_shift(8,"f");break;case 11:e.l+=4,p=kc(e,4);break;case 64:e.l+=4,p=Si(uc(e));break;default:throw new Error("unparsed value: "+e[e.l])}u[x]=p}}return e.l=t+r,u}function Nc(e,a,t){var r=e.content;if(!r)return{};nl(r,0);var s,n,i,o,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),d=r.read_shift(16);if(d!==fi.utils.consts.HEADER_CLSID&&d!==t)throw new Error("Bad PropertySet CLSID "+d);if(1!==(s=r.read_shift(4))&&2!==s)throw new Error("Unrecognized #Sets: "+s);if(n=r.read_shift(16),o=r.read_shift(4),1===s&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);2===s&&(i=r.read_shift(16),l=r.read_shift(4));var h,u=wc(r,a),m={SystemIdentifier:c};for(var f in u)m[f]=u[f];if(m.FMTID=n,1===s)return m;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);try{h=wc(r,null)}catch(g){}for(f in h)m[f]=h[f];return m.FMTID=[n,i],m}function jc(e,a){return e.read_shift(a),null}function kc(e,a){return 1===e.read_shift(a)}function Ec(e){return e.read_shift(2,"u")}function Tc(e,a){return function(e,a,t){for(var r=[],s=e.l+a;e.l<s;)r.push(t(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return r}(e,a,Ec)}function Sc(e,a,t){var r=e.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";(t&&t.biff,t&&8!=t.biff)?12==t.biff&&(s="wstr"):e.read_shift(1)&&(s="dbcs-cont");return t.biff>=2&&t.biff<=5&&(s="cpstr"),r?e.read_shift(r,s):""}function Cc(e){var a,t=e.read_shift(2),r=e.read_shift(1),s=4&r,n=8&r,i=1+(1&r),o=0,l={};n&&(o=e.read_shift(2)),s&&(a=e.read_shift(4));var c=2==i?"dbcs-cont":"sbcs-cont",d=0===t?"":e.read_shift(t,c);return n&&(e.l+=4*o),s&&(e.l+=a),l.t=d,n||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Ac(e,a,t){if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(a,"cpstr");if(t.biff>=12)return e.read_shift(a,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(a,"sbcs-cont"):e.read_shift(a,"dbcs-cont")}function _c(e,a,t){var r=e.read_shift(t&&2==t.biff?1:2);return 0===r?(e.l++,""):Ac(e,r,t)}function Rc(e,a,t){if(t.biff>5)return _c(e,0,t);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Oc(e,a){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var a=e.read_shift(4),t=e.l,r=!1;a>24&&(e.l+=a-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(r=!0),e.l=t);var s=e.read_shift((r?a-24:a)>>1,"utf16le").replace(vn,"");return r&&(e.l+=24),s}(e);case"0303000000000000c000000000000046":return function(e){for(var a=e.read_shift(2),t="";a-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return t+r.replace(/\\/g,"/");var s=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return t+e.read_shift(s>>1,"utf16le").replace(vn,"")}(e);default:throw new Error("Unsupported Moniker "+t)}}function Ic(e){var a=e.read_shift(4);return a>0?e.read_shift(a,"utf16le").replace(vn,""):""}function Mc(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Pc(e,a){var t=Mc(e);return t[3]=0,t}function Lc(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Dc(e,a,t){var r=t.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function Fc(e){return[e.read_shift(2),Fl(e)]}function zc(e){var a=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(2),r:a},e:{c:e.read_shift(2),r:t}}}function Bc(e){var a=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(1),r:a},e:{c:e.read_shift(1),r:t}}}var Uc=Bc;function $c(e){e.l+=4;var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,a,r]}function Wc(e){e.l+=2,e.l+=e.read_shift(2)}var Vc={0:Wc,4:Wc,5:Wc,6:Wc,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:Wc,9:Wc,10:Wc,11:Wc,12:Wc,13:function(e){var a={};return e.l+=4,e.l+=16,a.fSharedNote=e.read_shift(2),e.l+=4,a},14:Wc,15:Wc,16:Wc,17:Wc,18:Wc,19:Wc,20:Wc,21:$c};function Hc(e,a){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),(a-=2)>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(a>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(a),t}function Gc(e,a,t){var r=0;t&&2==t.biff||(r=e.read_shift(2));var s=e.read_shift(2);return t&&2==t.biff&&(r=1-(s>>15),s&=32767),[{Unsynced:1&r,DyZero:(2&r)>>1,ExAsc:(4&r)>>2,ExDsc:(8&r)>>3},s]}var qc=Rc;function Xc(e,a,t){var r=e.l+a,s=8!=t.biff&&t.biff?2:4,n=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:n,c:o},e:{r:i,c:l}}}function Yc(e,a,t){var r=Lc(e);2!=t.biff&&9!=a||++e.l;var s=function(e){var a=e.read_shift(1);return 1===e.read_shift(1)?a:1===a}(e);return r.val=s,r.t=!0===s||!1===s?"b":"e",r}var Kc=function(e,a,t){return 0===a?"":Rc(e,0,t)};function Jc(e,a,t){var r,s=e.read_shift(2),n={fBuiltIn:1&s,fWantAdvise:s>>>1&1,fWantPict:s>>>2&1,fOle:s>>>3&1,fOleLink:s>>>4&1,cf:s>>>5&1023,fIcon:s>>>15&1};return 14849===t.sbcch&&(r=function(e,a,t){e.l+=4,a-=4;var r=e.l+a,s=Sc(e,0,t),n=e.read_shift(2);if(n!==(r-=e.l))throw new Error("Malformed AddinUdf: padding = "+r+" != "+n);return e.l+=n,s}(e,a-2,t)),n.body=r||e.read_shift(a-2),"string"==typeof r&&(n.Name=r),n}var Zc=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Qc(e,a,t){var r=e.l+a,s=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(t&&2==t.biff?1:2),l=0;(!t||t.biff>=5)&&(5!=t.biff&&(e.l+=2),l=e.read_shift(2),5==t.biff&&(e.l+=2),e.l+=4);var c=Ac(e,i,t);32&s&&(c=Zc[c.charCodeAt(0)]);var d=r-e.l;t&&2==t.biff&&--d;var h=r!=e.l&&0!==o&&d>0?function(e,a,t,r){var s,n=e.l+a,i=Uh(e,r,t);n!==e.l&&(s=Bh(e,n-e.l,i,t));return[i,s]}(e,d,t,o):[];return{chKey:n,Name:c,itab:l,rgce:h}}function ed(e,a,t){if(t.biff<8)return function(e,a,t){3==e[e.l+1]&&e[e.l]++;var r=Sc(e,0,t);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,t);for(var r=[],s=e.l+a,n=e.read_shift(t.biff>8?4:2);0!==n--;)r.push(Dc(e,t.biff,t));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return r}function ad(e,a,t){var r=Uc(e);switch(t.biff){case 2:e.l++,a-=7;break;case 3:case 4:e.l+=2,a-=8;break;default:e.l+=6,a-=12}return[r,qh(e,a,t)]}var td={8:function(e,a){var t=e.l+a;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=t,{fmt:r}}};function rd(e,a,t){if(!t.cellStyles)return il(e,a);var r=t&&t.biff>=12?4:2,s=e.read_shift(r),n=e.read_shift(r),i=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:s,e:n,w:i,ixfe:o,flags:l};return(t.biff>=5||!t.biff)&&(c.level=l>>8&7),c}var sd=Lc,nd=Tc,id=_c;var od=[2,3,48,49,131,139,140,245],ld=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},a=pi({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(a,t){var r=t||{};r.dateNF||(r.dateNF="yyyymmdd");var s=Sl(function(a,t){var r=[],s=mn(1);switch(t.type){case"base64":s=gn(dn(a));break;case"binary":s=gn(a);break;case"buffer":case"array":s=a}nl(s,0);var n=s.read_shift(1),i=!!(136&n),o=!1,l=!1;switch(n){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+n.toString(16))}var c=0,d=521;2==n&&(c=s.read_shift(2)),s.l+=3,2!=n&&(c=s.read_shift(4)),c>1048576&&(c=1e6),2!=n&&(d=s.read_shift(2));var h=s.read_shift(2),u=t.codepage||1252;2!=n&&(s.l+=16,s.read_shift(1),0!==s[s.l]&&(u=e[s[s.l]]),s.l+=1,s.l+=2),l&&(s.l+=36);for(var m=[],f={},g=Math.min(s.length,2==n?521:d-10-(o?264:0)),p=l?32:11;s.l<g&&13!=s[s.l];)switch((f={}).name=rn.utils.decode(u,s.slice(s.l,s.l+p)).replace(/[\u0000\r\n].*$/g,""),s.l+=p,f.type=String.fromCharCode(s.read_shift(1)),2==n||l||(f.offset=s.read_shift(4)),f.len=s.read_shift(1),2==n&&(f.offset=s.read_shift(2)),f.dec=s.read_shift(1),f.name.length&&m.push(f),2!=n&&(s.l+=l?13:14),f.type){case"B":(!o||8!=f.len)&&t.WTF;break;case"G":case"P":t.WTF;break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+f.type)}if(13!==s[s.l]&&(s.l=d-1),13!==s.read_shift(1))throw new Error("DBF Terminator not found "+s.l+" "+s[s.l]);s.l=d;var x=0,b=0;for(r[0]=[],b=0;b!=m.length;++b)r[0][b]=m[b].name;for(;c-- >0;)if(42!==s[s.l])for(++s.l,r[++x]=[],b=0,b=0;b!=m.length;++b){var v=s.slice(s.l,s.l+m[b].len);s.l+=m[b].len,nl(v,0);var y=rn.utils.decode(u,v);switch(m[b].type){case"C":y.trim().length&&(r[x][b]=y.replace(/\s+$/,""));break;case"D":8===y.length?r[x][b]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):r[x][b]=y;break;case"F":r[x][b]=parseFloat(y.trim());break;case"+":case"I":r[x][b]=l?2147483648^v.read_shift(-4,"i"):v.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":r[x][b]=!0;break;case"N":case"F":r[x][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+n.toString(16));r[x][b]="##MEMO##"+(l?parseInt(y.trim(),10):v.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(r[x][b]=+y||0);break;case"@":r[x][b]=new Date(v.read_shift(-8,"f")-621356832e5);break;case"T":r[x][b]=new Date(864e5*(v.read_shift(4)-2440588)+v.read_shift(4));break;case"Y":r[x][b]=v.read_shift(4,"i")/1e4+v.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[x][b]=-v.read_shift(-8,"f");break;case"B":if(o&&8==m[b].len){r[x][b]=v.read_shift(8,"f");break}case"G":case"P":v.l+=m[b].len;break;case"0":if("_NullFlags"===m[b].name)break;default:throw new Error("DBF Unsupported data type "+m[b].type)}}else s.l+=h;if(2!=n&&s.l<s.length&&26!=s[s.l++])throw new Error("DBF EOF Marker missing "+(s.l-1)+" of "+s.length+" "+s[s.l-1].toString(16));return t&&t.sheetRows&&(r=r.slice(0,t.sheetRows)),t.DBF=m,r}(a,r),r);return s["!cols"]=r.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete r.DBF,s}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,a){try{return El(t(e,a),a)}catch(r){if(a&&a.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:t,from_sheet:function(e,t){var s=t||{};if(+s.codepage>=0&&Qs(+s.codepage),"string"==s.type)throw new Error("Cannot write DBF to JS string");var n=cl(),i=af(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],d=0,h=0,u=0,m=1;for(d=0;d<o.length;++d)if(((c[d]||{}).DBF||{}).name)o[d]=c[d].DBF.name,++u;else if(null!=o[d]){if(++u,"number"==typeof o[d]&&(o[d]=o[d].toString(10)),"string"!=typeof o[d])throw new Error("DBF Invalid column name "+o[d]+" |"+typeof o[d]+"|");if(o.indexOf(o[d])!==d)for(h=0;h<1024;++h)if(-1==o.indexOf(o[d]+"_"+h)){o[d]+="_"+h;break}}var f=Nl(e["!ref"]),g=[],p=[],x=[];for(d=0;d<=f.e.c-f.s.c;++d){var b="",v="",y=0,w=[];for(h=0;h<l.length;++h)null!=l[h][d]&&w.push(l[h][d]);if(0!=w.length&&null!=o[d]){for(h=0;h<w.length;++h){switch(typeof w[h]){case"number":v="B";break;case"string":default:v="C";break;case"boolean":v="L";break;case"object":v=w[h]instanceof Date?"D":"C"}y=Math.max(y,String(w[h]).length),b=b&&b!=v?"C":v}y>250&&(y=250),"C"==(v=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==b&&"N"==v&&(b="N",x[d]=c[d].DBF.dec,y=c[d].DBF.len),p[d]="C"==b||"N"==v?y:r[b]||0,m+=p[d],g[d]=b}else g[d]="?"}var N=n.next(32);for(N.write_shift(4,318902576),N.write_shift(4,l.length),N.write_shift(2,296+32*u),N.write_shift(2,m),d=0;d<4;++d)N.write_shift(4,0);for(N.write_shift(4,(+a[Ys]||3)<<8),d=0,h=0;d<o.length;++d)if(null!=o[d]){var j=n.next(32),k=(o[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,k,"sbcs"),j.write_shift(1,"?"==g[d]?"C":g[d],"sbcs"),j.write_shift(4,h),j.write_shift(1,p[d]||r[g[d]]||0),j.write_shift(1,x[d]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),h+=p[d]||r[g[d]]||0}var E=n.next(264);for(E.write_shift(4,13),d=0;d<65;++d)E.write_shift(4,0);for(d=0;d<l.length;++d){var T=n.next(m);for(T.write_shift(1,0),h=0;h<o.length;++h)if(null!=o[h])switch(g[h]){case"L":T.write_shift(1,null==l[d][h]?63:l[d][h]?84:70);break;case"B":T.write_shift(8,l[d][h]||0,"f");break;case"N":var S="0";for("number"==typeof l[d][h]&&(S=l[d][h].toFixed(x[h]||0)),u=0;u<p[h]-S.length;++u)T.write_shift(1,32);T.write_shift(1,S,"sbcs");break;case"D":l[d][h]?(T.write_shift(4,("0000"+l[d][h].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(l[d][h].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+l[d][h].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var C=String(null!=l[d][h]?l[d][h]:"").slice(0,p[h]);for(T.write_shift(1,C,"sbcs"),u=0;u<p[h]-C.length;++u)T.write_shift(1,32)}}return n.next(1).write_shift(1,26),n.end()}}}(),cd=function(){var e={AA:"√Ä",BA:"√Å",CA:"√Ç",DA:195,HA:"√Ñ",JA:197,AE:"√à",BE:"√â",CE:"√ä",HE:"√ã",AI:"√å",BI:"√ç",CI:"√é",HI:"√è",AO:"√í",BO:"√ì",CO:"√î",DO:213,HO:"√ñ",AU:"√ô",BU:"√ö",CU:"√õ",HU:"√ú",Aa:"√†",Ba:"√°",Ca:"√¢",Da:227,Ha:"√§",Ja:229,Ae:"√®",Be:"√©",Ce:"√™",He:"√´",Ai:"√¨",Bi:"√≠",Ci:"√Æ",Hi:"√Ø",Ao:"√≤",Bo:"√≥",Co:"√¥",Do:245,Ho:"√∂",Au:"√π",Bu:"√∫",Cu:"√ª",Hu:"√º",KC:"√á",Kc:"√ß",q:"√¶",z:"≈ì",a:"√Ü",j:"≈í",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},a=new RegExp("N("+gi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(a,t){var r=e[t];return"number"==typeof r?on(r):r},r=function(e,a,t){var r=a.charCodeAt(0)-32<<4|t.charCodeAt(0)-48;return 59==r?e:on(r)};function s(e,s){var n,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,h=[],u=[],m=null,f={},g=[],p=[],x=[],b=0;for(+s.codepage>=0&&Qs(+s.codepage);c!==i.length;++c){b=0;var v,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(a,t),w=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),N=w[0];if(y.length>0)switch(N){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&u.push(y.slice(3).replace(/;;/g,";"));break;case"C":var j=!1,k=!1,E=!1,T=!1,S=-1,C=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[d].slice(1))-1,k=!0;break;case"Y":for(o=parseInt(w[d].slice(1))-1,k||(l=0),n=h.length;n<=o;++n)h[n]=[];break;case"K":'"'===(v=w[d].slice(1)).charAt(0)?v=v.slice(1,v.length-1):"TRUE"===v?v=!0:"FALSE"===v?v=!1:isNaN(Ri(v))?isNaN(Ii(v).getDate())||(v=Si(v)):(v=Ri(v),null!==m&&si(m)&&(v=Ni(v))),j=!0;break;case"E":T=!0;var A=gh(w[d].slice(1),{r:o,c:l});h[o][l]=[h[o][l],A];break;case"S":E=!0,h[o][l]=[h[o][l],"S5S"];break;case"R":S=parseInt(w[d].slice(1))-1;break;case"C":C=parseInt(w[d].slice(1))-1;break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+y)}if(j&&(h[o][l]&&2==h[o][l].length?h[o][l][0]=v:h[o][l]=v,m=null),E){if(T)throw new Error("SYLK shared formula cannot have own formula");var _=S>-1&&h[S][C];if(!_||!_[1])throw new Error("SYLK shared formula cannot find base");h[o][l][1]=bh(_[1],{r:o-S,c:l-C})}break;case"F":var R=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":l=parseInt(w[d].slice(1))-1,++R;break;case"Y":for(o=parseInt(w[d].slice(1))-1,n=h.length;n<=o;++n)h[n]=[];break;case"M":b=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":m=u[parseInt(w[d].slice(1))];break;case"W":for(x=w[d].slice(1).split(" "),n=parseInt(x[0],10);n<=parseInt(x[1],10);++n)b=parseInt(x[2],10),p[n-1]=0===b?{hidden:!0}:{wch:b},Hd(p[n-1]);break;case"C":p[l=parseInt(w[d].slice(1))-1]||(p[l]={});break;case"R":g[o=parseInt(w[d].slice(1))-1]||(g[o]={}),b>0?(g[o].hpt=b,g[o].hpx=Xd(b)):0===b&&(g[o].hidden=!0);break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+y)}R<1&&(m=null);break;default:if(s&&s.WTF)throw new Error("SYLK bad record "+y)}}return g.length>0&&(f["!rows"]=g),p.length>0&&(f["!cols"]=p),s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),[h,f]}function n(e,a){var t=function(e,a){switch(a.type){case"base64":return s(dn(e),a);case"binary":return s(e,a);case"buffer":return s(hn&&Buffer.isBuffer(e)?e.toString("binary"):pn(e),a);case"array":return s(Ci(e),a)}throw new Error("Unrecognized type "+a.type)}(e,a),r=t[0],n=t[1],i=Sl(r,a);return gi(n).forEach(function(e){i[e]=n[e]}),i}function i(e,a,t,r){var s="C;Y"+(t+1)+";X"+(r+1)+";K";switch(e.t){case"n":s+=e.v||0,e.f&&!e.F&&(s+=";E"+xh(e.f,{r:t,c:r}));break;case"b":s+=e.v?"TRUE":"FALSE";break;case"e":s+=e.w||e.v;break;case"d":s+='"'+(e.w||e.v)+'"';break;case"s":s+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return s}return e["|"]=254,{to_workbook:function(e,a){return El(n(e,a),a)},to_sheet:n,from_sheet:function(e,a){var t,r,s=["ID;PWXL;N;E"],n=[],o=Nl(e["!ref"]),l=Array.isArray(e),c="\r\n";s.push("P;PGeneral"),s.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=s,e["!cols"].forEach(function(e,a){var t="F;W"+(a+1)+" "+(a+1)+" ";e.hidden?t+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Bd(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Ud(e.wpx)),"number"==typeof e.wch&&(t+=Math.round(e.wch)))," "!=t.charAt(t.length-1)&&r.push(t)})),e["!rows"]&&function(e,a){a.forEach(function(a,t){var r="F;";a.hidden?r+="M0;":a.hpt?r+="M"+20*a.hpt+";":a.hpx&&(r+="M"+20*qd(a.hpx)+";"),r.length>2&&e.push(r+"R"+(t+1))})}(s,e["!rows"]),s.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var d=o.s.r;d<=o.e.r;++d)for(var h=o.s.c;h<=o.e.c;++h){var u=vl({r:d,c:h});(t=l?(e[d]||[])[h]:e[u])&&(null!=t.v||t.f&&!t.F)&&n.push(i(t,0,d,h))}return s.join(c)+c+n.join(c)+c+"E"+c}}}(),dd=function(){function e(e,a){for(var t=e.split("\n"),r=-1,s=-1,n=0,i=[];n!==t.length;++n)if("BOT"!==t[n].trim()){if(!(r<0)){for(var o=t[n].trim().split(","),l=o[0],c=o[1],d=t[++n]||"";1&(d.match(/["]/g)||[]).length&&n<t.length-1;)d+="\n"+t[++n];switch(d=d.trim(),+l){case-1:if("BOT"===d){i[++r]=[],s=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[r][s]=!0:"FALSE"===d?i[r][s]=!1:isNaN(Ri(c))?isNaN(Ii(c).getDate())?i[r][s]=c:i[r][s]=Si(c):i[r][s]=Ri(c),++s;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[r][s++]=""!==d?d:null}if("EOD"===d)break}}else i[++r]=[],s=0;return a&&a.sheetRows&&(i=i.slice(0,a.sheetRows)),i}function a(a,t){return Sl(function(a,t){switch(t.type){case"base64":return e(dn(a),t);case"binary":return e(a,t);case"buffer":return e(hn&&Buffer.isBuffer(a)?a.toString("binary"):pn(a),t);case"array":return e(Ci(a),t)}throw new Error("Unrecognized type "+t.type)}(a,t),t)}return{to_workbook:function(e,t){return El(a(e,t),t)},to_sheet:a,from_sheet:function(){var e=function(e,a,t,r,s){e.push(a),e.push(t+","+r),e.push('"'+s.replace(/"/g,'""')+'"')},a=function(e,a,t,r){e.push(a+","+t),e.push(1==a?'"'+r.replace(/"/g,'""')+'"':r)};return function(t){var r,s=[],n=Nl(t["!ref"]),i=Array.isArray(t);e(s,"TABLE",0,1,"sheetjs"),e(s,"VECTORS",0,n.e.r-n.s.r+1,""),e(s,"TUPLES",0,n.e.c-n.s.c+1,""),e(s,"DATA",0,0,"");for(var o=n.s.r;o<=n.e.r;++o){a(s,-1,0,"BOT");for(var l=n.s.c;l<=n.e.c;++l){var c=vl({r:o,c:l});if(r=i?(t[o]||[])[l]:t[c])switch(r.t){case"n":var d=r.w;d||null==r.v||(d=r.v),null==d?r.f&&!r.F?a(s,1,0,"="+r.f):a(s,1,0,""):a(s,0,d,"V");break;case"b":a(s,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":a(s,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=li(r.z||_n[14],bi(Si(r.v)))),a(s,0,r.w,"V");break;default:a(s,1,0,"")}else a(s,1,0,"")}}a(s,-1,0,"EOD");return s.join("\r\n")}}()}}(),hd=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function a(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(a,t){return Sl(function(a,t){for(var r=a.split("\n"),s=-1,n=-1,i=0,o=[];i!==r.length;++i){var l=r[i].trim().split(":");if("cell"===l[0]){var c=bl(l[1]);if(o.length<=c.r)for(s=o.length;s<=c.r;++s)o[s]||(o[s]=[]);switch(s=c.r,n=c.c,l[2]){case"t":o[s][n]=e(l[3]);break;case"v":o[s][n]=+l[3];break;case"vtf":var d=l[l.length-1];case"vtc":"nl"===l[3]?o[s][n]=!!+l[4]:o[s][n]=+l[4],"vtf"==l[2]&&(o[s][n]=[o[s][n],d])}}}return t&&t.sheetRows&&(o=o.slice(0,t.sheetRows)),o}(a,t),t)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",n=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var t,r=[],s=[],n="",i=yl(e["!ref"]),o=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(n=vl({r:l,c:c}),(t=o?(e[l]||[])[c]:e[n])&&null!=t.v&&"z"!==t.t){switch(s=["cell",n,"t"],t.t){case"s":case"str":s.push(a(t.v));break;case"n":t.f?(s[2]="vtf",s[3]="n",s[4]=t.v,s[5]=a(t.f)):(s[2]="v",s[3]=t.v);break;case"b":s[2]="vt"+(t.f?"f":"c"),s[3]="nl",s[4]=t.v?"1":"0",s[5]=a(t.f||(t.v?"TRUE":"FALSE"));break;case"d":var d=bi(Si(t.v));s[2]="vtc",s[3]="nd",s[4]=""+d,s[5]=t.w||li(t.z||_n[14],d);break;case"e":continue}r.push(s.join(":"))}return r.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,a){return El(t(e,a),a)},to_sheet:t,from_sheet:function(e){return[r,s,n,s,o(e),i].join("\n")}}}(),ud=function(){function e(e,a,t,r,s){s.raw?a[t][r]=e:""===e||("TRUE"===e?a[t][r]=!0:"FALSE"===e?a[t][r]=!1:isNaN(Ri(e))?isNaN(Ii(e).getDate())?a[t][r]=e:a[t][r]=Si(e):a[t][r]=Ri(e))}var a={44:",",9:"\t",59:";",124:"|"},t={44:3,9:2,59:1,124:0};function r(e){for(var r={},s=!1,n=0,i=0;n<e.length;++n)34==(i=e.charCodeAt(n))?s=!s:!s&&i in a&&(r[i]=(r[i]||0)+1);for(n in i=[],r)Object.prototype.hasOwnProperty.call(r,n)&&i.push([r[n],n]);if(!i.length)for(n in r=t)Object.prototype.hasOwnProperty.call(r,n)&&i.push([r[n],n]);return i.sort(function(e,a){return e[0]-a[0]||t[e[1]]-t[a[1]]}),a[i.pop()[1]]||44}function s(e,a){var t=a||{},s="",n=t.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(s=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(s=e.charAt(4),e=e.slice(6)):s=r(e.slice(0,1024)):s=t&&t.FS?t.FS:r(e.slice(0,1024));var o=0,l=0,c=0,d=0,h=0,u=s.charCodeAt(0),m=!1,f=0,g=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var p,x,b=null!=t.dateNF?(p=t.dateNF,x=(x="number"==typeof p?_n[p]:p).replace(ui,"(\\d+)"),new RegExp("^"+x+"$")):null;function v(){var a=e.slice(d,h),r={};if('"'==a.charAt(0)&&'"'==a.charAt(a.length-1)&&(a=a.slice(1,-1).replace(/""/g,'"')),0===a.length)r.t="z";else if(t.raw)r.t="s",r.v=a;else if(0===a.trim().length)r.t="s",r.v=a;else if(61==a.charCodeAt(0))34==a.charCodeAt(1)&&34==a.charCodeAt(a.length-1)?(r.t="s",r.v=a.slice(2,-1).replace(/""/g,'"')):1!=a.length?(r.t="n",r.f=a.slice(1)):(r.t="s",r.v=a);else if("TRUE"==a)r.t="b",r.v=!0;else if("FALSE"==a)r.t="b",r.v=!1;else if(isNaN(c=Ri(a)))if(!isNaN(Ii(a).getDate())||b&&a.match(b)){r.z=t.dateNF||_n[14];var s=0;b&&a.match(b)&&(a=function(e,a,t){var r=-1,s=-1,n=-1,i=-1,o=-1,l=-1;(a.match(ui)||[]).forEach(function(e,a){var c=parseInt(t[a+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":n=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:s=c}}),l>=0&&-1==o&&s>=0&&(o=s,s=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==r&&-1==s&&-1==n?d:c+"T"+d}(0,t.dateNF,a.match(b)||[]),s=1),t.cellDates?(r.t="d",r.v=Si(a,s)):(r.t="n",r.v=bi(Si(a,s))),!1!==t.cellText&&(r.w=li(r.z,r.v instanceof Date?bi(r.v):r.v)),t.cellNF||delete r.z}else r.t="s",r.v=a;else r.t="n",!1!==t.cellText&&(r.w=a),r.v=c;if("z"==r.t||(t.dense?(n[o]||(n[o]=[]),n[o][l]=r):n[vl({c:l,r:o})]=r),d=h+1,g=e.charCodeAt(d),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),f==u)++l;else if(l=0,++o,t.sheetRows&&t.sheetRows<=o)return!0}e:for(;h<e.length;++h)switch(f=e.charCodeAt(h)){case 34:34===g&&(m=!m);break;case u:case 10:case 13:if(!m&&v())break e}return h-d>0&&v(),n["!ref"]=wl(i),n}function n(a,t){return t&&t.PRN?t.FS||"sep="==a.slice(0,4)||a.indexOf("\t")>=0||a.indexOf(",")>=0||a.indexOf(";")>=0?s(a,t):Sl(function(a,t){var r=t||{},s=[];if(!a||0===a.length)return s;for(var n=a.split(/[\r\n]/),i=n.length-1;i>=0&&0===n[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=n[c].indexOf(" "))?l=n[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){s[c]=[];var d=0;for(e(n[c].slice(0,o).trim(),s,c,d,r),d=1;d<=(n[c].length-o)/10+1;++d)e(n[c].slice(o+10*(d-1),o+10*d).trim(),s,c,d,r)}return r.sheetRows&&(s=s.slice(0,r.sheetRows)),s}(a,t),t):s(a,t)}function i(e,a){var t="",r="string"==a.type?[0,0,0,0]:Km(e,a);switch(a.type){case"base64":t=dn(e);break;case"binary":case"string":t=e;break;case"buffer":65001==a.codepage?t=e.toString("utf8"):(a.codepage,t=hn&&Buffer.isBuffer(e)?e.toString("binary"):pn(e));break;case"array":t=Ci(e);break;default:throw new Error("Unrecognized type "+a.type)}return 239==r[0]&&187==r[1]&&191==r[2]?t=uo(t.slice(3)):"string"!=a.type&&"buffer"!=a.type&&65001==a.codepage?t=uo(t):a.type,"socialcalc:version:"==t.slice(0,19)?hd.to_sheet("string"==a.type?t:uo(t),a):n(t,a)}return{to_workbook:function(e,a){return El(i(e,a),a)},to_sheet:i,from_sheet:function(e){for(var a,t=[],r=Nl(e["!ref"]),s=Array.isArray(e),n=r.s.r;n<=r.e.r;++n){for(var i=[],o=r.s.c;o<=r.e.c;++o){var l=vl({r:n,c:o});if((a=s?(e[n]||[])[o]:e[l])&&null!=a.v){for(var c=(a.w||(kl(a),a.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}t.push(i.join(""))}return t.join("\n")}}}();var md=function(){function e(e,a,t){if(e){nl(e,e.l||0);for(var r=t.Enum||x;e.l<e.length;){var s=e.read_shift(2),n=r[s]||r[65535],i=e.read_shift(2),o=e.l+i,l=n.f&&n.f(e,i,t);if(e.l=o,a(l,n,s))return}}}function a(a,t){if(!a)return a;var r=t||{},s=r.dense?[]:{},n="Sheet1",i="",o=0,l={},c=[],d=[],h={s:{r:0,c:0},e:{r:0,c:0}},u=r.sheetRows||0;if(0==a[2]&&(8==a[3]||9==a[3])&&a.length>=16&&5==a[14]&&108===a[15])throw new Error("Unsupported Works 3 for Mac file");if(2==a[2])r.Enum=x,e(a,function(e,a,t){switch(t){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:h=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==t&&!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||_n[14],r.cellDates&&(e[1].t="d",e[1].v=Ni(e[1].v))),r.qpro&&e[3]>o&&(s["!ref"]=wl(h),l[n]=s,c.push(n),s=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],n=i||"Sheet"+(o+1),i="");var d=r.dense?(s[e[0].r]||[])[e[0].c]:s[vl(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}r.dense?(s[e[0].r]||(s[e[0].r]=[]),s[e[0].r][e[0].c]=e[1]):s[vl(e[0])]=e[1]}},r);else{if(26!=a[2]&&14!=a[2])throw new Error("Unrecognized LOTUS BOF "+a[2]);r.Enum=b,14==a[2]&&(r.qpro=!0,a.l=0),e(a,function(e,a,t){switch(t){case 204:n=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(s["!ref"]=wl(h),l[n]=s,c.push(n),s=r.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],n="Sheet"+(o+1)),u>0&&e[0].r>=u)break;r.dense?(s[e[0].r]||(s[e[0].r]=[]),s[e[0].r][e[0].c]=e[1]):s[vl(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==o&&(n=e[1])}},r)}if(s["!ref"]=wl(h),l[i||n]=s,c.push(i||n),!d.length)return{SheetNames:c,Sheets:l};for(var m={},f=[],g=0;g<d.length;++g)l[c[g]]?(f.push(d[g]||c[g]),m[d[g]]=l[d[g]]||l[c[g]]):(f.push(d[g]),m[d[g]]={"!ref":"A1"});return{SheetNames:f,Sheets:m}}function t(e,a,t){var r=[{c:0,r:0},{t:"n",v:0},0,0];return t.qpro&&20768!=t.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,a,r){var s=e.l+a,n=t(e,0,r);if(n[1].t="s",20768==r.vers){e.l++;var i=e.read_shift(1);return n[1].v=e.read_shift(i,"utf8"),n}return r.qpro&&e.l++,n[1].v=e.read_shift(s-e.l,"cstr"),n}function s(e,a,t){var r=ol(7+t.length);r.write_shift(1,255),r.write_shift(2,a),r.write_shift(2,e),r.write_shift(1,39);for(var s=0;s<r.length;++s){var n=t.charCodeAt(s);r.write_shift(1,n>=128?95:n)}return r.write_shift(1,0),r}function n(e,a,t){var r=ol(7);return r.write_shift(1,255),r.write_shift(2,a),r.write_shift(2,e),r.write_shift(2,t,"i"),r}function i(e,a,t){var r=ol(13);return r.write_shift(1,255),r.write_shift(2,a),r.write_shift(2,e),r.write_shift(8,t,"f"),r}function o(e,a,t){var r=32768&a;return a=(r?e:0)+((a&=-32769)>=8192?a-16384:a),(r?"":"$")+(t?xl(a):gl(a))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var a=[{c:0,r:0},{t:"n",v:0},0];return a[0].r=e.read_shift(2),a[3]=e[e.l++],a[0].c=e[e.l++],a}function h(e,a,t,r){var s=ol(6+r.length);s.write_shift(2,e),s.write_shift(1,t),s.write_shift(1,a),s.write_shift(1,39);for(var n=0;n<r.length;++n){var i=r.charCodeAt(n);s.write_shift(1,i>=128?95:i)}return s.write_shift(1,0),s}function u(e,a){var t=d(e),r=e.read_shift(4),s=e.read_shift(4),n=e.read_shift(2);if(65535==n)return 0===r&&3221225472===s?(t[1].t="e",t[1].v=15):0===r&&3489660928===s?(t[1].t="e",t[1].v=42):t[1].v=0,t;var i=32768&n;return n=(32767&n)-16446,t[1].v=(1-2*i)*(s*Math.pow(2,n+32)+r*Math.pow(2,n)),t}function m(e,a,t,r){var s=ol(14);if(s.write_shift(2,e),s.write_shift(1,t),s.write_shift(1,a),0==r)return s.write_shift(4,0),s.write_shift(4,0),s.write_shift(2,65535),s;var n,i=0,o=0,l=0;return r<0&&(i=1,r=-r),o=0|Math.log2(r),2147483648&(l=(r/=Math.pow(2,o-31))>>>0)||(++o,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,n=(r*=Math.pow(2,32))>>>0,s.write_shift(4,n),s.write_shift(4,l),o+=16383+(i?32768:0),s.write_shift(2,o),s}function f(e,a){var t=d(e),r=e.read_shift(8,"f");return t[1].v=r,t}function g(e,a){return 0==e[e.l+a-1]?e.read_shift(a,"cstr"):""}function p(e,a){var t=ol(5+e.length);t.write_shift(2,14e3),t.write_shift(2,a);for(var r=0;r<e.length;++r){var s=e.charCodeAt(r);t[t.l++]=s>127?95:s}return t[t.l++]=0,t}var x={0:{n:"BOF",f:Ec},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,a,t){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==a&&t.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==a&&t.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==a&&t.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,a,r){var s=t(e,0,r);return s[1].v=e.read_shift(2,"i"),s}},14:{n:"NUMBER",f:function(e,a,r){var s=t(e,0,r);return s[1].v=e.read_shift(8,"f"),s}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,a,r){var s=e.l+a,n=t(e,0,r);if(n[1].v=e.read_shift(8,"f"),r.qpro)e.l=s;else{var i=e.read_shift(2);!function(e,a){nl(e,0);var t=[],r=0,s="",n="",i="",d="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:t.push(e.read_shift(8,"f"));break;case 1:n=o(a[0].c,e.read_shift(2),!0),s=o(a[0].r,e.read_shift(2),!1),t.push(n+s);break;case 2:var u=o(a[0].c,e.read_shift(2),!0),m=o(a[0].r,e.read_shift(2),!1);n=o(a[0].c,e.read_shift(2),!0),s=o(a[0].r,e.read_shift(2),!1),t.push(u+m+":"+n+s);break;case 3:if(e.l<e.length)return;break;case 4:t.push("("+t.pop()+")");break;case 5:t.push(e.read_shift(2));break;case 6:for(var f="";h=e[e.l++];)f+=String.fromCharCode(h);t.push('"'+f.replace(/"/g,'""')+'"');break;case 8:t.push("-"+t.pop());break;case 23:t.push("+"+t.pop());break;case 22:t.push("NOT("+t.pop()+")");break;case 20:case 21:d=t.pop(),i=t.pop(),t.push(["AND","OR"][h-20]+"("+i+","+d+")");break;default:if(h<32&&c[h])d=t.pop(),i=t.pop(),t.push(i+c[h]+d);else{if(!l[h])return;if(69==(r=l[h][1])&&(r=e[e.l++]),r>t.length)return;var g=t.slice(-r);t.length-=r,t.push(l[h][0]+"("+g.join(",")+")")}}}1==t.length&&(a[1].f=""+t[0])}(e.slice(e.l,e.l+i),n),e.l+=i}return n}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:g},222:{n:"SHEETNAMELP",f:function(e,a){var t=e[e.l++];t>a-1&&(t=a-1);for(var r="";r.length<t;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,a){var t=d(e);return t[1].t="s",t[1].v=e.read_shift(a-4,"cstr"),t}},23:{n:"NUMBER17",f:u},24:{n:"NUMBER18",f:function(e,a){var t=d(e);t[1].v=e.read_shift(2);var r=t[1].v>>1;if(1&t[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return t[1].v=r,t}},25:{n:"FORMULA19",f:function(e,a){var t=u(e);return e.l+=a-14,t}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,a){for(var t={},r=e.l+a;e.l<r;){var s=e.read_shift(2);if(14e3==s){for(t[s]=[0,""],t[s][0]=e.read_shift(2);e[e.l];)t[s][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return t}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,a){var t=d(e),r=e.read_shift(4);return t[1].v=r>>6,t}},38:{n:"??"},39:{n:"NUMBER27",f:f},40:{n:"FORMULA28",f:function(e,a){var t=f(e);return e.l+=a-10,t}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:g},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,a,t){if(t.qpro&&!(a<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(a-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,a){var t=a||{};if(+t.codepage>=0&&Qs(+t.codepage),"string"==t.type)throw new Error("Cannot write WK1 to JS string");var r,o,l=cl(),c=Nl(e["!ref"]),d=Array.isArray(e),h=[];xm(l,0,(r=1030,(o=ol(2)).write_shift(2,r),o)),xm(l,6,function(e){var a=ol(8);return a.write_shift(2,e.s.c),a.write_shift(2,e.s.r),a.write_shift(2,e.e.c),a.write_shift(2,e.e.r),a}(c));for(var u=Math.min(c.e.r,8191),m=c.s.r;m<=u;++m)for(var f=gl(m),g=c.s.c;g<=c.e.c;++g){m===c.s.r&&(h[g]=xl(g));var p=h[g]+f,x=d?(e[m]||[])[g]:e[p];if(x&&"z"!=x.t)if("n"==x.t)(0|x.v)==x.v&&x.v>=-32768&&x.v<=32767?xm(l,13,n(m,g,x.v)):xm(l,14,i(m,g,x.v));else xm(l,15,s(m,g,kl(x).slice(0,239)))}return xm(l,1),l.end()},book_to_wk3:function(e,a){var t=a||{};if(+t.codepage>=0&&Qs(+t.codepage),"string"==t.type)throw new Error("Cannot write WK3 to JS string");var r=cl();xm(r,0,function(e){var a=ol(26);a.write_shift(2,4096),a.write_shift(2,4),a.write_shift(4,0);for(var t=0,r=0,s=0,n=0;n<e.SheetNames.length;++n){var i=e.SheetNames[n],o=e.Sheets[i];if(o&&o["!ref"]){++s;var l=yl(o["!ref"]);t<l.e.r&&(t=l.e.r),r<l.e.c&&(r=l.e.c)}}t>8191&&(t=8191);return a.write_shift(2,t),a.write_shift(1,s),a.write_shift(1,r),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,1),a.write_shift(1,2),a.write_shift(4,0),a.write_shift(4,0),a}(e));for(var s=0,n=0;s<e.SheetNames.length;++s)(e.Sheets[e.SheetNames[s]]||{})["!ref"]&&xm(r,27,p(e.SheetNames[s],n++));var i=0;for(s=0;s<e.SheetNames.length;++s){var o=e.Sheets[e.SheetNames[s]];if(o&&o["!ref"]){for(var l=Nl(o["!ref"]),c=Array.isArray(o),d=[],u=Math.min(l.e.r,8191),f=l.s.r;f<=u;++f)for(var g=gl(f),x=l.s.c;x<=l.e.c;++x){f===l.s.r&&(d[x]=xl(x));var b=d[x]+g,v=c?(o[f]||[])[x]:o[b];if(v&&"z"!=v.t)if("n"==v.t)xm(r,23,m(f,x,i,v.v));else xm(r,22,h(f,x,i,kl(v).slice(0,239)))}++i}}return xm(r,1),r.end()},to_workbook:function(e,t){switch(t.type){case"base64":return a(gn(dn(e)),t);case"binary":return a(gn(e),t);case"buffer":case"array":return a(e,t)}throw"Unsupported type "+t.type}}}();var fd=function(){var e=fo("t"),a=fo("rPr");function t(t){var r=t.match(e);if(!r)return{t:"s",v:""};var s={t:"s",v:ao(r[1])},n=t.match(a);return n&&(s.s=function(e){var a={},t=e.match(Xi),r=0,s=!1;if(t)for(;r!=t.length;++r){var n=Ji(t[r]);switch(n[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":a.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==n.val)break;a.cp=Js[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":a.outline=1;break;case"</outline>":break;case"<rFont":a.name=n.val;break;case"<sz":a.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":a.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":a.uval="double";break;case"singleAccounting":a.uval="single-accounting";break;case"doubleAccounting":a.uval="double-accounting"}case"<u>":case"<u/>":a.u=1;break;case"</u>":break;case"<b":if("0"==n.val)break;case"<b>":case"<b/>":a.b=1;break;case"</b>":break;case"<i":if("0"==n.val)break;case"<i>":case"<i/>":a.i=1;break;case"</i>":break;case"<color":n.rgb&&(a.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":a.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":a.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(47!==n[0].charCodeAt(1)&&!s)throw new Error("Unrecognized rich format "+n[0])}}return a}(n[1])),s}var r=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(e){return e.replace(r,"").split(s).map(t).filter(function(e){return e.v})}}(),gd=function(){var e=/(\r\n|\n)/g;function a(a){var t=[[],a.v,[]];return a.v?(a.s&&function(e,a,t){var r=[];e.u&&r.push("text-decoration: underline;"),e.uval&&r.push("text-underline-style:"+e.uval+";"),e.sz&&r.push("font-size:"+e.sz+"pt;"),e.outline&&r.push("text-effect: outline;"),e.shadow&&r.push("text-shadow: auto;"),a.push('<span style="'+r.join("")+'">'),e.b&&(a.push("<b>"),t.push("</b>")),e.i&&(a.push("<i>"),t.push("</i>")),e.strike&&(a.push("<s>"),t.push("</s>"));var s=e.valign||"";"superscript"==s||"super"==s?s="sup":"subscript"==s&&(s="sub"),""!=s&&(a.push("<"+s+">"),t.push("</"+s+">")),t.push("</span>")}(a.s,t[0],t[2]),t[0].join("")+t[1].replace(e,"<br/>")+t[2].join("")):""}return function(e){return e.map(a).join("")}}(),pd=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xd=/<(?:\w+:)?r>/,bd=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function vd(e,a){var t=!a||a.cellHTML,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=ao(uo(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=uo(e),t&&(r.h=so(r.t))):e.match(xd)&&(r.r=uo(e),r.t=ao(uo((e.replace(bd,"").match(pd)||[]).join("").replace(Xi,""))),t&&(r.h=gd(fd(r.r)))),r):{t:""}}var yd=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wd=/<(?:\w+:)?(?:si|sstItem)>/g,Nd=/<\/(?:\w+:)?(?:si|sstItem)>/;function jd(e){for(var a=[],t=e.split(""),r=0;r<t.length;++r)a[r]=t[r].charCodeAt(0);return a}function kd(e,a){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),a>=4&&(e.l+=a-4),t}function Ed(e){for(var a=e.read_shift(4),t=e.l+a-4,r={},s=e.read_shift(4),n=[];s-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=n,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function Td(e){var a=function(e){var a={};return e.read_shift(4),e.l+=4,a.id=e.read_shift(0,"lpp4"),a.name=e.read_shift(0,"lpp4"),a.R=kd(e,4),a.U=kd(e,4),a.W=kd(e,4),a}(e);if(a.ename=e.read_shift(0,"8lpp4"),a.blksz=e.read_shift(4),a.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return a}function Sd(e,a){var t=e.l+a,r={};r.Flags=63&e.read_shift(4),e.l+=4,r.AlgID=e.read_shift(4);var s=!1;switch(r.AlgID){case 26126:case 26127:case 26128:s=36==r.Flags;break;case 26625:s=4==r.Flags;break;case 0:s=16==r.Flags||4==r.Flags||36==r.Flags;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function Cd(e,a){var t={},r=e.l+a;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function Ad(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4);return{t:"Std",h:Sd(e,a),v:Cd(e,e.length-e.l)}}function _d(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Rd(e){var a=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(Xi,function(e){var t=Ji(e);switch(Zi(t[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":a.forEach(function(e){r[e]=t[e]});break;case"<dataIntegrity":r.encryptedHmacKey=t.encryptedHmacKey,r.encryptedHmacValue=t.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"<keyEncryptor":r.uri=t.uri;break;case"<encryptedKey":r.encs.push(t);break;default:throw t[0]}}),r}var Od=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],a=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(e,a){return 255&((t=e^a)/2|128*t);var t};return function(s){for(var n,i,o,l=jd(s),c=function(e){for(var r=a[e.length-1],s=104,n=e.length-1;n>=0;--n)for(var i=e[n],o=0;7!=o;++o)64&i&&(r^=t[s]),i*=2,--s;return r}(l),d=l.length,h=mn(16),u=0;16!=u;++u)h[u]=0;for(1&~d||(n=c>>8,h[d]=r(e[0],n),--d,n=255&c,i=l[l.length-1],h[d]=r(i,n));d>0;)n=c>>8,h[--d]=r(l[d],n),n=255&c,h[--d]=r(l[d],n);for(d=15,o=15-l.length;o>0;)n=c>>8,h[d]=r(e[o],n),--o,n=255&c,h[--d]=r(l[d],n),--d,--o;return h}}(),Id=function(e){var a=0,t=Od(e);return function(e){var r=function(e,a,t,r,s){var n,i;for(s||(s=a),r||(r=Od(e)),n=0;n!=a.length;++n)i=a[n],i=255&((i^=r[t])>>5|i<<3),s[n]=i,++t;return[s,t,r]}("",e,a,t);return a=r[1],r[0]}};function Md(e,a,t,r){var s={key:Ec(e),verificationBytes:Ec(e)};return t.password&&(s.verifier=function(e){var a,t,r=0,s=jd(e),n=s.length+1;for((a=mn(n))[0]=s.length,t=1;t!=n;++t)a[t]=s[t-1];for(t=n-1;t>=0;--t)r=((16384&r?1:0)|r<<1&32767)^a[t];return 52811^r}(t.password)),r.valid=s.verificationBytes===s.verifier,r.valid&&(r.insitu=Id(t.password)),s}function Pd(e,a,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,1===r.Info?r.Data=function(e){var a={},t=a.EncryptionVersionInfo=kd(e,4);if(1!=t.Major||1!=t.Minor)throw"unrecognized version code "+t.Major+" : "+t.Minor;return a.Salt=e.read_shift(16),a.EncryptedVerifier=e.read_shift(16),a.EncryptedVerifierHash=e.read_shift(16),a}(e):r.Data=function(e,a){var t={},r=t.EncryptionVersionInfo=kd(e,4);if(a-=4,2!=r.Minor)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),a-=4;var s=e.read_shift(4);return a-=4,t.EncryptionHeader=Sd(e,s),a-=s,t.EncryptionVerifier=Cd(e,a),t}(e,a),r}var Ld=function(){function e(e,t){switch(t.type){case"base64":return a(dn(e),t);case"binary":return a(e,t);case"buffer":return a(hn&&Buffer.isBuffer(e)?e.toString("binary"):pn(e),t);case"array":return a(Ci(e),t)}throw new Error("Unrecognized type "+t.type)}function a(e,a){var t=(a||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var s={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach(function(e,a){Array.isArray(t)&&(t[a]=[]);for(var r,n=/\\\w+\b/g,i=0,o=-1;r=n.exec(e);){if("\\cell"===r[0]){var l=e.slice(i,n.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(t)?t[a][o]=c:t[vl({r:a,c:o})]=c}}i=n.lastIndex}o>s.e.c&&(s.e.c=o)}),t["!ref"]=wl(s),t}return{to_workbook:function(a,t){return El(e(a,t),t)},to_sheet:e,from_sheet:function(e){for(var a,t=["{\\rtf1\\ansi"],r=Nl(e["!ref"]),s=Array.isArray(e),n=r.s.r;n<=r.e.r;++n){t.push("\\trowd\\trautofit1");for(var i=r.s.c;i<=r.e.c;++i)t.push("\\cellx"+(i+1));for(t.push("\\pard\\intbl"),i=r.s.c;i<=r.e.c;++i){var o=vl({r:n,c:i});(a=s?(e[n]||[])[i]:e[o])&&(null!=a.v||a.f&&!a.F)&&(t.push(" "+(a.w||(kl(a),a.w))),t.push("\\cell"))}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}}}();function Dd(e){for(var a=0,t=1;3!=a;++a)t=256*t+(e[a]>255?255:e[a]<0?0:e[a]);return t.toString(16).toUpperCase().slice(1)}function Fd(e,a){if(0===a)return e;var t,r,s=function(e){var a=e[0]/255,t=e[1]/255,r=e[2]/255,s=Math.max(a,t,r),n=Math.min(a,t,r),i=s-n;if(0===i)return[0,0,a];var o,l=0,c=s+n;switch(o=i/(c>1?2-c:c),s){case a:l=((t-r)/i+6)%6;break;case t:l=(r-a)/i+2;break;case r:l=(a-t)/i+4}return[l/6,o,c/2]}((r=(t=e).slice("#"===t[0]?1:0).slice(0,6),[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]));return s[2]=a<0?s[2]*(1+a):1-(1-s[2])*(1-a),Dd(function(e){var a,t=e[0],r=e[1],s=e[2],n=2*r*(s<.5?s:1-s),i=s-n/2,o=[i,i,i],l=6*t;if(0!==r)switch(0|l){case 0:case 6:a=n*l,o[0]+=n,o[1]+=a;break;case 1:a=n*(2-l),o[0]+=a,o[1]+=n;break;case 2:a=n*(l-2),o[1]+=n,o[2]+=a;break;case 3:a=n*(4-l),o[1]+=a,o[2]+=n;break;case 4:a=n*(l-4),o[2]+=n,o[0]+=a;break;case 5:a=n*(6-l),o[2]+=a,o[0]+=n}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(s))}var zd=6;function Bd(e){return Math.floor((e+Math.round(128/zd)/256)*zd)}function Ud(e){return Math.floor((e-5)/zd*100+.5)/100}function $d(e){return Math.round((e*zd+5)/zd*256)/256}function Wd(e){return $d(Ud(Bd(e)))}function Vd(e){var a=Math.abs(e-Wd(e)),t=zd;if(a>.005)for(zd=1;zd<15;++zd)Math.abs(e-Wd(e))<=a&&(a=Math.abs(e-Wd(e)),t=zd);zd=t}function Hd(e){e.width?(e.wpx=Bd(e.width),e.wch=Ud(e.wpx),e.MDW=zd):e.wpx?(e.wch=Ud(e.wpx),e.width=$d(e.wch),e.MDW=zd):"number"==typeof e.wch&&(e.width=$d(e.wch),e.wpx=Bd(e.width),e.MDW=zd),e.customWidth&&delete e.customWidth}var Gd=96;function qd(e){return 96*e/Gd}function Xd(e){return e*Gd/96}var Yd={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var Kd=["numFmtId","fillId","fontId","borderId","xfId"],Jd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var Zd=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,t=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(n,i,o){var l,c={};return n?((l=(n=n.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,a,t){a.NumberFmt=[];for(var r=gi(_n),s=0;s<r.length;++s)a.NumberFmt[r[s]]=_n[r[s]];var n=e[0].match(Xi);if(n)for(s=0;s<n.length;++s){var i=Ji(n[s]);switch(Zi(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=ao(uo(i.formatCode)),l=parseInt(i.numFmtId,10);if(a.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=a.NumberFmt[l];--l);a.NumberFmt[l]=o}ci(o,l)}break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(l,c,o),(l=n.match(r))&&function(e,a,t,r){a.Fonts=[];var s={},n=!1;(e[0].match(Xi)||[]).forEach(function(e){var i=Ji(e);switch(Zi(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":a.Fonts.push(s),s={};break;case"<name":i.val&&(s.name=uo(i.val));break;case"<b":s.bold=i.val?io(i.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=i.val?io(i.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(i.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=i.val?io(i.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=i.val?io(i.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=i.val?io(i.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=i.val?io(i.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=i.val?io(i.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":i.val&&(s.sz=+i.val);break;case"<vertAlign":i.val&&(s.vertAlign=i.val);break;case"<family":i.val&&(s.family=parseInt(i.val,10));break;case"<scheme":i.val&&(s.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=Js[parseInt(i.val,10)];break;case"<color":if(s.color||(s.color={}),i.auto&&(s.color.auto=io(i.auto)),i.rgb)s.color.rgb=i.rgb.slice(-6);else if(i.indexed){s.color.index=parseInt(i.indexed,10);var o=Kl[s.color.index];81==s.color.index&&(o=Kl[1]),o||(o=Kl[1]),s.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(s.color.theme=parseInt(i.theme,10),i.tint&&(s.color.tint=parseFloat(i.tint)),i.theme&&t.themeElements&&t.themeElements.clrScheme&&(s.color.rgb=Fd(t.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<AlternateContent":case"<ext":n=!0;break;case"</AlternateContent>":case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+i[0]+" in fonts")}})}(l,c,i,o),(l=n.match(t))&&function(e,a,t,r){a.Fills=[];var s={},n=!1;(e[0].match(Xi)||[]).forEach(function(e){var t=Ji(e);switch(Zi(t[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":s={},a.Fills.push(s);break;case"<gradientFill":case"</gradientFill>":a.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":t.patternType&&(s.patternType=t.patternType);break;case"<bgColor":s.bgColor||(s.bgColor={}),t.indexed&&(s.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(s.bgColor.theme=parseInt(t.theme,10)),t.tint&&(s.bgColor.tint=parseFloat(t.tint)),t.rgb&&(s.bgColor.rgb=t.rgb.slice(-6));break;case"<fgColor":s.fgColor||(s.fgColor={}),t.theme&&(s.fgColor.theme=parseInt(t.theme,10)),t.tint&&(s.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(s.fgColor.rgb=t.rgb.slice(-6));break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+t[0]+" in fills")}})}(l,c,0,o),(l=n.match(s))&&function(e,a,t,r){a.Borders=[];var s={},n=!1;(e[0].match(Xi)||[]).forEach(function(e){var t=Ji(e);switch(Zi(t[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":s={},t.diagonalUp&&(s.diagonalUp=io(t.diagonalUp)),t.diagonalDown&&(s.diagonalDown=io(t.diagonalDown)),a.Borders.push(s);break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+t[0]+" in borders")}})}(l,c,0,o),(l=n.match(a))&&function(e,a,t){var r;a.CellXf=[];var s=!1;(e[0].match(Xi)||[]).forEach(function(e){var n=Ji(e),i=0;switch(Zi(n[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(r=n)[0],i=0;i<Kd.length;++i)r[Kd[i]]&&(r[Kd[i]]=parseInt(r[Kd[i]],10));for(i=0;i<Jd.length;++i)r[Jd[i]]&&(r[Jd[i]]=io(r[Jd[i]]));if(a.NumberFmt&&r.numFmtId>392)for(i=392;i>60;--i)if(a.NumberFmt[r.numFmtId]==a.NumberFmt[i]){r.numFmtId=i;break}a.CellXf.push(r);break;case"<alignment":case"<alignment/>":var o={};n.vertical&&(o.vertical=n.vertical),n.horizontal&&(o.horizontal=n.horizontal),null!=n.textRotation&&(o.textRotation=n.textRotation),n.indent&&(o.indent=n.indent),n.wrapText&&(o.wrapText=io(n.wrapText)),r.alignment=o;break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(t&&t.WTF&&!s)throw new Error("unrecognized "+n[0]+" in cellXfs")}})}(l,c,o),c):c}}();var Qd=il;var eh=il;var ah=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function th(e,a,t){a.themeElements.clrScheme=[];var r={};(e[0].match(Xi)||[]).forEach(function(e){var s=Ji(e);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===s[0].charAt(1)?(a.themeElements.clrScheme[ah.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function rh(){}function sh(){}var nh=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ih=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,oh=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var lh=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ch(e,a){var t,r;e&&0!==e.length||((t=[Hi])[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',t[t.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',t[t.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',t[t.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',t[t.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',t[t.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',t[t.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",e=t.join(""));var s={};if(!(r=e.match(lh)))throw new Error("themeElements not found in theme");return function(e,a,t){var r;a.themeElements={},[["clrScheme",nh,th],["fontScheme",ih,rh],["fmtScheme",oh,sh]].forEach(function(s){if(!(r=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](r,a,t)})}(r[0],s,a),s.raw=e,s}function dh(e){var a={};switch(a.xclrType=e.read_shift(2),a.nTintShade=e.read_shift(2),a.xclrType){case 0:case 4:e.l+=4;break;case 1:a.xclrValue=function(e,a){return il(e,a)}(e,4);break;case 2:a.xclrValue=Mc(e);break;case 3:a.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,a}function hh(e){var a=e.read_shift(2),t=e.read_shift(2)-4,r=[a];switch(a){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=dh(e);break;case 6:r[1]=function(e,a){return il(e,a)}(e,t);break;case 14:case 15:r[1]=e.read_shift(1===t?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+a+" "+t)}return r}function uh(e,a){a.forEach(function(e){e[0]})}function mh(e,a,t,r){var s,n=Array.isArray(e);a.forEach(function(a){var i=bl(a.ref);if(n?(e[i.r]||(e[i.r]=[]),s=e[i.r][i.c]):s=e[a.ref],!s){s={t:"z"},n?e[i.r][i.c]=s:e[a.ref]=s;var o=Nl(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=wl(o);l!==e["!ref"]&&(e["!ref"]=l)}s.c||(s.c=[]);var c={a:a.author,t:a.t,r:a.r,T:t};a.h&&(c.h=a.h);for(var d=s.c.length-1;d>=0;--d){if(!t&&s.c[d].T)return;t&&!s.c[d].T&&s.c.splice(d,1)}if(t&&r)for(d=0;d<r.length;++d)if(c.a==r[d].id){c.a=r[d].name||c.a;break}s.c.push(c)})}var fh=Cl;var gh=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,a={r:0,c:0};function t(e,t,r,s){var n=!1,i=!1;0==r.length?i=!0:"["==r.charAt(0)&&(i=!0,r=r.slice(1,-1)),0==s.length?n=!0:"["==s.charAt(0)&&(n=!0,s=s.slice(1,-1));var o=r.length>0?0|parseInt(r,10):0,l=s.length>0?0|parseInt(s,10):0;return n?l+=a.c:--l,i?o+=a.r:--o,t+(n?"":"$")+xl(l)+(i?"":"$")+gl(o)}return function(r,s){return a=s,r.replace(e,t)}}(),ph=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,xh=function(){return function(e,a){return e.replace(ph,function(e,t,r,s,n,i){var o=pl(s)-(r?0:a.c),l=fl(i)-(n?0:a.r);return t+"R"+(0==l?"":n?l+1:"["+l+"]")+"C"+(0==o?"":r?o+1:"["+o+"]")})}}();function bh(e,a){return e.replace(ph,function(e,t,r,s,n,i){return t+("$"==r?r+s:xl(pl(s)+a.c))+("$"==n?n+i:gl(fl(i)+a.r))})}function vh(e,a,t){var r=yl(a).s,s=bl(t);return bh(e,{r:s.r-r.r,c:s.c-r.c})}function yh(e){return e.replace(/_xlfn\./g,"")}function wh(e){e.l+=1}function Nh(e,a){var t=e.read_shift(2);return[16383&t,t>>14&1,t>>15&1]}function jh(e,a,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return kh(e);12==t.biff&&(r=4)}var s=e.read_shift(r),n=e.read_shift(r),i=Nh(e),o=Nh(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function kh(e){var a=Nh(e),t=Nh(e),r=e.read_shift(1),s=e.read_shift(1);return{s:{r:a[0],c:r,cRel:a[1],rRel:a[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function Eh(e,a,t){if(t&&t.biff>=2&&t.biff<=5)return function(e){var a=Nh(e),t=e.read_shift(1);return{r:a[0],c:t,cRel:a[1],rRel:a[2]}}(e);var r=e.read_shift(t&&12==t.biff?4:2),s=Nh(e);return{r:r,c:s[0],cRel:s[1],rRel:s[2]}}function Th(e){var a=e.read_shift(2),t=e.read_shift(2);return{r:a,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function Sh(e){var a=1&e[e.l+1];return e.l+=4,[a,1]}function Ch(e){return[e.read_shift(1),e.read_shift(1)]}function Ah(e,a){var t=[e.read_shift(1)];if(12==a)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=kc(e,1)?"TRUE":"FALSE",12!=a&&(e.l+=7);break;case 37:case 16:t[1]=Jl[e[e.l]],e.l+=12==a?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Ul(e);break;case 2:t[1]=Rc(e,0,{biff:a>0&&a<8?2:a});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function _h(e,a,t){for(var r=e.read_shift(12==t.biff?4:2),s=[],n=0;n!=r;++n)s.push((12==t.biff?Bl:zc)(e));return s}function Rh(e,a,t){var r=0,s=0;12==t.biff?(r=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,0==--s&&(s=256));for(var n=0,i=[];n!=r&&(i[n]=[]);++n)for(var o=0;o!=s;++o)i[n][o]=Ah(e,t.biff);return i}function Oh(e,a,t){return e.l+=2,[Th(e)]}function Ih(e){return e.l+=6,[]}function Mh(e){return e.l+=2,[Ec(e),1&e.read_shift(2)]}var Ph=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Lh={1:{n:"PtgExp",f:function(e,a,t){return e.l++,t&&12==t.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(t&&2==t.biff?1:2)]}},2:{n:"PtgTbl",f:il},3:{n:"PtgAdd",f:wh},4:{n:"PtgSub",f:wh},5:{n:"PtgMul",f:wh},6:{n:"PtgDiv",f:wh},7:{n:"PtgPower",f:wh},8:{n:"PtgConcat",f:wh},9:{n:"PtgLt",f:wh},10:{n:"PtgLe",f:wh},11:{n:"PtgEq",f:wh},12:{n:"PtgGe",f:wh},13:{n:"PtgGt",f:wh},14:{n:"PtgNe",f:wh},15:{n:"PtgIsect",f:wh},16:{n:"PtgUnion",f:wh},17:{n:"PtgRange",f:wh},18:{n:"PtgUplus",f:wh},19:{n:"PtgUminus",f:wh},20:{n:"PtgPercent",f:wh},21:{n:"PtgParen",f:wh},22:{n:"PtgMissArg",f:wh},23:{n:"PtgStr",f:function(e,a,t){return e.l++,Sc(e,0,t)}},26:{n:"PtgSheet",f:function(e,a,t){return e.l+=5,e.l+=2,e.l+=2==t.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,a,t){return e.l+=2==t.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Jl[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Ul(e)}},32:{n:"PtgArray",f:function(e,a,t){var r=(96&e[e.l++])>>5;return e.l+=2==t.biff?6:12==t.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,a,t){var r=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(t&&t.biff<=3?1:2);return[ru[s],tu[s],r]}},34:{n:"PtgFuncVar",f:function(e,a,t){var r=e[e.l++],s=e.read_shift(1),n=t&&t.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[s,(0===n[0]?tu:au)[n[1]]]}},35:{n:"PtgName",f:function(e,a,t){var r=e.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,n=e.read_shift(s);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,n]}},36:{n:"PtgRef",f:function(e,a,t){var r=(96&e[e.l])>>5;return e.l+=1,[r,Eh(e,0,t)]}},37:{n:"PtgArea",f:function(e,a,t){return[(96&e[e.l++])>>5,jh(e,t.biff>=2&&t.biff,t)]}},38:{n:"PtgMemArea",f:function(e,a,t){var r=e.read_shift(1)>>>5&3;return e.l+=t&&2==t.biff?3:4,[r,e.read_shift(t&&2==t.biff?1:2)]}},39:{n:"PtgMemErr",f:il},40:{n:"PtgMemNoMem",f:il},41:{n:"PtgMemFunc",f:function(e,a,t){return[e.read_shift(1)>>>5&3,e.read_shift(t&&2==t.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,a,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,12==t.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,a,t){var r=(96&e[e.l++])>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,a,t){var r=(96&e[e.l])>>5;e.l+=1;var s=function(e,a,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return function(e){var a=e.read_shift(2),t=e.read_shift(1),r=(32768&a)>>15,s=(16384&a)>>14;return a&=16383,1==r&&a>=8192&&(a-=16384),1==s&&t>=128&&(t-=256),{r:a,c:t,cRel:s,rRel:r}}(e);var s=e.read_shift(r>=12?4:2),n=e.read_shift(2),i=(16384&n)>>14,o=(32768&n)>>15;if(n&=16383,1==o)for(;s>524287;)s-=1048576;if(1==i)for(;n>8191;)n-=16384;return{r:s,c:n,cRel:i,rRel:o}}(e,0,t);return[r,s]}},45:{n:"PtgAreaN",f:function(e,a,t){var r=(96&e[e.l++])>>5,s=function(e,a,t){if(t.biff<8)return kh(e);var r=e.read_shift(12==t.biff?4:2),s=e.read_shift(12==t.biff?4:2),n=Nh(e),i=Nh(e);return{s:{r:r,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,t);return[r,s]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,a,t){return 5==t.biff?function(e){var a=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[a,t,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,a,t){var r=(96&e[e.l])>>5;e.l+=1;var s=e.read_shift(2);return t&&5==t.biff&&(e.l+=12),[r,s,Eh(e,0,t)]}},59:{n:"PtgArea3d",f:function(e,a,t){var r=(96&e[e.l++])>>5,s=e.read_shift(2,"i");if(t)switch(t.biff){case 5:e.l+=12;break;case 12:0}return[r,s,jh(e,0,t)]}},60:{n:"PtgRefErr3d",f:function(e,a,t){var r=(96&e[e.l++])>>5,s=e.read_shift(2),n=4;if(t)switch(t.biff){case 5:n=15;break;case 12:n=6}return e.l+=n,[r,s]}},61:{n:"PtgAreaErr3d",f:function(e,a,t){var r=(96&e[e.l++])>>5,s=e.read_shift(2),n=8;if(t)switch(t.biff){case 5:e.l+=12,n=6;break;case 12:n=12}return e.l+=n,[r,s]}},255:{}},Dh={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Fh={1:{n:"PtgElfLel",f:Mh},2:{n:"PtgElfRw",f:Oh},3:{n:"PtgElfCol",f:Oh},6:{n:"PtgElfRwV",f:Oh},7:{n:"PtgElfColV",f:Oh},10:{n:"PtgElfRadical",f:Oh},11:{n:"PtgElfRadicalS",f:Ih},13:{n:"PtgElfColS",f:Ih},15:{n:"PtgElfColSV",f:Ih},16:{n:"PtgElfRadicalLel",f:Mh},25:{n:"PtgList",f:function(e){e.l+=2;var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2);return{ixti:a,coltype:3&t,rt:Ph[t>>2&31],idx:r,c:s,C:n}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},zh={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,a,t){var r=255&e[e.l+1]?1:0;return e.l+=t&&2==t.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,a,t){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(t&&2==t.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,a,t){e.l+=2;for(var r=e.read_shift(t&&2==t.biff?1:2),s=[],n=0;n<=r;++n)s.push(e.read_shift(t&&2==t.biff?1:2));return s}},8:{n:"PtgAttrGoto",f:function(e,a,t){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(t&&2==t.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,a,t){e.l+=t&&2==t.biff?3:4}},32:{n:"PtgAttrBaxcel",f:Sh},33:{n:"PtgAttrBaxcel",f:Sh},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Ch(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Ch(e)}},128:{n:"PtgAttrIfError",f:function(e){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(2)]}},255:{}};function Bh(e,a,t,r){if(r.biff<8)return il(e,a);for(var s=e.l+a,n=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=Rh(e,0,r),n.push(t[i][1]);break;case"PtgMemArea":t[i][2]=_h(e,t[i][1],r),n.push(t[i][2]);break;case"PtgExp":r&&12==r.biff&&(t[i][1][1]=e.read_shift(4),n.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return 0!==(a=s-e.l)&&n.push(il(e,a)),n}function Uh(e,a,t){for(var r,s,n=e.l+a,i=[];n!=e.l;)a=n-e.l,s=e[e.l],r=Lh[s]||Lh[Dh[s]],24!==s&&25!==s||(r=(24===s?Fh:zh)[e[e.l+1]]),r&&r.f?i.push([r.n,r.f(e,a,t)]):il(e,a);return i}function $h(e){for(var a=[],t=0;t<e.length;++t){for(var r=e[t],s=[],n=0;n<r.length;++n){var i=r[n];if(i)if(2===i[0])s.push('"'+i[1].replace(/"/g,'""')+'"');else s.push(i[1]);else s.push("")}a.push(s.join(","))}return a.join(";")}var Wh={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Vh(e,a,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[a]))return e.SheetNames[a];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[a];if(t.biff<8)return a>1e4&&(a-=65536),a<0&&(a=-a),0==a?"":e.XTI[a-1];if(!r)return"SH33TJSERR1";var s="";if(t.biff>8)switch(e[r[0]][0]){case 357:return s=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 358:return null!=t.SID?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return s=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?s:s+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[r[0]][0][3]?(s=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?s:s+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Hh(e,a,t){var r=Vh(e,a,t);return"#REF"==r?r:function(e,a){if(!(e||a&&a.biff<=5&&a.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,t)}function Gh(e,a,t,r,s){var n,i,o,l,c=s&&s.biff||8,d={s:{c:0,r:0}},h=[],u=0,m=0,f="";if(!e[0]||!e[0][0])return"";for(var g=-1,p="",x=0,b=e[0].length;x<b;++x){var v=e[0][x];switch(v[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(n=h.pop(),i=h.pop(),g>=0){switch(e[0][g][1][0]){case 0:p=_i(" ",e[0][g][1][1]);break;case 1:p=_i("\r",e[0][g][1][1]);break;default:if(p="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}i+=p,g=-1}h.push(i+Wh[v[0]]+n);break;case"PtgIsect":n=h.pop(),i=h.pop(),h.push(i+" "+n);break;case"PtgUnion":n=h.pop(),i=h.pop(),h.push(i+","+n);break;case"PtgRange":n=h.pop(),i=h.pop(),h.push(i+":"+n);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=dl(v[1][1],d,s),h.push(ul(o,c));break;case"PtgRefN":o=t?dl(v[1][1],t,s):v[1][1],h.push(ul(o,c));break;case"PtgRef3d":u=v[1][1],o=dl(v[1][2],d,s),f=Hh(r,u,s),h.push(f+"!"+ul(o,c));break;case"PtgFunc":case"PtgFuncVar":var y=v[1][0],w=v[1][1];y||(y=0);var N=0==(y&=127)?[]:h.slice(-y);h.length-=y,"User"===w&&(w=N.shift()),h.push(w+"("+N.join(",")+")");break;case"PtgBool":h.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(v[1]);break;case"PtgNum":h.push(String(v[1]));break;case"PtgStr":h.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=hl(v[1][1],t?{s:t}:d,s),h.push(ml(l,s));break;case"PtgArea":l=hl(v[1][1],d,s),h.push(ml(l,s));break;case"PtgArea3d":u=v[1][1],l=v[1][2],f=Hh(r,u,s),h.push(f+"!"+ml(l,s));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":m=v[1][2];var j=(r.names||[])[m-1]||(r[0]||[])[m],k=j?j.Name:"SH33TJSNAME"+String(m);k&&"_xlfn."==k.slice(0,6)&&!s.xlfn&&(k=k.slice(6)),h.push(k);break;case"PtgNameX":var E,T=v[1][1];if(m=v[1][2],!(s.biff<=5)){var S="";if(14849==((r[T]||[])[0]||[])[0]||(1025==((r[T]||[])[0]||[])[0]?r[T][m]&&r[T][m].itab>0&&(S=r.SheetNames[r[T][m].itab-1]+"!"):S=r.SheetNames[m-1]+"!"),r[T]&&r[T][m])S+=r[T][m].Name;else if(r[0]&&r[0][m])S+=r[0][m].Name;else{var C=(Vh(r,T,s)||"").split(";;");C[m-1]?S=C[m-1]:S+="SH33TJSERRX"}h.push(S);break}T<0&&(T=-T),r[T]&&(E=r[T][m]),E||(E={Name:"SH33TJSERRY"}),h.push(E.Name);break;case"PtgParen":var A="(",_=")";if(g>=0){switch(p="",e[0][g][1][0]){case 2:A=_i(" ",e[0][g][1][1])+A;break;case 3:A=_i("\r",e[0][g][1][1])+A;break;case 4:_=_i(" ",e[0][g][1][1])+_;break;case 5:_=_i("\r",e[0][g][1][1])+_;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}h.push(A+h.pop()+_);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":o={c:v[1][1],r:v[1][0]};var R={c:t.c,r:t.r};if(r.sharedf[vl(o)]){var O=r.sharedf[vl(o)];h.push(Gh(O,d,R,r,s))}else{var I=!1;for(n=0;n!=r.arrayf.length;++n)if(i=r.arrayf[n],!(o.c<i[0].s.c||o.c>i[0].e.c||o.r<i[0].s.r||o.r>i[0].e.r)){h.push(Gh(i[1],d,R,r,s)),I=!0;break}I||h.push(v[1])}break;case"PtgArray":h.push("{"+$h(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=x;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=s.biff&&g>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][x][0])){var M=!0;switch((v=e[0][g])[1][0]){case 4:M=!1;case 0:p=_i(" ",v[1][1]);break;case 5:M=!1;case 1:p=_i("\r",v[1][1]);break;default:if(p="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}h.push((M?p:"")+h.pop()+(M?"":p)),g=-1}}if(h.length>1&&s.WTF)throw new Error("bad formula stack");return h[0]}function qh(e,a,t){var r,s=e.l+a,n=2==t.biff?1:2,i=e.read_shift(n);if(65535==i)return[[],il(e,a-2)];var o=Uh(e,i,t);return a!==i+n&&(r=Bh(e,a-i-n,o,t)),e.l=s,[o,r]}function Xh(e,a,t){var r,s=e.l+a,n=e.read_shift(2),i=Uh(e,n,t);return 65535==n?[[],il(e,a-2)]:(a!==n+2&&(r=Bh(e,s-n-2,i,t)),[i,r])}function Yh(e,a,t){var r=e.l+a,s=Lc(e);2==t.biff&&++e.l;var n=function(e){var a;if(65535!==Xo(e,e.l+6))return[Ul(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return a=1===e[e.l+2],e.l+=8,[a,"b"];case 2:return a=e[e.l+2],e.l+=8,[a,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=t.biff&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var o=function(e,a,t){var r,s=e.l+a,n=2==t.biff?1:2,i=e.read_shift(n);if(65535==i)return[[],il(e,a-2)];var o=Uh(e,i,t);return a!==i+n&&(r=Bh(e,a-i-n,o,t)),e.l=s,[o,r]}(e,r-e.l,t);return{cell:s,val:n[0],formula:o,shared:i>>3&1,tt:n[1]}}function Kh(e,a,t){var r=e.read_shift(4),s=Uh(e,r,t),n=e.read_shift(4);return[s,n>0?Bh(e,n,s,t):null]}var Jh=Kh,Zh=Kh,Qh=Kh,eu=Kh,au={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},tu={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ru={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function su(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,a){return a.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function nu(e){var a=e.split(":");return[a[0].split(".")[0],a[0].split(".")[1]+(a.length>1?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}var iu={},ou={};function lu(e,a){if(e){var t=[.7,.7,.75,.75,.3,.3];"xlml"==a&&(t=[1,1,1,1,.5,.5]),null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer&&(e.footer=t[5])}}function cu(e,a,t,r,s,n){try{r.cellNF&&(e.z=_n[a])}catch(o){if(r.WTF)throw o}if("z"!==e.t||r.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=Si(e.v)),(!r||!1!==r.cellText)&&"z"!==e.t)try{if(null==_n[a]&&ci(hi[a]||"General",a),"e"===e.t)e.w=e.w||Jl[e.v];else if(0===a)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Bn(e.v);else if("d"===e.t){var i=bi(e.v);e.w=(0|i)===i?i.toString(10):Bn(i)}else{if(void 0===e.v)return"";e.w=Un(e.v,ou)}else"d"===e.t?e.w=li(a,bi(e.v),ou):e.w=li(a,e.v,ou)}catch(o){if(r.WTF)throw o}if(r.cellStyles&&null!=t)try{e.s=n.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Fd(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Fd(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(r.WTF&&n.Fills)throw o}}}var du=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,hu=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,uu=/<(?:\w:)?hyperlink [^>]*>/gm,mu=/"(\w*:\w*)"/,fu=/<(?:\w:)?col\b[^>]*[\/]?>/g,gu=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pu=/<(?:\w:)?pageMargins[^>]*\/>/g,xu=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,bu=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,vu=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function yu(e,a,t,r,s,n,i){if(!e)return e;r||(r={"!id":{}});var o=a.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",h=e.match(hu);h?(c=e.slice(0,h.index),d=e.slice(h.index+h[0].length)):c=d=e;var u=c.match(xu);u?wu(u[0],o,s,t):(u=c.match(bu))&&function(e,a,t,r,s){wu(e.slice(0,e.indexOf(">")),t,r,s)}(u[0],u[1],o,s,t);var m=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var f=c.slice(m,m+50).match(mu);f&&function(e,a){var t=Nl(a);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=wl(t))}(o,f[1])}var g=c.match(vu);g&&g[1]&&function(e,a){a.Views||(a.Views=[{}]);(e.match(Nu)||[]).forEach(function(e,t){var r=Ji(e);a.Views[t]||(a.Views[t]={}),+r.zoomScale&&(a.Views[t].zoom=+r.zoomScale),io(r.rightToLeft)&&(a.Views[t].RTL=!0)})}(g[1],s);var p=[];if(a.cellStyles){var x=c.match(fu);x&&function(e,a){for(var t=!1,r=0;r!=a.length;++r){var s=Ji(a[r],!0);s.hidden&&(s.hidden=io(s.hidden));var n=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!t&&s.width&&(t=!0,Vd(s.width)),Hd(s);n<=i;)e[n++]=Ai(s)}}(p,x)}h&&ju(h[1],o,a,l,n,i);var b=d.match(gu);b&&(o["!autofilter"]=function(e){var a={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return a}(b[0]));var v=[],y=d.match(du);if(y)for(m=0;m!=y.length;++m)v[m]=Nl(y[m].slice(y[m].indexOf('"')+1));var w=d.match(uu);w&&function(e,a,t){for(var r=Array.isArray(e),s=0;s!=a.length;++s){var n=Ji(uo(a[s]),!0);if(!n.ref)return;var i=((t||{})["!id"]||[])[n.id];i?(n.Target=i.Target,n.location&&(n.Target+="#"+ao(n.location))):(n.Target="#"+ao(n.location),i={Target:n.Target,TargetMode:"Internal"}),n.Rel=i,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var o=Nl(n.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=vl({c:c,r:l});r?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=n):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=n)}}}(o,w,r);var N,j,k=d.match(pu);if(k&&(o["!margins"]=(N=Ji(k[0]),j={},["left","right","top","bottom","header","footer"].forEach(function(e){N[e]&&(j[e]=parseFloat(N[e]))}),j)),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=wl(l)),a.sheetRows>0&&o["!ref"]){var E=Nl(o["!ref"]);a.sheetRows<=+E.e.r&&(E.e.r=a.sheetRows-1,E.e.r>l.e.r&&(E.e.r=l.e.r),E.e.r<E.s.r&&(E.s.r=E.e.r),E.e.c>l.e.c&&(E.e.c=l.e.c),E.e.c<E.s.c&&(E.s.c=E.e.c),o["!fullref"]=o["!ref"],o["!ref"]=wl(E))}return p.length>0&&(o["!cols"]=p),v.length>0&&(o["!merges"]=v),o}function wu(e,a,t,r){var s=Ji(e);t.Sheets[r]||(t.Sheets[r]={}),s.codeName&&(t.Sheets[r].CodeName=ao(uo(s.codeName)))}var Nu=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var ju=function(){var e=/<(?:\w+:)?c[ \/>]/,a=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,n=fo("v"),i=fo("f");return function(o,l,c,d,h,u){for(var m,f,g,p,x,b=0,v="",y=[],w=[],N=0,j=0,k=0,E="",T=0,S=0,C=0,A=0,_=Array.isArray(u.CellXf),R=[],O=[],I=Array.isArray(l),M=[],P={},L=!1,D=!!c.sheetStubs,F=o.split(a),z=0,B=F.length;z!=B;++z){var U=(v=F[z].trim()).length;if(0!==U){var $=0;e:for(b=0;b<U;++b)switch(v[b]){case">":if("/"!=v[b-1]){++b;break e}if(c&&c.cellStyles){if(T=null!=(f=Ji(v.slice($,b),!0)).r?parseInt(f.r,10):T+1,S=-1,c.sheetRows&&c.sheetRows<T)continue;P={},L=!1,f.ht&&(L=!0,P.hpt=parseFloat(f.ht),P.hpx=Xd(P.hpt)),"1"==f.hidden&&(L=!0,P.hidden=!0),null!=f.outlineLevel&&(L=!0,P.level=+f.outlineLevel),L&&(M[T-1]=P)}break;case"<":$=b}if($>=b)break;if(T=null!=(f=Ji(v.slice($,b),!0)).r?parseInt(f.r,10):T+1,S=-1,!(c.sheetRows&&c.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),c&&c.cellStyles&&(P={},L=!1,f.ht&&(L=!0,P.hpt=parseFloat(f.ht),P.hpx=Xd(P.hpt)),"1"==f.hidden&&(L=!0,P.hidden=!0),null!=f.outlineLevel&&(L=!0,P.level=+f.outlineLevel),L&&(M[T-1]=P)),y=v.slice(b).split(e);for(var W=0;W!=y.length&&"<"==y[W].trim().charAt(0);++W);for(y=y.slice(W),b=0;b!=y.length;++b)if(0!==(v=y[b].trim()).length){if(w=v.match(t),N=b,j=0,k=0,v="<c "+("<"==v.slice(0,1)?">":"")+v,null!=w&&2===w.length){for(N=0,E=w[1],j=0;j!=E.length&&!((k=E.charCodeAt(j)-64)<1||k>26);++j)N=26*N+k;S=--N}else++S;for(j=0;j!=v.length&&62!==v.charCodeAt(j);++j);if(++j,(f=Ji(v.slice(0,j),!0)).r||(f.r=vl({r:T-1,c:S})),m={t:""},null!=(w=(E=v.slice(j)).match(n))&&""!==w[1]&&(m.v=ao(w[1])),c.cellFormula){if(null!=(w=E.match(i))&&""!==w[1]){if(m.f=ao(uo(w[1])).replace(/\r\n/g,"\n"),c.xlfn||(m.f=yh(m.f)),w[0].indexOf('t="array"')>-1)m.F=(E.match(s)||[])[1],m.F.indexOf(":")>-1&&R.push([Nl(m.F),m.F]);else if(w[0].indexOf('t="shared"')>-1){p=Ji(w[0]);var V=ao(uo(w[1]));c.xlfn||(V=yh(V)),O[parseInt(p.si,10)]=[p,V,f.r]}}else(w=E.match(/<f[^>]*\/>/))&&O[(p=Ji(w[0])).si]&&(m.f=vh(O[p.si][1],O[p.si][2],f.r));var H=bl(f.r);for(j=0;j<R.length;++j)H.r>=R[j][0].s.r&&H.r<=R[j][0].e.r&&H.c>=R[j][0].s.c&&H.c<=R[j][0].e.c&&(m.F=R[j][1])}if(null==f.t&&void 0===m.v)if(m.f||m.F)m.v=0,m.t="n";else{if(!D)continue;m.t="z"}else m.t=f.t||"n";switch(d.s.c>S&&(d.s.c=S),d.e.c<S&&(d.e.c=S),m.t){case"n":if(""==m.v||null==m.v){if(!D)continue;m.t="z"}else m.v=parseFloat(m.v);break;case"s":if(void 0===m.v){if(!D)continue;m.t="z"}else g=iu[parseInt(m.v,10)],m.v=g.t,m.r=g.r,c.cellHTML&&(m.h=g.h);break;case"str":m.t="s",m.v=null!=m.v?uo(m.v):"",c.cellHTML&&(m.h=so(m.v));break;case"inlineStr":w=E.match(r),m.t="s",null!=w&&(g=vd(w[1]))?(m.v=g.t,c.cellHTML&&(m.h=g.h)):m.v="";break;case"b":m.v=io(m.v);break;case"d":c.cellDates?m.v=Si(m.v,1):(m.v=bi(Si(m.v,1)),m.t="n");break;case"e":c&&!1===c.cellText||(m.w=m.v),m.v=Zl[m.v]}if(C=A=0,x=null,_&&void 0!==f.s&&null!=(x=u.CellXf[f.s])&&(null!=x.numFmtId&&(C=x.numFmtId),c.cellStyles&&null!=x.fillId&&(A=x.fillId)),cu(m,C,A,c,h,u),c.cellDates&&_&&"n"==m.t&&si(_n[C])&&(m.t="d",m.v=Ni(m.v)),f.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+f.cm-1];G&&"XLDAPR"==G.type&&(m.D=!0)}if(I){var q=bl(f.r);l[q.r]||(l[q.r]=[]),l[q.r][q.c]=m}else l[f.r]=m}}}}M.length>0&&(l["!rows"]=M)}}();var ku=Bl;function Eu(e){return[Il(e),Ul(e),"n"]}var Tu=Bl;var Su=["left","right","top","bottom","header","footer"];function Cu(e,a,t,r,s,n){var i=n||{"!type":"chart"};if(!e)return n;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var a=function(e){var a,t=[],r=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var a=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=r?+a[2]:a[2])});var s=ao((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){a=e.replace(/<.*?>/g,"")}),[t,s,a]}(e);d.s.r=d.s.c=0,d.e.c=o,c=xl(o),a[0].forEach(function(e,t){i[c+gl(t)]={t:"n",v:e,z:a[1]},l=t}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=wl(d)),i}var Au=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_u=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ru=[],Ou=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Iu(e,a){for(var t=0;t!=e.length;++t)for(var r=e[t],s=0;s!=a.length;++s){var n=a[s];if(null==r[n[0]])r[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof r[n[0]]&&(r[n[0]]=io(r[n[0]]));break;case"int":"string"==typeof r[n[0]]&&(r[n[0]]=parseInt(r[n[0]],10))}}}function Mu(e,a){for(var t=0;t!=a.length;++t){var r=a[t];if(null==e[r[0]])e[r[0]]=r[1];else switch(r[2]){case"bool":"string"==typeof e[r[0]]&&(e[r[0]]=io(e[r[0]]));break;case"int":"string"==typeof e[r[0]]&&(e[r[0]]=parseInt(e[r[0]],10))}}}function Pu(e){Mu(e.WBProps,Au),Mu(e.CalcPr,Ou),Iu(e.WBView,_u),Iu(e.Sheets,Ru),ou.date1904=io(e.WBProps.date1904)}var Lu="][*?/\\".split("");var Du=/<\w+:workbook/;function Fu(e,a){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=a-8,t}function zu(e,a,t){return".bin"===a.slice(-4)?function(e,a){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],s=!1;a||(a={}),a.biff=12;var n=[],i=[[]];return i.SheetNames=[],i.XTI=[],gm[16]={n:"BrtFRTArchID$",f:Fu},ll(e,function(e,o,l){switch(l){case 156:i.SheetNames.push(e.name),t.Sheets.push(e);break;case 153:t.WBProps=e;break;case 39:null!=e.Sheet&&(a.SID=e.Sheet),e.Ref=Gh(e.Ptg,0,null,i,a),delete a.SID,delete e.Ptg,n.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,e]):i[0]=[l,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:r.push(l),s=!0;break;case 36:case 38:r.pop(),s=!1;break;default:if(o.T);else if(!s||a.WTF&&37!=r[r.length-1]&&35!=r[r.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},a),Pu(t),t.Names=n,t.supbooks=i,t}(e,t):function(e,a){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,s="xmlns",n={},i=0;if(e.replace(Xi,function(o,l){var c=Ji(o);switch(Zi(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(Du)&&(s="xmlns"+o.match(/<(\w+):/)[1]),t.xmlns=c[s];break;case"<fileVersion":delete c[0],t.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":Au.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":t.WBProps[e[0]]=io(c[e[0]]);break;case"int":t.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:t.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(t.WBProps.CodeName=uo(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],t.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=ao(uo(c.name)),delete c[0],t.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":r=!1;break;case"<definedName":(n={}).Name=uo(c.name),c.comment&&(n.Comment=c.comment),c.localSheetId&&(n.Sheet=+c.localSheetId),io(c.hidden||"0")&&(n.Hidden=!0),i=l+o.length;break;case"</definedName>":n.Ref=ao(uo(e.slice(i,l))),t.Names.push(n);break;case"<calcPr":case"<calcPr/>":delete c[0],t.CalcPr=c;break;default:if(!r&&a.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===Eo.indexOf(t.xmlns))throw new Error("Unknown Namespace: "+t.xmlns);return Pu(t),t}(e,t)}function Bu(e,a,t,r,s,n,i,o){return".bin"===a.slice(-4)?function(e,a,t,r,s,n,i){if(!e)return e;var o=a||{};r||(r={"!id":{}});var l,c,d,h,u,m,f,g,p,x,b=o.dense?[]:{},v={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,w=!1,N=[];o.biff=12,o["!row"]=0;var j=0,k=!1,E=[],T={},S=o.supbooks||s.supbooks||[[]];if(S.sharedf=T,S.arrayf=E,S.SheetNames=s.SheetNames||s.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=S,s.Names))for(var C=0;C<s.Names.length;++C)S[0][C+1]=s.Names[C];var A,_=[],R=[],O=!1;if(gm[16]={n:"BrtShortReal",f:Eu},ll(e,function(e,a,C){if(!w)switch(C){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(w=!0),p=gl(u=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=Xd(e.hpt)),R[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":g=iu[e[1]],d.v=g.t,d.r=g.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==o.cellText&&(d.w=Jl[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((h=i.CellXf[e[0].iStyleRef])&&cu(d,h.numFmtId,null,o,n,i),m=-1==e[0].c?m+1:e[0].c,o.dense?(b[u]||(b[u]=[]),b[u][m]=d):b[xl(m)+p]=d,o.cellFormula){for(k=!1,j=0;j<E.length;++j){var I=E[j];c.r>=I[0].s.r&&c.r<=I[0].e.r&&m>=I[0].s.c&&m<=I[0].e.c&&(d.F=wl(I[0]),k=!0)}!k&&e.length>3&&(d.f=e[3])}if(v.s.r>c.r&&(v.s.r=c.r),v.s.c>m&&(v.s.c=m),v.e.r<c.r&&(v.e.r=c.r),v.e.c<m&&(v.e.c=m),o.cellDates&&h&&"n"==d.t&&si(_n[h.numFmtId])){var M=Mn(d.v);M&&(d.t="d",d.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}A&&("XLDAPR"==A.type&&(d.D=!0),A=void 0);break;case 1:case 12:if(!o.sheetStubs||y)break;d={t:"z",v:void 0},m=-1==e[0].c?m+1:e[0].c,o.dense?(b[u]||(b[u]=[]),b[u][m]=d):b[xl(m)+p]=d,v.s.r>c.r&&(v.s.r=c.r),v.s.c>m&&(v.s.c=m),v.e.r<c.r&&(v.e.r=c.r),v.e.c<m&&(v.e.c=m),A&&("XLDAPR"==A.type&&(d.D=!0),A=void 0);break;case 176:N.push(e);break;case 49:A=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var P=r["!id"][e.relId];for(P?(e.Target=P.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=P):""==e.relId&&(e.Target="#"+e.loc),u=e.rfx.s.r;u<=e.rfx.e.r;++u)for(m=e.rfx.s.c;m<=e.rfx.e.c;++m)o.dense?(b[u]||(b[u]=[]),b[u][m]||(b[u][m]={t:"z",v:void 0}),b[u][m].l=e):(f=vl({c:m,r:u}),b[f]||(b[f]={t:"z",v:void 0}),b[f].l=e);break;case 426:if(!o.cellFormula)break;E.push(e),(x=o.dense?b[u][m]:b[xl(m)+p]).f=Gh(e[1],0,{r:c.r,c:m},S,o),x.F=wl(e[0]);break;case 427:if(!o.cellFormula)break;T[vl(e[0].s)]=e[1],(x=o.dense?b[u][m]:b[xl(m)+p]).f=Gh(e[1],0,{r:c.r,c:m},S,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)_[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},O||(O=!0,Vd(e.w/256)),Hd(_[e.e+1]);break;case 161:b["!autofilter"]={ref:wl(e)};break;case 476:b["!margins"]=e;break;case 147:s.Sheets[t]||(s.Sheets[t]={}),e.name&&(s.Sheets[t].CodeName=e.name),(e.above||e.left)&&(b["!outline"]={above:e.above,left:e.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),e.RTL&&(s.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:case 37:y=!0;break;case 36:case 38:y=!1;break;default:if(a.T);else if(!y||o.WTF)throw new Error("Unexpected record 0x"+C.toString(16))}},o),delete o.supbooks,delete o["!row"],!b["!ref"]&&(v.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(b["!ref"]=wl(l||v)),o.sheetRows&&b["!ref"]){var I=Nl(b["!ref"]);o.sheetRows<=+I.e.r&&(I.e.r=o.sheetRows-1,I.e.r>v.e.r&&(I.e.r=v.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>v.e.c&&(I.e.c=v.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),b["!fullref"]=b["!ref"],b["!ref"]=wl(I))}return N.length>0&&(b["!merges"]=N),_.length>0&&(b["!cols"]=_),R.length>0&&(b["!rows"]=R),b}(e,r,t,s,n,i,o):yu(e,r,t,s,n,i,o)}function Uu(e,a,t,r,s,n,i,o){return".bin"===a.slice(-4)?function(e,a,t,r,s){if(!e)return e;r||(r={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ll(e,function(e,r,o){switch(o){case 550:n["!rel"]=e;break;case 651:s.Sheets[t]||(s.Sheets[t]={}),e.name&&(s.Sheets[t].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(r.T>0);else if(r.T<0);else if(!i||a.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}},a),r["!id"][n["!rel"]]&&(n["!drawel"]=r["!id"][n["!rel"]]),n}(e,r,t,s,n):function(e,a,t,r,s){if(!e)return e;r||(r={"!id":{}});var n,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(xu);return o&&wu(o[0],0,s,t),(n=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=n[1]),r["!id"][i["!rel"]]&&(i["!drawel"]=r["!id"][i["!rel"]]),i}(e,0,t,s,n)}function $u(e,a,t,r){return".bin"===a.slice(-4)?function(e,a,t){var r={NumberFmt:[]};for(var s in _n)r.NumberFmt[s]=_n[s];r.CellXf=[],r.Fonts=[];var n=[],i=!1;return ll(e,function(e,s,o){switch(o){case 44:r.NumberFmt[e[0]]=e[1],ci(e[1],e[0]);break;case 43:r.Fonts.push(e),null!=e.color.theme&&a&&a.themeElements&&a.themeElements.clrScheme&&(e.color.rgb=Fd(a.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==n[n.length-1]&&r.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:n.push(o),i=!0;break;case 38:n.pop(),i=!1;break;default:if(s.T>0)n.push(o);else if(s.T<0)n.pop();else if(!i||t.WTF&&37!=n[n.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),r}(e,t,r):Zd(e,t,r)}function Wu(e,a,t){return".bin"===a.slice(-4)?function(e,a){var t=[],r=!1;return ll(e,function(e,s,n){switch(n){case 159:t.Count=e[0],t.Unique=e[1];break;case 19:t.push(e);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(s.T,!r||a.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}}),t}(e,t):function(e,a){var t=[],r="";if(!e)return t;var s=e.match(yd);if(s){r=s[2].replace(wd,"").split(Nd);for(var n=0;n!=r.length;++n){var i=vd(r[n].trim(),a);null!=i&&(t[t.length]=i)}s=Ji(s[1]),t.Count=s.count,t.Unique=s.uniqueCount}return t}(e,t)}function Vu(e,a,t){return".bin"===a.slice(-4)?function(e,a){var t=[],r=[],s={},n=!1;return ll(e,function(e,i,o){switch(o){case 632:r.push(e);break;case 635:s=e;break;case 637:s.t=e.t,s.h=e.h,s.r=e.r;break;case 636:if(s.author=r[s.iauthor],delete s.iauthor,a.sheetRows&&s.rfx&&a.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,t.push(s);break;case 3072:case 37:case 38:break;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T);else if(!n||a.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),t}(e,t):function(e,a){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&t.push(a[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var s=e.match(/<(?:\w+:)?comment[^>]*>/);if(s){var n=Ji(s[0]),i={author:n.authorId&&t[n.authorId]||"sheetjsghost",ref:n.ref,guid:n.guid},o=bl(n.ref);if(!(a.sheetRows&&a.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&vd(l[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),a.cellHTML&&(i.h=c.h),r.push(i)}}}}),r}(e,t)}function Hu(e,a,t){return".bin"===a.slice(-4)?function(e){var a=[];return ll(e,function(e,t,r){if(63===r)a.push(e);else if(!t.T)throw new Error("Unexpected record 0x"+r.toString(16))}),a}(e):function(e){var a=[];if(!e)return a;var t=1;return(e.match(Xi)||[]).forEach(function(e){var r=Ji(e);switch(r[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?t=r.i:r.i=t,a.push(r)}}),a}(e)}function Gu(e,a,t,r){if(".bin"===t.slice(-4))return function(e,a,t,r){if(!e)return e;var s=r||{},n=!1;ll(e,function(e,a,t){switch(t){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T);else if(!n||s.WTF)throw new Error("Unexpected record 0x"+t.toString(16))}},s)}(e,0,0,r)}function qu(e,a,t){return".bin"===a.slice(-4)?function(e,a,t){var r={Types:[],Cell:[],Value:[]},s=t||{},n=[],i=!1,o=2;return ll(e,function(e,a,t){switch(t){case 335:r.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?r.Cell.push({type:r.Types[e[0]-1].name,index:e[1]}):0==o&&r.Value.push({type:r.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:n.push(t),i=!0;break;case 36:n.pop(),i=!1;break;default:if(a.T);else if(!i||s.WTF&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+t.toString(16))}}),r}(e,0,t):function(e,a,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var s,n=!1,i=2;return e.replace(Xi,function(e){var a=Ji(e);switch(Zi(a[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":r.Types.push({name:a.name});break;case"<futureMetadata":for(var o=0;o<r.Types.length;++o)r.Types[o].name==a.name&&(s=r.Types[o]);break;case"<rc":1==i?r.Cell.push({type:r.Types[a.t-1].name,index:+a.v}):0==i&&r.Value.push({type:r.Types[a.t-1].name,index:+a.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+a.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in metadata")}return e}),r}(e,0,t)}var Xu,Yu=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ku=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ju(e,a){var t=e.split(/\s+/),r=[];if(r[0]=t[0],1===t.length)return r;var s,n,i,o=e.match(Yu);if(o)for(i=0;i!=o.length;++i)-1===(n=(s=o[i].match(Ku))[1].indexOf(":"))?r[s[1]]=s[2].slice(1,s[2].length-1):r["xmlns:"===s[1].slice(0,6)?"xmlns"+s[1].slice(6):s[1].slice(n+1)]=s[2].slice(1,s[2].length-1);return r}function Zu(e){var a={};if(1===e.split(/\s+/).length)return a;var t,r,s,n=e.match(Yu);if(n)for(s=0;s!=n.length;++s)-1===(r=(t=n[s].match(Ku))[1].indexOf(":"))?a[t[1]]=t[2].slice(1,t[2].length-1):a["xmlns:"===t[1].slice(0,6)?"xmlns"+t[1].slice(6):t[1].slice(r+1)]=t[2].slice(1,t[2].length-1);return a}function Qu(e,a,t,r){var s=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=io(r);break;case"i2":case"int":s=parseInt(r,10);break;case"r4":case"float":s=parseFloat(r);break;case"date":case"dateTime.tz":s=Si(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[ao(a)]=s}function em(e,a,t){if("z"!==e.t){if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Jl[e.v]:"General"===a?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Bn(e.v):e.w=Un(e.v):e.w=(r=a||"General",s=e.v,"General"===(n=Xu[r]||ao(r))?Un(s):li(n,s))}catch(l){if(t.WTF)throw l}var r,s,n;try{var i=Xu[a]||a||"General";if(t.cellNF&&(e.z=i),t.cellDates&&"n"==e.t&&si(i)){var o=Mn(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(l){if(t.WTF)throw l}}}function am(e,a,t){if(t.cellStyles&&a.Interior){var r=a.Interior;r.Pattern&&(r.patternType=Yd[r.Pattern]||r.Pattern)}e[a.ID]=a}function tm(e,a,t,r,s,n,i,o,l,c){var d="General",h=r.StyleID,u={};c=c||{};var m=[],f=0;for(void 0===h&&o&&(h=o.StyleID),void 0===h&&i&&(h=i.StyleID);void 0!==n[h]&&(n[h].nf&&(d=n[h].nf),n[h].Interior&&m.push(n[h].Interior),n[h].Parent);)h=n[h].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=io(e);break;case"String":r.t="s",r.r=no(ao(e)),r.v=e.indexOf("<")>-1?ao(a||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),r.v=(Si(e)-new Date(Date.UTC(1899,11,30)))/864e5,r.v!=r.v?r.v=ao(e):r.v<60&&(r.v=r.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===r.v&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=Zl[e],!1!==c.cellText&&(r.w=e);break;default:""==e&&""==a?r.t="z":(r.t="s",r.v=no(a||e))}if(em(r,d,c),!1!==c.cellFormula)if(r.Formula){var g=ao(r.Formula);61==g.charCodeAt(0)&&(g=g.slice(1)),r.f=gh(g,s),delete r.Formula,"RC"==r.ArrayRange?r.F=gh("RC:RC",s):r.ArrayRange&&(r.F=gh(r.ArrayRange,s),l.push([Nl(r.F),r.F]))}else for(f=0;f<l.length;++f)s.r>=l[f][0].s.r&&s.r<=l[f][0].e.r&&s.c>=l[f][0].s.c&&s.c<=l[f][0].e.c&&(r.F=l[f][1]);c.cellStyles&&(m.forEach(function(e){!u.patternType&&e.patternType&&(u.patternType=e.patternType)}),r.s=u),void 0!==r.StyleID&&(r.ixfe=r.StyleID)}function rm(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function sm(e,a){var t=a||{};di();var r=sn(No(e));"binary"!=t.type&&"array"!=t.type&&"base64"!=t.type||(r=uo(r));var s,n=r.slice(0,1024).toLowerCase(),i=!1;if((1023&(n=n.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&n.indexOf(","),1023&n.indexOf(";"))){var o=Ai(t);return o.type="string",ud.to_workbook(r,o)}if(-1==n.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){n.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,a){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||0==t.length)throw new Error("Invalid HTML: could not find <table>");if(1==t.length)return El(bm(t[0],a),a);var r={SheetNames:[],Sheets:{}};return t.forEach(function(e,t){cf(r,bm(e,a),"Sheet"+(t+1))}),r}(r,t);Xu={"General Number":"General","General Date":_n[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":_n[15],"Short Date":_n[14],"Long Time":_n[19],"Medium Time":_n[18],"Short Time":_n[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:_n[2],Standard:_n[4],Percent:_n[10],Scientific:_n[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c,d=[],h={},u=[],m=t.dense?[]:{},f="",g={},p={},x=Ju('<Data ss:Type="String">'),b=0,v=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},j={},k="",E=0,T=[],S={},C={},A=0,_=[],R=[],O={},I=[],M=!1,P=[],L=[],D={},F=0,z=0,B={Sheets:[],WBProps:{date1904:!1}},U={};jo.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/gm,"");for(var $="";s=jo.exec(r);)switch(s[3]=($=s[3]).toLowerCase()){case"data":if("data"==$){if("/"===s[1]){if((l=d.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&d.push([s[3],!0]);break}if(d[d.length-1][1])break;"/"===s[1]?tm(r.slice(b,s.index),k,x,"comment"==d[d.length-1][0]?O:g,{c:v,r:y},N,I[v],p,P,t):(k="",x=Ju(s[0]),b=s.index+s[0].length);break;case"cell":if("/"===s[1])if(R.length>0&&(g.c=R),(!t.sheetRows||t.sheetRows>y)&&void 0!==g.v&&(t.dense?(m[y]||(m[y]=[]),m[y][v]=g):m[xl(v)+gl(y)]=g),g.HRef&&(g.l={Target:ao(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(F=v+(0|parseInt(g.MergeAcross,10)),z=y+(0|parseInt(g.MergeDown,10)),T.push({s:{c:v,r:y},e:{c:F,r:z}})),t.sheetStubs)if(g.MergeAcross||g.MergeDown){for(var W=v;W<=F;++W)for(var V=y;V<=z;++V)(W>v||V>y)&&(t.dense?(m[V]||(m[V]=[]),m[V][W]={t:"z"}):m[xl(W)+gl(V)]={t:"z"});v=F+1}else++v;else g.MergeAcross?v=F+1:++v;else(g=Zu(s[0])).Index&&(v=+g.Index-1),v<w.s.c&&(w.s.c=v),v>w.e.c&&(w.e.c=v),"/>"===s[0].slice(-2)&&++v,R=[];break;case"row":"/"===s[1]||"/>"===s[0].slice(-2)?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),"/>"===s[0].slice(-2)&&(p=Ju(s[0])).Index&&(y=+p.Index-1),v=0,++y):((p=Ju(s[0])).Index&&(y=+p.Index-1),D={},("0"==p.AutoFitHeight||p.Height)&&(D.hpx=parseInt(p.Height,10),D.hpt=qd(D.hpx),L[y]=D),"1"==p.Hidden&&(D.hidden=!0,L[y]=D));break;case"worksheet":if("/"===s[1]){if((l=d.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"));u.push(f),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(m["!ref"]=wl(w),t.sheetRows&&t.sheetRows<=w.e.r&&(m["!fullref"]=m["!ref"],w.e.r=t.sheetRows-1,m["!ref"]=wl(w))),T.length&&(m["!merges"]=T),I.length>0&&(m["!cols"]=I),L.length>0&&(m["!rows"]=L),h[f]=m}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=v=0,d.push([s[3],!1]),l=Ju(s[0]),f=ao(l.Name),m=t.dense?[]:{},T=[],P=[],L=[],U={name:f,Hidden:0},B.Sheets.push(U);break;case"table":if("/"===s[1]){if((l=d.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==s[0].slice(-2))break;d.push([s[3],!1]),I=[],M=!1}break;case"style":"/"===s[1]?am(N,j,t):j=Ju(s[0]);break;case"numberformat":j.nf=ao(Ju(s[0]).Format||"General"),Xu[j.nf]&&(j.nf=Xu[j.nf]);for(var H=0;392!=H&&_n[H]!=j.nf;++H);if(392==H)for(H=57;392!=H;++H)if(null==_n[H]){ci(j.nf,H);break}break;case"column":if("table"!==d[d.length-1][0])break;if((c=Ju(s[0])).Hidden&&(c.hidden=!0,delete c.Hidden),c.Width&&(c.wpx=parseInt(c.Width,10)),!M&&c.wpx>10){M=!0,zd=6;for(var G=0;G<I.length;++G)I[G]&&Hd(I[G])}M&&Hd(c),I[c.Index-1||I.length]=c;for(var q=0;q<+c.Span;++q)I[I.length]=Ai(c);break;case"namedrange":if("/"===s[1])break;B.Names||(B.Names=[]);var X=Ji(s[0]),Y={Name:X.Name,Ref:gh(X.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Y.Sheet=B.Sheets.length-1),B.Names.push(Y);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===s[0].slice(-2))break;"/"===s[1]?k+=r.slice(E,s.index):E=s.index+s[0].length;break;case"interior":if(!t.cellStyles)break;j.Interior=Ju(s[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===s[0].slice(-2))break;"/"===s[1]?hc(S,$,r.slice(A,s.index)):A=s.index+s[0].length;break;case"styles":case"workbook":if("/"===s[1]){if((l=d.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else d.push([s[3],!1]);break;case"comment":if("/"===s[1]){if((l=d.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"));rm(O),R.push(O)}else d.push([s[3],!1]),O={a:(l=Ju(s[0])).Author};break;case"autofilter":if("/"===s[1]){if((l=d.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==s[0].charAt(s[0].length-2)){var K=Ju(s[0]);m["!autofilter"]={ref:gh(K.Range).replace(/\$/g,"")},d.push([s[3],!0])}break;case"datavalidation":if("/"===s[1]){if((l=d.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&d.push([s[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===s[1]){if((l=d.pop())[0]!==s[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==s[0].charAt(s[0].length-2)&&d.push([s[3],!0]);break;default:if(0==d.length&&"document"==s[3])return Sm(r,t);if(0==d.length&&"uof"==s[3])return Sm(r,t);var J=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(s[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(s[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(s[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(s[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(s[3]){case"visible":if("/>"===s[0].slice(-2));else if("/"===s[1])switch(r.slice(A,s.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2}else A=s.index+s[0].length;break;case"header":m["!margins"]||lu(m["!margins"]={},"xlml"),isNaN(+Ji(s[0]).Margin)||(m["!margins"].header=+Ji(s[0]).Margin);break;case"footer":m["!margins"]||lu(m["!margins"]={},"xlml"),isNaN(+Ji(s[0]).Margin)||(m["!margins"].footer=+Ji(s[0]).Margin);break;case"pagemargins":var Z=Ji(s[0]);m["!margins"]||lu(m["!margins"]={},"xlml"),isNaN(+Z.Top)||(m["!margins"].top=+Z.Top),isNaN(+Z.Left)||(m["!margins"].left=+Z.Left),isNaN(+Z.Right)||(m["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(m["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(s[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(s[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(s[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(s[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(s[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(s[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(s[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(s[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+s[3]+"|"+d.join("|");if("customdocumentproperties"===d[d.length-1][0]){if("/>"===s[0].slice(-2))break;"/"===s[1]?Qu(C,$,_,r.slice(A,s.index)):(_=s,A=s.index+s[0].length);break}if(t.WTF)throw"Unrecognized tag: "+s[3]+"|"+d.join("|")}var Q={};return t.bookSheets||t.bookProps||(Q.Sheets=h),Q.SheetNames=u,Q.Workbook=B,Q.SSF=Ai(_n),Q.Props=S,Q.Custprops=C,Q}function nm(e,a){switch(Hm(a=a||{}),a.type||"base64"){case"base64":return sm(dn(e),a);case"binary":case"buffer":case"file":return sm(e,a);case"array":return sm(pn(e),a)}}function im(e){var a={},t=e.content;if(t.l=28,a.AnsiUserType=t.read_shift(0,"lpstr-ansi"),a.AnsiClipboardFormat=function(e){return $l(e,1)}(t),t.length-t.l<=4)return a;var r=t.read_shift(4);return 0==r||r>40?a:(t.l-=4,a.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4||1907505652!==(r=t.read_shift(4))?a:(a.UnicodeClipboardFormat=function(e){return $l(e,2)}(t),0==(r=t.read_shift(4))||r>40?a:(t.l-=4,void(a.Reserved2=t.read_shift(0,"lpwstr")))))}var om=[60,1084,2066,2165,2175];function lm(e,a,t,r,s){var n=r,i=[],o=t.slice(t.l,t.l+n);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:s.enc.insitu(o)}i.push(o),t.l+=n;for(var l=Xo(t,t.l),c=pm[l],d=0;null!=c&&om.indexOf(l)>-1;)n=Xo(t,t.l+2),d=t.l+4,2066==l?d+=4:2165!=l&&2175!=l||(d+=12),o=t.slice(d,t.l+4+n),i.push(o),t.l+=4+n,c=pm[l=Xo(t,t.l)];var h=bn(i);nl(h,0);var u=0;h.lens=[];for(var m=0;m<i.length;++m)h.lens.push(u),u+=i[m].length;if(h.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+r;return a.f(h,h.length,s)}function cm(e,a,t){if("z"!==e.t&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,a.cellNF&&(e.z=_n[r])}catch(n){if(a.WTF)throw n}if(!a||!1!==a.cellText)try{"e"===e.t?e.w=e.w||Jl[e.v]:0===r||"General"==r?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Bn(e.v):e.w=Un(e.v):e.w=li(r,e.v,{date1904:!!t,dateNF:a&&a.dateNF})}catch(n){if(a.WTF)throw n}if(a.cellDates&&r&&"n"==e.t&&si(_n[r]||String(r))){var s=Mn(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function dm(e,a,t){return{v:e,ixfe:a,t:t}}function hm(e,a){var t,r,s,n,i,o,l,c,d={opts:{}},h={},u=a.dense?[]:{},m={},f={},g=null,p=[],x="",b={},v="",y={},w=[],N=[],j=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},T=function(e){return e<8?Kl[e]:e<64&&j[e-8]||Kl[e]},S=function(e,a,r){if(!(D>1||r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&a.XF&&a.XF.data&&function(e,a,t){var r,s=a.XF.data;s&&s.patternType&&t&&t.cellStyles&&(a.s={},a.s.patternType=s.patternType,(r=Dd(T(s.icvFore)))&&(a.s.fgColor={rgb:r}),(r=Dd(T(s.icvBack)))&&(a.s.bgColor={rgb:r}))}(0,a,r),delete a.ixfe,delete a.XF,t=e,v=vl(e),f&&f.s&&f.e||(f={s:{r:0,c:0},e:{r:0,c:0}}),e.r<f.s.r&&(f.s.r=e.r),e.c<f.s.c&&(f.s.c=e.c),e.r+1>f.e.r&&(f.e.r=e.r+1),e.c+1>f.e.c&&(f.e.c=e.c+1),r.cellFormula&&a.f)for(var s=0;s<w.length;++s)if(!(w[s][0].s.c>e.c||w[s][0].s.r>e.r||w[s][0].e.c<e.c||w[s][0].e.r<e.r)){a.F=wl(w[s][0]),w[s][0].s.c==e.c&&w[s][0].s.r==e.r||delete a.f,a.f&&(a.f=""+Gh(w[s][1],0,e,M,C));break}r.dense?(u[e.r]||(u[e.r]=[]),u[e.r][e.c]=a):u[v]=a}},C={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!a&&!!a.cellStyles,WTF:!!a&&!!a.wtf};a.password&&(C.password=a.password);var A=[],_=[],R=[],O=[],I=!1,M=[];M.SheetNames=C.snames,M.sharedf=C.sharedf,M.arrayf=C.arrayf,M.names=[],M.XTI=[];var P,L=0,D=0,F=0,z=[],B=[];C.codepage=1200,Qs(1200);for(var U=!1;e.l<e.length-1;){var $=e.l,W=e.read_shift(2);if(0===W&&10===L)break;var V=e.l===e.length?0:e.read_shift(2),H=pm[W];if(H&&H.f){if(a.bookSheets&&133===L&&133!==W)break;if(L=W,2===H.r||12==H.r){var G=e.read_shift(2);if(V-=2,!C.enc&&G!==W&&((255&G)<<8|G>>8)!==W)throw new Error("rt mismatch: "+G+"!="+W);12==H.r&&(e.l+=10,V-=10)}var q={};if(q=10===W?H.f(e,V,C):lm(W,H,e,V,C),0==D&&-1===[9,521,1033,2057].indexOf(L))continue;switch(W){case 34:d.opts.Date1904=k.WBProps.date1904=q;break;case 134:d.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=q,!a.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=q;break;case 66:var X=Number(q);switch(X){case 21010:X=1200;break;case 32768:X=1e4;break;case 32769:X=1252}Qs(C.codepage=X),U=!0;break;case 317:C.rrtabid=q;break;case 25:C.winlocked=q;break;case 439:d.opts.RefreshAll=q;break;case 12:d.opts.CalcCount=q;break;case 16:d.opts.CalcDelta=q;break;case 17:d.opts.CalcIter=q;break;case 13:d.opts.CalcMode=q;break;case 14:d.opts.CalcPrecision=q;break;case 95:d.opts.CalcSaveRecalc=q;break;case 15:C.CalcRefMode=q;break;case 2211:d.opts.FullCalc=q;break;case 129:q.fDialog&&(u["!type"]="dialog"),q.fBelow||((u["!outline"]||(u["!outline"]={})).above=!0),q.fRight||((u["!outline"]||(u["!outline"]={})).left=!0);break;case 224:N.push(q);break;case 430:M.push([q]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(q);break;case 24:case 536:P={Name:q.Name,Ref:Gh(q.rgce,0,null,M,C)},q.itab>0&&(P.Sheet=q.itab-1),M.names.push(P),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(B[q.itab-1]={ref:wl(q.rgce[0][0][1][2])});break;case 22:C.ExternCount=q;break;case 23:0==M.length&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(q),M.XTI=M.XTI.concat(q);break;case 2196:if(C.biff<8)break;null!=P&&(P.Comment=q[1]);break;case 18:u["!protect"]=q;break;case 19:0!==q&&C.WTF;break;case 133:m[q.pos]=q,C.snames.push(q.name);break;case 10:if(--D)break;if(f.e){if(f.e.r>0&&f.e.c>0){if(f.e.r--,f.e.c--,u["!ref"]=wl(f),a.sheetRows&&a.sheetRows<=f.e.r){var Y=f.e.r;f.e.r=a.sheetRows-1,u["!fullref"]=u["!ref"],u["!ref"]=wl(f),f.e.r=Y}f.e.r++,f.e.c++}A.length>0&&(u["!merges"]=A),_.length>0&&(u["!objects"]=_),R.length>0&&(u["!cols"]=R),O.length>0&&(u["!rows"]=O),k.Sheets.push(E)}""===x?b=u:h[x]=u,u=a.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===C.biff&&(C.biff={9:2,521:3,1033:4}[W]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),C.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(C.biff=5,U=!0,Qs(C.codepage=28591)),8==C.biff&&0==q.BIFFVer&&16==q.dt&&(C.biff=2),D++)break;if(u=a.dense?[]:{},C.biff<8&&!U&&(U=!0,Qs(C.codepage=a.codepage||1252)),C.biff<5||0==q.BIFFVer&&4096==q.dt){""===x&&(x="Sheet1"),f={s:{r:0,c:0},e:{r:0,c:0}};var K={pos:e.l-V,name:x};m[K.pos]=K,C.snames.push(x)}else x=(m[$]||{name:""}).name;32==q.dt&&(u["!type"]="chart"),64==q.dt&&(u["!type"]="macro"),A=[],_=[],C.arrayf=w=[],R=[],O=[],I=!1,E={Hidden:(m[$]||{hs:0}).hs,name:x};break;case 515:case 3:case 2:"chart"==u["!type"]&&(a.dense?(u[q.r]||[])[q.c]:u[vl({c:q.c,r:q.r})])&&++q.c,o={ixfe:q.ixfe,XF:N[q.ixfe]||{},v:q.val,t:"n"},F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S({c:q.c,r:q.r},o,a);break;case 5:case 517:o={ixfe:q.ixfe,XF:N[q.ixfe],v:q.val,t:q.t},F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S({c:q.c,r:q.r},o,a);break;case 638:o={ixfe:q.ixfe,XF:N[q.ixfe],v:q.rknum,t:"n"},F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S({c:q.c,r:q.r},o,a);break;case 189:for(var J=q.c;J<=q.C;++J){var Z=q.rkrec[J-q.c][0];o={ixfe:Z,XF:N[Z],v:q.rkrec[J-q.c][1],t:"n"},F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S({c:J,r:q.r},o,a)}break;case 6:case 518:case 1030:if("String"==q.val){g=q;break}if((o=dm(q.val,q.cell.ixfe,q.tt)).XF=N[o.ixfe],a.cellFormula){var Q=q.formula;if(Q&&Q[0]&&Q[0][0]&&"PtgExp"==Q[0][0][0]){var ee=Q[0][0][1][0],ae=Q[0][0][1][1],te=vl({r:ee,c:ae});y[te]?o.f=""+Gh(q.formula,0,q.cell,M,C):o.F=((a.dense?(u[ee]||[])[ae]:u[te])||{}).F}else o.f=""+Gh(q.formula,0,q.cell,M,C)}F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S(q.cell,o,a),g=q;break;case 7:case 519:if(!g)throw new Error("String record expects Formula");g.val=q,(o=dm(q,g.cell.ixfe,"s")).XF=N[o.ixfe],a.cellFormula&&(o.f=""+Gh(g.formula,0,g.cell,M,C)),F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S(g.cell,o,a),g=null;break;case 33:case 545:w.push(q);var re=vl(q[0].s);if(r=a.dense?(u[q[0].s.r]||[])[q[0].s.c]:u[re],a.cellFormula&&r){if(!g)break;if(!re||!r)break;r.f=""+Gh(q[1],0,q[0],M,C),r.F=wl(q[0])}break;case 1212:if(!a.cellFormula)break;if(v){if(!g)break;y[vl(g.cell)]=q[0],((r=a.dense?(u[g.cell.r]||[])[g.cell.c]:u[vl(g.cell)])||{}).f=""+Gh(q[0],0,t,M,C)}break;case 253:o=dm(p[q.isst].t,q.ixfe,"s"),p[q.isst].h&&(o.h=p[q.isst].h),o.XF=N[o.ixfe],F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S({c:q.c,r:q.r},o,a);break;case 513:a.sheetStubs&&(o={ixfe:q.ixfe,XF:N[q.ixfe],t:"z"},F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S({c:q.c,r:q.r},o,a));break;case 190:if(a.sheetStubs)for(var se=q.c;se<=q.C;++se){var ne=q.ixfe[se-q.c];o={ixfe:ne,XF:N[ne],t:"z"},F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S({c:se,r:q.r},o,a)}break;case 214:case 516:case 4:(o=dm(q.val,q.ixfe,"s")).XF=N[o.ixfe],F>0&&(o.z=z[o.ixfe>>8&63]),cm(o,a,d.opts.Date1904),S({c:q.c,r:q.r},o,a);break;case 0:case 512:1===D&&(f=q);break;case 252:p=q;break;case 1054:if(4==C.biff){z[F++]=q[1];for(var ie=0;ie<F+163&&_n[ie]!=q[1];++ie);ie>=163&&ci(q[1],F+163)}else ci(q[1],q[0]);break;case 30:z[F++]=q;for(var oe=0;oe<F+163&&_n[oe]!=q;++oe);oe>=163&&ci(q,F+163);break;case 229:A=A.concat(q);break;case 93:_[q.cmo[0]]=C.lastobj=q;break;case 438:C.lastobj.TxO=q;break;case 127:C.lastobj.ImData=q;break;case 440:for(i=q[0].s.r;i<=q[0].e.r;++i)for(n=q[0].s.c;n<=q[0].e.c;++n)(r=a.dense?(u[i]||[])[n]:u[vl({c:n,r:i})])&&(r.l=q[1]);break;case 2048:for(i=q[0].s.r;i<=q[0].e.r;++i)for(n=q[0].s.c;n<=q[0].e.c;++n)(r=a.dense?(u[i]||[])[n]:u[vl({c:n,r:i})])&&r.l&&(r.l.Tooltip=q[1]);break;case 28:if(C.biff<=5&&C.biff>=2)break;r=a.dense?(u[q[0].r]||[])[q[0].c]:u[vl(q[0])];var le=_[q[2]];r||(a.dense?(u[q[0].r]||(u[q[0].r]=[]),r=u[q[0].r][q[0].c]={t:"z"}):r=u[vl(q[0])]={t:"z"},f.e.r=Math.max(f.e.r,q[0].r),f.s.r=Math.min(f.s.r,q[0].r),f.e.c=Math.max(f.e.c,q[0].c),f.s.c=Math.min(f.s.c,q[0].c)),r.c||(r.c=[]),s={a:q[1],t:le.TxO.t},r.c.push(s);break;case 2173:uh(N[q.ixfe],q.ext);break;case 125:if(!C.cellStyles)break;for(;q.e>=q.s;)R[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},I||(I=!0,Vd(q.w/256)),Hd(R[q.e+1]);break;case 520:var ce={};null!=q.level&&(O[q.r]=ce,ce.level=q.level),q.hidden&&(O[q.r]=ce,ce.hidden=!0),q.hpt&&(O[q.r]=ce,ce.hpt=q.hpt,ce.hpx=Xd(q.hpt));break;case 38:case 39:case 40:case 41:u["!margins"]||lu(u["!margins"]={}),u["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[W]]=q;break;case 161:u["!margins"]||lu(u["!margins"]={}),u["!margins"].header=q.header,u["!margins"].footer=q.footer;break;case 574:q.RTL&&(k.Views[0].RTL=!0);break;case 146:j=q;break;case 2198:c=q;break;case 140:l=q;break;case 442:x?E.CodeName=q||E.name:k.WBProps.CodeName=q||"ThisWorkbook"}}else e.l+=V}return d.SheetNames=gi(m).sort(function(e,a){return Number(e)-Number(a)}).map(function(e){return m[e].name}),a.bookSheets||(d.Sheets=h),!d.SheetNames.length&&b["!ref"]?(d.SheetNames.push("Sheet1"),d.Sheets&&(d.Sheets.Sheet1=b)):d.Preamble=b,d.Sheets&&B.forEach(function(e,a){d.Sheets[d.SheetNames[a]]["!autofilter"]=e}),d.Strings=p,d.SSF=Ai(_n),C.enc&&(d.Encryption=C.enc),c&&(d.Themes=c),d.Metadata={},void 0!==l&&(d.Metadata.Country=l),M.names.length>0&&(k.Names=M.names),d.Workbook=k,d}var um="e0859ff2f94f6810ab9108002b27b3d9",mm="02d5cdd59c2e1b10939708002b2cf9ae";function fm(e,a){var t,r,s,n;if(a||(a={}),Hm(a),en(),a.codepage&&Zs(a.codepage),e.FullPaths){if(fi.find(e,"/encryption"))throw new Error("File is password-protected");t=fi.find(e,"!CompObj"),r=fi.find(e,"/Workbook")||fi.find(e,"/Book")}else{switch(a.type){case"base64":e=gn(dn(e));break;case"binary":e=gn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}nl(e,0),r={content:e}}if(t&&im(t),a.bookProps&&!a.bookSheets)s={};else{var i=hn?"buffer":"array";if(r&&r.content)s=hm(r.content,a);else if((n=fi.find(e,"PerfectOffice_MAIN"))&&n.content)s=md.to_workbook(n.content,(a.type=i,a));else{if(!(n=fi.find(e,"NativeContent_MAIN"))||!n.content)throw(n=fi.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");s=md.to_workbook(n.content,(a.type=i,a))}a.bookVBA&&e.FullPaths&&fi.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=function(e){var a=fi.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if("/"!==t.slice(-1)&&t.match(/_VBA_PROJECT_CUR/)){var s=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");fi.utils.cfb_add(a,s,e.FileIndex[r].content)}}),fi.write(a)}(e))}var o={};return e.FullPaths&&function(e,a,t){var r=fi.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var s=Nc(r,Hl,mm);for(var n in s)a[n]=s[n]}catch(c){if(t.WTF)throw c}var i=fi.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Nc(i,Gl,um);for(var l in o)null==a[l]&&(a[l]=o[l])}catch(c){if(t.WTF)throw c}a.HeadingPairs&&a.TitlesOfParts&&(oc(a.HeadingPairs,a.TitlesOfParts,a,t),delete a.HeadingPairs,delete a.TitlesOfParts)}(e,o,a),s.Props=s.Custprops=o,a.bookFiles&&(s.cfb=e),s}var gm={0:{f:function(e,a){var t={},r=e.l+a;t.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=r,7&n&&(t.level=7&n),16&n&&(t.hidden=!0),32&n&&(t.hpt=s/20),t}},1:{f:function(e){return[Ol(e)]}},2:{f:function(e){return[Ol(e),Fl(e),"n"]}},3:{f:function(e){return[Ol(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Ol(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Ol(e),Ul(e),"n"]}},6:{f:function(e){return[Ol(e),Cl(e),"str"]}},7:{f:function(e){return[Ol(e),e.read_shift(4),"s"]}},8:{f:function(e,a,t){var r=e.l+a,s=Ol(e);s.r=t["!row"];var n=[s,Cl(e),"str"];if(t.cellFormula){e.l+=2;var i=Zh(e,r-e.l,t);n[3]=Gh(i,0,s,t.supbooks,t)}else e.l=r;return n}},9:{f:function(e,a,t){var r=e.l+a,s=Ol(e);s.r=t["!row"];var n=[s,Ul(e),"n"];if(t.cellFormula){e.l+=2;var i=Zh(e,r-e.l,t);n[3]=Gh(i,0,s,t.supbooks,t)}else e.l=r;return n}},10:{f:function(e,a,t){var r=e.l+a,s=Ol(e);s.r=t["!row"];var n=[s,e.read_shift(1),"b"];if(t.cellFormula){e.l+=2;var i=Zh(e,r-e.l,t);n[3]=Gh(i,0,s,t.supbooks,t)}else e.l=r;return n}},11:{f:function(e,a,t){var r=e.l+a,s=Ol(e);s.r=t["!row"];var n=[s,e.read_shift(1),"e"];if(t.cellFormula){e.l+=2;var i=Zh(e,r-e.l,t);n[3]=Gh(i,0,s,t.supbooks,t)}else e.l=r;return n}},12:{f:function(e){return[Il(e)]}},13:{f:function(e){return[Il(e),Fl(e),"n"]}},14:{f:function(e){return[Il(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Il(e),e.read_shift(1),"b"]}},16:{f:Eu},17:{f:function(e){return[Il(e),Cl(e),"str"]}},18:{f:function(e){return[Il(e),e.read_shift(4),"s"]}},19:{f:_l},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,a,t){var r=e.l+a;e.l+=4,e.l+=1;var s=e.read_shift(4),n=Ll(e),i=Qh(e,0,t),o=Pl(e);e.l=r;var l={Name:n,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,a,t){var r={};r.sz=e.read_shift(2)/20;var s=function(e){var a=e.read_shift(1);return e.l++,{fBold:1&a,fItalic:2&a,fUnderline:4&a,fStrikeout:8&a,fOutline:16&a,fShadow:32&a,fCondense:64&a,fExtend:128&a}}(e);switch(s.fItalic&&(r.italic=1),s.fCondense&&(r.condense=1),s.fExtend&&(r.extend=1),s.fShadow&&(r.shadow=1),s.fOutline&&(r.outline=1),s.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var n=e.read_shift(1);0!=n&&(r.underline=n);var i=e.read_shift(1);i>0&&(r.family=i);var o=e.read_shift(1);switch(o>0&&(r.charset=o),e.l++,r.color=function(e){var a={},t=e.read_shift(1)>>>1,r=e.read_shift(1),s=e.read_shift(2,"i"),n=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,t){case 0:a.auto=1;break;case 1:a.index=r;var l=Kl[r];l&&(a.rgb=Dd(l));break;case 2:a.rgb=Dd([n,i,o]);break;case 3:a.theme=r}return 0!=s&&(a.tint=s>0?s/32767:s/32768),a}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Cl(e),r}},44:{f:function(e,a){return[e.read_shift(2),Cl(e)]}},45:{f:Qd},46:{f:eh},47:{f:function(e,a){var t=e.l+a,r=e.read_shift(2),s=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:s}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var a=[],t=e.read_shift(4);t-- >0;)a.push([e.read_shift(4),e.read_shift(4)]);return a}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rd},62:{f:function(e){return[Ol(e),_l(e),"is"]}},63:{f:function(e){var a={};a.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),a.r=vl(t);var r=e.read_shift(1);return 2&r&&(a.l="1"),8&r&&(a.a="1"),a}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:il,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var a=e.read_shift(2);return e.l+=28,{RTL:32&a}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,a){var t={},r=e[e.l];return++e.l,t.above=!(64&r),t.left=!(128&r),e.l+=18,t.name=Ml(e),t}},148:{f:ku,p:16},151:{f:function(){}},152:{},153:{f:function(e,a){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var s=a>8?Cl(e):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(65536&r),t.backupFile=!!(64&r),t.checkCompatibility=!!(4096&r),t.date1904=!!(1&r),t.filterPrivacy=!!(8&r),t.hidePivotFieldList=!!(1024&r),t.promptedSolutions=!!(16&r),t.publishItems=!!(2048&r),t.refreshAllConnections=!!(262144&r),t.saveExternalLinkValues=!!(128&r),t.showBorderUnselectedTables=!!(4&r),t.showInkAnnotation=!!(32&r),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(32768&r),t.updateLinks=["userSet","never","always"][r>>8&3],t}},154:{},155:{},156:{f:function(e,a){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Dl(e),t.name=Cl(e),t}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Bl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Tu},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,a){return{flags:e.read_shift(4),version:e.read_shift(4),name:Cl(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Dl},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ed},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,a,t){var r=e.l+a,s=zl(e),n=e.read_shift(1),i=[s];if(i[2]=n,t.cellFormula){var o=Jh(e,r-e.l,t);i[1]=o}else e.l=r;return i}},427:{f:function(e,a,t){var r=e.l+a,s=[Bl(e)];if(t.cellFormula){var n=eu(e,r-e.l,t);s[1]=n,e.l=r}else e.l=r;return s}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var a={};return Su.forEach(function(t){a[t]=Ul(e)}),a}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,a){var t=e.l+a,r=Bl(e),s=Pl(e),n=Cl(e),i=Cl(e),o=Cl(e);e.l=t;var l={rfx:r,relId:s,loc:n,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Dl},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:fh},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var a={};a.iauthor=e.read_shift(4);var t=Bl(e);return a.rfx=t.s,a.ref=vl(t.s),e.l+=16,a}},636:{T:-1},637:{f:Rl},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,a){return e.l+=10,{name:Cl(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},pm={6:{f:Yh},10:{f:jc},12:{f:Ec},13:{f:Ec},14:{f:kc},15:{f:kc},16:{f:Ul},17:{f:kc},18:{f:kc},19:{f:Ec},20:{f:Kc},21:{f:Kc},23:{f:ed},24:{f:Qc},25:{f:kc},26:{},27:{},28:{f:function(e,a,t){return function(e,a,t){if(!(t.biff<8)){var r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=Rc(e,0,t);return t.biff<8&&e.read_shift(1),[{r:r,c:s},o,i,n]}}(e,0,t)}},29:{},34:{f:kc},35:{f:Jc},38:{f:Ul},39:{f:Ul},40:{f:Ul},41:{f:Ul},42:{f:kc},43:{f:kc},47:{f:function(e,a,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?Pd(e,a-2,r):Md(e,t.biff,t,r),r}},49:{f:function(e,a,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return r.name=Sc(e,0,t),r}},51:{f:Ec},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:kc},65:{f:function(){}},66:{f:Ec},77:{},80:{},81:{},82:{},85:{f:Ec},89:{},90:{},91:{},92:{f:function(e,a,t){if(t.enc)return e.l+=a,"";var r=e.l,s=Rc(e,0,t);return e.read_shift(a+r-e.l),s}},93:{f:function(e,a,t){if(t&&t.biff<8)return function(e,a,t){e.l+=4;var r=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,a-=36;var i=[];return i.push((td[r]||il)(e,a,t)),{cmo:[s,r,n],ft:i}}(e,a,t);var r=$c(e),s=function(e,a){for(var t=e.l+a,r=[];e.l<t;){var s=e.read_shift(2);e.l-=2;try{r.push(Vc[s](e,t-e.l))}catch(n){return e.l=t,r}}return e.l!=t&&(e.l=t),r}(e,a-22,r[1]);return{cmo:r,ft:s}}},94:{},95:{f:kc},96:{},97:{},99:{f:kc},125:{f:rd},128:{f:function(e){e.l+=4;var a=[e.read_shift(2),e.read_shift(2)];if(0!==a[0]&&a[0]--,0!==a[1]&&a[1]--,a[0]>7||a[1]>7)throw new Error("Bad Gutters: "+a.join("|"));return a}},129:{f:function(e,a,t){var r=t&&8==t.biff||2==a?e.read_shift(2):(e.l+=a,0);return{fDialog:16&r,fBelow:64&r,fRight:128&r}}},130:{f:Ec},131:{f:kc},132:{f:kc},133:{f:function(e,a,t){var r=e.read_shift(4),s=3&e.read_shift(1),n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule"}var i=Sc(e,0,t);return 0===i.length&&(i="Sheet1"),{pos:r,hs:s,dt:n,name:i}}},134:{},140:{f:function(e){var a,t=[0,0];return a=e.read_shift(2),t[0]=ql[a]||a,a=e.read_shift(2),t[1]=ql[a]||a,t}},141:{f:Ec},144:{},146:{f:function(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push(Pc(e));return t}},151:{},152:{},153:{},154:{},155:{},156:{f:Ec},157:{},158:{},160:{f:nd},161:{f:function(e,a){var t={};return a<32||(e.l+=16,t.header=Ul(e),t.footer=Ul(e),e.l+=2),t}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,a){for(var t=e.l+a-2,r=e.read_shift(2),s=e.read_shift(2),n=[];e.l<t;)n.push(Fc(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:r,c:s,C:i,rkrec:n}}},190:{f:function(e,a){for(var t=e.l+a-2,r=e.read_shift(2),s=e.read_shift(2),n=[];e.l<t;)n.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:r,c:s,C:i,ixfe:n}}},193:{f:jc},197:{},198:{},199:{},200:{},201:{},202:{f:kc},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ec},220:{},221:{f:kc},222:{},224:{f:function(e,a,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data=function(e,a,t,r){var s={},n=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=Xl[o>>26],r.cellStyles?(s.alc=7&n,s.fWrap=n>>3&1,s.alcV=n>>4&7,s.fJustLast=n>>7&1,s.trot=n>>8&255,s.cIndent=n>>16&15,s.fShrinkToFit=n>>20&1,s.iReadOrder=n>>22&2,s.fAtrNum=n>>26&1,s.fAtrFnt=n>>27&1,s.fAtrAlc=n>>28&1,s.fAtrBdr=n>>29&1,s.fAtrPat=n>>30&1,s.fAtrProt=n>>31&1,s.dgLeft=15&i,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=127&o,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=127&l,s.icvBack=l>>7&127,s.fsxButton=l>>14&1,s):s}(e,0,r.fStyle,t),r}},225:{f:function(e,a){return 0===a||e.read_shift(2),1200}},226:{f:jc},227:{},229:{f:function(e,a){for(var t=[],r=e.read_shift(2);r--;)t.push(zc(e));return t}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,a){for(var t=e.l+a,r=e.read_shift(4),s=e.read_shift(4),n=[],i=0;i!=s&&e.l<t;++i)n.push(Cc(e));return n.Count=r,n.Unique=s,n}},253:{f:function(e){var a=Lc(e);return a.isst=e.read_shift(4),a}},255:{f:function(e,a){var t={};return t.dsst=e.read_shift(2),e.l+=a-2,t}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Tc},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:kc},353:{f:jc},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,a,t){var r=e.l+a,s=e.read_shift(2),n=e.read_shift(2);if(t.sbcch=n,1025==n||14849==n)return[n,s];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var i=Ac(e,n),o=[];r>e.l;)o.push(_c(e));return[n,s,i,o]}},431:{f:kc},432:{},433:{},434:{},437:{},438:{f:function(e,a,t){var r=e.l,s="";try{e.l+=4;var n=(t.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(n)?e.l+=6:function(e){var a=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[a,t]}(e);var i=e.read_shift(2);e.read_shift(2),Ec(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-r!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((s+=Ac(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?i:2*i))break}if(s.length!==i&&s.length!==2*i)throw new Error("cchText: "+i+" != "+s.length);return e.l=r+a,{t:s}}catch(d){return e.l=r+a,{t:s}}}},439:{f:kc},440:{f:function(e,a){var t=zc(e);e.l+=16;var r=function(e,a){var t=e.l+a,r=e.read_shift(4);if(2!==r)throw new Error("Unrecognized streamVersion: "+r);var s=e.read_shift(2);e.l+=2;var n,i,o,l,c,d,h="";16&s&&(n=Ic(e,e.l)),128&s&&(i=Ic(e,e.l)),257&~s||(o=Ic(e,e.l)),1==(257&s)&&(l=Oc(e,e.l)),8&s&&(h=Ic(e,e.l)),32&s&&(c=e.read_shift(16)),64&s&&(d=uc(e)),e.l=t;var u=i||o||l||"";u&&h&&(u+="#"+h),u||(u="#"+h),2&s&&"/"==u.charAt(0)&&"/"!=u.charAt(1)&&(u="file://"+u);var m={Target:u};return c&&(m.guid=c),d&&(m.time=d),n&&(m.Tooltip=n),m}(e,a-24);return[t,r]}},441:{},442:{f:_c},443:{},444:{f:Ec},445:{},446:{},448:{f:jc},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:jc},512:{f:Xc},513:{f:sd},515:{f:function(e,a,t){t.biffguess&&2==t.biff&&(t.biff=5);var r=Lc(e),s=Ul(e);return r.val=s,r}},516:{f:function(e,a,t){t.biffguess&&2==t.biff&&(t.biff=5),e.l;var r=Lc(e);2==t.biff&&e.l++;var s=_c(e,e.l,t);return r.val=s,r}},517:{f:Yc},519:{f:id},520:{f:function(e){var a={};a.r=e.read_shift(2),a.c=e.read_shift(2),a.cnt=e.read_shift(2)-a.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,7&r&&(a.level=7&r),32&r&&(a.hidden=!0),64&r&&(a.hpt=t/20),a}},523:{},545:{f:ad},549:{f:Gc},566:{},574:{f:function(e,a,t){return t&&t.biff>=2&&t.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var a=e.read_shift(2),t=e.read_shift(2),r=Fc(e);return{r:a,c:t,ixfe:r[0],rknum:r[1]}}},659:{},1048:{},1054:{f:function(e,a,t){return[e.read_shift(2),Rc(e,0,t)]}},1084:{},1212:{f:function(e,a,t){var r=Bc(e);e.l++;var s=e.read_shift(1);return[Xh(e,a-=8,t),s,r]}},2048:{f:function(e,a){e.read_shift(2);var t=zc(e),r=e.read_shift((a-10)/2,"dbcs-cont");return[t,r=r.replace(vn,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Hc},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:jc},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var a={cxfs:0,crc:0};return a.cxfs=e.read_shift(2),a.crc=e.read_shift(4),a},r:12},2173:{f:function(e,a){e.l,e.l+=2;var t=e.read_shift(2);e.l+=2;for(var r=e.read_shift(2),s=[];r-- >0;)s.push(hh(e,e.l));return{ixfe:t,ext:s}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:kc,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,a,t){if(!(t.biff<8)){var r=e.read_shift(2),s=e.read_shift(2);return[Ac(e,r,t),Ac(e,s,t)]}e.l+=a},r:12},2197:{},2198:{f:function(e,a,t){var r=e.l+a;if(124226!==e.read_shift(4))if(t.cellStyles){var s,n=e.slice(e.l);e.l=r;try{s=Wi(n,{type:"array"})}catch(o){return}var i=Bi(s,"theme/theme/theme1.xml",!0);if(i)return ch(i,t)}else e.l=r},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:jc},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var a=function(e){var a=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:a,flags:t}}(e);if(2211!=a.type)throw new Error("Invalid Future Record "+a.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ec},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,a,t){var r={area:!1};if(5!=t.biff)return e.l+=a,r;var s=e.read_shift(1);return e.l+=3,16&s&&(r.area=!0),r}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var a=e.read_shift(2),t=[];a-- >0;)t.push(Pc(e));return t}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Xc},1:{},2:{f:function(e){var a=Lc(e);++e.l;var t=e.read_shift(2);return a.t="n",a.val=t,a}},3:{f:function(e){var a=Lc(e);++e.l;var t=Ul(e);return a.t="n",a.val=t,a}},4:{f:function(e,a,t){t.biffguess&&5==t.biff&&(t.biff=2);var r=Lc(e);++e.l;var s=Rc(e,0,t);return r.t="str",r.val=s,r}},5:{f:Yc},7:{f:function(e){var a=e.read_shift(1);return 0===a?(e.l++,""):e.read_shift(a,"sbcs-cont")}},8:{},9:{f:Hc},11:{},22:{f:Ec},30:{f:qc},31:{},32:{},33:{f:ad},36:{},37:{f:Gc},50:{f:function(e,a){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=a-13}},62:{},52:{},67:{},68:{f:Ec},69:{},86:{},126:{},127:{f:function(e){var a=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),s={fmt:a,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,s}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,a,t){var r=e.l+a,s=Lc(e),n=e.read_shift(2),i=Ac(e,n,t);return e.l=r,s.t="str",s.val=i,s}},223:{},234:{},354:{},421:{},518:{f:Yh},521:{f:Hc},536:{f:Qc},547:{f:Jc},561:{},579:{},1030:{f:Yh},1033:{f:Hc},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function xm(e,a,t,r){var s=a;if(!isNaN(s)){var n=(t||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,n),n>0&&Go(t)&&e.push(t)}}function bm(e,a){var t=a||{},r=t.dense?[]:{},s=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),i=s.index,o=n&&n.index||e.length,l=Mi(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,h=0,u=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},f=[];for(i=0;i<l.length;++i){var g=l[i].trim(),p=g.slice(0,3).toLowerCase();if("<tr"!=p){if("<td"==p||"<th"==p){var x=g.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var b=x[o].trim();if(b.match(/<t[dh]/i)){for(var v=b,y=0;"<"==v.charAt(0)&&(y=v.indexOf(">"))>-1;)v=v.slice(y+1);for(var w=0;w<f.length;++w){var N=f[w];N.s.c==d&&N.s.r<c&&c<=N.e.r&&(d=N.e.c+1,w=-1)}var j=Ji(b.slice(0,b.indexOf(">")));u=j.colspan?+j.colspan:1,((h=+j.rowspan)>1||u>1)&&f.push({s:{r:c,c:d},e:{r:c+(h||1)-1,c:d+u-1}});var k=j.t||j["data-t"]||"";if(v.length)if(v=go(v),m.s.r>c&&(m.s.r=c),m.e.r<c&&(m.e.r=c),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),v.length){var E={t:"s",v:v};t.raw||!v.trim().length||"s"==k||("TRUE"===v?E={t:"b",v:!0}:"FALSE"===v?E={t:"b",v:!1}:isNaN(Ri(v))?isNaN(Ii(v).getDate())||(E={t:"d",v:Si(v)},t.cellDates||(E={t:"n",v:bi(E.v)}),E.z=t.dateNF||_n[14]):E={t:"n",v:Ri(v)}),t.dense?(r[c]||(r[c]=[]),r[c][d]=E):r[vl({r:c,c:d})]=E,d+=u}else d+=u;else d+=u}}}}else{if(++c,t.sheetRows&&t.sheetRows<=c){--c;break}d=0}}return r["!ref"]=wl(m),f.length&&(r["!merges"]=f),r}function vm(e,a,t,r){for(var s=e["!merges"]||[],n=[],i=a.s.c;i<=a.e.c;++i){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>t||s[c].s.c>i||s[c].e.r<t||s[c].e.c<i)){if(s[c].s.r<t||s[c].s.c<i){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var d=vl({r:t,c:i}),h=r.dense?(e[t]||[])[i]:e[d],u=h&&null!=h.v&&(h.h||so(h.w||(kl(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),r.editable?u='<span contenteditable="true">'+u+"</span>":h&&(m["data-t"]=h&&h.t||"z",null!=h.v&&(m["data-v"]=h.v),null!=h.z&&(m["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(u='<a href="'+h.l.Target+'">'+u+"</a>")),m.id=(r.id||"sjs")+"-"+d,n.push(wo("td",u,m))}}return"<tr>"+n.join("")+"</tr>"}function ym(e,a,t){var r=t||{},s=0,n=0;if(null!=r.origin)if("number"==typeof r.origin)s=r.origin;else{var i="string"==typeof r.origin?bl(r.origin):r.origin;s=i.r,n=i.c}var o=a.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var d=yl(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==s&&(c.e.r=s=d.e.r+1)}var h=[],u=0,m=e["!rows"]||(e["!rows"]=[]),f=0,g=0,p=0,x=0,b=0,v=0;for(e["!cols"]||(e["!cols"]=[]);f<o.length&&g<l;++f){var y=o[f];if(Nm(y)){if(r.display)continue;m[g]={hidden:!0}}var w=y.children;for(p=x=0;p<w.length;++p){var N=w[p];if(!r.display||!Nm(N)){var j=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):go(N.innerHTML),k=N.getAttribute("data-z")||N.getAttribute("z");for(u=0;u<h.length;++u){var E=h[u];E.s.c==x+n&&E.s.r<g+s&&g+s<=E.e.r&&(x=E.e.c+1-n,u=-1)}v=+N.getAttribute("colspan")||1,((b=+N.getAttribute("rowspan")||1)>1||v>1)&&h.push({s:{r:g+s,c:x+n},e:{r:g+s+(b||1)-1,c:x+n+(v||1)-1}});var T={t:"s",v:j},S=N.getAttribute("data-t")||N.getAttribute("t")||"";null!=j&&(0==j.length?T.t=S||"z":r.raw||0==j.trim().length||"s"==S||("TRUE"===j?T={t:"b",v:!0}:"FALSE"===j?T={t:"b",v:!1}:isNaN(Ri(j))?isNaN(Ii(j).getDate())||(T={t:"d",v:Si(j)},r.cellDates||(T={t:"n",v:bi(T.v)}),T.z=r.dateNF||_n[14]):T={t:"n",v:Ri(j)})),void 0===T.z&&null!=k&&(T.z=k);var C="",A=N.getElementsByTagName("A");if(A&&A.length)for(var _=0;_<A.length&&(!A[_].hasAttribute("href")||"#"==(C=A[_].getAttribute("href")).charAt(0));++_);C&&"#"!=C.charAt(0)&&(T.l={Target:C}),r.dense?(e[g+s]||(e[g+s]=[]),e[g+s][x+n]=T):e[vl({c:x+n,r:g+s})]=T,c.e.c<x+n&&(c.e.c=x+n),x+=v}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+s),e["!ref"]=wl(c),g>=l&&(e["!fullref"]=wl((c.e.r=o.length-f+g-1+s,c))),e}function wm(e,a){return ym((a||{}).dense?[]:{},e,a)}function Nm(e){var a="",t=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return t&&(a=t(e).getPropertyValue("display")),a||(a=e.style&&e.style.display),"none"===a}function jm(e){var a=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[ao(a.replace(/<[^>]*>/g,""))]}var km={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Em(e,a){var t,r,s,n,i,o,l=a||{},c=No(e),d=[],h={name:""},u="",m=0,f={},g=[],p=l.dense?[]:{},x={value:""},b="",v=0,y=[],w=-1,N=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,E={},T=[],S={},C=[],A=1,_=1,R=[],O={Names:[]},I={},M=["",""],P=[],L={},D="",F=0,z=!1,B=!1,U=0;for(jo.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");i=jo.exec(c);)switch(i[3]=i[3].replace(/_.*$/,"")){case"table":case"Â∑•‰ΩúË°®":"/"===i[1]?(j.e.c>=j.s.c&&j.e.r>=j.s.r?p["!ref"]=wl(j):p["!ref"]="A1:A1",l.sheetRows>0&&l.sheetRows<=j.e.r&&(p["!fullref"]=p["!ref"],j.e.r=l.sheetRows-1,p["!ref"]=wl(j)),T.length&&(p["!merges"]=T),C.length&&(p["!rows"]=C),s.name=s["ÂêçÁß∞"]||s.name,"undefined"!=typeof JSON&&JSON.stringify(s),g.push(s.name),f[s.name]=p,B=!1):"/"!==i[0].charAt(i[0].length-2)&&(s=Ji(i[0],!1),w=N=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,p=l.dense?[]:{},T=[],C=[],B=!0);break;case"table-row-group":"/"===i[1]?--k:++k;break;case"table-row":case"Ë°å":if("/"===i[1]){w+=A,A=1;break}if((n=Ji(i[0],!1))["Ë°åÂè∑"]?w=n["Ë°åÂè∑"]-1:-1==w&&(w=0),(A=+n["number-rows-repeated"]||1)<10)for(U=0;U<A;++U)k>0&&(C[w+U]={level:k});N=-1;break;case"covered-table-cell":"/"!==i[1]&&++N,l.sheetStubs&&(l.dense?(p[w]||(p[w]=[]),p[w][N]={t:"z"}):p[vl({r:w,c:N})]={t:"z"}),b="",y=[];break;case"table-cell":case"Êï∞ÊçÆ":if("/"===i[0].charAt(i[0].length-2))++N,x=Ji(i[0],!1),_=parseInt(x["number-columns-repeated"]||"1",10),o={t:"z",v:null},x.formula&&0!=l.cellFormula&&(o.f=su(ao(x.formula))),"string"==(x["Êï∞ÊçÆÁ±ªÂûã"]||x["value-type"])&&(o.t="s",o.v=ao(x["string-value"]||""),l.dense?(p[w]||(p[w]=[]),p[w][N]=o):p[vl({r:w,c:N})]=o),N+=_-1;else if("/"!==i[1]){b="",v=0,y=[],_=1;var $=A?w+A-1:w;if(++N>j.e.c&&(j.e.c=N),N<j.s.c&&(j.s.c=N),w<j.s.r&&(j.s.r=w),$>j.e.r&&(j.e.r=$),P=[],L={},o={t:(x=Ji(i[0],!1))["Êï∞ÊçÆÁ±ªÂûã"]||x["value-type"],v:null},l.cellFormula)if(x.formula&&(x.formula=ao(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(S={s:{r:w,c:N},e:{r:w+(parseInt(x["number-matrix-rows-spanned"],10)||0)-1,c:N+(parseInt(x["number-matrix-columns-spanned"],10)||0)-1}},o.F=wl(S),R.push([S,o.F])),x.formula)o.f=su(x.formula);else for(U=0;U<R.length;++U)w>=R[U][0].s.r&&w<=R[U][0].e.r&&N>=R[U][0].s.c&&N<=R[U][0].e.c&&(o.F=R[U][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(S={s:{r:w,c:N},e:{r:w+(parseInt(x["number-rows-spanned"],10)||0)-1,c:N+(parseInt(x["number-columns-spanned"],10)||0)-1}},T.push(S)),x["number-columns-repeated"]&&(_=parseInt(x["number-columns-repeated"],10)),o.t){case"boolean":o.t="b",o.v=io(x["boolean-value"]);break;case"float":case"percentage":case"currency":o.t="n",o.v=parseFloat(x.value);break;case"date":o.t="d",o.v=Si(x["date-value"]),l.cellDates||(o.t="n",o.v=bi(o.v)),o.z="m/d/yy";break;case"time":o.t="n",o.v=ji(x["time-value"])/86400,l.cellDates&&(o.t="d",o.v=Ni(o.v)),o.z="HH:MM:SS";break;case"number":o.t="n",o.v=parseFloat(x["Êï∞ÊçÆÊï∞ÂÄº"]);break;default:if("string"!==o.t&&"text"!==o.t&&o.t)throw new Error("Unsupported value type "+o.t);o.t="s",null!=x["string-value"]&&(b=ao(x["string-value"]),y=[])}}else{if(z=!1,"s"===o.t&&(o.v=b||"",y.length&&(o.R=y),z=0==v),I.Target&&(o.l=I),P.length>0&&(o.c=P,P=[]),b&&!1!==l.cellText&&(o.w=b),z&&(o.t="z",delete o.v),(!z||l.sheetStubs)&&!(l.sheetRows&&l.sheetRows<=w))for(var W=0;W<A;++W){if(_=parseInt(x["number-columns-repeated"]||"1",10),l.dense)for(p[w+W]||(p[w+W]=[]),p[w+W][N]=0==W?o:Ai(o);--_>0;)p[w+W][N+_]=Ai(o);else for(p[vl({r:w+W,c:N})]=o;--_>0;)p[vl({r:w+W,c:N+_})]=Ai(o);j.e.c<=N&&(j.e.c=N)}N+=(_=parseInt(x["number-columns-repeated"]||"1",10))-1,_=0,o={},b="",y=[]}I={};break;case"document":case"document-content":case"ÁîµÂ≠êË°®Ê†ºÊñáÊ°£":case"spreadsheet":case"‰∏ª‰Ωì":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===i[1]){if((t=d.pop())[0]!==i[3])throw"Bad state: "+t}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!0]);break;case"annotation":if("/"===i[1]){if((t=d.pop())[0]!==i[3])throw"Bad state: "+t;L.t=b,y.length&&(L.R=y),L.a=D,P.push(L)}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!1]);D="",F=0,b="",v=0,y=[];break;case"creator":"/"===i[1]?D=c.slice(F,i.index):F=i.index+i[0].length;break;case"meta":case"ÂÖÉÊï∞ÊçÆ":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===i[1]){if((t=d.pop())[0]!==i[3])throw"Bad state: "+t}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!1]);b="",v=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"ÁîµÂ≠êË°®Ê†º":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"Ê†áÈ¢ò":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===i[1]){if(E[h.name]=u,(t=d.pop())[0]!==i[3])throw"Bad state: "+t}else"/"!==i[0].charAt(i[0].length-2)&&(u="",h=Ji(i[0],!1),d.push([i[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":r=Ji(i[0],!1),u+=km[i[3]]["long"===r.style?1:0]}break;case"text":if("/>"===i[0].slice(-2))break;if("/"===i[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":u+=c.slice(m,i.index)}else m=i.index+i[0].length;break;case"named-range":M=nu((r=Ji(i[0],!1))["cell-range-address"]);var V={Name:r.name,Ref:M[0]+"!"+M[1]};B&&(V.Sheet=g.length),O.Names.push(V);break;case"p":case"ÊñáÊú¨‰∏≤":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==i[1]||x&&x["string-value"])Ji(i[0],!1),v=i.index+i[0].length;else{var H=jm(c.slice(v,i.index));b=(b.length>0?b+"\n":"")+H[0]}break;case"database-range":if("/"===i[1])break;try{f[(M=nu(Ji(i[0])["target-range-address"]))[0]]["!autofilter"]={ref:M[1]}}catch(q){}break;case"a":if("/"!==i[1]){if(!(I=Ji(i[0],!1)).href)break;I.Target=ao(I.href),delete I.href,"#"==I.Target.charAt(0)&&I.Target.indexOf(".")>-1?(M=nu(I.Target.slice(1)),I.Target="#"+M[0]+"!"+M[1]):I.Target.match(/^\.\.[\\\/]/)&&(I.Target=I.Target.slice(3))}break;default:switch(i[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"Ë°®:":case"Â≠ó:":break;default:if(l.WTF)throw new Error(i)}}var G={Sheets:f,SheetNames:g,Workbook:O};return l.bookSheets&&delete G.Sheets,G}function Tm(e,a){a=a||{},Di(e,"META-INF/manifest.xml")&&function(e,a){for(var t,r,s=No(e);t=jo.exec(s);)switch(t[3]){case"manifest":break;case"file-entry":if("/"==(r=Ji(t[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==r.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(a&&a.WTF)throw t}}(zi(e,"META-INF/manifest.xml"),a);var t=Bi(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=Em(uo(t),a);return Di(e,"meta.xml")&&(r.Props=nc(zi(e,"meta.xml"))),r}function Sm(e,a){return Em(e,a)}
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Cm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Am(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):uo(pn(e))}function _m(e){var a=e.reduce(function(e,a){return e+a.length},0),t=new Uint8Array(a),r=0;return e.forEach(function(e){t.set(e,r),r+=e.length}),t}function Rm(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Om(e,a){var t=a?a[0]:0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;if(r+=(127&e[t])*Math.pow(2,28),++t,e[t++]<128)break e;if(r+=(127&e[t])*Math.pow(2,35),++t,e[t++]<128)break e;if(r+=(127&e[t])*Math.pow(2,42),++t,e[t++]<128)break e}return a&&(a[0]=t),r}function Im(e){var a=0,t=127&e[a];e:if(e[a++]>=128){if(t|=(127&e[a])<<7,e[a++]<128)break e;if(t|=(127&e[a])<<14,e[a++]<128)break e;if(t|=(127&e[a])<<21,e[a++]<128)break e;t|=(127&e[a])<<28}return t}function Mm(e){for(var a=[],t=[0];t[0]<e.length;){var r,s=t[0],n=Om(e,t),i=7&n,o=0;if(0==(n=Math.floor(n/8)))break;switch(i){case 0:for(var l=t[0];e[t[0]++]>=128;);r=e.slice(l,t[0]);break;case 5:o=4,r=e.slice(t[0],t[0]+o),t[0]+=o;break;case 1:o=8,r=e.slice(t[0],t[0]+o),t[0]+=o;break;case 2:o=Om(e,t),r=e.slice(t[0],t[0]+o),t[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var c={data:r,type:i};null==a[n]?a[n]=[c]:a[n].push(c)}return a}function Pm(e,a){return(null==e?void 0:e.map(function(e){return a(e.data)}))||[]}function Lm(e,a){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=Om(a,t),s=[];t[0]<a.length;){var n=3&a[t[0]];if(0!=n){var i=0,o=0;if(1==n?(o=4+(a[t[0]]>>2&7),i=(224&a[t[0]++])<<3,i|=a[t[0]++]):(o=1+(a[t[0]++]>>2),2==n?(i=a[t[0]]|a[t[0]+1]<<8,t[0]+=2):(i=(a[t[0]]|a[t[0]+1]<<8|a[t[0]+2]<<16|a[t[0]+3]<<24)>>>0,t[0]+=4)),s=[_m(s)],0==i)throw new Error("Invalid offset 0");if(i>s[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(s.push(s[0].slice(-i)),o-=i;o>=s[s.length-1].length;)s.push(s[s.length-1]),o-=s[s.length-1].length;s.push(s[0].slice(-i,-i+o))}else{var l=a[t[0]++]>>2;if(l<60)++l;else{var c=l-59;l=a[t[0]],c>1&&(l|=a[t[0]+1]<<8),c>2&&(l|=a[t[0]+2]<<16),c>3&&(l|=a[t[0]+3]<<24),l>>>=0,l++,t[0]+=c}s.push(a.slice(t[0],t[0]+l)),t[0]+=l}}var d=_m(s);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function Dm(e,a,t){var r,s=Cm(e),n=s.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,h=new Date(2001,0,1);switch(1&n&&(c=function(e,a){for(var t=(127&e[a+15])<<7|e[a+14]>>1,r=1&e[a+14],s=a+13;s>=a;--s)r=256*r+e[s];return(128&e[a+15]?-r:r)*Math.pow(10,t-6176)}(e,i),i+=16),2&n&&(d=s.getFloat64(i,!0),i+=8),4&n&&(h.setTime(h.getTime()+1e3*s.getFloat64(i,!0)),i+=8),8&n&&(l=s.getUint32(i,!0),i+=4),16&n&&(o=s.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:r={t:"n",v:c};break;case 3:r={t:"s",v:a[l]};break;case 5:r={t:"d",v:h};break;case 6:r={t:"b",v:d>0};break;case 7:r={t:"n",v:d/86400};break;case 8:r={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&n," : ").concat(e.slice(0,4)));r={t:"s",v:t[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&n," : ").concat(e.slice(0,4)))}return r}function Fm(e,a,t){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,a,t,r){var s,n=Cm(e),i=n.getUint32(4,!0),o=(r>1?12:8)+4*Rm(i&(r>1?3470:398)),l=-1,c=-1,d=NaN,h=new Date(2001,0,1);switch(512&i&&(l=n.getUint32(o,!0),o+=4),o+=4*Rm(i&(r>1?12288:4096)),16&i&&(c=n.getUint32(o,!0),o+=4),32&i&&(d=n.getFloat64(o,!0),o+=8),64&i&&(h.setTime(h.getTime()+1e3*n.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:s={t:"n",v:d};break;case 3:s={t:"s",v:a[c]};break;case 5:s={t:"d",v:h};break;case 6:s={t:"b",v:d>0};break;case 7:s={t:"n",v:d/86400};break;case 8:s={t:"e",v:0};break;case 9:if(l>-1)s={t:"s",v:t[l]};else if(c>-1)s={t:"s",v:a[c]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));s={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return s}(e,a,t,e[0]);case 5:return Dm(e,a,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function zm(e){return Om(Mm(e)[1][0].data)}function Bm(e,a){var t=Mm(a.data),r=Im(t[1][0].data),s=t[3],n=[];return(s||[]).forEach(function(a){var t=Mm(a.data),s=Im(t[1][0].data)>>>0;switch(r){case 1:n[s]=Am(t[3][0].data);break;case 8:var i=Mm(e[zm(t[9][0].data)][0].data),o=e[zm(i[1][0].data)][0],l=Im(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=Mm(o.data);n[s]=c[3].map(function(e){return Am(e.data)}).join("")}}),n}function Um(e,a){var t,r=Mm(a.data),s=(null==(t=null==r?void 0:r[7])?void 0:t[0])?Im(r[7][0].data)>>>0>0?1:0:-1,n=Pm(r[5],function(e){return function(e,a){var t,r,s,n,i,o,l,c,d,h,u,m,f,g,p,x,b=Mm(e),v=Im(b[1][0].data)>>>0,y=Im(b[2][0].data)>>>0,w=(null==(r=null==(t=b[8])?void 0:t[0])?void 0:r.data)&&Im(b[8][0].data)>0||!1;if((null==(n=null==(s=b[7])?void 0:s[0])?void 0:n.data)&&0!=a)p=null==(o=null==(i=b[7])?void 0:i[0])?void 0:o.data,x=null==(c=null==(l=b[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(h=null==(d=b[4])?void 0:d[0])?void 0:h.data)||1==a)throw"NUMBERS Tile missing ".concat(a," cell storage");p=null==(m=null==(u=b[4])?void 0:u[0])?void 0:m.data,x=null==(g=null==(f=b[3])?void 0:f[0])?void 0:g.data}for(var N=w?4:1,j=Cm(p),k=[],E=0;E<p.length/2;++E){var T=j.getUint16(2*E,!0);T<65535&&k.push([E,T])}if(k.length!=y)throw"Expected ".concat(y," cells, found ").concat(k.length);var S=[];for(E=0;E<k.length-1;++E)S[k[E][0]]=x.subarray(k[E][1]*N,k[E+1][1]*N);return k.length>=1&&(S[k[k.length-1][0]]=x.subarray(k[k.length-1][1]*N)),{R:v,cells:S}}(e,s)});return{nrows:Im(r[4][0].data)>>>0,data:n.reduce(function(e,a){return e[a.R]||(e[a.R]=[]),a.cells.forEach(function(t,r){if(e[a.R][r])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(r));e[a.R][r]=t}),e},[])}}function $m(e,a){var t={"!ref":"A1"},r=e[zm(Mm(a.data)[2][0].data)],s=Im(r[0].meta[1][0].data);if(6001!=s)throw new Error("6000 unexpected reference to ".concat(s));return function(e,a,t){var r,s=Mm(a.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(Im(s[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(n.e.c=(Im(s[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));t["!ref"]=wl(n);var i=Mm(s[4][0].data),o=Bm(e,e[zm(i[4][0].data)][0]),l=(null==(r=i[17])?void 0:r[0])?Bm(e,e[zm(i[17][0].data)][0]):[],c=Mm(i[3][0].data),d=0;c[1].forEach(function(a){var r=Mm(a.data),s=e[zm(r[2][0].data)][0],n=Im(s.meta[1][0].data);if(6002!=n)throw new Error("6001 unexpected reference to ".concat(n));var i=Um(0,s);i.data.forEach(function(e,a){e.forEach(function(e,r){var s=vl({r:d+a,c:r}),n=Fm(e,o,l);n&&(t[s]=n)})}),d+=i.nrows})}(e,r[0],t),t}function Wm(e,a){var t={SheetNames:[],Sheets:{}};if(Pm(Mm(a.data)[1],zm).forEach(function(a){e[a].forEach(function(a){if(2==Im(a.meta[1][0].data)){var r=function(e,a){var t,r=Mm(a.data),s={name:(null==(t=r[1])?void 0:t[0])?Am(r[1][0].data):"",sheets:[]};return Pm(r[2],zm).forEach(function(a){e[a].forEach(function(a){6e3==Im(a.meta[1][0].data)&&s.sheets.push($m(e,a))})}),s}(e,a);r.sheets.forEach(function(e,a){cf(t,e,0==a?r.name:r.name+"_"+a,!0)})}})}),0==t.SheetNames.length)throw new Error("Empty NUMBERS file");return t}function Vm(e){var a,t,r,s,n={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var a,t;try{a=function(e){for(var a=[],t=0;t<e.length;){var r=e[t++],s=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,a.push(Lm(r,e.slice(t,t+s))),t+=s}if(t!==e.length)throw new Error("data is not a valid framed stream!");return _m(a)}(e.content)}catch(r){return}try{t=function(e){for(var a,t=[],r=[0];r[0]<e.length;){var s=Om(e,r),n=Mm(e.slice(r[0],r[0]+s));r[0]+=s;var i={id:Im(n[1][0].data),messages:[]};n[2].forEach(function(a){var t=Mm(a.data),s=Im(t[3][0].data);i.messages.push({meta:t,data:e.slice(r[0],r[0]+s)}),r[0]+=s}),(null==(a=n[3])?void 0:a[0])&&(i.merge=Im(n[3][0].data)>>>0>0),t.push(i)}return t}(a)}catch(r){return}t.forEach(function(e){n[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var o=(null==(s=null==(r=null==(t=null==(a=null==n?void 0:n[1])?void 0:a[0])?void 0:t.meta)?void 0:r[1])?void 0:s[0].data)&&1==Im(n[1][0].meta[1][0].data)&&n[1][0];if(o||i.forEach(function(e){n[e].forEach(function(e){if(1==Im(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return Wm(n,o)}function Hm(e){var a;(a=[["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]],function(e){for(var t=0;t!=a.length;++t){var r=a[t];void 0===e[r[0]]&&(e[r[0]]=r[1]),"n"===r[2]&&(e[r[0]]=Number(e[r[0]]))}})(e)}function Gm(e,a,t,r,s,n,i,o,l,c,d,h){try{n[r]=tc(Bi(e,t,!0),a);var u,m=zi(e,a);switch(o){case"sheet":u=Bu(m,a,s,l,n[r],c,d,h);break;case"chart":if(!(u=Uu(m,a,s,l,n[r],c))||!u["!drawel"])break;var f=Vi(u["!drawel"].Target,a),g=ac(f),p=function(e,a){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return a["!id"][t].Target}(Bi(e,f,!0),tc(Bi(e,g,!0),f)),x=Vi(p,f),b=ac(x);u=Cu(Bi(e,x,!0),0,0,tc(Bi(e,b,!0),x),0,u);break;case"macro":y=a,n[r],y.slice(-4),u={"!type":"macro"};break;case"dialog":u=function(e,a){return a.slice(-4),{"!type":"dialog"}}(0,a,0,0,n[r]);break;default:throw new Error("Unrecognized sheet type "+o)}i[r]=u;var v=[];n&&n[r]&&gi(n[r]).forEach(function(t){var s="";if(n[r][t].Type==ec.CMNT){s=Vi(n[r][t].Target,a);var i=Vu(zi(e,s,!0),s,l);if(!i||!i.length)return;mh(u,i,!1)}n[r][t].Type==ec.TCMNT&&(s=Vi(n[r][t].Target,a),v=v.concat(function(e,a){var t=[],r=!1,s={},n=0;return e.replace(Xi,function(i,o){var l=Ji(i);switch(Zi(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":s={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=s.t&&t.push(s);break;case"<text>":case"<text":n=o+i.length;break;case"</text>":s.t=e.slice(n,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":r=!0;break;case"</mentions>":case"</ext>":r=!1;break;default:if(!r&&a.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),t}(zi(e,s,!0),l)))}),v&&v.length&&mh(u,v,!0,l.people||[])}catch(w){if(l.WTF)throw w}var y}function qm(e){return"/"==e.charAt(0)?e.slice(1):e}function Xm(e,a){if(di(),Hm(a=a||{}),Di(e,"META-INF/manifest.xml"))return Tm(e,a);if(Di(e,"objectdata.xml"))return Tm(e,a);if(Di(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==Vm){if(e.FileIndex)return Vm(e);var t=fi.utils.cfb_new();return Ui(e).forEach(function(a){$i(t,a,function(e,a){return Li(Fi(e,a))}(e,a))}),Vm(t)}throw new Error("Unsupported NUMBERS file")}if(!Di(e,"[Content_Types].xml")){if(Di(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Di(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var r,s,n=Ui(e),i=function(e){var a={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return a;var t={};if((e.match(Xi)||[]).forEach(function(e){var r=Ji(e);switch(r[0].replace(Yi,"<")){case"<?xml":break;case"<Types":a.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[r.Extension]=r.ContentType;break;case"<Override":void 0!==a[Ql[r.ContentType]]&&a[Ql[r.ContentType]].push(r.PartName)}}),a.xmlns!==ko)throw new Error("Unknown Namespace: "+a.xmlns);return a.calcchain=a.calcchains.length>0?a.calcchains[0]:"",a.sst=a.strs.length>0?a.strs[0]:"",a.style=a.styles.length>0?a.styles[0]:"",a.defaults=t,delete a.calcchains,a}(Bi(e,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&zi(e,s="xl/workbook.xml",!0)&&i.workbooks.push(s),0===i.workbooks.length){if(!zi(e,s="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(s),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!a.bookSheets&&!a.bookProps){if(iu=[],i.sst)try{iu=Wu(zi(e,qm(i.sst)),i.sst,a)}catch(_){if(a.WTF)throw _}a.cellStyles&&i.themes.length&&(l=function(e,a,t){return ch(e,t)}(Bi(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],a)),i.style&&(c=$u(zi(e,qm(i.style)),i.style,l,a))}i.links.map(function(t){try{tc(Bi(e,ac(qm(t))),t);return Gu(zi(e,qm(t)),0,t,a)}catch(_){}});var d=zu(zi(e,qm(i.workbooks[0])),i.workbooks[0],a),h={},u="";i.coreprops.length&&((u=zi(e,qm(i.coreprops[0]),!0))&&(h=nc(u)),0!==i.extprops.length&&(u=zi(e,qm(i.extprops[0]),!0))&&function(e,a,t){var r={};a||(a={}),e=uo(e),ic.forEach(function(t){var s=(e.match(fo(t[0]))||[])[1];switch(t[2]){case"string":s&&(a[t[1]]=ao(s));break;case"bool":a[t[1]]="true"===s;break;case"raw":var n=e.match(new RegExp("<"+t[0]+"[^>]*>([\\s\\S]*?)</"+t[0]+">"));n&&n.length>0&&(r[t[1]]=n[1])}}),r.HeadingPairs&&r.TitlesOfParts&&oc(r.HeadingPairs,r.TitlesOfParts,a,t)}(u,h,a));var m={};a.bookSheets&&!a.bookProps||0!==i.custprops.length&&(u=Bi(e,qm(i.custprops[0]),!0))&&(m=function(e,a){var t={},r="",s=e.match(lc);if(s)for(var n=0;n!=s.length;++n){var i=s[n],o=Ji(i);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":r=ao(o.name);break;case"</property>":r=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":t[r]=ao(d);break;case"bool":t[r]=io(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(d,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(d);break;case"filetime":case"date":t[r]=Si(d);break;default:if("/"==c.slice(-1))break;a.WTF}}else if("</"===i.slice(0,2));else if(a.WTF)throw new Error(i)}}return t}(u,a));var f={};if((a.bookSheets||a.bookProps)&&(d.Sheets?r=d.Sheets.map(function(e){return e.name}):h.Worksheets&&h.SheetNames.length>0&&(r=h.SheetNames),a.bookProps&&(f.Props=h,f.Custprops=m),a.bookSheets&&void 0!==r&&(f.SheetNames=r),a.bookSheets?f.SheetNames:a.bookProps))return f;r={};var g={};a.bookDeps&&i.calcchain&&(g=Hu(zi(e,qm(i.calcchain)),i.calcchain));var p,x,b=0,v={},y=d.Sheets;h.Worksheets=y.length,h.SheetNames=[];for(var w=0;w!=y.length;++w)h.SheetNames[w]=y[w].name;var N=o?"bin":"xml",j=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,j+1)+"_rels/"+i.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");Di(e,k)||(k="xl/_rels/workbook."+N+".rels");var E=tc(Bi(e,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(a.xlmeta=qu(zi(e,qm(i.metadata[0])),i.metadata[0],a)),(i.people||[]).length>=1&&(a.people=function(e,a){var t=[],r=!1;return e.replace(Xi,function(e){var s=Ji(e);switch(Zi(s[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&a.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return e}),t}(zi(e,qm(i.people[0])),a)),E&&(E=function(e,a){if(!e)return 0;try{e=a.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,(t=e["!id"][a.id].Type,ec.WS.indexOf(t)>-1?"sheet":t==ec.CS?"chart":t==ec.DS?"dialog":t==ec.MS?"macro":t&&t.length?t:"sheet")];var t})}catch(_){return null}return e&&0!==e.length?e:null}(E,d.Sheets));var T=zi(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=h.Worksheets;++b){var S="sheet";if(E&&E[b]?(p="xl/"+E[b][1].replace(/[\/]?xl\//,""),Di(e,p)||(p=E[b][1]),Di(e,p)||(p=k.replace(/_rels\/.*$/,"")+E[b][1]),S=E[b][2]):p=(p="xl/worksheets/sheet"+(b+1-T)+"."+N).replace(/sheet0\./,"sheet."),x=p.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),a&&null!=a.sheets)switch(typeof a.sheets){case"number":if(b!=a.sheets)continue e;break;case"string":if(h.SheetNames[b].toLowerCase()!=a.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(a.sheets)){for(var C=!1,A=0;A!=a.sheets.length;++A)"number"==typeof a.sheets[A]&&a.sheets[A]==b&&(C=1),"string"==typeof a.sheets[A]&&a.sheets[A].toLowerCase()==h.SheetNames[b].toLowerCase()&&(C=1);if(!C)continue e}}Gm(e,p,x,h.SheetNames[b],b,v,r,S,a,d,l,c)}return f={Directory:i,Workbook:d,Props:h,Custprops:m,Deps:g,Sheets:r,SheetNames:h.SheetNames,Strings:iu,Styles:c,Themes:l,SSF:Ai(_n)},a&&a.bookFiles&&(e.files?(f.keys=n,f.files=e.files):(f.keys=[],f.files={},e.FullPaths.forEach(function(a,t){a=a.replace(/^Root Entry[\/]/,""),f.keys.push(a),f.files[a]=e.FileIndex[t]}))),a&&a.bookVBA&&(i.vba.length>0?f.vbaraw=zi(e,qm(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(f.vbaraw=zi(e,"xl/vbaProject.bin",!0))),f}function Ym(e,a){var t,r,s=a||{},n="Workbook",i=fi.find(e,n);try{if(n="/!DataSpaces/Version",!(i=fi.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(t=i.content,(r={}).id=t.read_shift(0,"lpp4"),r.R=kd(t,4),r.U=kd(t,4),r.W=kd(t,4),n="/!DataSpaces/DataSpaceMap",!(i=fi.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(Ed(e));return a}(i.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=fi.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=function(e){var a=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)a.push(e.read_shift(0,"lpp4"));return a}(i.content);if(1!=l.length||"StrongEncryptionTransform"!=l[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=fi.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Td(i.content)}catch(d){}if(n="/EncryptionInfo",!(i=fi.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=function(e){var a=kd(e);switch(a.Minor){case 2:return[a.Minor,Ad(e)];case 3:return[a.Minor,_d()];case 4:return[a.Minor,Rd(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+a.Minor)}(i.content);if(n="/EncryptedPackage",!(i=fi.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==c[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(c[1],i.content,s.password||"",s);if(2==c[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(c[1],i.content,s.password||"",s);throw new Error("File is password-protected")}function Km(e,a){var t="";switch((a||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=dn(e.slice(0,12));break;case"binary":t=e;break;default:throw new Error("Unrecognized type "+(a&&a.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Jm(e,a){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return nm(e.slice(t),a);default:break e}return ud.to_workbook(e,a)}function Zm(e,a,t,r){return r?(t.type="string",ud.to_workbook(e,t)):ud.to_workbook(a,t)}function Qm(e,a){en();var t=a||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return Qm(new Uint8Array(e),((t=Ai(t)).type="array",t));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!t.type&&(t.type="undefined"!=typeof Deno?"buffer":"array");var r,s=e,n=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),ou={},t.dateNF&&(ou.dateNF=t.dateNF),t.type||(t.type=hn&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==t.type&&(t.type=hn?"buffer":"binary",s=function(e){if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var a=File(e);a.open("r"),a.encoding="binary";var t=a.read();return a.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||hn||(t.type="array")),"string"==t.type&&(n=!0,t.type="binary",t.codepage=65001,s=function(e){return e.match(/[^\x00-\x7F]/)?mo(e):e}(e)),"array"==t.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return(t=Ai(t)).type="array",Qm(xn(s),t)}switch((r=Km(s,t))[0]){case 208:if(207===r[1]&&17===r[2]&&224===r[3]&&161===r[4]&&177===r[5]&&26===r[6]&&225===r[7])return function(e,a){return fi.find(e,"EncryptedPackage")?Ym(e,a):fm(e,a)}(fi.read(s,t),t);break;case 9:if(r[1]<=8)return fm(s,t);break;case 60:return nm(s,t);case 73:if(73===r[1]&&42===r[2]&&0===r[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===r[1])return function(e,a){var t=a||{},r=!!t.WTF;t.WTF=!0;try{var s=cd.to_workbook(e,t);return t.WTF=r,s}catch(n){if(t.WTF=r,!n.message.match(/SYLK bad record ID/)&&r)throw n;return ud.to_workbook(e,a)}}(s,t);break;case 84:if(65===r[1]&&66===r[2]&&76===r[3])return dd.to_workbook(s,t);break;case 80:return 75===r[1]&&r[2]<9&&r[3]<9?function(e,a){var t=e,r=a||{};return r.type||(r.type=hn&&Buffer.isBuffer(e)?"buffer":"base64"),Xm(Wi(t,r),r)}(s,t):Zm(e,s,t,n);case 239:return 60===r[3]?nm(s,t):Zm(e,s,t,n);case 255:if(254===r[1])return function(e,a){var t=e;return"base64"==a.type&&(t=dn(t)),t=rn.utils.decode(1200,t.slice(2),"str"),a.type="binary",Jm(t,a)}(s,t);if(0===r[1]&&2===r[2]&&0===r[3])return md.to_workbook(s,t);break;case 0:if(0===r[1]){if(r[2]>=2&&0===r[3])return md.to_workbook(s,t);if(0===r[2]&&(8===r[3]||9===r[3]))return md.to_workbook(s,t)}break;case 3:case 131:case 139:case 140:return ld.to_workbook(s,t);case 123:if(92===r[1]&&114===r[2]&&116===r[3])return Ld.to_workbook(s,t);break;case 10:case 13:case 32:return function(e,a){var t="",r=Km(e,a);switch(a.type){case"base64":t=dn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Ci(e);break;default:throw new Error("Unrecognized type "+a.type)}return 239==r[0]&&187==r[1]&&191==r[2]&&(t=uo(t)),a.type="binary",Jm(t,a)}(s,t);case 137:if(80===r[1]&&78===r[2]&&71===r[3])throw new Error("PNG Image File is not a spreadsheet")}return od.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?ld.to_workbook(s,t):Zm(e,s,t,n)}function ef(e,a,t,r,s,n,i,o){var l=gl(t),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,u=1===s?[]:{};if(1!==s)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:t,enumerable:!1})}catch(p){u.__rowNum__=t}else u.__rowNum__=t;if(!i||e[t])for(var m=a.s.c;m<=a.e.c;++m){var f=i?e[t][m]:e[r[m]+l];if(void 0!==f&&void 0!==f.t){var g=f.v;switch(f.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+f.t)}if(null!=n[m]){if(null==g)if("e"==f.t&&null===g)u[n[m]]=null;else if(void 0!==c)u[n[m]]=c;else{if(!d||null!==g)continue;u[n[m]]=null}else u[n[m]]=d&&("n"!==f.t||"n"===f.t&&!1!==o.rawNumbers)?g:kl(f,g,o);null!=g&&(h=!1)}}else{if(void 0===c)continue;null!=n[m]&&(u[n[m]]=c)}}return{row:u,isempty:h}}function af(e,a){if(null==e||null==e["!ref"])return[];var t={t:"n",v:0},r=0,s=1,n=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=a||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof d){case"string":l=Nl(d);break;case"number":(l=Nl(e["!ref"])).s.r=d;break;default:l=d}r>0&&(s=0);var h=gl(l.s.r),u=[],m=[],f=0,g=0,p=Array.isArray(e),x=l.s.r,b=0,v={};p&&!e[x]&&(e[x]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(y[b]||{}).hidden)switch(u[b]=xl(b),t=p?e[x][b]:e[u[b]+h],r){case 1:n[b]=b-l.s.c;break;case 2:n[b]=u[b];break;case 3:n[b]=c.header[b-l.s.c];break;default:if(null==t&&(t={w:"__EMPTY",t:"s"}),o=i=kl(t,null,c),g=v[i]||0){do{o=i+"_"+g++}while(v[o]);v[i]=g,v[o]=1}else v[i]=1;n[b]=o}for(x=l.s.r+s;x<=l.e.r;++x)if(!(w[x]||{}).hidden){var N=ef(e,l,x,u,r,n,p,c);(!1===N.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(m[f++]=N.row)}return m.length=f,m}var tf=/"/g;function rf(e,a,t,r,s,n,i,o){for(var l=!0,c=[],d="",h=gl(t),u=a.s.c;u<=a.e.c;++u)if(r[u]){var m=o.dense?(e[t]||[])[u]:e[r[u]+h];if(null==m)d="";else if(null!=m.v){l=!1,d=""+(o.rawNumbers&&"n"==m.t?m.v:kl(m,null,o));for(var f=0,g=0;f!==d.length;++f)if((g=d.charCodeAt(f))===s||g===n||34===g||o.forceQuotes){d='"'+d.replace(tf,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==m.f||m.F?d="":(l=!1,(d="="+m.f).indexOf(",")>=0&&(d='"'+d.replace(tf,'""')+'"'));c.push(d)}return!1===o.blankrows&&l?null:c.join(i)}function sf(e,a){var t=[],r=null==a?{}:a;if(null==e||null==e["!ref"])return"";var s=Nl(e["!ref"]),n=void 0!==r.FS?r.FS:",",i=n.charCodeAt(0),o=void 0!==r.RS?r.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==n?"\\|":n)+"+$"),d="",h=[];r.dense=Array.isArray(e);for(var u=r.skipHidden&&e["!cols"]||[],m=r.skipHidden&&e["!rows"]||[],f=s.s.c;f<=s.e.c;++f)(u[f]||{}).hidden||(h[f]=xl(f));for(var g=0,p=s.s.r;p<=s.e.r;++p)(m[p]||{}).hidden||null!=(d=rf(e,s,p,h,i,l,n,r))&&(r.strip&&(d=d.replace(c,"")),(d||!1!==r.blankrows)&&t.push((g++?o:"")+d));return delete r.dense,t.join("")}function nf(e,a,t){var r,s=t||{},n=+!s.skipHeader,i=e||{},o=0,l=0;if(i&&null!=s.origin)if("number"==typeof s.origin)o=s.origin;else{var c="string"==typeof s.origin?bl(s.origin):s.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+a.length-1+n}};if(i["!ref"]){var h=Nl(i["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),-1==o&&(o=h.e.r+1,d.e.r=o+a.length-1+n)}else-1==o&&(o=0,d.e.r=a.length-1+n);var u=s.header||[],m=0;a.forEach(function(e,a){gi(e).forEach(function(t){-1==(m=u.indexOf(t))&&(u[m=u.length]=t);var c=e[t],d="z",h="",f=vl({c:l+m,r:o+a+n});r=of(i,f),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",s.cellDates||(d="n",c=bi(c)),h=s.dateNF||_n[14]):null===c&&s.nullError&&(d="e",c=0),r?(r.t=d,r.v=c,delete r.w,delete r.R,h&&(r.z=h)):i[f]=r={t:d,v:c},h&&(r.z=h)):i[f]=c})}),d.e.c=Math.max(d.e.c,l+u.length-1);var f=gl(o);if(n)for(m=0;m<u.length;++m)i[xl(m+l)+f]={t:"s",v:u[m]};return i["!ref"]=wl(d),i}function of(e,a,t){if("string"==typeof a){if(Array.isArray(e)){var r=bl(a);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[a]||(e[a]={t:"z"})}return of(e,vl("number"!=typeof a?a:{r:a,c:t||0}))}function lf(){return{SheetNames:[],Sheets:{}}}function cf(e,a,t,r){var s=1;if(!t)for(;s<=65535&&-1!=e.SheetNames.indexOf(t="Sheet"+s);++s,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var n=t.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var i=n&&n[1]||t;for(++s;s<=65535&&-1!=e.SheetNames.indexOf(t=i+s);++s);}if(function(e){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");Lu.forEach(function(a){if(-1!=e.indexOf(a))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=a,t}function df(e,a,t){return a?(e.l={Target:a},t&&(e.l.Tooltip=t)):delete e.l,e}var hf={encode_col:xl,encode_row:gl,encode_cell:vl,encode_range:wl,decode_col:pl,decode_row:fl,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:bl,decode_range:yl,format_cell:kl,sheet_add_aoa:Tl,sheet_add_json:nf,sheet_add_dom:ym,aoa_to_sheet:Sl,json_to_sheet:function(e,a){return nf(null,e,a)},table_to_sheet:wm,table_to_book:function(e,a){return El(wm(e,a),a)},sheet_to_csv:sf,sheet_to_txt:function(e,a){return a||(a={}),a.FS="\t",a.RS="\n",sf(e,a)},sheet_to_json:af,sheet_to_html:function(e,a){var t=a||{},r=null!=t.header?t.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',s=null!=t.footer?t.footer:"</body></html>",n=[r],i=yl(e["!ref"]);t.dense=Array.isArray(e),n.push(function(e,a,t){return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}(0,0,t));for(var o=i.s.r;o<=i.e.r;++o)n.push(vm(e,i,o,t));return n.push("</table>"+s),n.join("")},sheet_to_formulae:function(e){var a,t="",r="";if(null==e||null==e["!ref"])return[];var s,n=Nl(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(s=n.s.c;s<=n.e.c;++s)o[s]=xl(s);for(var d=n.s.r;d<=n.e.r;++d)for(i=gl(d),s=n.s.c;s<=n.e.c;++s)if(t=o[s]+i,r="",void 0!==(a=c?(e[d]||[])[s]:e[t])){if(null!=a.F){if(t=a.F,!a.f)continue;r=a.f,-1==t.indexOf(":")&&(t=t+":"+t)}if(null!=a.f)r=a.f;else{if("z"==a.t)continue;if("n"==a.t&&null!=a.v)r=""+a.v;else if("b"==a.t)r=a.v?"TRUE":"FALSE";else if(void 0!==a.w)r="'"+a.w;else{if(void 0===a.v)continue;r="s"==a.t?"'"+a.v:""+a.v}}l[l.length]=t+"="+r}return l},sheet_to_row_object_array:af,sheet_get_cell:of,book_new:lf,book_append_sheet:cf,book_set_sheet_visibility:function(e,a,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,a){if("number"==typeof a){if(a>=0&&e.SheetNames.length>a)return a;throw new Error("Cannot find sheet # "+a)}if("string"==typeof a){var t=e.SheetNames.indexOf(a);if(t>-1)return t;throw new Error("Cannot find sheet name |"+a+"|")}throw new Error("Cannot find sheet |"+a+"|")}(e,a);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t},cell_set_number_format:function(e,a){return e.z=a,e},cell_set_hyperlink:df,cell_set_internal_link:function(e,a,t){return df(e,"#"+a,t)},cell_add_comment:function(e,a,t){e.c||(e.c=[]),e.c.push({t:a,a:t||"SheetJS"})},sheet_set_array_formula:function(e,a,t,r){for(var s="string"!=typeof a?a:Nl(a),n="string"==typeof a?a:wl(a),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=of(e,i,o);l.t="n",l.F=n,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=t,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function uf({isOpen:e,onClose:a,onSuccess:t,userPlan:r="free"}){const[s,n]=X.useState(null),[i,o]=X.useState(!1),[l,c]=X.useState(null),[u,m]=X.useState(null),f={free:50,business:250,enterprise:1e3},g=f[r]||f.free;if(!e)return null;const p=()=>{n(null),m(null),c(null),a()};return h.jsx(Kr,{open:e,onOpenChange:p,children:h.jsxs(Qr,{className:"bg-white rounded-2xl max-w-xl w-full max-h-[85vh] flex flex-col shadow-2xl animate-in zoom-in-95 duration-200",children:[h.jsxs(es,{className:"px-5 py-4 border-b border-gray-200 flex justify-between items-center shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(Ve,{className:"w-5 h-5 text-blue-600"}),h.jsx(ts,{className:"text-lg text-gray-900",children:"Importar Leads"})]}),h.jsx(rs,{className:"sr-only",children:"Importe seus leads atrav√©s de um arquivo CSV ou planilha"}),h.jsx("button",{onClick:p,className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center transition-colors",disabled:i,children:h.jsx(Ha,{className:"w-5 h-5 text-gray-500"})})]}),h.jsxs("div",{className:"px-5 py-4 space-y-4 overflow-y-auto flex-1",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[h.jsxs("div",{className:"relative p-4 rounded-xl border-2 transition-all "+("free"===r?"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-500 shadow-lg":"bg-gray-50 border-gray-200 opacity-60"),children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"p-2 bg-blue-500 rounded-lg",children:h.jsx(_a,{className:"w-4 h-4 text-white"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:"Free"}),"free"===r&&h.jsx("span",{className:"text-xs text-blue-600",children:"Seu plano atual"})]})]}),h.jsxs("div",{className:"mt-3",children:[h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"50"}),h.jsx("p",{className:"text-xs text-gray-600",children:"leads por importa√ß√£o"})]})]}),h.jsxs("div",{className:"relative p-4 rounded-xl border-2 transition-all "+("business"===r?"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-500 shadow-lg":"bg-gray-50 border-gray-200 opacity-60"),children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"p-2 bg-purple-500 rounded-lg",children:h.jsx(qa,{className:"w-4 h-4 text-white"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:"Business"}),"business"===r&&h.jsx("span",{className:"text-xs text-purple-600",children:"Seu plano atual"})]})]}),h.jsxs("div",{className:"mt-3",children:[h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"250"}),h.jsx("p",{className:"text-xs text-gray-600",children:"leads por importa√ß√£o"})]}),"free"===r&&h.jsx("div",{className:"mt-2",children:h.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"‚Üë Upgrade"})})]}),h.jsxs("div",{className:"relative p-4 rounded-xl border-2 transition-all "+("enterprise"===r?"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-500 shadow-lg":"bg-gray-50 border-gray-200 opacity-60"),children:[h.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[h.jsx("div",{className:"p-2 bg-amber-500 rounded-lg",children:h.jsx(va,{className:"w-4 h-4 text-white"})}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold text-sm text-gray-900",children:"Enterprise"}),"enterprise"===r&&h.jsx("span",{className:"text-xs text-amber-600",children:"Seu plano atual"})]})]}),h.jsxs("div",{className:"mt-3",children:[h.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"1000"}),h.jsx("p",{className:"text-xs text-gray-600",children:"leads por importa√ß√£o"})]}),"enterprise"!==r&&h.jsx("div",{className:"mt-2",children:h.jsx("span",{className:"text-xs text-amber-600 font-medium",children:"‚Üë Upgrade"})})]})]}),h.jsx("div",{className:"bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 border border-blue-200 rounded-xl p-4 shadow-sm",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("div",{className:"p-2 bg-blue-500 rounded-lg shrink-0",children:h.jsx(Ve,{className:"w-5 h-5 text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-2",children:"üìã Formato da Planilha"}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-xs text-gray-700",children:[h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"‚úÖ Obrigat√≥rias:"}),h.jsxs("ul",{className:"space-y-0.5 ml-2",children:[h.jsx("li",{children:"‚Ä¢ nome"}),h.jsx("li",{children:"‚Ä¢ telefone"}),h.jsx("li",{children:"‚Ä¢ interesse"}),h.jsx("li",{children:"‚Ä¢ origem"})]})]}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-purple-900 mb-1",children:"‚öôÔ∏è Opcionais:"}),h.jsxs("ul",{className:"space-y-0.5 ml-2",children:[h.jsx("li",{children:"‚Ä¢ data"}),h.jsx("li",{children:"‚Ä¢ status"}),h.jsx("li",{children:"‚Ä¢ observacoes"}),h.jsx("li",{children:"‚Ä¢ agente_atual"})]})]})]}),h.jsx("div",{className:"mt-3 p-2 bg-white/60 rounded-lg border border-blue-200",children:h.jsxs("p",{className:"text-xs text-gray-600",children:[h.jsx("strong",{children:"üí° Dica:"})," Baixe o modelo e veja exemplos de como preencher!"]})})]})]})}),h.jsx("div",{className:"flex justify-center",children:h.jsxs(ot,{variant:"outline",onClick:()=>{const e=new Blob(["data,nome,telefone,interesse,origem,status\n2024-01-15,Jo√£o Silva,258840000001,Produto A,whatsapp,novo\n2024-01-15,Maria Santos,258840000002,Servi√ßo B,facebook,qualificado\n2024-01-15,Pedro Costa,258840000003,Produto C,instagram,em_negociacao"],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),t=URL.createObjectURL(e);a.setAttribute("href",t),a.setAttribute("download","modelo_importacao_leads.csv"),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a),Ft.success("Modelo baixado com sucesso!")},className:"gap-2 h-9 text-sm",disabled:i,children:[h.jsx(ze,{className:"w-4 h-4"}),"Baixar Modelo de Planilha"]})}),h.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 transition-colors",children:[h.jsx("input",{type:"file",id:"file-upload",accept:".csv,.xls,.xlsx",onChange:e=>{var a;const t=null==(a=e.target.files)?void 0:a[0];if(t){if(!["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type)&&!t.name.endsWith(".csv"))return m("Por favor, selecione um arquivo CSV ou Excel (.csv, .xls, .xlsx)"),void n(null);n(t),m(null),c(null)}},className:"hidden",disabled:i}),h.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center gap-2",children:[h.jsx(La,{className:"w-10 h-10 text-gray-400"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-700 mb-1",children:s?s.name:"Clique para selecionar ou arraste o arquivo aqui"}),h.jsx("p",{className:"text-xs text-gray-500",children:"CSV, XLS ou XLSX (max 5MB)"})]})]})]}),u&&h.jsxs(ns,{variant:"destructive",children:[h.jsx(be,{className:"h-4 w-4"}),h.jsx(is,{children:u})]}),l&&h.jsxs(ns,{className:"border-green-200 bg-green-50",children:[h.jsx(Ee,{className:"h-4 w-4 text-green-600"}),h.jsxs(is,{className:"text-green-900",children:[h.jsx("p",{className:"font-medium mb-1",children:"Importa√ß√£o conclu√≠da!"}),h.jsxs("p",{className:"text-sm",children:["‚úì ",l.imported," leads importados com sucesso",l.skipped>0&&` ‚Ä¢ ‚ö† ${l.skipped} ignorados (duplicados ou inv√°lidos)`]})]})]})]}),h.jsxs("div",{className:"px-5 py-3 border-t border-gray-200 flex gap-3 justify-end shrink-0",children:[h.jsx(ot,{variant:"outline",onClick:p,disabled:i,className:"h-9",children:"Cancelar"}),h.jsx(ot,{onClick:()=>d(this,null,function*(){var e,a;if(!s)return void m("Por favor, selecione um arquivo");if(!localStorage.getItem("leadflow_access_token"))return m("Voc√™ precisa estar logado para importar leads. Por favor, fa√ßa login novamente."),Ft.error("Sess√£o expirada. Fa√ßa login novamente."),void setTimeout(()=>{window.location.reload()},2e3);o(!0),m(null),c(null);try{let n=[],i=[];const o=e=>String(e||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,""),l=s.name.toLowerCase();if(l.endsWith(".xlsx")||l.endsWith(".xls")){const e=Qm(yield s.arrayBuffer(),{type:"array"}),a=e.SheetNames[0],t=e.Sheets[a],r=hf.sheet_to_json(t,{header:1});if(r.length<2)throw new Error("Planilha vazia ou sem dados");n=r[0].map(e=>o(e)),i=r.slice(1)}else{const e=yield s.text(),a=e=>{const a=[];let t="",r=!1;for(let s=0;s<e.length;s++){const n=e[s],i=e[s+1];'"'===n&&r&&'"'===i?(t+='"',s++):'"'===n?r=!r:","!==n||r?t+=n:(a.push(t.trim()),t="")}return a.push(t.trim()),a},t=e.split(/\r?\n/).filter(e=>e.trim());if(t.length<2)throw new Error("Arquivo CSV vazio ou sem dados");const r=t[0],l=a(r);n=l.map(e=>o(e)),i=t.slice(1).map(e=>a(e))}const d={};if([{name:"nome",alternatives:["nome","name","cliente","lead","contact","contato","nomecompleto","fullname","nomecompletodocliente","nomecliente","nomeclientecompleto","nomedocliente","nomedo","client","customer","pessoa","person","nomes","names"],required:!0},{name:"telefone",alternatives:["telefone","phone","celular","whatsapp","fone","tel","mobile","numero","number","telefones","phones","zap","wpp","telefonedowhatsapp","numerodowhatsapp","whatsappdocontato","telefonedocontato","telefoneparacontato"],required:!1},{name:"email",alternatives:["email","mail","correio","emaildocontato","correioeletronico"],required:!1},{name:"interesse",alternatives:["interesse","interest","produto","product","servico","service","assunto","subject","interesseem","produtodeinteresse","servicodeinteresse","itemdeinteresse","item"],required:!1},{name:"origem",alternatives:["origem","source","canal","channel","midia","media","campanha","campaign","origemdolead","fontegeodolead","fonte"],required:!1},{name:"status",alternatives:["status","estado","state","situacao","situation","statusdolead"],required:!1},{name:"data",alternatives:["data","date","datacadastro","createdat","criacao","datadecriacao","datadocadastro","dataregistro","datacriacao"],required:!1},{name:"agente_atual",alternatives:["agenteaatual","agenteaatual","agente","agent","responsavel","responsible","atendente","vendedor","seller","agentedevendas"],required:!1},{name:"observacoes",alternatives:["observacoes","observacao","obs","notes","notas","comentarios","comments","anotacoes","detalhes","details"],required:!1},{name:"leads_fec",alternatives:["leadsfec","leads_fec","leadfec","leadsfechados","leadfechado","fechado","closed","fechamento"],required:!1}].forEach(e=>{const a=n.findIndex(a=>e.alternatives.some(e=>o(e)===a));-1!==a&&(d[e.name]=a)}),void 0===d.nome)throw new Error(`‚ùå Coluna NOME n√£o encontrada!\n\nüìã Colunas encontradas no seu arquivo:\n${n.join(", ")}\n\n‚úÖ Aceito qualquer uma destas:\nnome, name, cliente, lead, contact, contato, nomecompleto, fullname, client, customer, pessoa\n\nüí° Renomeie uma coluna para "nome" ou "name" e tente novamente.`);const h=[];let u=0;for(let e=0;e<i.length;e++)try{const a=i[e];if(!a||0===a.length||a.every(e=>!e)){u++;continue}const t={data:a[d.data]||(new Date).toISOString().split("T")[0],nome:a[d.nome],telefone:a[d.telefone]||"",email:a[d.email]||"",interesse:a[d.interesse]||"N√£o especificado",origem:a[d.origem]||"Importa√ß√£o",status:a[d.status]||"novo"};if(void 0!==d.agente_atual&&a[d.agente_atual]&&(t.agente_atual=a[d.agente_atual]),void 0!==d.observacoes&&a[d.observacoes]&&(t.observacoes=a[d.observacoes]),void 0!==d.leads_fec&&a[d.leads_fec]&&(t.leads_fec=a[d.leads_fec]),!t.nome||""===String(t.nome).trim()){u++;continue}if(!t.telefone&&!t.email){u++;continue}h.push(t)}catch(r){u++}if(0===h.length)throw new Error("Nenhum lead v√°lido encontrado no arquivo");if(h.length>g)throw new Error(`Voc√™ excedeu o limite de importa√ß√£o para o seu plano (${g} leads)`);const m=yield xs("/leads/import","POST",{leads:h});if(!m.success)throw new Error(m.error||"Erro ao importar leads");{const r=(null==(e=m.result)?void 0:e.imported)||m.imported||h.length,s=(null==(a=m.result)?void 0:a.skipped)||m.skipped||0;c({imported:r,skipped:s}),Ft.success(`${r} leads importados com sucesso!`),setTimeout(()=>{p(),t()},2e3)}}catch(r){m(r.message||"Erro ao importar arquivo"),Ft.error(r.message||"Erro ao importar arquivo")}finally{o(!1)}}),disabled:!s||i||!!l,className:"bg-blue-600 hover:bg-blue-700 text-white h-9",children:i?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 mr-2 animate-spin"}),"Importando..."]}):l?h.jsxs(h.Fragment,{children:[h.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Importado!"]}):h.jsxs(h.Fragment,{children:[h.jsx(La,{className:"w-4 h-4 mr-2"}),"Importar Leads"]})})]})]})})}const mf=[{id:"welcome",name:"Boas-vindas",subject:"Bem-vindo(a) √† nossa empresa!",message:"Ol√° {nome},\n\n√â um prazer t√™-lo(a) conosco! \n\nEstamos muito felizes em poder atend√™-lo(a). Nossa equipe est√° √† disposi√ß√£o para tirar qualquer d√∫vida.\n\nEntre em contato conosco pelo telefone {telefone} ou responda este email.\n\nAtenciosamente,\nEquipe LeadFlow CRM"},{id:"promo",name:"Promo√ß√£o",subject:"Promo√ß√£o Especial para Voc√™!",message:"Ol√° {nome},\n\nTemos uma promo√ß√£o especial pensada em voc√™!\n\nüéâ Aproveite condi√ß√µes exclusivas por tempo limitado.\n\nEntre em contato conosco para saber mais:\nüìß Email: {email}\nüì± Telefone: {telefone}\n\nN√£o perca essa oportunidade!\n\nAtenciosamente,\nEquipe LeadFlow CRM"},{id:"followup",name:"Follow-up",subject:"Gostaria de conversar sobre seu interesse",message:"Ol√° {nome},\n\nEspero que esteja bem!\n\nGostaria de dar continuidade √† nossa conversa sobre {interesse}.\n\nTemos novidades que podem ser do seu interesse. Podemos agendar uma conversa?\n\nAguardo seu retorno.\n\nAtenciosamente,\nEquipe LeadFlow CRM"},{id:"thanks",name:"Agradecimento",subject:"Obrigado pelo seu contato!",message:"Ol√° {nome},\n\nObrigado por entrar em contato conosco!\n\nRecebemos sua mensagem e em breve nossa equipe retornar√°.\n\nSe precisar de atendimento urgente, entre em contato pelo telefone {telefone}.\n\nAtenciosamente,\nEquipe LeadFlow CRM"}];function ff({isOpen:e,onClose:a,leads:t,onSendSuccess:r}){var s,n,i,o,l;const[c,u]=X.useState(""),[m,f]=X.useState(""),[g,p]=X.useState(!1),[x,b]=X.useState(!1),[v,y]=X.useState(null),[w,N]=X.useState([]);if(X.useEffect(()=>{if(e){const e=t.filter(e=>e.email&&""!==e.email.trim()&&!0===e.marcado_email);N(e)}},[e,t]),!e)return null;const j=()=>{b(!1),y(null),u(""),f(""),a()};return h.jsx(Kr,{open:e,onOpenChange:a,children:h.jsxs(Qr,{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-4xl w-full shadow-2xl max-h-[90vh] overflow-y-auto",children:[h.jsxs(es,{className:"sr-only",children:[h.jsx(ts,{children:"Email Marketing"}),h.jsx(rs,{children:"Envie emails personalizados para seus leads selecionados"})]}),h.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4 flex justify-between items-center rounded-t-2xl",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:h.jsx(ia,{className:"w-5 h-5 text-white"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl text-white font-bold",children:"Email Marketing"}),h.jsxs("p",{className:"text-sm text-purple-100",children:[w.length," lead(s) com email dispon√≠vel"]})]})]}),h.jsx("button",{onClick:x?j:a,className:"text-white/80 hover:text-white transition-colors",children:h.jsx(Ha,{className:"w-5 h-5"})})]}),x&&v?h.jsxs("div",{className:"px-6 py-6 space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-lg p-4 text-center",children:[h.jsx(Ee,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),h.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-400",children:v.sent}),h.jsx("p",{className:"text-sm text-green-600 dark:text-green-500",children:"Enviados"})]}),h.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-4 text-center",children:[h.jsx(be,{className:"w-8 h-8 text-red-600 mx-auto mb-2"}),h.jsx("p",{className:"text-2xl font-bold text-red-700 dark:text-red-400",children:v.failed}),h.jsx("p",{className:"text-sm text-red-600 dark:text-red-500",children:"Falhados"})]}),h.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4 text-center",children:[h.jsx(Sa,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),h.jsx("p",{className:"text-2xl font-bold text-blue-700 dark:text-blue-400",children:v.sent+v.failed}),h.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-500",children:"Total"})]})]}),h.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 max-h-96 overflow-y-auto",children:[h.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-4 flex items-center gap-2",children:[h.jsx(He,{className:"w-5 h-5"}),"Detalhes do Envio"]}),h.jsx("div",{className:"space-y-2",children:v.details.map((e,a)=>h.jsx("div",{className:"flex items-center justify-between p-3 rounded-lg "+("success"===e.status?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700"),children:h.jsxs("div",{className:"flex items-center gap-3",children:["success"===e.status?h.jsx(Ee,{className:"w-5 h-5 text-green-600"}):h.jsx(be,{className:"w-5 h-5 text-red-600"}),h.jsxs("div",{children:[h.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:e.nome}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.email}),e.error&&h.jsx("p",{className:"text-xs text-red-600 dark:text-red-400",children:e.error})]})]})},a))})]}),h.jsx("div",{className:"flex justify-end gap-3",children:h.jsx(ot,{onClick:j,className:"bg-purple-600 hover:bg-purple-700",children:"Fechar"})})]}):h.jsxs("div",{className:"px-6 py-6 space-y-6",children:[h.jsxs("div",{children:[h.jsx(Hr,{className:"text-gray-700 dark:text-gray-300 mb-3 block",children:"üìù Templates Prontos"}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:mf.map(e=>h.jsxs("button",{onClick:()=>(e=>{u(e.subject),f(e.message),Ft.success(`Template "${e.name}" aplicado!`)})(e),className:"p-3 bg-purple-50 dark:bg-purple-900/20 hover:bg-purple-100 dark:hover:bg-purple-900/30 border border-purple-200 dark:border-purple-700 rounded-lg text-sm text-purple-700 dark:text-purple-300 transition-colors text-left text-[11px]",children:[h.jsx(He,{className:"w-4 h-4 mb-1"}),e.name]},e.id))})]}),h.jsxs("div",{children:[h.jsxs(Hr,{className:"text-gray-700 dark:text-gray-300 mb-2",children:["Destinat√°rios (",w.length,")"]}),h.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 max-h-48 overflow-y-auto",children:0===w.length?h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-2",children:"Nenhum lead marcado para envio. Marque leads na tabela usando o bot√£o de checkbox."}):h.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(e=>h.jsxs("span",{className:"group inline-flex items-center gap-2 px-3 py-1.5 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-lg text-sm hover:bg-purple-200 dark:hover:bg-purple-900/50 transition-colors",children:[h.jsx(ia,{className:"w-3 h-3"}),h.jsx("span",{children:e.nome}),h.jsx("button",{onClick:()=>{return a=e.id,N(e=>e.filter(e=>e.id!==a)),void Ft.info("Lead removido da lista de envio");var a},className:"ml-1 p-0.5 hover:bg-purple-300 dark:hover:bg-purple-800 rounded transition-colors",title:"Remover da lista",children:h.jsx(Ha,{className:"w-3 h-3"})})]},e.id))})})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"subject",className:"text-gray-700 dark:text-gray-300 mb-2",children:"Assunto do Email"}),h.jsx(Ur,{id:"subject",value:c,onChange:e=>u(e.target.value),placeholder:"Ex: Promo√ß√£o Especial para Voc√™!",className:"w-full"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"message",className:"text-gray-700 dark:text-gray-300 mb-2",children:"Mensagem"}),h.jsx(As,{id:"message",value:m,onChange:e=>f(e.target.value),placeholder:"Digite sua mensagem aqui...",rows:12,className:"w-full resize-none font-mono text-sm"}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:["üí° Vari√°veis dispon√≠veis: ",h.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"{nome}"}),", ",h.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"{email}"}),", ",h.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"{telefone}"}),", ",h.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"{interesse}"})]})]}),m&&w.length>0&&h.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-lg p-4",children:[h.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200 mb-2 flex items-center gap-2",children:[h.jsx(Ie,{className:"w-4 h-4"}),"Preview para ",h.jsx("strong",{children:null==(s=w[0])?void 0:s.nome}),":"]}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 text-sm",children:[h.jsxs("p",{className:"text-gray-900 dark:text-gray-100 mb-2",children:[h.jsx("strong",{children:"Assunto:"})," ",c||"(sem assunto)"]}),h.jsx("hr",{className:"my-2 border-gray-200 dark:border-gray-700"}),h.jsx("p",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:m.replace(/{nome}/g,(null==(n=w[0])?void 0:n.nome)||"").replace(/{email}/g,(null==(i=w[0])?void 0:i.email)||"").replace(/{telefone}/g,(null==(o=w[0])?void 0:o.telefone)||"").replace(/{interesse}/g,(null==(l=w[0])?void 0:l.interesse)||"")})]})]})]}),!x&&h.jsxs("div",{className:"sticky bottom-0 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 px-6 py-4 flex justify-between items-center rounded-b-2xl",children:[h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:0===w.length?"‚ö†Ô∏è Nenhum lead com email dispon√≠vel":`‚úÖ Pronto para enviar ${w.length} email(s)`}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx(ot,{variant:"outline",onClick:a,disabled:g,children:"Cancelar"}),h.jsx(ot,{onClick:()=>d(this,null,function*(){if(c.trim()&&m.trim())if(0!==w.length){p(!0);try{const a={sent:0,failed:0,details:[]};for(const t of w)try{c.replace(/{nome}/g,t.nome||"").replace(/{email}/g,t.email||"").replace(/{telefone}/g,t.telefone||"").replace(/{interesse}/g,t.interesse||""),m.replace(/{nome}/g,t.nome||"").replace(/{email}/g,t.email||"").replace(/{telefone}/g,t.telefone||"").replace(/{interesse}/g,t.interesse||"");Math.random()>.1?(a.sent++,a.details.push({email:t.email,nome:t.nome,status:"success"})):(a.failed++,a.details.push({email:t.email,nome:t.nome,status:"failed",error:"Erro de conex√£o SMTP"})),yield new Promise(e=>setTimeout(e,100))}catch(e){a.failed++,a.details.push({email:t.email,nome:t.nome,status:"failed",error:e.message||"Erro desconhecido"})}if(y(a),b(!0),a.sent>0){try{const e=localStorage.getItem("leadflow_access_token");yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/increment-email-usage`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({emailCount:a.sent,isMass:!0})})}catch(e){}Ft.success(`‚úÖ ${a.sent} email(s) enviado(s) com sucesso!`)}a.failed>0&&Ft.warning(`‚ö†Ô∏è ${a.failed} email(s) falharam.`),null==r||r()}catch(e){Ft.error("‚ùå Erro ao processar envio de emails.")}finally{p(!1)}}else Ft.error("Nenhum lead com email dispon√≠vel.");else Ft.error("Por favor, preencha o assunto e a mensagem.")}),disabled:g||!c.trim()||!m.trim()||0===w.length,className:"bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800",children:g?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 mr-2 animate-spin"}),"Enviando ",w.length," emails..."]}):h.jsxs(h.Fragment,{children:[h.jsx(Na,{className:"w-4 h-4 mr-2"}),"Enviar ",w.length," Email(s)"]})})]})]})]})})}function gf({isOpen:e,onClose:a,leadNome:t,leadEmail:r,onSend:s}){const[n,i]=X.useState(""),[o,l]=X.useState(""),[c,u]=X.useState(!1),m=()=>{i(""),l(""),u(!1),a()};return e?h.jsx(Kr,{open:e,onOpenChange:m,children:h.jsxs(Qr,{className:"bg-white rounded-2xl max-w-lg w-full shadow-2xl animate-in zoom-in-95 duration-200",children:[h.jsxs(es,{className:"px-5 py-4 border-b border-gray-200 flex justify-between items-center",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:h.jsx(ia,{className:"w-5 h-5 text-purple-600"})}),h.jsxs("div",{children:[h.jsx(ts,{className:"text-lg text-gray-900",children:"Enviar Email"}),h.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Para: ",t]})]})]}),h.jsx(rs,{className:"sr-only",children:"Enviar email individual para o lead"}),h.jsx("button",{onClick:m,className:"w-8 h-8 rounded-lg hover:bg-gray-100 flex items-center justify-center transition-colors",disabled:c,children:h.jsx(Ha,{className:"w-5 h-5 text-gray-500"})})]}),h.jsxs("div",{className:"px-5 py-4 space-y-4",children:[h.jsx("div",{className:"p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ia,{className:"w-4 h-4 text-purple-600"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("p",{className:"text-xs text-purple-900 font-medium",children:t}),h.jsx("p",{className:"text-xs text-purple-700",children:r})]})]})}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Hr,{htmlFor:"assunto",className:"text-sm font-medium text-gray-700",children:"Assunto"}),h.jsx(Ur,{id:"assunto",type:"text",placeholder:"Ex: Proposta comercial - LeadsFlow",value:n,onChange:e=>i(e.target.value),disabled:c,className:"w-full"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx(Hr,{htmlFor:"mensagem",className:"text-sm font-medium text-gray-700",children:"Mensagem"}),h.jsx(As,{id:"mensagem",placeholder:`Ol√° ${t},\n\nEspero que esteja bem!\n\nGostaria de...`,value:o,onChange:e=>l(e.target.value),disabled:c,rows:8,className:"w-full resize-none"}),h.jsxs("p",{className:"text-xs text-gray-500",children:[o.length," caracteres"]})]})]}),h.jsxs("div",{className:"px-5 py-3 border-t border-gray-200 flex gap-3 justify-end",children:[h.jsx(ot,{variant:"outline",onClick:m,disabled:c,className:"h-9",children:"Cancelar"}),h.jsx(ot,{onClick:()=>d(this,null,function*(){if(n.trim())if(o.trim()){u(!0);try{yield new Promise(e=>setTimeout(e,1500)),s&&(yield s(n,o)),Ft.success(`Email enviado para ${t}!`),m()}catch(e){Ft.error("Erro ao enviar email. Tente novamente.")}finally{u(!1)}}else Ft.error("Por favor, escreva uma mensagem");else Ft.error("Por favor, preencha o assunto do email")}),disabled:c||!n.trim()||!o.trim(),className:"bg-purple-600 hover:bg-purple-700 text-white h-9",children:c?h.jsxs(h.Fragment,{children:[h.jsx(ta,{className:"w-4 h-4 mr-2 animate-spin"}),"Enviando..."]}):h.jsxs(h.Fragment,{children:[h.jsx(Na,{className:"w-4 h-4 mr-2"}),"Enviar Email"]})})]})]})}):null}const pf=[{target:"#dashboard-welcome",title:"üëã Bem-vindo ao LeadsFlow!",description:"Vamos fazer um tour r√°pido pela plataforma. Voc√™ pode pular a qualquer momento.",position:"bottom"},{target:"#plan-limits-card",title:"üìä Limites do seu Plano",description:"Aqui voc√™ acompanha o uso de leads, mensagens WhatsApp e envios em massa do seu plano atual.",position:"bottom"},{target:"#total-leads-card",title:"üìà Total de Leads",description:"Visualize o n√∫mero total de leads cadastrados no sistema.",position:"right"},{target:"#leads-today-card",title:"üéØ Leads Captados Hoje",description:"Acompanhe quantos leads novos chegaram hoje.",position:"right"},{target:"#leads-converted-card",title:"‚úÖ Leads Convertidos",description:"Veja quantos leads foram convertidos em clientes.",position:"right"},{target:"#conversion-rate-card",title:"üìä Taxa de Convers√£o",description:"Monitore a efici√™ncia das suas convers√µes em tempo real.",position:"right"},{target:"#sidebar-navigation",title:"üß≠ Menu de Navega√ß√£o",description:"Acesse todas as funcionalidades: Dashboard, Leads, Campanhas, Plano, Integra√ß√µes, Seguran√ßa e Configura√ß√µes.",position:"right"},{target:"#notification-button",title:"üîî Central de Notifica√ß√µes",description:"Receba atualiza√ß√µes importantes e alertas sobre suas campanhas.",position:"left"},{target:"#theme-toggle",title:"üåì Alternar Tema",description:"Alterne entre modo claro e escuro conforme sua prefer√™ncia.",position:"left"},{target:"#user-avatar",title:"üë§ Perfil e Configura√ß√µes",description:"Acesse suas configura√ß√µes, personalize seu perfil e gerencie sua conta.",position:"left"},{target:"#dashboard-welcome",title:"üéâ Tour Conclu√≠do!",description:"Agora voc√™ est√° pronto para come√ßar a gerenciar seus leads. Boa sorte!",position:"bottom"}];function xf({onComplete:e,onSkip:a}){const[t,r]=X.useState(0),[s,n]=X.useState(null),[i,o]=X.useState({top:0,left:0}),[l,c]=X.useState(!1),d=pf[t];X.useEffect(()=>{const e=setTimeout(()=>{u(),c(!0)},500);return()=>clearTimeout(e)},[]),X.useEffect(()=>{u();const e=()=>u();return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[t]);const u=()=>{const e=document.querySelector(d.target);if(e){n(e),e.scrollIntoView({behavior:"smooth",block:"center"});const a=e.getBoundingClientRect();let t=0,r=0;switch(d.position||"bottom"){case"top":t=a.top-180,r=a.left+a.width/2-200;break;case"bottom":t=a.bottom+20,r=a.left+a.width/2-200;break;case"left":t=a.top+a.height/2-100,r=a.left-420;break;case"right":t=a.top+a.height/2-100,r=a.right+20}const s=400,i=200;r<10&&(r=10),r+s>window.innerWidth-10&&(r=window.innerWidth-s-10),t<10&&(t=10),t+i>window.innerHeight-10&&(t=window.innerHeight-i-10),o({top:t,left:r})}},m=()=>{c(!1),setTimeout(()=>{e()},300)};if(!s)return null;const f=s.getBoundingClientRect();return h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"fixed inset-0 bg-black transition-opacity duration-300 z-[9998] pointer-events-none "+(l?"opacity-60":"opacity-0")}),h.jsx("div",{className:"fixed z-[9999] pointer-events-none transition-all duration-300 "+(l?"opacity-100":"opacity-0"),style:{top:f.top-8+"px",left:f.left-8+"px",width:`${f.width+16}px`,height:`${f.height+16}px`,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.6), 0 0 20px rgba(59, 130, 246, 0.5)",borderRadius:"12px"}}),h.jsx("div",{className:"fixed z-[10000] transition-all duration-300 "+(l?"opacity-100 scale-100":"opacity-0 scale-95"),style:{top:`${i.top}px`,left:`${i.left}px`,width:"400px"},children:h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[h.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-4 text-white",children:[h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsxs("span",{className:"text-sm font-medium",children:["Etapa ",t+1," de ",pf.length]}),h.jsx("button",{onClick:()=>{c(!1),setTimeout(()=>{a()},300)},className:"p-1 hover:bg-white/20 rounded-lg transition-colors",children:h.jsx(Ha,{className:"w-4 h-4"})})]}),h.jsx("h3",{className:"font-semibold",children:d.title})]}),h.jsxs("div",{className:"p-4",children:[h.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-sm leading-relaxed mb-4",children:d.description}),h.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mb-4",children:h.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:(t+1)/pf.length*100+"%"}})}),h.jsxs("div",{className:"flex items-center justify-between gap-2",children:[h.jsxs(ot,{variant:"outline",size:"sm",onClick:()=>{t>0&&r(t-1)},disabled:0===t,className:"flex items-center gap-1",children:[h.jsx(_e,{className:"w-4 h-4"}),"Voltar"]}),h.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t+1,"/",pf.length]}),t===pf.length-1?h.jsxs(ot,{size:"sm",onClick:m,className:"flex items-center gap-1 bg-green-600 hover:bg-green-700",children:[h.jsx(Ce,{className:"w-4 h-4"}),"Finalizar"]}):h.jsxs(ot,{size:"sm",onClick:()=>{t<pf.length-1?r(t+1):m()},className:"flex items-center gap-1",children:["Pr√≥ximo",h.jsx(Re,{className:"w-4 h-4"})]})]})]})]})})]})}function bf({chatWebhookUrl:e="",chatType:a="n8n"}){const[t,r]=X.useState(!1),[s,n]=X.useState(!1),[i,o]=X.useState([]),[l,c]=X.useState(""),[u,m]=X.useState(!1);X.useEffect(()=>{t&&0===i.length&&setTimeout(()=>{o([{text:"üëã Ol√°! Sou seu assistente virtual. Como posso ajudar voc√™ hoje?",sender:"bot"}])},500)},[t,i.length]);const f=()=>d(this,null,function*(){if(!l.trim())return;const a=l.trim();c(""),o(e=>[...e,{text:a,sender:"user"}]),m(!0);try{if(e){const t=yield fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:a,type:"chat",timestamp:(new Date).toISOString()})});if(!t.ok)throw new Error("Erro ao conectar com o assistente");{const e=yield t.json(),a=e.response||e.message||e.reply||"Mensagem recebida!";setTimeout(()=>{o(e=>[...e,{text:a,sender:"bot"}]),m(!1)},1e3)}}else setTimeout(()=>{o(e=>[...e,{text:"Para ativar respostas autom√°ticas, configure o webhook de chat nas Integra√ß√µes.",sender:"bot"}]),m(!1)},1e3)}catch(t){setTimeout(()=>{o(e=>[...e,{text:"‚ùå Desculpe, n√£o consegui processar sua mensagem. Tente novamente.",sender:"bot"}]),m(!1)},1e3)}});return t?h.jsxs("div",{className:"fixed bottom-6 right-6 z-50 bg-white dark:bg-gray-900 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 transition-all "+(s?"w-80 h-16":"w-96 h-[600px]"),children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800 bg-gradient-to-r from-blue-600 to-purple-600 rounded-t-2xl",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx("div",{className:"w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center",children:h.jsx(ca,{className:"w-5 h-5 text-white"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"font-semibold text-white",children:"Assistente Virtual"}),h.jsx("p",{className:"text-xs text-white/80",children:"Online agora"})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>n(!s),className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-white/20 text-white transition-colors","aria-label":s?"Maximizar":"Minimizar",children:h.jsx(ha,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>r(!1),className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-white/20 text-white transition-colors","aria-label":"Fechar chat",children:h.jsx(Ha,{className:"w-4 h-4"})})]})]}),!s&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 h-[440px]",children:[i.map((e,a)=>h.jsx("div",{className:"flex "+("user"===e.sender?"justify-end":"justify-start"),children:h.jsx("div",{className:"max-w-[80%] rounded-2xl px-4 py-2 "+("user"===e.sender?"bg-gradient-to-r from-blue-600 to-purple-600 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-900 dark:text-gray-100"),children:h.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.text})})},a)),u&&h.jsx("div",{className:"flex justify-start",children:h.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-2xl px-4 py-3",children:h.jsxs("div",{className:"flex gap-1",children:[h.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),h.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),h.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})})]}),h.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-800",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx(Ur,{value:l,onChange:e=>c(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),f())},placeholder:"Digite sua mensagem...",className:"flex-1",disabled:u}),h.jsx(ot,{onClick:f,disabled:!l.trim()||u,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:h.jsx(Na,{className:"w-4 h-4"})})]}),h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:["Powered by ","typebot"===a?"Typebot":"N8N"," ‚Ä¢ LeadsFlow API"]})]})]})]}):h.jsxs("button",{onClick:()=>r(!0),className:"fixed bottom-6 right-6 z-50 w-14 h-14 bg-gradient-to-br from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-full shadow-lg flex items-center justify-center transition-all hover:scale-110 group","aria-label":"Abrir chat",children:[h.jsx(ca,{className:"w-6 h-6"}),h.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full animate-pulse"})]})}function vf({user:e,onLogout:a,onSettings:t,onAdmin:r,onUserUpdate:s}){var n,i,c,u,m,f;const[g,p]=X.useState(!1),[x,b]=X.useState("dashboard"),[v,y]=X.useState(!0),[w,N]=X.useState(!1),[j,k]=X.useState({origem:"",status:"",busca:""}),[E,T]=X.useState({origem:"",status:"",busca:""}),[S,C]=X.useState([]),[A,_]=X.useState(!0),[R,O]=X.useState(!1),[I,M]=X.useState(!1),[P,L]=X.useState(!1),[D,F]=X.useState(!1),[z,B]=X.useState(!1),[U,$]=X.useState(!1),[W,V]=X.useState(!1),[H,G]=X.useState(!1),[q,Y]=X.useState(!1),[K,J]=X.useState([]),[Z,Q]=X.useState(null),[ee,ae]=X.useState(!1);X.useEffect(()=>{localStorage.getItem("leadflow_access_token")&&te();"dark"===localStorage.getItem("crm_tema")&&(p(!0),document.documentElement.classList.add("dark"));!localStorage.getItem("leadsflow_tour_completed")&&e&&setTimeout(()=>{ae(!0)},2e3);const a=()=>{const e=window.innerWidth<768;N(e),e&&y(!1)};a(),window.addEventListener("resize",a);const t=()=>{te()};return window.addEventListener("leads-updated",t),()=>{window.removeEventListener("resize",a),window.removeEventListener("leads-updated",t)}},[]);const te=()=>d(this,null,function*(){try{_(!0);const e=yield js();e.success&&C(e.leads)}catch(e){}finally{_(!1)}}),re=()=>d(this,null,function*(){try{_(!0);localStorage.getItem("n8n_webhook_url")?(Ft.info("üîÑ Sincronizando leads do N8N..."),yield se()):(Ft.info("üîÑ Atualizando lista de leads..."),yield te(),Ft.success("‚úÖ Lista de leads atualizada!"))}catch(e){Ft.error("Erro ao atualizar leads")}finally{_(!1)}}),se=()=>d(this,null,function*(){try{const a=localStorage.getItem("n8n_webhook_url");if(!a)return void Ft.error("Configure o webhook N8N nas Integra√ß√µes primeiro");try{new URL(a)}catch(e){return void Ft.error("URL do webhook N8N inv√°lida. Verifique a configura√ß√£o nas Integra√ß√µes.")}_(!0);const t=localStorage.getItem("leadflow_access_token"),r=`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/n8n/sync`,s=yield fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({webhookUrl:a})});if(!s.ok){const e=yield s.json().catch(()=>({error:"Unknown error"}));if(408===s.status)Ft.error("‚è±Ô∏è Timeout: O webhook N8N n√£o respondeu em 30 segundos. Verifique se o workflow est√° ativo.");else if(502===s.status){const a=e.details||e.error||"Erro ao conectar com o webhook N8N";a.includes("Empty response")?Ft.error('‚ùå Webhook retornou resposta vazia.\n\nCertifique-se de que seu workflow N8N:\n‚Ä¢ Tem um node "Respond to Webhook"\n‚Ä¢ Est√° retornando dados\n‚Ä¢ Est√° ativo e funcionando\n\nVerifique os logs do N8N para mais detalhes.',{duration:8e3}):a.includes("Invalid JSON")?Ft.error('‚ùå Webhook retornou JSON inv√°lido.\n\nCertifique-se de que seu workflow N8N:\n‚Ä¢ Retorna um array de objetos JSON\n‚Ä¢ Usa o node "Respond to Webhook"\n‚Ä¢ Est√° configurado corretamente\n\nAbra o console (F12) para ver a resposta recebida.',{duration:8e3}):Ft.error(`‚ùå Erro 502: ${a}\n\nVerifique se a URL est√° correta e o workflow est√° ativo no N8N.`,{duration:6e3})}else 401===s.status?Ft.error("‚ùå Erro de autentica√ß√£o. Fa√ßa login novamente."):Ft.error(`‚ùå Erro: ${e.error||"Erro ao sincronizar"}. Verifique o console (F12) para mais detalhes.`);return void(yield te())}const n=yield s.json();yield te(),n.added>0&&Ft.success(`‚úÖ ${n.added} lead(s) importado(s) do Google Sheets!`),n.errors>0&&Ft.warning(`‚ö†Ô∏è ${n.errors} lead(s) n√£o puderam ser importados`),n.limitReached&&Ft.warning("‚ö†Ô∏è Limite de leads atingido! Alguns leads n√£o foram importados."),0===n.added&&0===n.errors&&Ft.info("‚ÑπÔ∏è Nenhum lead novo encontrado na planilha")}catch(a){Ft.error("‚ùå Erro ao sincronizar com Google Sheets. Verifique o console (F12) e confirme se o webhook N8N est√° ativo.");try{yield te()}catch(t){}}finally{_(!1)}});!function({onRefresh:e,enabled:a=!0,interval:t=15e3}){const r=X.useRef(null);X.useEffect(()=>{if(a)return r.current=setInterval(()=>{e()},t),()=>{r.current&&(clearInterval(r.current),r.current=null)};r.current&&(clearInterval(r.current),r.current=null)},[a,t,e])}({onRefresh:te,enabled:"dashboard"===x||"leads"===x,interval:15e3});const ne=a=>{if(!e)return!1;const t=e.limits||{},r=e.usage||{};return"leads"===a?-1===t.leads||(r.leads||0)<t.leads:"mensagens"===a?-1===t.messages||(r.messages||0)<t.messages:"envios"===a&&(-1===t.massMessages||(r.massMessages||0)<t.massMessages)},ie=a=>d(this,null,function*(){var t;if(confirm("Tem certeza que deseja deletar este lead?"))try{(yield Ts(a)).success&&(C(S.filter(e=>e.id!==a)),s(l(o({},e),{usage:l(o({},e.usage),{leads:Math.max(0,((null==(t=e.usage)?void 0:t.leads)||0)-1)})})))}catch(r){}}),oe=()=>{const e=!g;p(e),e?(document.documentElement.classList.add("dark"),localStorage.setItem("crm_tema","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("crm_tema","light"))},le=()=>{B(!0)},ce=()=>{if(!ne("leads"))return alert("‚õî Limite de leads atingido! Fa√ßa upgrade para continuar."),void le();O(!0)},de=()=>{const a=(null==e?void 0:e.plan)||"free";if(!["business","pro","enterprise"].includes(a)){const e=document.createElement("div");return e.className="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",e.innerHTML='\n        <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full shadow-2xl animate-in zoom-in-95 duration-200">\n          <div class="p-6 text-center">\n            <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">\n              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>\n              </svg>\n            </div>\n            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-2">Recurso Premium</h3>\n            <p class="text-gray-600 dark:text-gray-400 mb-6">\n              O <strong>Envio em Massa</strong> est√° dispon√≠vel apenas nos planos <strong>Pro</strong>, <strong>Business</strong> e <strong>Enterprise</strong>.\n            </p>\n            <div class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4 mb-6">\n              <p class="text-sm text-blue-800 dark:text-blue-200">\n                ‚ú® Fa√ßa upgrade agora e envie mensagens para centenas de leads simultaneamente!\n              </p>\n            </div>\n            <div class="flex gap-3">\n              <button onclick="this.closest(\'.fixed\').remove()" class="flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">\n                Cancelar\n              </button>\n              <button onclick="this.closest(\'.fixed\').remove(); document.querySelector(\'[data-upgrade-btn]\').click()" class="flex-1 px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg transition-all shadow-md hover:shadow-lg">\n                Fazer Upgrade\n              </button>\n            </div>\n          </div>\n        </div>\n      ',void document.body.appendChild(e)}if(!ne("envios"))return alert("‚õî Limite de envios atingido! Fa√ßa upgrade para continuar."),void le();F(!0)},he=e=>d(this,null,function*(){const a=S[e];if(a.id)try{const t=l(o({},a),{marcado_email:!a.marcado_email}),r=yield Es(a.id,t);if(r.success){const a=[...S];a[e]=r.lead,C(a)}}catch(t){}}),ue=()=>{if(0!==S.filter(e=>e.email&&""!==e.email.trim()).length)return ne("mensagens")?void G(!0):(alert("‚õî Limite de mensagens atingido! Fa√ßa upgrade para continuar."),void le());alert("Nenhum lead com email dispon√≠vel. Adicione emails aos seus leads para usar esta funcionalidade.")},me=e=>{Q(S[e]),M(!0)},fe=e=>d(this,null,function*(){const a=S[e];yield ie(a.id)}),ge=e=>{if(!ne("mensagens"))return alert("‚õî Limite de mensagens atingido! Fa√ßa upgrade para continuar."),void le();const a=S[e];J([a.id]),$(!0)},pe=e=>{if(!ne("mensagens"))return alert("‚õî Limite de mensagens atingido! Fa√ßa upgrade para continuar."),void le();const a=S[e];a.email?(Q(a),Y(!0)):alert("‚ùå Este lead n√£o possui email cadastrado.")},xe=()=>{const a={free:10,business:500,enterprise:-1},t=(null==e?void 0:e.plan)||"free",r=a[t]||a.free;if(-1!==r&&S.length>r){if(!confirm(`‚ö†Ô∏è Limite de Exporta√ß√£o\n\nSeu plano ${t.toUpperCase()} permite exportar at√© ${r} leads.\nVoc√™ tem ${S.length} leads no total.\n\nDeseja exportar os primeiros ${r} leads?`))return void(confirm("Deseja fazer upgrade para exportar todos os seus leads?")&&B(!0))}const s=-1===r?S:S.slice(0,r),n=s.map(e=>[e.nome||"",e.telefone||"",e.interesse||"",e.origem||"",e.status||"",e.data||"",e.agente_atual||"",(e.observacoes||"").replace(/\n/g," ")].map(e=>e.includes(",")||e.includes('"')?'"'+e.replace(/"/g,'""')+'"':e).join(",")),i=["Nome","Telefone","Interesse","Origem","Status","Data","Agente","Observacoes"].join(",")+"\n"+n.join("\n"),o=new Blob([new Uint8Array([239,187,191]),i],{type:"text/csv;charset=utf-8"}),l=window.URL.createObjectURL(o),c=document.createElement("a");c.href=l,c.download=`leads_export_${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(l),document.body.removeChild(c),alert(`‚úÖ Exporta√ß√£o conclu√≠da!\n\n${s.length} leads exportados com sucesso.`)},be=()=>{const a={free:50,business:250,enterprise:1e3},t=(null==e?void 0:e.plan)||"free",r=a[t]||a.free;confirm(`üì• Importa√ß√£o de Leads\n\nSeu plano ${t.toUpperCase()} permite importar at√© ${r} leads por vez.\n\nO sistema ir√° importar apenas os primeiros ${r} leads da sua planilha.\n\nDeseja continuar?`)&&V(!0)},ve=X.useMemo(()=>S.filter(e=>{var a,t,r;const s=!E.origem||e.origem===E.origem,n=!E.status||e.status===E.status,i=!E.busca||(null==(a=e.nome)?void 0:a.toLowerCase().includes(E.busca.toLowerCase()))||(null==(t=e.telefone)?void 0:t.includes(E.busca))||(null==(r=e.interesse)?void 0:r.toLowerCase().includes(E.busca.toLowerCase()));return s&&n&&i}),[S,E]),ye=X.useMemo(()=>{const e=(new Date).toISOString().split("T")[0];return{total:ve.length,novosHoje:ve.filter(a=>a.data===e).length,convertidos:ve.filter(e=>"convertido"===e.status).length}},[ve]),we=X.useMemo(()=>Array.from(new Set(S.map(e=>e.origem).filter(Boolean))),[S]),Ne=X.useMemo(()=>Array.from(new Set(S.map(e=>e.status).filter(Boolean))),[S]),je={leads:(null==(n=null==e?void 0:e.limits)?void 0:n.leads)||0,mensagens:(null==(i=null==e?void 0:e.limits)?void 0:i.messages)||0,envios:(null==(c=null==e?void 0:e.limits)?void 0:c.massMessages)||0,usados:{leads:(null==(u=null==e?void 0:e.usage)?void 0:u.leads)||0,mensagens:(null==(m=null==e?void 0:e.usage)?void 0:m.messages)||0,envios:(null==(f=null==e?void 0:e.usage)?void 0:f.massMessages)||0}},ke=(()=>{if(!(null==e?void 0:e.trialEndsAt))return null;const a=new Date,t=new Date(e.trialEndsAt).getTime()-a.getTime(),r=Math.ceil(t/864e5);return Math.max(0,r)})();return h.jsxs("div",{className:"min-h-screen flex bg-gray-50 dark:bg-gray-900 transition-colors",children:[h.jsx(zr,{isOpen:v,onClose:()=>y(!1),currentPage:x,onNavigate:b,isDark:g,onToggleTheme:oe,isMobile:w,user:e}),h.jsxs("div",{className:"flex-1 flex flex-col min-w-0 transition-all duration-300 "+(!w&&v?"md:ml-[260px]":""),children:[h.jsx(Dr,{user:e,isDark:g,currentPage:x,onNavigate:b,onToggleTheme:oe,onNovoLead:ce,onEmailMarketing:ue,onMassMessage:de,onSettings:()=>b("account"),onLogout:a,isSidebarOpen:v,onToggleSidebar:()=>y(!v),onStartTour:()=>{b("dashboard"),setTimeout(()=>{ae(!0)},500)}}),h.jsxs("main",{className:"flex-1 overflow-y-auto",children:[h.jsxs("div",{className:"w-full max-w-[1600px] mx-auto px-4 md:px-6 py-6",children:["dashboard"===x&&h.jsxs("div",{className:"space-y-6",children:[h.jsx(Zt,{limites:je,diasRestantes:ke,onUpgrade:le,userPlan:(null==e?void 0:e.plan)||"free",isTrial:(null==e?void 0:e.isTrial)||!1}),h.jsx(Xt,{totalLeads:ye.total,leadsNovosHoje:ye.novosHoje,leadsFechados:ye.convertidos}),h.jsx(qt,{totalLeads:ye.total,leadsNovosHoje:ye.novosHoje,leadsFechados:ye.convertidos,leads:ve,limites:je}),h.jsx(Jt,{leads:ve,origens:we,status:Ne,onFilterChange:e=>{T(e)}}),h.jsx(Qt,{leads:S,onEdit:me,onDelete:fe,onChat:ge,onSendEmail:pe}),h.jsx(Yt,{origens:we,status:Ne,onFilterChange:k}),h.jsx(Kt,{leads:S,onEdit:me,onDelete:fe,onChat:ge,onRefresh:re,onExport:xe,onImport:be,onToggleEmailMarketing:he,onSendEmail:pe,onNovoLead:ce,onCampaigns:()=>b("campaigns"),onDeleteMultiple:a=>d(this,null,function*(){var t;try{let n=0;for(const e of a){const a=S[e];if(a&&a.id)try{(yield Ts(a.id)).success&&n++}catch(r){}}yield te();const i=Math.max(0,((null==(t=e.usage)?void 0:t.leads)||0)-n);s(l(o({},e),{usage:l(o({},e.usage),{leads:i})})),Ft.success(`${n} lead(s) deletado(s) com sucesso!`)}catch(r){Ft.error("Erro ao deletar leads selecionados")}}),userPlan:(null==e?void 0:e.plan)||"free",planExpired:!1,loading:A})]}),"leads"===x&&h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"mb-6",children:[h.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-2",children:"Leads"}),h.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Gerencie todos os seus leads"})]}),h.jsx(Xt,{totalLeads:ye.total,leadsNovosHoje:ye.novosHoje,leadsFechados:ye.convertidos}),h.jsx(qt,{totalLeads:ye.total,leadsNovosHoje:ye.novosHoje,leadsFechados:ye.convertidos,leads:ve,limites:je}),h.jsx(Qt,{leads:S,onEdit:me,onDelete:fe,onChat:ge,onSendEmail:pe}),h.jsx(Yt,{origens:we,status:Ne,onFilterChange:k}),h.jsx(Kt,{leads:S,onEdit:me,onDelete:fe,onChat:ge,onRefresh:re,onExport:xe,onImport:be,onToggleEmailMarketing:he,onSendEmail:pe,onNovoLead:ce,onCampaigns:()=>b("campaigns"),userPlan:(null==e?void 0:e.plan)||"free",planExpired:!1})]}),"campaigns"===x&&h.jsx(Fs,{onNovoLead:ce,onEmailMarketing:ue,onMassMessage:de,leads:S,userPlan:(null==e?void 0:e.subscription_plan)||"free",user:e,onUserUpdate:s}),"plan"===x&&h.jsx(Br,{user:e,onUpgrade:le}),"integrations"===x&&h.jsx(ls,{user:e}),"security"===x&&h.jsx(cs,{user:e}),"account"===x&&h.jsx(ds,{user:e,onUpdateUser:s}),"admin"===x&&h.jsx(Cs,{})]}),h.jsx("footer",{className:"border-t border-gray-200 dark:border-gray-700 mt-12 py-6",children:h.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[h.jsxs("p",{className:"text-center md:text-left",children:["¬© ",(new Date).getFullYear()," ",h.jsx("span",{className:"font-bold text-gray-900 dark:text-white",children:"LeadsFlow"})," ",h.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"SAAS"}),". Todos os direitos reservados."]}),h.jsxs("p",{className:"text-center md:text-right",children:["Desenvolvido por ",h.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"PersonalCreativeLda"})]})]})})})]})]}),h.jsx(zs,{isOpen:R,onClose:()=>O(!1),onSave:a=>d(this,null,function*(){var t;try{const r=yield ks(a);return!!r.success&&(C([...S,r.lead]),O(!1),s(l(o({},e),{usage:l(o({},e.usage),{leads:((null==(t=e.usage)?void 0:t.leads)||0)+1})})),!0)}catch(r){return r.message.includes("limit reached")||r.message.includes("Lead limit reached")?(alert("‚õî Limite de leads atingido! Fa√ßa upgrade do seu plano."),B(!0)):alert("‚ùå Erro ao criar lead: "+(r.message||"Erro desconhecido")),!1}})}),h.jsx(Bs,{isOpen:I,lead:Z,onClose:()=>{M(!1),Q(null)},onSave:e=>d(this,null,function*(){try{if(!e.id)return void alert("Erro: ID do lead n√£o encontrado. Por favor, recarregue a p√°gina.");const a=yield Es(e.id,e);if(a.success){const t=[...S],r=t.findIndex(a=>a.id===e.id);-1!==r&&(t[r]=a.lead,C(t)),M(!1),Q(null)}}catch(a){alert("Erro ao atualizar lead. Por favor, tente novamente.")}})}),h.jsx(Us,{isOpen:P,lead:Z,onClose:()=>{L(!1),Q(null)},webhookUrl:""}),h.jsx(Ws,{isOpen:D,leads:S,onClose:()=>F(!1),webhookUrl:"",userPlan:null==e?void 0:e.plan,onUpgrade:()=>{F(!1),B(!0)}}),h.jsx(qs,{isOpen:z,onClose:()=>B(!1),currentPlan:(null==e?void 0:e.plan)||"free",onUpgradeSuccess:e=>{s(e)}}),h.jsx(Xs,{isOpen:U,onClose:()=>{$(!1),J([])},leadIds:K,leadNames:K.map(e=>{const a=S.find(a=>a.id===e);return(null==a?void 0:a.nome)||"Lead sem nome"}),isMassMessage:K.length>1,userPlan:null==e?void 0:e.plan,onSuccess:()=>{te()}}),h.jsx(uf,{isOpen:W,onClose:()=>V(!1),onSuccess:te,userPlan:(null==e?void 0:e.plan)||"free"}),h.jsx(ff,{isOpen:H,onClose:()=>G(!1),leads:S,onSendSuccess:()=>{te()}}),h.jsx(gf,{isOpen:q,onClose:()=>{Y(!1),Q(null)},leadNome:(null==Z?void 0:Z.nome)||"",leadEmail:(null==Z?void 0:Z.email)||"",onSend:(e,a)=>d(this,null,function*(){})}),ee&&h.jsx(xf,{onComplete:()=>{localStorage.setItem("leadsflow_tour_completed","true"),ae(!1),Ft.success("üéâ Tour conclu√≠do! Agora voc√™ conhece todas as funcionalidades!")},onSkip:()=>{localStorage.setItem("leadsflow_tour_completed","true"),ae(!1),Ft.info("Tour pulado. Voc√™ pode reinici√°-lo a qualquer momento.")}}),h.jsx(bf,{chatWebhookUrl:localStorage.getItem("chat_webhook_url")||"",chatType:"n8n"})]})}const yf={};function wf({onSuccess:e,onSwitchToSignup:a,onSetup:t}){const[r,s]=X.useState(""),[n,i]=X.useState(""),[o,l]=X.useState(""),[c,u]=X.useState(!1),[m,f]=X.useState(!1),[g,p]=X.useState(""),[x,b]=X.useState(!1),[v,y]=X.useState(!1),[w,N]=X.useState([]);X.useEffect(()=>{const e=e=>{if(e.key&&"d"===e.key.toLowerCase()){const e=Date.now();N(a=>{const t=[...a,e].filter(a=>e-a<1e3);return t.length>=3?(y(!0),[]):t})}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);return h.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-purple-50 px-4 py-8",children:[h.jsxs("div",{className:"w-full max-w-md",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-10 space-y-6",children:[h.jsx("div",{className:"flex justify-center",children:h.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center",children:h.jsx(sa,{className:"w-8 h-8 text-blue-600"})})}),h.jsxs("div",{className:"text-center space-y-2",children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Bem-vindo de volta"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Entre na sua conta para continuar"})]}),o&&h.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[h.jsx(be,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),h.jsx("p",{className:"text-sm text-red-700 whitespace-pre-line",children:o})]}),h.jsxs(ot,{onClick:()=>d(this,null,function*(){l(""),u(!0);try{const e=us(),{data:a,error:t}=yield e.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});if(t)throw t}catch(e){l(e.message||"Erro ao fazer login com Google"),u(!1)}}),disabled:c,variant:"outline",className:"w-full py-3 rounded-xl border-gray-200 hover:bg-gray-50",children:[h.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[h.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),h.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),h.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),h.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),h.jsx("span",{className:"text-sm font-medium",children:"Sign in with Google"})]}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 flex items-center",children:h.jsx("div",{className:"w-full border-t border-gray-200"})}),h.jsx("div",{className:"relative flex justify-center",children:h.jsx("span",{className:"px-4 bg-white text-xs text-gray-400",children:"or"})})]}),h.jsxs("form",{onSubmit:a=>d(this,null,function*(){a.preventDefault(),l(""),u(!0);try{(yield bs.signin(r,n)).success&&e()}catch(t){const e=t.message||"Erro ao fazer login";e.includes("Invalid login credentials")||e.includes("Invalid")||e.includes("credentials")?l('‚ùå Email ou senha incorretos. Verifique suas credenciais e tente novamente.\n\nüí° Dica: Se voc√™ acabou de criar sua conta, aguarde alguns segundos e tente novamente.\n\nüîß Para testar o sistema, pressione "d" tr√™s vezes rapidamente para criar uma conta de demonstra√ß√£o.'):e.includes("n√£o encontrado")||e.includes("not found")?l('‚ùå Email n√£o encontrado. Por favor, crie uma conta clicando em "Criar conta gr√°tis".\n\nüîß Pressione "d" tr√™s vezes rapidamente para criar uma conta de demonstra√ß√£o.'):e.includes("Email not confirmed")?l("‚ùå Por favor, confirme seu email antes de fazer login. Verifique sua caixa de entrada."):l(`‚ùå ${e}`)}finally{u(!1)}}),className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"email",className:"text-sm text-gray-700",children:"Email"}),h.jsxs("div",{className:"relative mt-1.5",children:[h.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{id:"email",type:"email",placeholder:"seu@email.com",value:r,onChange:e=>s(e.target.value),className:"pl-10 py-3 rounded-xl border-gray-200",required:!0})]})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx(Hr,{htmlFor:"password",className:"text-sm text-gray-700",children:"Password"}),h.jsx("button",{type:"button",onClick:()=>f(!0),className:"text-sm text-blue-600 hover:text-blue-700",children:"Forgot password?"})]}),h.jsxs("div",{className:"relative mt-1.5",children:[h.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{id:"password",type:"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:n,onChange:e=>i(e.target.value),className:"pl-10 py-3 rounded-xl border-gray-200",required:!0})]})]}),h.jsx(ot,{type:"submit",disabled:c,className:"w-full py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-medium",children:c?"Signing in...":"Sign in"})]}),h.jsx("div",{className:"text-center",children:h.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",h.jsx("button",{onClick:a,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign up"})]})})]}),h.jsxs("div",{className:"mt-6 text-center",children:[h.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["By continuing, you agree to our"," ",h.jsx("a",{href:"#termos",className:"text-blue-600 hover:underline",children:"Terms of Service"})," ","and"," ",h.jsx("a",{href:"#privacidade",className:"text-blue-600 hover:underline",children:"Privacy Policy"})]}),h.jsxs("p",{className:"text-xs text-gray-400",children:["¬© ",(new Date).getFullYear()," PersonalCreativeLda. All rights reserved."]}),t&&h.jsx("button",{onClick:t,className:"mt-2 text-xs text-gray-300 hover:text-gray-500 transition-colors",children:"Dev Setup"}),v&&h.jsx("button",{onClick:()=>d(this,null,function*(){l(""),u(!0);try{const a=yield bs.setupDemo();if(a.success){if(s("demo@leadflow.com"),i("demo123456"),a.needsWait)return l('‚úÖ Conta de teste criada! Aguarde 10 segundos e clique em "Entrar".\n\nEmail: demo@leadflow.com\nSenha: demo123456'),void u(!1);setTimeout(()=>d(this,null,function*(){try{yield bs.signin("demo@leadflow.com","demo123456"),e()}catch(a){l('‚úÖ Conta criada! Clique em "Entrar" para acessar.\n\nEmail: demo@leadflow.com\nSenha: demo123456'),u(!1)}}),3e3)}}catch(a){l("Erro ao criar conta de teste: "+a.message),u(!1)}}),className:"mt-2 text-xs text-gray-300 hover:text-gray-500 transition-colors",children:"Debug Setup"}),v&&h.jsx("button",{onClick:()=>d(this,null,function*(){l(""),u(!0);try{const{projectId:a}=yield function(e,a){let t=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));t=Promise.allSettled(a.map(e=>{if((e=function(e){return"/"+e}(e))in yf)return;yf[e]=!0;const a=e.endsWith(".css"),t=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${t}`))return;const s=document.createElement("link");return s.rel=a?"stylesheet":"modulepreload",a||(s.as="script"),s.crossOrigin="",s.href=e,r&&s.setAttribute("nonce",r),document.head.appendChild(s),a?new Promise((a,t)=>{s.addEventListener("load",a),s.addEventListener("error",()=>t(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function r(e){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=e,window.dispatchEvent(a),!a.defaultPrevented)throw e}return t.then(a=>{for(const e of a||[])"rejected"===e.status&&r(e.reason);return e().catch(r)})}(()=>d(this,null,function*(){const{projectId:e}=yield Promise.resolve().then(()=>Xr);return{projectId:e}}),void 0),t=yield fetch(`https://${a}.supabase.co/functions/v1/make-server-4be966ab/auth/setup-admin`,{method:"POST",headers:{"Content-Type":"application/json"}}),r=yield t.json();if(!t.ok||!r.success)throw new Error(r.error||`Server returned ${t.status}`);s("admin@leadflow.com"),i("admin123456"),l("‚úÖ Conta admin criada/atualizada!\n\nüìß Email: admin@leadflow.com\nüîë Senha: admin123456\n\n‚è≥ Fazendo login em 6 segundos..."),setTimeout(()=>d(this,null,function*(){try{if(!(yield bs.signin("admin@leadflow.com","admin123456")).success)throw new Error("Login returned false");e()}catch(a){l('‚úÖ Conta admin criada!\n\nüìß Email: admin@leadflow.com\nüîë Senha: admin123456\n\nüëÜ Os campos est√£o preenchidos - clique em "Sign in"'),u(!1)}}),6e3)}catch(a){l("‚ùå Erro:\n"+a.message),u(!1)}}),className:"mt-2 text-xs text-gray-300 hover:text-gray-500 transition-colors",children:"Admin Setup"})]})]}),m&&h.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-10 max-w-md w-full space-y-6",children:[h.jsxs("div",{className:"text-center space-y-2",children:[h.jsx("h3",{className:"text-2xl font-semibold text-gray-900",children:"Reset Password"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Enter your email to receive a password reset link"})]}),x&&h.jsx("div",{className:"p-4 bg-green-50 border border-green-200 rounded-xl",children:h.jsx("p",{className:"text-sm text-green-700",children:"‚úÖ Email sent successfully! Check your inbox."})}),o&&h.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[h.jsx(be,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),h.jsx("p",{className:"text-sm text-red-700",children:o})]}),h.jsxs("form",{onSubmit:e=>d(this,null,function*(){e.preventDefault(),l(""),u(!0);try{const e=us(),{error:a}=yield e.auth.resetPasswordForEmail(g,{redirectTo:`${window.location.origin}/#type=recovery`});if(a)throw a;b(!0),setTimeout(()=>{f(!1),b(!1),p("")},3e3)}catch(a){l(a.message||"Erro ao enviar email de recupera√ß√£o")}finally{u(!1)}}),className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"reset-email",className:"text-sm text-gray-700",children:"Email"}),h.jsxs("div",{className:"relative mt-1.5",children:[h.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{id:"reset-email",type:"email",placeholder:"seu@email.com",value:g,onChange:e=>p(e.target.value),className:"pl-10 py-3 rounded-xl border-gray-200",required:!0})]})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx(ot,{type:"button",onClick:()=>{f(!1),p(""),l("")},variant:"outline",className:"flex-1 py-3 rounded-xl border-gray-200",children:"Cancel"}),h.jsx(ot,{type:"submit",disabled:c,className:"flex-1 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-medium",children:c?"Sending...":"Send Link"})]})]})]})})]})}function Nf({onSuccess:e,onSwitchToLogin:a}){const[t,r]=X.useState(""),[s,n]=X.useState(""),[i,o]=X.useState(""),[l,c]=X.useState(""),[u,m]=X.useState(!1),[f,g]=X.useState(!1);return u?h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-purple-50 px-4",children:h.jsx("div",{className:"w-full max-w-md",children:h.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-10 space-y-6 text-center",children:[h.jsx("div",{className:"flex justify-center",children:h.jsx("div",{className:"w-16 h-16 bg-green-50 rounded-full flex items-center justify-center",children:h.jsx(Te,{className:"w-8 h-8 text-green-600"})})}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Account Created!"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Welcome to LeadFlow CRM. Redirecting to dashboard..."})]}),h.jsxs("div",{className:"flex items-center justify-center gap-2",children:[h.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),h.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),h.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}):h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-purple-50 px-4 py-8",children:h.jsxs("div",{className:"w-full max-w-md",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-10 space-y-6",children:[h.jsx("div",{className:"flex justify-center",children:h.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center",children:h.jsx(Fa,{className:"w-8 h-8 text-blue-600"})})}),h.jsxs("div",{className:"text-center space-y-2",children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Create your account"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Start your free trial today"})]}),l&&h.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[h.jsx(be,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),h.jsx("p",{className:"text-sm text-red-700",children:l})]}),h.jsxs(ot,{onClick:()=>d(this,null,function*(){c(""),g(!0);try{const e=us(),{data:a,error:t}=yield e.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}});if(t)throw t}catch(e){c(e.message||"Erro ao criar conta com Google"),g(!1)}}),disabled:f,variant:"outline",className:"w-full py-3 rounded-xl border-gray-200 hover:bg-gray-50",children:[h.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[h.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),h.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),h.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),h.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),h.jsx("span",{className:"text-sm font-medium",children:"Sign up with Google"})]}),h.jsxs("div",{className:"relative",children:[h.jsx("div",{className:"absolute inset-0 flex items-center",children:h.jsx("div",{className:"w-full border-t border-gray-200"})}),h.jsx("div",{className:"relative flex justify-center",children:h.jsx("span",{className:"px-4 bg-white text-xs text-gray-400",children:"or"})})]}),h.jsxs("form",{onSubmit:a=>d(this,null,function*(){var r;a.preventDefault(),c(""),g(!0);try{if(i.length<6)throw new Error("A senha deve ter pelo menos 6 caracteres");(yield bs.signup(s,i,t)).success&&(m(!0),setTimeout(()=>{e()},1e3))}catch(n){(null==(r=n.message)?void 0:r.includes("j√° est√° cadastrado"))?c(n.message):c(n.message||"Erro ao criar conta")}finally{g(!1)}}),className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"name",className:"text-sm text-gray-700",children:"Full name"}),h.jsxs("div",{className:"relative mt-1.5",children:[h.jsx(za,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{id:"name",type:"text",placeholder:"Your name",value:t,onChange:e=>r(e.target.value),className:"pl-10 py-3 rounded-xl border-gray-200",required:!0})]})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"email",className:"text-sm text-gray-700",children:"Email"}),h.jsxs("div",{className:"relative mt-1.5",children:[h.jsx(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{id:"email",type:"email",placeholder:"you@example.com",value:s,onChange:e=>n(e.target.value),className:"pl-10 py-3 rounded-xl border-gray-200",required:!0})]})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"password",className:"text-sm text-gray-700",children:"Password"}),h.jsxs("div",{className:"relative mt-1.5",children:[h.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{id:"password",type:"password",placeholder:"Minimum 6 characters",value:i,onChange:e=>o(e.target.value),className:"pl-10 py-3 rounded-xl border-gray-200",required:!0})]})]}),h.jsx(ot,{type:"submit",disabled:f,className:"w-full py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-medium",children:f?"Creating account...":"Create account"})]}),h.jsxs("div",{className:"space-y-2 pt-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Te,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),h.jsx("span",{className:"text-sm text-gray-600",children:"Free plan - No credit card required"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Te,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),h.jsx("span",{className:"text-sm text-gray-600",children:"100 leads included"})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Te,{className:"w-4 h-4 text-green-500 flex-shrink-0"}),h.jsx("span",{className:"text-sm text-gray-600",children:"Upgrade anytime"})]})]}),h.jsx("div",{className:"text-center pt-2",children:h.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",h.jsx("button",{onClick:a,className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]}),h.jsxs("div",{className:"mt-6 text-center",children:[h.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["By creating an account, you agree to our"," ",h.jsx("a",{href:"#termos",className:"text-blue-600 hover:underline",children:"Terms of Service"})," ","and"," ",h.jsx("a",{href:"#privacidade",className:"text-blue-600 hover:underline",children:"Privacy Policy"})]}),h.jsxs("p",{className:"text-xs text-gray-400",children:["¬© ",(new Date).getFullYear()," PersonalCreativeLda. All rights reserved."]})]})]})})}function jf({onSuccess:e,onCancel:a}){const[t,r]=X.useState(""),[s,n]=X.useState(""),[i,o]=X.useState(""),[l,c]=X.useState(!1),[u,m]=X.useState(!1);return h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 via-white to-purple-50 px-4 py-8",children:h.jsxs("div",{className:"w-full max-w-md",children:[h.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-10 space-y-6",children:[h.jsx("div",{className:"flex justify-center",children:h.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center",children:h.jsx(ra,{className:"w-8 h-8 text-blue-600"})})}),h.jsxs("div",{className:"text-center space-y-2",children:[h.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Redefinir Senha"}),h.jsx("p",{className:"text-sm text-gray-500",children:"Escolha uma nova senha para sua conta"})]}),u&&h.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-xl flex items-start gap-3",children:[h.jsx(Te,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-green-700 font-medium",children:"‚úÖ Senha redefinida com sucesso!"}),h.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Redirecionando para o login..."})]})]}),i&&h.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[h.jsx(be,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),h.jsx("p",{className:"text-sm text-red-700",children:i})]}),!u&&h.jsxs("form",{onSubmit:a=>d(this,null,function*(){if(a.preventDefault(),o(""),t.length<6)o("A senha deve ter pelo menos 6 caracteres");else if(t===s){c(!0);try{const a=us(),{error:r}=yield a.auth.updateUser({password:t});if(r)throw r;m(!0),setTimeout(()=>{e()},2e3)}catch(r){o(r.message||"Erro ao redefinir senha")}finally{c(!1)}}else o("As senhas n√£o coincidem")}),className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"password",className:"text-sm text-gray-700",children:"Nova Senha"}),h.jsxs("div",{className:"relative mt-1.5",children:[h.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{id:"password",type:"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:t,onChange:e=>r(e.target.value),className:"pl-10 py-3 rounded-xl border-gray-200",required:!0,minLength:6})]}),h.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"M√≠nimo de 6 caracteres"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"confirm-password",className:"text-sm text-gray-700",children:"Confirmar Nova Senha"}),h.jsxs("div",{className:"relative mt-1.5",children:[h.jsx(ra,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),h.jsx(Ur,{id:"confirm-password",type:"password",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",value:s,onChange:e=>n(e.target.value),className:"pl-10 py-3 rounded-xl border-gray-200",required:!0,minLength:6})]})]}),h.jsxs("div",{className:"flex gap-3 pt-2",children:[h.jsx(ot,{type:"button",onClick:a,variant:"outline",className:"flex-1 py-3 rounded-xl border-gray-200",children:"Cancelar"}),h.jsx(ot,{type:"submit",disabled:l,className:"flex-1 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-medium",children:l?"Salvando...":"Redefinir Senha"})]})]})]}),h.jsx("div",{className:"mt-6 text-center",children:h.jsxs("p",{className:"text-xs text-gray-400",children:["¬© ",(new Date).getFullYear()," PersonalCreativeLda. All rights reserved."]})})]})})}function kf(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(W,o({"data-slot":"tabs",className:nt("flex flex-col gap-2",t)},r))}function Ef(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(V,o({"data-slot":"tabs-list",className:nt("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",t)},r))}function Tf(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(H,o({"data-slot":"tabs-trigger",className:nt("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t)},r))}function Sf(e){var a=e,{className:t}=a,r=c(a,["className"]);return h.jsx(G,o({"data-slot":"tabs-content",className:nt("flex-1 outline-none",t)},r))}function Cf({currentAvatar:e,userName:a,onAvatarUpdate:t}){const[r,s]=X.useState(!1),[n,i]=X.useState(e||null);X.useEffect(()=>{i(e||null)},[e]);return h.jsxs("div",{className:"flex items-center gap-6",children:[h.jsxs(Or,{className:"h-24 w-24",children:[h.jsx(Ir,{src:n||void 0,alt:a}),h.jsx(Mr,{className:"text-2xl",children:a.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)||h.jsx(za,{className:"h-12 w-12"})})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsx("div",{className:"flex gap-2",children:h.jsxs(ot,{variant:"outline",size:"sm",disabled:r,onClick:()=>{var e;return null==(e=document.getElementById("avatar-upload"))?void 0:e.click()},children:[h.jsx(La,{className:"h-4 w-4 mr-2"}),r?"Enviando...":"Alterar Foto"]})}),h.jsx("p",{className:"text-sm text-muted-foreground",children:"JPG, PNG ou GIF. M√°ximo 2MB."}),h.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",onChange:a=>d(this,null,function*(){var r,n;const o=null==(r=a.target.files)?void 0:r[0];if(o)if(o.type.startsWith("image/"))if(o.size>2097152)Ft.error("A imagem deve ter menos de 2MB");else try{s(!0);const e=new FileReader;e.onloadend=()=>{i(e.result)},e.readAsDataURL(o);const a=new FormData;a.append("avatar",o);const r=localStorage.getItem("leadflow_access_token"),n=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/users/avatar`,{method:"POST",headers:{Authorization:`Bearer ${r||qr}`},body:a});if(!n.ok){const e=(yield n.json().catch(()=>({}))).error||"Failed to upload avatar";throw Ft.error(`Erro ao enviar foto: ${e}`),new Error(e)}const l=yield n.json();if(!l.success||!l.avatarUrl)throw new Error("Invalid server response");t(l.avatarUrl),Ft.success("Foto de perfil atualizada com sucesso!")}catch(l){(null==(n=l.message)?void 0:n.includes("Erro ao enviar foto"))||Ft.error("Erro ao enviar foto de perfil"),i(e||null)}finally{s(!1)}else Ft.error("Por favor, selecione uma imagem v√°lida")}),className:"hidden"})]})]})}function Af(e,a){if(!e)return!1;if(function(e){return!!(e&&e.isTrial&&e.trialEndsAt)&&new Date<new Date(e.trialEndsAt)}(e))return!0;switch(a){case"http_endpoint":case"advanced_automation":return"business"===e.plan||"enterprise"===e.plan;case"mass_whatsapp":case"email_marketing":return!0;default:return!1}}function _f({user:e,onUpgrade:a}){const[t,r]=X.useState(""),[s,n]=X.useState(""),[i,o]=X.useState(""),[l,c]=X.useState(""),[u,m]=X.useState(""),[f,g]=X.useState(!1),[p,x]=X.useState(!1),[b,v]=X.useState(!1),[y,w]=X.useState(!1),[N,j]=X.useState(!1),[k,E]=X.useState(null),T=Af(e,"http_endpoint"),S="enterprise"===(null==e?void 0:e.plan),C=T?`https://${window.location.hostname}/api/leads/external/${null==e?void 0:e.id}`:null,A=(null==e?void 0:e.id)?`https://${window.location.hostname}/api/webhook/n8n-leads/${null==e?void 0:e.id}`:null;X.useEffect(()=>{_()},[e]);const _=()=>d(this,null,function*(){try{const e=localStorage.getItem("leadflow_access_token"),a=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/webhooks/settings`,{headers:{Authorization:`Bearer ${e}`}});if(a.ok){const e=yield a.json();e.success&&e.webhookSettings&&(r(e.webhookSettings.metaPixelId||""),n(e.webhookSettings.googleAnalyticsId||""),o(e.webhookSettings.n8nMassWebhook||""),c(e.webhookSettings.n8nLeadsWebhook||""),m(e.webhookSettings.googleSheetsWebhook||""),e.webhookSettings.n8nMassWebhook&&localStorage.setItem("n8n_mass_webhook_url",e.webhookSettings.n8nMassWebhook))}}catch(e){}});return h.jsx("div",{className:"space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-6",children:[h.jsx("h3",{className:"text-gray-900 dark:text-gray-100 mb-6",children:"Integra√ß√µes Externas"}),h.jsxs("div",{className:"space-y-6",children:[T&&h.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-6",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0",children:h.jsx(Ua,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-2",children:"HTTP Endpoint para Captura de Leads"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Use este endpoint para receber leads de integra√ß√µes externas como N8N, Facebook Leads Ads, Google Ads, etc."}),h.jsxs("div",{className:"relative",children:[h.jsx(Ur,{value:C||"",readOnly:!0,className:"pr-24 font-mono text-sm bg-white dark:bg-gray-800"}),h.jsx(ot,{size:"sm",variant:"outline",onClick:()=>{C&&(navigator.clipboard.writeText(C),v(!0),Ft.success("Endpoint copiado!"),setTimeout(()=>v(!1),2e3))},className:"absolute right-1 top-1",children:b?h.jsxs(h.Fragment,{children:[h.jsx(Ce,{className:"w-4 h-4 mr-1"}),"Copiado"]}):h.jsxs(h.Fragment,{children:[h.jsx(Me,{className:"w-4 h-4 mr-1"}),"Copiar"]})})]}),h.jsxs("div",{className:"mt-4 bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[h.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:h.jsx("strong",{children:"üìã Exemplo de requisi√ß√£o POST:"})}),h.jsx("pre",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded text-xs overflow-x-auto",children:'{\n  "nome": "Jo√£o Silva",\n  "email": "joao@email.com",\n  "telefone": "+5511999999999",\n  "interesse": "Produto X",\n  "origem": "Facebook Ads",\n  "status": "Novo"\n}'})]})]})]})}),!T&&h.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-lg p-6",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-amber-600 rounded-lg flex items-center justify-center flex-shrink-0",children:h.jsx(Ua,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg text-gray-900 dark:text-white mb-2",children:"HTTP Endpoint - Recurso Premium"}),h.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["O endpoint HTTP para captura autom√°tica de leads est√° dispon√≠vel apenas nos planos ",h.jsx("strong",{children:"Business"})," e ",h.jsx("strong",{children:"Enterprise"}),"."]}),h.jsx(ot,{className:"mt-4",size:"sm",onClick:a,children:"Fazer Upgrade"})]})]})}),S&&h.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 border border-purple-200 dark:border-purple-700 rounded-lg p-6",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-600 to-blue-600 rounded-lg flex items-center justify-center flex-shrink-0",children:h.jsx(Ua,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("h3",{className:"text-lg text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:["N8N Webhook - Envio em Massa WhatsApp",h.jsx("span",{className:"px-2 py-0.5 text-xs bg-amber-500 text-white rounded-full",children:"Enterprise"})]}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Configure o webhook do seu workflow N8N para automatizar envios em massa via Evolution API"}),h.jsxs("div",{className:"space-y-3",children:[h.jsx(Ur,{value:i,onChange:e=>o(e.target.value),placeholder:"https://seu-n8n.com/webhook/whatsapp-massa",className:"w-full font-mono text-sm bg-white dark:bg-gray-800"}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[h.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:h.jsx("strong",{children:"üìã Dados enviados pelo CRM:"})}),h.jsx("pre",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded text-xs overflow-x-auto",children:'{\n  "leads": [\n    {\n      "id": "lead-123",\n      "name": "Jo√£o Silva",\n      "phone": "+5511999999999",\n      "email": "joao@email.com"\n    }\n  ],\n  "message": "Sua mensagem aqui",\n  "timestamp": "2025-11-14T10:30:00Z",\n  "source": "LeadsFlow CRM"\n}'})]})]})]})]})}),h.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border border-green-200 dark:border-green-700 rounded-lg p-6",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-600 to-emerald-600 rounded-lg flex items-center justify-center flex-shrink-0",children:h.jsx(Ua,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("h3",{className:"text-lg text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:["Webhook N8N - Importa√ß√£o Autom√°tica de Leads",h.jsx("span",{className:"px-2 py-0.5 text-xs bg-green-500 text-white rounded-full",children:"Todos os planos"})]}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Configure este endpoint no seu workflow N8N. Quando novos leads aparecerem na planilha, o N8N enviar√° automaticamente para o CRM"}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{className:"text-sm text-gray-700 dark:text-gray-300 mb-2 block",children:h.jsx("strong",{children:"üîó Endpoint do CRM (Cole no N8N)"})}),h.jsxs("div",{className:"relative",children:[h.jsx(Ur,{value:A||"",readOnly:!0,className:"pr-24 font-mono text-sm bg-white dark:bg-gray-800"}),h.jsx(ot,{size:"sm",variant:"outline",onClick:()=>{A&&(navigator.clipboard.writeText(A),w(!0),Ft.success("Endpoint N8N copiado!"),setTimeout(()=>w(!1),2e3))},className:"absolute right-1 top-1",children:y?h.jsxs(h.Fragment,{children:[h.jsx(Ce,{className:"w-4 h-4 mr-1"}),"Copiado"]}):h.jsxs(h.Fragment,{children:[h.jsx(Me,{className:"w-4 h-4 mr-1"}),"Copiar"]})})]})]}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[h.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:h.jsx("strong",{children:"üîÑ Como funciona:"})}),h.jsxs("ol",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1.5 ml-4 list-decimal",children:[h.jsx("li",{children:"Copie o endpoint acima"}),h.jsx("li",{children:"No seu workflow N8N, adicione um n√≥ HTTP Request"}),h.jsxs("li",{children:["Configure o m√©todo como ",h.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 py-0.5 rounded",children:"POST"})]}),h.jsx("li",{children:"Cole o endpoint na URL"}),h.jsx("li",{children:"Quando novos leads aparecerem na planilha, o N8N envia automaticamente para o CRM"}),h.jsx("li",{children:"Os leads aparecem instantaneamente no dashboard!"})]})]}),h.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4",children:[h.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:h.jsx("strong",{children:"üìã Formato JSON que o N8N deve enviar:"})}),h.jsx("pre",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded text-xs overflow-x-auto",children:'{\n  "leads": [\n    {\n      "nome": "Maria Santos",\n      "email": "maria@email.com",\n      "telefone": "+5511988887777",\n      "interesse": "Consultoria",\n      "origem": "Google Sheets",\n      "status": "Novo"\n    }\n  ]\n}'})]}),h.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-lg p-3",children:h.jsxs("p",{className:"text-xs text-amber-800 dark:text-amber-200",children:["üí° ",h.jsx("strong",{children:"Dica:"}),' Configure o trigger do N8N para "Watch Changes" no Google Sheets. Assim, cada vez que uma nova linha for adicionada, o N8N detecta e envia automaticamente para o CRM!']})})]})]})]})}),h.jsx("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-teal-900/20 dark:to-cyan-900/20 border border-teal-200 dark:border-teal-700 rounded-lg p-6",children:h.jsxs("div",{className:"flex items-start gap-4",children:[h.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-teal-600 to-cyan-600 rounded-lg flex items-center justify-center flex-shrink-0",children:h.jsx(ka,{className:"w-6 h-6 text-white"})}),h.jsxs("div",{className:"flex-1",children:[h.jsxs("h3",{className:"text-lg text-gray-900 dark:text-white mb-2 flex items-center gap-2",children:["Atualizar Lista de Leads - Google Sheets",h.jsx("span",{className:"px-2 py-0.5 text-xs bg-teal-500 text-white rounded-full",children:"Todos os planos"})]}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:'Configure um webhook N8N que retorna os dados do Google Sheets. Clique em "Atualizar" para sincronizar manualmente os leads'}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{className:"text-sm text-gray-700 dark:text-gray-300 mb-2 block",children:h.jsx("strong",{children:"üîó URL do Webhook N8N (GET)"})}),h.jsx(Ur,{value:u,onChange:e=>m(e.target.value),placeholder:"https://seu-n8n.com/webhook/google-sheets",className:"w-full font-mono text-sm bg-white dark:bg-gray-800"})]}),h.jsxs("div",{className:"flex items-center justify-between bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:h.jsx("strong",{children:"üìä Sincronizar Leads"})}),k&&h.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["√öltima sincroniza√ß√£o: ",k]})]}),h.jsx(ot,{onClick:()=>d(this,null,function*(){if(u&&""!==u.trim()){j(!0);try{const e=yield fetch(u,{method:"GET"});if(!e.ok)throw new Error("Erro ao buscar dados do Google Sheets");const a=yield e.json();if(!a.leads||!Array.isArray(a.leads))throw new Error("Formato de resposta inv√°lido");const t=localStorage.getItem("leadflow_access_token"),r=yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/leads/import-from-sheets`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({leads:a.leads})});if(!r.ok)throw new Error("Erro ao importar leads para o CRM");const s=yield r.json();E((new Date).toLocaleString("pt-BR")),Ft.success(`‚úÖ ${s.count||a.leads.length} leads sincronizados com sucesso!`),window.dispatchEvent(new CustomEvent("leads-updated"))}catch(e){Ft.error("‚ùå Erro ao sincronizar: "+(e.message||"Erro desconhecido"))}finally{j(!1)}}else Ft.error("Configure a URL do Webhook do Google Sheets primeiro!")}),disabled:N||!u,className:"bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700",children:N?h.jsxs(h.Fragment,{children:[h.jsx(ba,{className:"w-4 h-4 mr-2 animate-spin"}),"Sincronizando..."]}):h.jsxs(h.Fragment,{children:[h.jsx(ba,{className:"w-4 h-4 mr-2"}),"Atualizar"]})})]}),h.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[h.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:h.jsx("strong",{children:"üîÑ Como configurar o webhook N8N:"})}),h.jsxs("ol",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1.5 ml-4 list-decimal",children:[h.jsx("li",{children:'Crie um workflow N8N com trigger "Webhook"'}),h.jsx("li",{children:'Adicione um n√≥ "Google Sheets" para ler os dados'}),h.jsx("li",{children:"Formate os dados no formato JSON esperado (veja abaixo)"}),h.jsx("li",{children:"Configure o webhook para aceitar m√©todo GET"}),h.jsx("li",{children:"Copie a URL do webhook e cole acima"}),h.jsx("li",{children:'Clique em "Atualizar" sempre que quiser sincronizar'})]})]}),h.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4",children:[h.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-2",children:h.jsx("strong",{children:"üìã Formato JSON que o webhook deve retornar:"})}),h.jsx("pre",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded text-xs overflow-x-auto",children:'{\n  "leads": [\n    {\n      "nome": "Carlos Mendes",\n      "email": "carlos@email.com",\n      "telefone": "+5511977776666",\n      "interesse": "Produto Premium",\n      "origem": "Google Sheets",\n      "status": "Novo"\n    },\n    {\n      "nome": "Ana Silva",\n      "email": "ana@email.com",\n      "telefone": "+5511966665555",\n      "interesse": "Servi√ßo VIP",\n      "origem": "Google Sheets",\n      "status": "Novo"\n    }\n  ]\n}'})]}),h.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-lg p-3",children:h.jsxs("p",{className:"text-xs text-amber-800 dark:text-amber-200",children:["üí° ",h.jsx("strong",{children:"Dica:"})," Configure o webhook com m√©todo GET para buscar todos os leads da planilha. O CRM ir√° detectar automaticamente leads duplicados e evitar duplica√ß√µes!"]})})]})]})]})}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(We,{className:"w-5 h-5 text-blue-600"}),h.jsx(Hr,{className:"text-gray-700 dark:text-gray-300",children:"Meta Pixel ID"})]}),h.jsx(Ur,{value:t,onChange:e=>r(e.target.value),placeholder:"Ex: 1234567890123456",className:"w-full"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Integre o Meta Pixel para rastrear convers√µes no Facebook e Instagram"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(Ne,{className:"w-5 h-5 text-orange-600"}),h.jsx(Hr,{className:"text-gray-700 dark:text-gray-300",children:"Google Analytics ID"})]}),h.jsx(Ur,{value:s,onChange:e=>n(e.target.value),placeholder:"Ex: G-XXXXXXXXXX ou UA-XXXXXXXXX",className:"w-full"}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Adicione o Google Analytics para rastrear o comportamento dos visitantes"})]}),h.jsx("div",{className:"flex justify-end",children:h.jsx(ot,{onClick:()=>d(this,null,function*(){g(!0);try{const e=localStorage.getItem("leadflow_access_token");(yield fetch(`https://${Gr}.supabase.co/functions/v1/make-server-4be966ab/webhooks/settings`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({metaPixelId:t,googleAnalyticsId:s,n8nMassWebhook:i,n8nLeadsWebhook:l,googleSheetsWebhook:u})})).ok?(i?localStorage.setItem("n8n_mass_webhook_url",i):localStorage.removeItem("n8n_mass_webhook_url"),x(!0),Ft.success("Configura√ß√µes salvas com sucesso!"),setTimeout(()=>x(!1),3e3)):Ft.error("Erro ao salvar configura√ß√µes")}catch(e){Ft.error("Erro ao salvar configura√ß√µes")}finally{g(!1)}}),disabled:f,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:f?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Salvando..."]}):p?h.jsxs(h.Fragment,{children:[h.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Salvo!"]}):"Salvar Integra√ß√µes"})})]})]})})}function Rf({user:e}){const[a,t]=X.useState(!1),[r,s]=X.useState(!1),[n,i]=X.useState(!1),[c,u]=X.useState({host:"",port:"587",user:"",password:"",fromEmail:"",fromName:"",secure:!1});X.useEffect(()=>{m()},[]);const m=()=>d(this,null,function*(){try{const e=yield xs("/smtp/settings","GET");e.success&&e.settings&&u({host:e.settings.host||"",port:e.settings.port||"587",user:e.settings.user||"",password:"",fromEmail:e.settings.fromEmail||"",fromName:e.settings.fromName||"",secure:e.settings.secure||!1})}catch(e){}});return h.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-6",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[h.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center",children:h.jsx(ia,{className:"w-5 h-5 text-white"})}),h.jsxs("div",{children:[h.jsx("h3",{className:"text-gray-900 dark:text-gray-100",children:"Configura√ß√µes SMTP"}),h.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Configure seu servidor SMTP para envio de email marketing"})]})]}),h.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-4 mb-6",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx(be,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),h.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[h.jsx("p",{className:"font-medium mb-1",children:"Provedores SMTP recomendados:"}),h.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[h.jsx("li",{children:"Gmail: smtp.gmail.com (porta 587)"}),h.jsx("li",{children:"SendGrid: smtp.sendgrid.net (porta 587)"}),h.jsx("li",{children:"Mailgun: smtp.mailgun.org (porta 587)"}),h.jsx("li",{children:"Amazon SES: email-smtp.us-east-1.amazonaws.com (porta 587)"})]})]})]})}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsxs(Hr,{htmlFor:"smtp-host",children:["Servidor SMTP ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx(Ur,{id:"smtp-host",value:c.host,onChange:e=>u(l(o({},c),{host:e.target.value})),placeholder:"smtp.gmail.com",className:"mt-1"})]}),h.jsxs("div",{children:[h.jsxs(Hr,{htmlFor:"smtp-port",children:["Porta ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx(Ur,{id:"smtp-port",value:c.port,onChange:e=>u(l(o({},c),{port:e.target.value})),placeholder:"587",type:"number",className:"mt-1"})]})]}),h.jsxs("div",{children:[h.jsxs(Hr,{htmlFor:"smtp-user",children:["Usu√°rio SMTP ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx(Ur,{id:"smtp-user",value:c.user,onChange:e=>u(l(o({},c),{user:e.target.value})),placeholder:"seu-email@gmail.com",type:"email",className:"mt-1"})]}),h.jsxs("div",{children:[h.jsxs(Hr,{htmlFor:"smtp-password",children:["Senha SMTP ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsxs("div",{className:"relative mt-1",children:[h.jsx(Ur,{id:"smtp-password",value:c.password,onChange:e=>u(l(o({},c),{password:e.target.value})),placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",type:n?"text":"password",className:"pr-10"}),h.jsx("button",{type:"button",onClick:()=>i(!n),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:n?h.jsx(Ue,{className:"w-4 h-4"}):h.jsx($e,{className:"w-4 h-4"})})]}),h.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Para Gmail, use uma senha de aplicativo. N√£o use sua senha principal."})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsxs(Hr,{htmlFor:"from-email",children:["Email de envio ",h.jsx("span",{className:"text-red-500",children:"*"})]}),h.jsx(Ur,{id:"from-email",value:c.fromEmail,onChange:e=>u(l(o({},c),{fromEmail:e.target.value})),placeholder:"noreply@seudominio.com",type:"email",className:"mt-1"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"from-name",children:"Nome do remetente"}),h.jsx(Ur,{id:"from-name",value:c.fromName,onChange:e=>u(l(o({},c),{fromName:e.target.value})),placeholder:"LeadFlow CRM",className:"mt-1"})]})]}),h.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[h.jsx(Ss,{id:"smtp-secure",checked:c.secure,onCheckedChange:e=>u(l(o({},c),{secure:e}))}),h.jsx(Hr,{htmlFor:"smtp-secure",className:"cursor-pointer",children:"Usar TLS/SSL (recomendado)"})]}),h.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[h.jsx(ot,{onClick:()=>d(this,null,function*(){if(c.host&&c.user&&c.fromEmail){t(!0);try{(yield xs("/smtp/settings","POST",c)).success&&(s(!0),setTimeout(()=>s(!1),3e3))}catch(e){alert("Erro ao salvar configura√ß√µes SMTP. Tente novamente.")}finally{t(!1)}}else alert("Por favor, preencha todos os campos obrigat√≥rios.")}),disabled:a,className:"bg-purple-600 hover:bg-purple-700 text-white",children:a?"Salvando...":r?h.jsxs(h.Fragment,{children:[h.jsx(Te,{className:"w-4 h-4 mr-2"}),"Salvo!"]}):h.jsxs(h.Fragment,{children:[h.jsx(ya,{className:"w-4 h-4 mr-2"}),"Salvar configura√ß√µes"]})}),h.jsxs(ot,{onClick:()=>d(this,null,function*(){if(c.host&&c.user&&c.fromEmail){t(!0);try{(yield xs("/smtp/test","POST",{toEmail:null==e?void 0:e.email})).success?alert(`‚úÖ Email de teste enviado para ${null==e?void 0:e.email}!`):alert("‚ùå Falha ao enviar email de teste. Verifique as configura√ß√µes.")}catch(a){alert(`‚ùå Erro ao enviar email de teste: ${a.message||"Erro desconhecido"}`)}finally{t(!1)}}else alert("Por favor, configure e salve as configura√ß√µes SMTP primeiro.")}),disabled:a||!c.host||!c.user,variant:"outline",children:[h.jsx(ia,{className:"w-4 h-4 mr-2"}),"Enviar email de teste"]})]})]}),h.jsx("div",{className:"mt-6 p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-700 rounded-lg",children:h.jsxs("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:[h.jsx("strong",{children:"Nota:"})," As configura√ß√µes SMTP s√£o necess√°rias para o envio de email marketing em massa. Certifique-se de usar credenciais v√°lidas de um provedor SMTP confi√°vel."]})})]})}function Of({user:e,onBack:a,onLogout:t,onProfileUpdate:r,onUpgrade:s}){var n,i,c,u,m,f,g,p,x;const[b,v]=X.useState((null==e?void 0:e.name)||""),[y,w]=X.useState(!1),[N,j]=X.useState(!1),[k,E]=X.useState(!1),[T,S]=X.useState(""),[C,A]=X.useState(""),[_,R]=X.useState(""),[O,I]=X.useState(!1);return h.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950",children:[h.jsx("div",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800",children:h.jsx("div",{className:"container mx-auto px-4 py-4",children:h.jsx("div",{className:"flex items-center gap-4",children:h.jsxs(ot,{variant:"ghost",size:"sm",onClick:a,children:[h.jsx(ve,{className:"w-4 h-4 mr-2"}),"Voltar ao Dashboard"]})})})}),h.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-5xl",children:[h.jsxs("div",{className:"mb-8",children:[h.jsx("h1",{className:"text-gray-900 dark:text-gray-100 mb-2",children:"Configura√ß√µes"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gerencie suas prefer√™ncias e informa√ß√µes da conta"})]}),h.jsxs(kf,{defaultValue:"profile",className:"space-y-6",children:[h.jsxs(Ef,{className:"grid w-full grid-cols-4",children:[h.jsxs(Tf,{value:"profile",children:[h.jsx(za,{className:"w-4 h-4 mr-2"}),"Perfil"]}),h.jsxs(Tf,{value:"plan",children:[h.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Plano"]}),h.jsxs(Tf,{value:"webhooks",children:[h.jsx(Ua,{className:"w-4 h-4 mr-2"}),"Integra√ß√µes"]}),h.jsxs(Tf,{value:"security",children:[h.jsx(Ea,{className:"w-4 h-4 mr-2"}),"Seguran√ßa"]})]}),h.jsx(Sf,{value:"profile",className:"space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-6",children:[h.jsx("h3",{className:"text-gray-900 dark:text-gray-100 mb-6",children:"Informa√ß√µes do perfil"}),h.jsxs("div",{className:"space-y-6",children:[h.jsx(Cf,{currentAvatar:null==e?void 0:e.avatar,userName:(null==e?void 0:e.name)||"Usu√°rio",onAvatarUpdate:a=>{const t=l(o({},e),{avatar:a});r(t)}}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"name",children:"Nome completo"}),h.jsx(Ur,{id:"name",value:b,onChange:e=>v(e.target.value),className:"mt-1"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"email",children:"Email"}),h.jsx(Ur,{id:"email",value:(null==e?void 0:e.email)||"",disabled:!0,className:"mt-1 bg-gray-50 dark:bg-gray-800"}),h.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"O email n√£o pode ser alterado"})]}),h.jsx("div",{className:"flex items-center gap-3",children:h.jsx(ot,{onClick:()=>d(this,null,function*(){w(!0);try{const e=yield vs(b);e.success&&(j(!0),r(e.user),setTimeout(()=>j(!1),3e3))}catch(e){}finally{w(!1)}}),disabled:y||b===(null==e?void 0:e.name),className:"bg-blue-600 hover:bg-blue-700 text-white",children:y?"Salvando...":N?h.jsxs(h.Fragment,{children:[h.jsx(Te,{className:"w-4 h-4 mr-2"}),"Salvo!"]}):h.jsxs(h.Fragment,{children:[h.jsx(ya,{className:"w-4 h-4 mr-2"}),"Salvar altera√ß√µes"]})})})]})]})]})}),h.jsx(Sf,{value:"plan",className:"space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-6",children:[h.jsx("h3",{className:"text-gray-900 dark:text-gray-100 mb-6",children:"Plano e cobran√ßa"}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("div",{className:"p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-950/30 dark:to-purple-950/30 rounded-lg border border-blue-100 dark:border-blue-900",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-1",children:"Plano atual"}),h.jsxs("p",{className:"text-gray-900 dark:text-gray-100",children:["Plano ",(M=null==e?void 0:e.plan,{free:"Gr√°tis",business:"Business",enterprise:"Enterprise"}[M]||M)]})]}),h.jsx(qa,{className:"w-8 h-8 text-blue-600"})]})}),h.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[h.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-1",children:"Leads"}),h.jsxs("p",{className:"text-gray-900 dark:text-gray-100",children:[(null==(n=null==e?void 0:e.usage)?void 0:n.leads)||0," /"," ",-1===(null==(i=null==e?void 0:e.limits)?void 0:i.leads)?"‚àû":(null==(c=null==e?void 0:e.limits)?void 0:c.leads)||0]})]}),h.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-1",children:"Mensagens"}),h.jsxs("p",{className:"text-gray-900 dark:text-gray-100",children:[(null==(u=null==e?void 0:e.usage)?void 0:u.messages)||0," /"," ",-1===(null==(m=null==e?void 0:e.limits)?void 0:m.messages)?"‚àû":(null==(f=null==e?void 0:e.limits)?void 0:f.messages)||0]})]}),h.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[h.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-1",children:"Envios em massa"}),h.jsxs("p",{className:"text-gray-900 dark:text-gray-100",children:[(null==(g=null==e?void 0:e.usage)?void 0:g.massMessages)||0," /"," ",-1===(null==(p=null==e?void 0:e.limits)?void 0:p.massMessages)?"‚àû":(null==(x=null==e?void 0:e.limits)?void 0:x.massMessages)||0]})]})]}),"free"===(null==e?void 0:e.plan)&&h.jsxs(ot,{onClick:s,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:[h.jsx(qa,{className:"w-4 h-4 mr-2"}),"Fazer upgrade do plano"]})]})]})}),h.jsxs(Sf,{value:"webhooks",className:"space-y-6",children:[h.jsx(os,{}),h.jsx(_f,{user:e,onUpgrade:s}),h.jsx(Rf,{user:e})]}),h.jsx(Sf,{value:"security",className:"space-y-6",children:h.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-sm border border-gray-200 dark:border-gray-800 p-6",children:[h.jsx("h3",{className:"text-gray-900 dark:text-gray-100 mb-6",children:"Seguran√ßa"}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs(ot,{variant:"outline",className:"w-full justify-start",onClick:()=>E(!0),children:[h.jsx(ra,{className:"w-4 h-4 mr-2"}),"Alterar senha"]}),h.jsx(ot,{variant:"outline",onClick:()=>d(this,null,function*(){try{yield bs.signout(),t()}catch(e){t()}}),className:"w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",children:"Sair da conta"})]})]})})]})]}),h.jsx(Kr,{open:k,onOpenChange:E,children:h.jsxs(Qr,{className:"sm:max-w-md",children:[h.jsxs(es,{children:[h.jsx(ts,{children:"Alterar senha"}),h.jsx(rs,{children:"Digite sua senha atual e escolha uma nova senha"})]}),h.jsxs("div",{className:"space-y-4 py-4",children:[h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"current-password",children:"Senha atual"}),h.jsx(Ur,{id:"current-password",type:"password",value:T,onChange:e=>S(e.target.value),className:"mt-1",placeholder:"Digite sua senha atual"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"new-password",children:"Nova senha"}),h.jsx(Ur,{id:"new-password",type:"password",value:C,onChange:e=>A(e.target.value),className:"mt-1",placeholder:"Digite a nova senha (m√≠n. 6 caracteres)"})]}),h.jsxs("div",{children:[h.jsx(Hr,{htmlFor:"confirm-password",children:"Confirmar nova senha"}),h.jsx(Ur,{id:"confirm-password",type:"password",value:_,onChange:e=>R(e.target.value),className:"mt-1",placeholder:"Confirme a nova senha"})]})]}),h.jsxs(as,{className:"flex gap-2",children:[h.jsx(ot,{variant:"outline",onClick:()=>{E(!1),S(""),A(""),R("")},disabled:O,children:"Cancelar"}),h.jsx(ot,{onClick:()=>d(this,null,function*(){if(T&&C&&_)if(C===_)if(C.length<6)Ft.error("A nova senha deve ter pelo menos 6 caracteres");else{I(!0);try{(yield ys(T,C)).success&&(Ft.success("Senha alterada com sucesso!"),E(!1),S(""),A(""),R(""))}catch(e){Ft.error(e.message||"Erro ao alterar senha")}finally{I(!1)}}else Ft.error("As senhas n√£o coincidem");else Ft.error("Por favor, preencha todos os campos")}),disabled:O,className:"bg-blue-600 hover:bg-blue-700 text-white",children:O?"Alterando...":"Alterar senha"})]})]})})]});var M}function If({pixelId:e}){return X.useEffect(()=>{var a,t,r,s,n,i;if(e)return a=window,t=document,r="script",a.fbq||(s=a.fbq=function(){s.callMethod?s.callMethod.apply(s,arguments):s.queue.push(arguments)},a._fbq||(a._fbq=s),s.push=s,s.loaded=!0,s.version="2.0",s.queue=[],(n=t.createElement(r)).async=!0,n.src="https://connect.facebook.net/en_US/fbevents.js",(i=t.getElementsByTagName(r)[0]).parentNode.insertBefore(n,i)),window.fbq("init",e),window.fbq("track","PageView"),()=>{}},[e]),null}const Mf=X.createContext(void 0),Pf={setTheme:e=>{},themes:[]},Lf=e=>{var a=c(e,[]);const{theme:t="system"}=null!==(r=X.useContext(Mf))&&void 0!==r?r:Pf;var r;return h.jsx(Gt,o({theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"}},a))};function Df(){const[e,a]=X.useState("landing"),[t,r]=X.useState(null),[s,n]=X.useState(!0),[i,l]=X.useState(""),[c,u]=X.useState(!1);X.useEffect(()=>{const e=window.location.hash;return e&&e.includes("type=recovery")?(n(!0),void setTimeout(()=>{p()},500)):e&&e.includes("access_token")&&!e.includes("type=recovery")?(n(!0),void setTimeout(()=>{g()},1e3)):void f()},[]),X.useEffect(()=>{t&&m()},[t]);const m=()=>d(this,null,function*(){var e;try{if(!localStorage.getItem("leadflow_access_token"))return;const a=yield xs("/webhooks/settings","GET");a.success&&(null==(e=a.webhookSettings)?void 0:e.metaPixelId)&&l(a.webhookSettings.metaPixelId)}catch(a){}}),f=()=>d(this,null,function*(){var e,t;try{const n=us(),{data:i}=yield n.auth.getSession();if(i.session){localStorage.setItem("leadflow_access_token",i.session.access_token),localStorage.setItem("leadflow_refresh_token",i.session.refresh_token);localStorage.getItem("leadflow_access_token");yield new Promise(e=>setTimeout(e,100));try{const t=yield xs("/user/profile","GET");r(o({id:i.session.user.id,email:i.session.user.email,name:(null==(e=i.session.user.user_metadata)?void 0:e.name)||t.name||"",avatar:t.avatar},t)),a("dashboard")}catch(s){r({id:i.session.user.id,email:i.session.user.email,name:(null==(t=i.session.user.user_metadata)?void 0:t.name)||"User",plan:"free",subscription_plan:"free",isTrial:!1,limits:{leads:100,messages:50,massMessages:5},usage:{leads:0,messages:0,massMessages:0}}),a("dashboard")}}}catch(i){localStorage.removeItem("leadflow_access_token"),localStorage.removeItem("leadflow_refresh_token")}n(!1)}),g=()=>d(this,null,function*(){var e,t;const s=us(),{data:n,error:i}=yield s.auth.getSession();if(!i&&n.session){localStorage.setItem("leadflow_access_token",n.session.access_token),localStorage.setItem("leadflow_refresh_token",n.session.refresh_token),localStorage.getItem("leadflow_access_token"),window.location.hash&&window.history.replaceState(null,"",window.location.pathname),yield new Promise(e=>setTimeout(e,100));try{const t=yield xs("/user/profile","GET");r(o({id:n.session.user.id,email:n.session.user.email,name:(null==(e=n.session.user.user_metadata)?void 0:e.name)||t.name||""},t)),a("dashboard")}catch(l){r({id:n.session.user.id,email:n.session.user.email,name:(null==(t=n.session.user.user_metadata)?void 0:t.name)||"",plan:"free",limits:{leads:100,messages:50,massMessages:5},usage:{leads:0,messages:0,massMessages:0}}),a("dashboard")}}}),p=()=>d(this,null,function*(){if(!window.location.hash.includes("type=recovery"))return n(!1),void a("landing");const e=us(),{data:t,error:r}=yield e.auth.getSession();if(r)return n(!1),void a("landing");t.session?(localStorage.setItem("leadflow_access_token",t.session.access_token),localStorage.setItem("leadflow_refresh_token",t.session.refresh_token),window.location.hash&&window.history.replaceState(null,"",window.location.pathname),a("reset-password"),n(!1)):(n(!1),a("landing"))}),x=()=>d(this,null,function*(){var e,t;try{yield new Promise(e=>setTimeout(e,100));if(!localStorage.getItem("leadflow_access_token"))return;const n=us(),{data:i}=yield n.auth.getSession();if(i.session){try{const a=yield xs("/user/profile","GET");r(o({id:i.session.user.id,email:i.session.user.email,name:(null==(e=i.session.user.user_metadata)?void 0:e.name)||a.name||"",avatar:a.avatar},a))}catch(s){r({id:i.session.user.id,email:i.session.user.email,name:(null==(t=i.session.user.user_metadata)?void 0:t.name)||""})}a("dashboard")}}catch(n){}}),b=()=>{localStorage.removeItem("leadflow_access_token"),localStorage.removeItem("leadflow_refresh_token"),r(null),a("landing")};return s?h.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:h.jsxs("div",{className:"text-center",children:[h.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),h.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Carregando..."}),h.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Vers√£o 31 - LeadFlow CRM"})]})}):h.jsxs(h.Fragment,{children:[h.jsx(If,{pixelId:i}),h.jsx(Lf,{}),"landing"===e&&h.jsxs("div",{className:"min-h-screen bg-gray-50",children:[h.jsx(ct,{onLogin:()=>a("login"),onSignup:()=>a("signup")}),h.jsxs("main",{children:[h.jsx(dt,{onGetStarted:()=>a("signup")}),h.jsx(ut,{}),h.jsx(pt,{}),h.jsx(bt,{onSelectPlan:()=>a("signup")}),h.jsx(yt,{}),h.jsx(Nt,{}),h.jsx(jt,{onGetStarted:()=>a("signup")})]}),h.jsx(Tt,{})]}),"login"===e&&h.jsx(wf,{onSuccess:x,onSwitchToSignup:()=>a("signup")}),"signup"===e&&h.jsx(Nf,{onSuccess:x,onSwitchToLogin:()=>a("login")}),"reset-password"===e&&h.jsx(jf,{onSuccess:()=>a("login"),onCancel:()=>a("login")}),"settings"===e&&h.jsx(Of,{user:t,onBack:()=>a("dashboard"),onLogout:b,onProfileUpdate:e=>{r(e)},onUpgrade:()=>u(!0)}),"admin"===e&&h.jsx(Cs,{}),"dashboard"===e&&h.jsx(vf,{user:t,onLogout:b,onSettings:()=>a("settings"),onAdmin:()=>a("admin"),onUserUpdate:r}),c&&h.jsx(qs,{isOpen:c,onClose:()=>u(!1),currentPlan:(null==t?void 0:t.plan)||"free",onUpgradeSuccess:e=>{r(e),u(!1)}})]})}fe.createRoot(document.getElementById("root")).render(h.jsx(K.StrictMode,{children:h.jsx(Df,{})}));
